{"version":3,"file":"mh091rc1a.js","sources":["../node_modules/gl-matrix/esm/common.js","../node_modules/gl-matrix/esm/mat4.js","../node_modules/gl-matrix/esm/vec3.js","../src/animorph/DirectoryList.ts","../src/animorph/PoseRotation.ts","../src/gl/calculateNormals.ts","../src/gl/RenderMesh.ts","../src/animorph/Face.ts","../src/filesystem/FileSystemAdapter.ts","../src/lib/StringToLineIterator.ts","../src/lib/StringToLine.ts","../src/animorph/FaceVector.ts","../src/animorph/Vertex.ts","../src/animorph/VertexVector.ts","../src/animorph/UnsortedUsedVertex.ts","../src/animorph/Target.ts","../src/animorph/TargetEntry.ts","../src/lib/MultiSet.ts","../src/animorph/PoseTranslation.ts","../src/animorph/PoseTarget.ts","../src/animorph/PoseEntry.ts","../src/animorph/FaceGroup.ts","../node_modules/toad.js/node_modules/toad.jsx/lib/jsx-runtime.js","../node_modules/toad.js/lib/src/util/lsx.js","../node_modules/toad.js/lib/src/Signal.js","../node_modules/toad.js/lib/src/model/Model.js","../node_modules/toad.js/lib/src/model/ValueModel.js","../node_modules/toad.js/lib/src/model/NumberModel.js","../node_modules/toad.js/lib/src/model/BooleanModel.js","../node_modules/toad.js/lib/src/util/BigDecimal.js","../node_modules/toad.js/lib/src/util/expressions/ExpressionNode.js","../node_modules/toad.js/lib/src/util/expressions/Lexer.js","../node_modules/toad.js/lib/src/util/expressions/expression.js","../node_modules/toad.js/lib/src/model/TextModel.js","../node_modules/toad.js/lib/src/model/HtmlModel.js","../node_modules/toad.js/lib/src/model/Action.js","../node_modules/toad.js/lib/src/util/dom.js","../node_modules/toad.js/lib/src/controller/globalController.js","../node_modules/toad.js/lib/src/controller/Controller.js","../node_modules/toad.js/lib/src/util/animation.js","../node_modules/toad.js/lib/src/view/View.js","../node_modules/toad.js/lib/src/view/ModelView.js","../node_modules/toad.js/lib/src/view/ActionView.js","../node_modules/toad.js/lib/src/style/tx-text.js","../node_modules/toad.js/lib/src/view/TextField.js","../node_modules/toad.js/lib/src/view/textAreaStyle.js","../node_modules/toad.js/lib/src/view/TextTool.js","../node_modules/toad.js/lib/src/view/TextArea.js","../node_modules/toad.js/lib/src/view/Display.js","../node_modules/toad.js/lib/src/style/tx-button.js","../node_modules/toad.js/lib/src/view/Button.js","../node_modules/toad.js/lib/src/view/BooleanView.js","../node_modules/toad.js/lib/src/style/tx-checkbox.js","../node_modules/toad.js/lib/src/view/Checkbox.js","../node_modules/toad.js/lib/src/style/tx-search.js","../node_modules/toad.js/lib/src/view/Search.js","../node_modules/toad.js/lib/src/style/tx-switch.js","../node_modules/toad.js/lib/src/view/Switch.js","../node_modules/toad.js/lib/src/style/tx-radio.js","../node_modules/toad.js/lib/src/view/RadioButton.js","../node_modules/toad.js/lib/src/menu/MenuState.js","../node_modules/toad.js/lib/src/menu/MenuHelper.js","../node_modules/toad.js/lib/src/menu/PopupMenu.js","../node_modules/toad.js/lib/src/style/tx-combobox.js","../node_modules/toad.js/lib/src/style/tx-menu.js","../node_modules/toad.js/lib/src/view/Select.js","../node_modules/toad.js/lib/src/style/tx-slider.js","../node_modules/toad.js/lib/src/util/color.js","../node_modules/toad.js/lib/src/view/Slider.js","../node_modules/toad.js/lib/src/view/GenericTool.js","../node_modules/toad.js/lib/src/view/ToolButton.js","../node_modules/toad.js/lib/src/view/SlotView.js","../node_modules/toad.js/lib/src/view/ToadIf.js","../node_modules/toad.js/lib/src/style/tx-tabs.js","../node_modules/toad.js/lib/src/style/tx-scrollbar.js","../node_modules/toad.js/lib/src/view/Tab.js","../node_modules/toad.js/lib/src/menu/menuStyle.js","../node_modules/toad.js/lib/src/menu/MenuButton.js","../node_modules/toad.js/lib/src/menu/MenuNode.js","../node_modules/toad.js/lib/src/menu/Menu.js","../node_modules/toad.js/lib/src/menu/MenuSpacer.js","../node_modules/toad.js/lib/src/table/model/TableModel.js","../node_modules/toad.js/lib/src/table/TableEditMode.js","../node_modules/toad.js/lib/src/table/adapter/TableAdapter.js","../node_modules/toad.js/lib/src/table/TableEventType.js","../node_modules/toad.js/lib/src/table/TablePos.js","../node_modules/toad.js/lib/src/table/model/SelectionModel.js","../node_modules/toad.js/lib/src/table/model/TypedTableModel.js","../node_modules/toad.js/lib/src/table/TableEvent.js","../node_modules/toad.js/lib/src/table/private/TableFriend.js","../node_modules/toad.js/lib/src/table/private/TableAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertRowAnimation.js","../node_modules/toad.js/lib/src/table/private/RemoveRowAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertColumnAnimation.js","../node_modules/toad.js/lib/src/table/private/RemoveColumnAnimation.js","../node_modules/toad.js/lib/src/util/scrollIntoView.js","../node_modules/toad.js/lib/src/table/style/tx-table.js","../node_modules/toad.js/lib/src/table/Table.js","../node_modules/toad.js/lib/src/table/TableTool.js","../src/animorph/Mesh.ts","../node_modules/fflate/esm/browser.js","../src/filesystem/HTTPFSAdapter.ts","../src/gl/shader/AbstractShader.ts","../src/gl/shader/RGBAShader.ts","../node_modules/toad.jsx/lib/jsx-runtime.js","../src/PosePanel.tsx","../src/DetailPanel.tsx","../src/CharacterPanel.tsx","../src/screen.tsx","../src/Selector.tsx","../src/SelectorListener.tsx","../src/main.ts","../src/gl/util.ts"],"sourcesContent":["/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\n\nenum RecursiveLevel {\n    NO_LIMIT = -1, // read directories recursive without limit\n    NO_RECURSIVE = 0, // read only the base directory without recursion\n}\n\nexport enum FileType {\n    REGULAR_FILE, // only regular files\n    DIRECTORY, // only directories\n}\n\nexport class DirectoryList {\n    private file_list: string[] = []\n    private file_filter: string = \"\"\n    private path: string = \"\"\n    private recursive_level: number = -1\n    private recursive_counter: number = 0\n    private file_type: FileType = FileType.REGULAR_FILE\n\n    setFileFilter(file_filter: string) {\n        this.file_filter = file_filter\n    }\n    setRecursive(recursive_level: number): void {\n        this.recursive_level = recursive_level\n    }\n    setRootPath(path: string): void {\n        this.path = path\n    }\n    setFileType(file_type: FileType) {\n        this.file_type = file_type\n    }\n    getDirectoryList(): string[] {\n        this.readDirRecursive(this.path)\n        this.recursive_counter = 0\n        return this.file_list\n    }\n    private readDirRecursive(dir_str: string) {\n        for (const dname of FileSystemAdapter.listDir(dir_str)) {\n            if (dir_str.charAt(0) === \".\") {\n                continue\n            }\n            const dir_file = `${dir_str}/${dname}`\n            if (FileSystemAdapter.isDir(dir_file)) {\n                if (this.file_type === FileType.DIRECTORY) {\n                    this.file_list.push(dir_file)\n                }\n                if (this.recursive_counter < this.recursive_level || this.recursive_level == RecursiveLevel.NO_LIMIT) {\n                    ++this.recursive_counter\n                    this.readDirRecursive(dir_file)\n                    --this.recursive_counter\n                }\n            } else {\n                if (this.hasFileFilterEnding(dir_file)) {\n                    this.file_list.push(dir_file)\n                }\n            }\n        }\n    }\n    private hasFileFilterEnding(file: string): boolean {\n        if (this.file_filter.length > file.length) {\n            return false\n        }\n        return file.endsWith(this.file_filter)\n    }\n}\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { UnsortedUsedVertex } from \"./PoseTarget\"\n\nexport interface PoseTargetData {\n    vertex_number: number\n    rotation: number\n}\n\nexport enum RotateAxis {\n    X_AXIS,\n    Y_AXIS,\n    Z_AXIS,\n}\n\nexport class PoseRotation extends Array<PoseTargetData> {\n    /// Used to calculate center\n    private centerVertexNumbers!: number[]\n    /// Will be used as parameter for Matrix::setRoation()\n    private axis!: RotateAxis\n    /// Set of all indices in the \".rot\" file\n    private modVertex: UnsortedUsedVertex = [];\n    /// Currently unused\n    private hasCenter: boolean = false\n    /// Minimum angle in radians\n    private minAngle: number = 0\n    /// Maximum angle in radians\n    private maxAngle: number = 0\n    /// will be set to true by PoseTarget::calcNormalizations() if our (min|max)Angle != PoseTarget::(min|max)Angle\n    private normalize: boolean = false\n    //string inFilename;\n    /* \\brief \"Category\"? Currently always \"00\"\n     * First two characters of the filename, eg . \"00\" for \"00_Z_LIMB_SPINE1.rot\"\n     */\n    private cat: string = \"\"\n\n    /* \\brief Centroid of centerVertexNumbers\n     * Is initialized by PoseTarget::calcRotationsCenteroids()\n     */\n    private center!: vec3\n    ///Limb rotation Type\n    private mbLimb!: boolean\n\n    clear() {\n        this.length = 0\n    }\n\n    load(filename: string): boolean {\n        this.clear()\n\n        const info = FileSystemAdapter.readFile(`${filename}.info`)\n            .split(\"\\n\")\n            .map((it) => it.trim())\n        if (info.length < 3) {\n            return false\n        }\n        const str = info[0]\n        const ax = info[1].charAt(0) // axis X,Y,Z\n        const minMax = info[2].split(\",\")\n        this.minAngle = parseFloat(minMax[0])\n        this.maxAngle = parseFloat(minMax[1])\n\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 2) {\n                const td: PoseTargetData = {\n                    vertex_number: parseInt(tokens[0]),\n                    rotation: parseFloat(tokens[1]),\n                }\n                this.modVertex.push(td.vertex_number)\n                this.push(td)\n            }\n        }\n\n        switch (ax) {\n            case \"X\":\n                this.axis = RotateAxis.X_AXIS\n                break\n            case \"Y\":\n                this.axis = RotateAxis.Y_AXIS\n                break\n            case \"Z\":\n                this.axis = RotateAxis.Z_AXIS\n                break\n            default:\n                throw Error(`unknown axis ${ax}`)\n        }\n        this.centerVertexNumbers = str.split(\",\").map((it) => parseInt(it))\n        return true\n    }\n    getCenterVertexNumbers() {\n        return this.centerVertexNumbers\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n    getCenter() {\n        return this.center\n    }\n    setCenter(c: vec3) {\n        this.center = c\n    }\n\n    getAxis() {\n        return this.axis\n    }\n    getHasCenter() {\n        return this.hasCenter\n    }\n    setHasCenter(c: boolean) {\n        this.hasCenter = c\n    }\n\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n    getNormalize() {\n        return this.normalize\n    }\n    setNormalize(inNormalize: boolean) {\n        this.normalize = inNormalize\n    }\n\n    //const string &getFilename() const {return inFilename;}\n    getCat() {\n        return this.cat\n    }\n    setCat(inCat: string) {\n        this.cat = inCat\n    }\n\n    setLimb(limb: boolean) {\n        this.mbLimb = limb\n    }\n    getLimb() {\n        return this.mbLimb\n    }\n}\n","import { vec3 } from 'gl-matrix'\n\nexport function calculateNormalsQuads(\n    normals: Float32Array,\n    vertex: Float32Array,\n    indices: number[]): Float32Array {\n\n    function addNormal(index: number, normal: vec3) {\n        normals[index] += normal[0]\n        normals[index + 1] += normal[1]\n        normals[index + 2] += normal[2]\n    }\n    \n    // add vectors\n    for (let i = 0; i < indices.length;) {\n        const i1 = indices[i++] * 3\n        const i2 = indices[i++] * 3\n        const i3 = indices[i++] * 3\n        const i4 = indices[i++] * 3\n    \n\n        const p1 = vec3.fromValues(vertex[i1], vertex[i1 + 1], vertex[i1 + 2])\n        const p2 = vec3.fromValues(vertex[i2], vertex[i2 + 1], vertex[i2 + 2])\n        const p3 = vec3.fromValues(vertex[i3], vertex[i3 + 1], vertex[i3 + 2])\n\n        const u = vec3.create(), v = vec3.create(), n = vec3.create()\n        vec3.subtract(u, p2, p1)\n        vec3.subtract(v, p3, p1)\n        vec3.cross(n, u, v)\n        vec3.normalize(n, n)\n\n        addNormal(i1, n)\n        addNormal(i2, n)\n        addNormal(i3, n)\n        addNormal(i4, n)\n    }\n\n    // normalize\n    for(let normalIndex = 0; normalIndex < vertex.length; normalIndex += 3) {\n        const normal = vec3.fromValues(normals[normalIndex], normals[normalIndex + 1], normals[normalIndex + 2])\n        vec3.normalize(normal, normal)\n        normals[normalIndex] = normal[0]\n        normals[normalIndex + 1] = normal[1]\n        normals[normalIndex + 2] = normal[2]\n    }\n    return normals\n}\n\nexport function calculateNormalsTriangles(\n    normals: Float32Array,\n    vertex: Float32Array,\n    indices: number[]): Float32Array {\n\n    function addNormal(index: number, normal: vec3) {\n        normals[index] += normal[0]\n        normals[index + 1] += normal[1]\n        normals[index + 2] += normal[2]\n    }\n    \n    // add vectors\n    for (let i = 0; i < indices.length;) {\n        const i1 = indices[i++] * 3\n        const i2 = indices[i++] * 3\n        const i3 = indices[i++] * 3\n\n        const p1 = vec3.fromValues(vertex[i1], vertex[i1 + 1], vertex[i1 + 2])\n        const p2 = vec3.fromValues(vertex[i2], vertex[i2 + 1], vertex[i2 + 2])\n        const p3 = vec3.fromValues(vertex[i3], vertex[i3 + 1], vertex[i3 + 2])\n\n        const u = vec3.create(), v = vec3.create(), n = vec3.create()\n        vec3.subtract(u, p2, p1)\n        vec3.subtract(v, p3, p1)\n        vec3.cross(n, u, v)\n        vec3.normalize(n, n)\n\n        addNormal(i1, n)\n        addNormal(i2, n)\n        addNormal(i3, n)\n    }\n\n    // normalize\n    for(let normalIndex = 0; normalIndex < vertex.length; normalIndex += 3) {\n        const normal = vec3.fromValues(normals[normalIndex], normals[normalIndex + 1], normals[normalIndex + 2])\n        vec3.normalize(normal, normal)\n        normals[normalIndex] = normal[0]\n        normals[normalIndex + 1] = normal[1]\n        normals[normalIndex + 2] = normal[2]\n    }\n    return normals\n}\n","import { calculateNormalsQuads, calculateNormalsTriangles } from \"./calculateNormals\"\nimport { AbstractShader } from \"./shader/AbstractShader\"\n\ninterface GLXYZUV {\n    idxExtra: number[]\n    indices: number[]\n    vertex: Float32Array\n    texcoord?: Float32Array\n}\n\n/**\n * I am a mesh which can be rendered by OpenGL.\n * a) convert quads to triangles\n * b) join fxyz and fuv into one list\n * c) calculate normals\n */\nexport class RenderMesh {\n    gl: WebGL2RenderingContext\n    glIndices: WebGLBuffer\n    glVertex: WebGLBuffer\n    glNormal: WebGLBuffer\n    glTexture?: WebGLBuffer\n\n    fvertex: number[]\n    normal: Float32Array\n    glData: GLXYZUV\n    quads: boolean\n\n    constructor(\n        gl: WebGL2RenderingContext,\n        vertex: Float32Array,\n        fvertex: number[],\n        uvs?: Float32Array,\n        fuvs?: number[],\n        quads = true\n    ) {\n        this.gl = gl\n        this.fvertex = fvertex\n        this.quads = quads\n\n        if (quads === false) {\n            this.glIndices = this.createBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, fvertex)\n            this.glVertex = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, vertex)\n            this.normal = new Float32Array(vertex.length)\n            calculateNormalsTriangles(this.normal, vertex, fvertex)\n            this.glNormal = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, this.normal)\n            this.glData = {\n                indices: fvertex,\n            } as GLXYZUV\n            return\n        }\n\n        const glData = decoupleXYZandUV(vertex, fvertex, uvs, fuvs)\n        this.glData = glData\n        this.glIndices = this.createBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, glData.indices)\n        this.glVertex = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, glData.vertex)\n        if (glData.texcoord) {\n            this.glTexture = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, glData.texcoord)\n        }\n\n        this.normal = new Float32Array(glData.vertex.length)\n        calculateNormalsQuads(this.normal, vertex, fvertex)\n        this.glData.idxExtra.forEach((v, i) => {\n            this.normal[vertex.length + i * 3] = this.normal[v * 3]\n            this.normal[vertex.length + i * 3 + 1] = this.normal[v * 3 + 1]\n            this.normal[vertex.length + i * 3 + 2] = this.normal[v * 3 + 2]\n        })\n\n        this.glNormal = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, this.normal)\n    }\n\n    update(vertex: Float32Array) {\n        if (this.quads) {\n            this.glData.vertex.set(vertex)\n            calculateNormalsQuads(this.normal, vertex, this.fvertex)\n\n            this.glData.idxExtra.forEach((v, i) => {\n                this.glData.vertex[vertex.length + i * 3] = vertex[v * 3]\n                this.glData.vertex[vertex.length + i * 3 + 1] = vertex[v * 3 + 1]\n                this.glData.vertex[vertex.length + i * 3 + 2] = vertex[v * 3 + 2]\n\n                this.normal[vertex.length + i * 3] = this.normal[v * 3]\n                this.normal[vertex.length + i * 3 + 1] = this.normal[v * 3 + 1]\n                this.normal[vertex.length + i * 3 + 2] = this.normal[v * 3 + 2]\n            })\n            // prettier-ignore\n            this.updateBuffer(this.glVertex, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.glData.vertex)\n            this.updateBuffer(this.glNormal, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.normal)\n        } else {\n            this.updateBuffer(this.glVertex, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, vertex)\n            calculateNormalsTriangles(this.normal, vertex, this.fvertex)\n            this.updateBuffer(this.glNormal, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.normal)\n        }\n    }\n\n    draw(programInfo: AbstractShader, mode: number) {\n        this.bind(programInfo)\n        this.gl.drawElements(mode, this.glData.indices.length, this.gl.UNSIGNED_SHORT, 0)\n    }\n\n    bind(programInfo: AbstractShader): void {\n        programInfo.bind(this.glIndices, this.glVertex, this.glNormal, this.glTexture)\n    }\n\n    drawSubset(mode: number, offset: number, length: number) {\n        // divide by quad edge count, multiply by triangle edge count, multiply by octets in short\n        // this.gl.drawElements(mode, (length / 4) * 6, this.gl.UNSIGNED_SHORT, (offset / 4) * 6)\n        this.gl.drawElements(mode, length, this.gl.UNSIGNED_SHORT, offset * 2)\n    }\n\n    protected createBuffer(\n        target: GLenum,\n        usage: GLenum,\n        type: Float32ArrayConstructor | Uint16ArrayConstructor,\n        data: number[] | Float32Array\n    ): WebGLBuffer {\n        const buffer = this.gl.createBuffer()\n        if (buffer === null) {\n            throw Error(\"Failed to create new WebGLBuffer\")\n        }\n        this.updateBuffer(buffer, target, usage, type, data)\n        return buffer\n    }\n\n    protected updateBuffer(\n        buffer: WebGLBuffer,\n        target: GLenum,\n        usage: GLenum,\n        type: Float32ArrayConstructor | Uint16ArrayConstructor,\n        data: number[] | Float32Array\n    ) {\n        this.gl.bindBuffer(target, buffer)\n        if (data instanceof Float32Array) {\n            this.gl.bufferData(target, data, usage)\n            return\n        }\n        if (data instanceof Int16Array) {\n            this.gl.bufferData(target, data, usage)\n            return\n        }\n        this.gl.bufferData(target, new type(data), usage)\n    }\n}\n\nexport function decoupleXYZandUV(\n    xyz: Float32Array,\n    fxyz: Uint16Array | number[],\n    uv?: Float32Array | number[],\n    fuv?: Uint16Array | number[]\n): GLXYZUV {\n    if (fuv !== undefined && fxyz.length !== fuv.length) {\n        throw Error(`fvertex and fuv must have the same length, instead it is ${fxyz.length} and ${fuv.length}`)\n    }\n    if (fuv !== undefined && uv === undefined) {\n        throw Error(`uv & fuv must both be defined`)\n    }\n    const indices: number[] = []\n    const uvOut = new Array((xyz.length / 3) * 2) // for each vertex we have texture coordinate\n\n    const idxExtra: number[] = []\n    const xyzOutExtra: number[] = []\n    const uvOutExtra: number[] = []\n\n    function getIndex(i: number) {\n        return fxyz[i]\n    }\n\n    function decoupleXYZandUV(i: number) {\n        const idxXYZ = fxyz[i]\n\n        const xyzIdx = fxyz[i]\n        const uvIdx = fuv![i]\n        const u = uv![uvIdx * 2]\n        const v = uv![uvIdx * 2 + 1]\n\n        if (uvOut[xyzIdx * 2] === undefined) {\n            uvOut[xyzIdx * 2] = u\n            uvOut[xyzIdx * 2 + 1] = v\n            return idxXYZ\n        }\n        if (uvOut[xyzIdx * 2] === u && uvOut[xyzIdx * 2 + 1] === v) {\n            return idxXYZ\n        }\n\n        const newIdxXYZ = (xyz.length + xyzOutExtra.length) / 3\n\n        const idxXYZIn = idxXYZ * 3\n        const x = xyz[idxXYZIn]\n        const y = xyz[idxXYZIn + 1]\n        const z = xyz[idxXYZIn + 2]\n\n        idxExtra.push(idxXYZ)\n        xyzOutExtra.push(x)\n        xyzOutExtra.push(y)\n        xyzOutExtra.push(z)\n        uvOutExtra.push(u)\n        uvOutExtra.push(v)\n\n        return newIdxXYZ\n    }\n\n    let f\n    if (fuv === undefined) {\n        f = getIndex\n    } else {\n        f = decoupleXYZandUV\n    }\n\n    for (let i = 0; i < fxyz.length; i += 4) {\n        const i0 = f(i)\n        indices.push(i0)\n        indices.push(f(i + 1))\n        const i2 = f(i + 2)\n        indices.push(i2)\n        indices.push(f(i + 3))\n        indices.push(i0)\n        indices.push(i2)\n    }\n\n    if (fuv === undefined) {\n        return {\n            idxExtra: [],\n            indices,\n            vertex: xyz,\n            texcoord: undefined,\n        }\n    }\n\n    const vertex = new Float32Array(xyz.length + xyzOutExtra.length)\n    const texcoord = new Float32Array(uvOut.length + uvOutExtra.length)\n\n    vertex.set(xyz)\n    vertex.set(xyzOutExtra, xyz.length)\n    texcoord.set(uvOut)\n    texcoord.set(uvOutExtra, uvOut.length)\n\n    return { indices, vertex, texcoord, idxExtra }\n}\n","import { vec3 } from \"gl-matrix\"\n\nexport class Face {\n    vertices: number[]\n    get size() {\n        return this.vertices.length\n    }\n    material_index: number\n    no: vec3\n\n    constructor(v0: number, v1: number, v2: number, v3?: number) {\n        if (v3 !== undefined) {\n            this.vertices = [v0, v1, v2, v3]\n        } else {\n            this.vertices = [v0, v1, v2]\n        }\n        this.material_index = -1\n        this.no = vec3.create()\n    }\n}\n","import { AbstractFileSystemAdapter } from \"./AbstractFileSystemAdapter\"\n\nexport class FileSystemAdapter {\n    private static instance?: AbstractFileSystemAdapter\n\n    static setInstance(instance: AbstractFileSystemAdapter) {\n        FileSystemAdapter.instance = instance\n    }\n    static readFile(pathname: string): string {\n        return FileSystemAdapter.instance!.readFile(pathname)\n    }\n    static exists(pathname: string): boolean {\n        return FileSystemAdapter.instance!.exists(pathname)\n    }\n    static isFile(pathname: string): boolean {\n        return FileSystemAdapter.instance!.isFile(pathname)\n    }\n    static isDir(pathname: string): boolean {\n        return FileSystemAdapter.instance!.isDir(pathname)\n    }\n    static listDir(pathname: string): string[] {\n        return FileSystemAdapter.instance!.listDir(pathname)\n    }\n    static realPath(pathname: string): string {\n        return FileSystemAdapter.instance!.realPath(pathname)\n    }\n    static joinPath(pathname1: string, pathname2: string): string {\n        return FileSystemAdapter.instance!.joinPath(pathname1, pathname2)\n    }\n}\n","export class StringToLineIterator implements Iterator<string> {\n    private data: string\n    private index: number\n\n    constructor(data: string) {\n        this.data = data\n        this.index = 0\n    }\n\n    next(): IteratorResult<string> {\n        if (this.data.length === 0 || this.index === -1)\n            return { value: undefined, done: true }\n        const nextIndex = this.data.indexOf('\\n', this.index)\n        let length: number | undefined\n        if (nextIndex === -1) {\n            length = undefined\n        } else {\n            length = nextIndex - this.index\n        }\n        const result = this.data.substr(this.index, length)\n        if (nextIndex === -1) {\n            this.index = -1\n        } else {\n            this.index = nextIndex + 1\n        }\n        return { value: result, done: false }\n    }\n\n}\n","import { StringToLineIterator } from './StringToLineIterator'\n\nexport class StringToLine implements Iterable<string> {\n    data: string;\n    constructor(data: string) {\n        this.data = data\n    }\n\n    [Symbol.iterator](): Iterator<string> {\n        return new StringToLineIterator(this.data)\n    }\n}\n","import { Face } from \"./Face\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\n\nexport class FaceVector extends Array<Face> {\n    loadGeometry(filename: string) {\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0, triangles = 0, quads = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            switch (tokens.length) {\n                case 3:\n                    ++triangles\n                    this.push(new Face(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2])))\n                    break\n                case 4:\n                    ++quads\n                    this.push(new Face(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2]), parseFloat(tokens[3])))\n                    break\n            }\n        }\n        console.log(`loaded ${triangles} triangles and ${quads} quads from ${filename}`)\n    }\n}\n","import { vec3 } from \"gl-matrix\"\n\nexport class Vertex {\n    co: vec3\n    constructor(x: number, y: number, z: number)\n    constructor(vertex: Vertex)\n    constructor(xOrVertex: number | Vertex, y?: number, z?: number) {\n        if (xOrVertex instanceof Vertex) {\n            this.co = vec3.clone(xOrVertex.co)\n        } else {\n            this.co = vec3.fromValues(xOrVertex, y!, z!)\n        }\n    }\n}\n","import { Vertex } from \"./Vertex\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { vec3 } from \"gl-matrix\"\n\nexport class VertexVector extends Array<Vertex> {\n    load(filename: string) {\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 3) {\n                this.push(new Vertex(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2])))\n            }\n        }\n        console.log(`loaded ${this.length} vertices from ${filename}`)\n    }\n    clone() {\n        const clone = new VertexVector(this.length)\n        for (let i = 0; i < this.length; ++i) {\n            const v = this[i]\n            clone[i] = new Vertex(v)\n        }\n        return clone\n    }\n    setFrom(src: VertexVector) {\n        if (this.length !== src.length) {\n            throw Error(`length must be the same`)\n        }\n        for (let i = 0; i < this.length; ++i) {\n            vec3.copy(this[i].co, src[i].co)\n        }\n    }\n}\n","export class UnsortedUsedVertex extends Array<number> { }\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { TargetData } from \"./TargetData\"\nimport { UnsortedUsedVertex } from \"./UnsortedUsedVertex\"\n\nexport class Target extends Array<TargetData> {\n    private modVertex = new UnsortedUsedVertex()\n    load(filename: string): boolean {\n        const data = FileSystemAdapter.readFile(`${filename}`)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 4) {\n                const td: TargetData = {\n                    vertex_number: parseInt(tokens[0]),\n                    morph_vector: vec3.fromValues(parseFloat(tokens[1]), parseFloat(tokens[2]), parseFloat(tokens[3])),\n                }\n                this.push(td)\n                this.modVertex.push(td.vertex_number)\n            }\n        }\n        // console.log(`loaded ${this.length} vectors for morph target ${filename}`)\n        return true\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n}\n","import { Target } from \"./Target\"\n\nexport class TargetEntry {\n    private mFilename: string\n    private mTarget?: Target = undefined;\n    private mTargetLoadTry: boolean = false;\n\n    constructor(filename: string, preload = false) {\n        this.mFilename = filename\n        if (preload) {\n            this.loadFromFile()\n        }\n    }\n\n    loadFromFile(): boolean {\n        if (this.mTargetLoadTry === false) {\n            this.mTargetLoadTry = true\n            this.mTarget = new Target()\n            if (!this.mTarget.load(this.mFilename)) {\n                this.mTarget = undefined\n            }\n        }\n        return this.mTarget !== undefined\n    }\n\n    getTarget(): Target | undefined {\n        if (!this.mTargetLoadTry) {\n            this.loadFromFile()\n        }\n        return this.mTarget\n    }\n}\n","export class MultiSet<T> {\n    private array: T[] = []\n    private order: (a: T, b: T) => boolean\n    constructor(order: (a: T, b: T) => boolean = (a: T, b: T) => a < b) {\n        this.order = order\n    }\n    get size() {\n        return this.array.length\n    }\n    entries() {\n        return this.array\n    }\n    [Symbol.iterator](): IterableIterator<T> {\n        return this.array[Symbol.iterator]()\n    }\n    last() {\n        return this.array[this.array.length-1]\n    }\n    eraseLast() {\n        this.array.length = this.array.length - 1\n    }\n    first() {\n        return this.array[0]\n    }\n    eraseFirst() {\n        this.array.splice(0, 1)\n    }\n    insert(k: T) {\n        let firstIndex = 0,\n            lastIndex = this.array.length,\n            middleIndex = Math.floor((lastIndex + firstIndex) / 2)\n        while (firstIndex < lastIndex) {\n            if (this.order(k, this.array[middleIndex])) {\n                lastIndex = middleIndex - 1\n            } else {\n                if (this.order(this.array[middleIndex], k)) {\n                    firstIndex = middleIndex + 1\n                } else {\n                    break\n                }\n            }\n            middleIndex = Math.floor((lastIndex + firstIndex) / 2)\n        }\n\n        if (middleIndex >= this.array.length) {\n            this.array.push(k)\n        } else {\n            if (middleIndex < 0) {\n                this.array.splice(0, 0, k)\n            } else {\n                if (this.order(k, this.array[middleIndex])) {\n                    this.array.splice(middleIndex, 0, k)\n                } else {\n                    this.array.splice(middleIndex + 1, 0, k)\n                }\n            }\n        }\n    }\n}\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { Target } from \"./Target\"\nimport { VertexVector } from \"./VertexVector\"\nimport { MultiSet } from \"lib/MultiSet\"\n\nconst FF_VERTEX_N = 10\n\nexport class PoseTranslation {\n    private target = new Target()\n    private originalSize!: number[]\n    private formFactor = vec3.fromValues(1, 1, 1)\n    private minAngle: number = 0\n    private maxAngle: number = 0\n    /// flag\n    private normalize: boolean = false\n    inFilename?: string\n    /// Can be used to influence the order of application of rotations and translations\n    private cat: string = \"\"\n\n    private mbLimb: boolean = false\n\n    load(filename: string): boolean {\n        this.inFilename = filename\n        const info = FileSystemAdapter.readFile(`${filename}.info`)\n            .split(\"\\n\")\n            .map((it) => it.trim())\n        if (info.length < 3) {\n            return false\n        }\n        this.originalSize = info[0].split(\",\").map((it) => parseFloat(it))\n        const minMax = info[1].split(\",\")\n        this.minAngle = parseFloat(minMax[0])\n        this.maxAngle = parseFloat(minMax[1])\n        this.target.load(filename)\n        return true\n    }\n\n    getModVertex() {\n        return this.target.getModVertex()\n    }\n    calcFormFactor(vertexvector: VertexVector) {\n        // these are meant to be c++ multiset, meaning they can have duplicate values and are sorted\n        // prettier-ignore\n        let minXSet = new MultiSet<number>(), maxXSet = new MultiSet<number>(),\n            minYSet = new MultiSet<number>(), maxYSet = new MultiSet<number>(),\n            minZSet = new MultiSet<number>(), maxZSet = new MultiSet<number>()\n\n        let counter = 0\n        let n_vertex = FF_VERTEX_N\n        //         pair< set<float>::iterator, bool > pr;\n\n        const tmpTarget = this.getTarget()\n\n        if (tmpTarget.length < FF_VERTEX_N * 2) {\n            n_vertex = Math.floor(tmpTarget.length / 2)\n        }\n\n        for (const td of tmpTarget) {\n            if (counter < n_vertex) {\n                minXSet.insert(vertexvector[td.vertex_number].co[0])\n                maxXSet.insert(vertexvector[td.vertex_number].co[0])\n                minYSet.insert(vertexvector[td.vertex_number].co[1])\n                maxYSet.insert(vertexvector[td.vertex_number].co[1])\n                minZSet.insert(vertexvector[td.vertex_number].co[2])\n                maxZSet.insert(vertexvector[td.vertex_number].co[2])\n                ++counter\n            } else {\n                if (vertexvector[td.vertex_number].co[0] < minXSet.last()) {\n                    minXSet.insert(vertexvector[td.vertex_number].co[0])\n                    minXSet.eraseLast()\n                }\n                if (vertexvector[td.vertex_number].co[0] > maxXSet.first()) {\n                    maxXSet.insert(vertexvector[td.vertex_number].co[0])\n                    maxXSet.eraseFirst()\n                }\n                if (vertexvector[td.vertex_number].co[1] < minYSet.last()) {\n                    minYSet.insert(vertexvector[td.vertex_number].co[1])\n                    minYSet.eraseLast()\n                }\n                if (vertexvector[td.vertex_number].co[1] > maxYSet.first()) {\n                    maxYSet.insert(vertexvector[td.vertex_number].co[1])\n                    maxYSet.eraseFirst()\n                }\n                if (vertexvector[td.vertex_number].co[2] < minZSet.last()) {\n                    minZSet.insert(vertexvector[td.vertex_number].co[2])\n                    minZSet.eraseLast()\n                }\n                if (vertexvector[td.vertex_number].co[2] > maxZSet.first()) {\n                    maxZSet.insert(vertexvector[td.vertex_number].co[2])\n                    maxZSet.eraseFirst()\n                }\n            }\n        }\n\n        // prettier-ignore\n        let minX = 0, maxX = 0, minY = 0, maxY = 0, minZ = 0, maxZ = 0\n        for (const it of minXSet) {\n            minX += it\n        }\n        for (const it of maxXSet) {\n            maxX += it\n        }\n        for (const it of minYSet) {\n            minY += it\n        }\n        for (const it of maxYSet) {\n            maxY += it\n        }\n        for (const it of minZSet) {\n            minZ += it\n        }\n        for (const it of maxZSet) {\n            maxZ += it\n        }\n\n        let xsize = maxXSet.size,\n            ysize = maxYSet.size,\n            zsize = maxZSet.size\n\n        this.formFactor = vec3.fromValues(\n            (maxX / xsize - minX / xsize) / this.originalSize[0],\n            (maxY / ysize - minY / ysize) / this.originalSize[1],\n            (maxZ / zsize - minZ / zsize) / this.originalSize[2]\n        )\n    }\n    getTarget() {\n        return this.target\n    }\n    getFormFactor() {\n        return this.formFactor\n    }\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n    getNormalize() {\n        return this.normalize\n    }\n    setNormalize(inNormalize: boolean) {\n        this.normalize = inNormalize\n    }\n    getFilename() {\n        return this.inFilename\n    }\n    getCat() {\n        return this.cat\n    }\n    setCat(inCat: string) {\n        this.cat = inCat\n    }\n\n    setLimb(limb: boolean) {\n        this.mbLimb = limb\n    }\n    getLimb() {\n        return this.mbLimb\n    }\n}\n","import { DirectoryList } from \"./DirectoryList\"\nimport { Vertex } from \"./Vertex\"\nimport { PoseRotation } from \"./PoseRotation\"\nimport { PoseTranslation } from \"./PoseTranslation\"\nimport { vec3 } from \"gl-matrix\"\nimport { VertexVector } from \"./VertexVector\"\n\nexport class UnsortedUsedVertex extends Array<number> {}\n\nexport function calcCenteroid(vertexNumbers: number[], vertexvector: Vertex[]): vec3 {\n    let center = vec3.create()\n    for (const vn of vertexNumbers) {\n        vec3.add(center, center, vertexvector[vn].co)\n    }\n    vec3.scale(center, center, 1 / vertexNumbers.length)\n    return center\n}\n\nexport class PoseTarget {\n    // normally these vectors contain only one element\n    /// Translations to be applied on Mesh::doPose()\n    private positiveTranslations: PoseTranslation[] = []\n    /// Translations to be applied on Mesh::doPose() with morph_value < 0\n    private negativeTranslations: PoseTranslation[] = []\n    /// Rotations to be applied on Mesh::doPose()\n    private positiveRotations: PoseRotation[] = []\n    /// Rotations to be applied on Mesh::doPose() with morph_value < 0\n    private negativeRotations: PoseRotation[] = []\n\n    private targetName: string\n    /// flags whether wehave special transformations for Mesh::doPose() with morph_value < 0\n    private negative: boolean = false\n    private positive: boolean = false\n    /// flag for calcNormalizations()\n    private normalizationInited: boolean = false\n    private fullPath: string\n    private modVertex = new Set<number>()\n    private minAngle: number = 0.0\n    private maxAngle: number = 0.0\n\n    constructor(targetName: string, fullpath: string) {\n        this.targetName = targetName\n        this.fullPath = fullpath\n    }\n    load() {\n        const positive_rotation_type = \".rot\"\n        const negative_rotation_type = \"-.rot\"\n        const positive_translation_type = \".target\"\n        const negative_translation_type = \"-.target\"\n\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(this.fullPath)\n        dir_list.setRecursive(0)\n\n        const files = dir_list.getDirectoryList()\n        for (const file of files) {\n            const target_name = file.substring(this.fullPath.length + 1)\n            if (target_name.endsWith(negative_rotation_type)) {\n                const tmpRotation = new PoseRotation()\n                if (tmpRotation.load(file)) {\n                    tmpRotation.setCat(target_name.substring(0, 2))\n                    tmpRotation.setLimb(target_name.indexOf(\"LIMB\") !== -1)\n                    this.negativeRotations.push(tmpRotation)\n                    tmpRotation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.negative = true\n                    this.minAngle = Math.min(this.minAngle, tmpRotation.getMinAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(positive_rotation_type)) {\n                const tmpRotation = new PoseRotation()\n                if (tmpRotation.load(file)) {\n                    tmpRotation.setCat(target_name.substring(0, 2))\n                    tmpRotation.setLimb(target_name.indexOf(\"LIMB\") !== -1)\n                    this.positiveRotations.push(tmpRotation)\n                    tmpRotation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.positive = true\n                    this.maxAngle = Math.max(this.maxAngle, tmpRotation.getMaxAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(negative_translation_type)) {\n                const tmpTranslation = new PoseTranslation()\n                if (tmpTranslation.load(file)) {\n                    tmpTranslation.setCat(target_name.substring(0, 2))\n                    this.negativeTranslations.push(tmpTranslation)\n                    tmpTranslation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.minAngle = Math.min(this.minAngle, tmpTranslation.getMinAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(positive_translation_type)) {\n                const tmpTranslation = new PoseTranslation()\n                if (tmpTranslation.load(file)) {\n                    tmpTranslation.setCat(target_name.substring(0, 2))\n                    this.positiveTranslations.push(tmpTranslation)\n                    tmpTranslation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.maxAngle = Math.max(this.maxAngle, tmpTranslation.getMaxAngle())\n                }\n                continue\n            }\n        }\n    }\n    /// Initializes the center of all rotations with the controid of their centerVertexNumbers\n    calcRotationsCenteroids(vertexvector: VertexVector, rotations?: PoseRotation[]): void {\n        if (rotations === undefined) {\n            if (this.positive) {\n                this.calcRotationsCenteroids(vertexvector, this.positiveRotations)\n            }\n            if (this.negative) {\n                this.calcRotationsCenteroids(vertexvector, this.negativeRotations)\n            }\n        } else {\n            for (const rotations_it of rotations) {\n                rotations_it.setCenter(calcCenteroid(rotations_it.getCenterVertexNumbers(), vertexvector))\n            }\n        }\n    }\n\n    calcTranslationsFormFactors(vertexvector: VertexVector, translations?: PoseTranslation[]): void {\n        if (translations === undefined) {\n            if (this.positive) {\n                this.calcTranslationsFormFactors(vertexvector, this.positiveTranslations)\n            }\n            if (this.negative) {\n                this.calcTranslationsFormFactors(vertexvector, this.negativeTranslations)\n            }\n        } else {\n            for (const translations_it of translations) {\n                translations_it.calcFormFactor(vertexvector)\n            }\n        }\n    }\n    calcNormalizations() {\n        if (this.normalizationInited) {\n            return\n        }\n        for (const rotations_it of this.positiveRotations) {\n            if (rotations_it.getMinAngle() !== this.minAngle || rotations_it.getMaxAngle() !== this.maxAngle) {\n                rotations_it.setNormalize(true)\n            }\n        }\n        for (const rotations_it of this.negativeRotations) {\n            if (rotations_it.getMinAngle() !== this.minAngle || rotations_it.getMaxAngle() !== this.maxAngle) {\n                rotations_it.setNormalize(true)\n            }\n         }\n        for (const translations_it of this.positiveTranslations) {\n            if (translations_it.getMinAngle() !== this.minAngle || translations_it.getMaxAngle() !== this.maxAngle) {\n                translations_it.setNormalize(true)\n            }\n        }\n        for (const translations_it of this.negativeTranslations) {\n            if (translations_it.getMinAngle() !== this.minAngle || translations_it.getMaxAngle() !== this.maxAngle) {\n                translations_it.setNormalize(true)\n            }\n        }\n        this.normalizationInited = true\n    }\n    hasNegative() {\n        return this.negative\n    }\n    hasPositive() {\n        return this.positive\n    }\n    getPositiveTranslations() {\n        return this.positiveTranslations\n    }\n    getNegativeTranslations() {\n        return this.negativeTranslations\n    }\n    getPositiveRotations() {\n        return this.positiveRotations\n    }\n    getNegativeRotations() {\n        return this.negativeRotations\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n    //void showCenters();\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n}\n","import { PoseTarget } from \"./PoseTarget\"\n\nexport class PoseEntry {\n    private mFilename: string\n    private mFullPath: string\n    private mTarget?: PoseTarget\n    private mTargetLoadTry: boolean = false;\n    constructor(filename: string, fullPath: string, preload = false) {\n        this.mFilename = filename\n        this.mFullPath = fullPath\n        if (preload) {\n            this.loadFromFile()\n        }\n    }\n    loadFromFile(): boolean {\n        if (this.mTargetLoadTry === false) {\n            this.mTargetLoadTry = true\n            this.mTarget = new PoseTarget(this.mFilename, this.mFullPath)\n            this.mTarget.load()\n        }\n        return this.mTarget !== undefined\n    }\n    isLoaded() {\n        return this.mTargetLoadTry\n    }\n    getTarget() {\n        if (!this.mTargetLoadTry) {\n            this.loadFromFile()\n        }\n        return this.mTarget\n    }\n}\n","import { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\n\nclass FGroupData extends Array<number> {}\nexport class VertexData extends Map<number, number> {}\n\nexport class FGroup {\n    visible!: boolean\n    /// A vector of ints\n    facesIndexes!: FGroupData\n    facesIndexes_subd?: FGroupData ///subdivision\n}\n\nexport function isAlpha(ch: string){\n    return ch >= \"a\" && ch <= \"z\" || ch >= \"A\" && ch <= \"Z\"\n}\n\nexport class FaceGroup extends Map<string, FGroup> {\n    private loaded: boolean = false;\n    // Maps FaceGroup identifiers via vertex group numbers to vertex indices\n    private vertexes = new Map<string, VertexData>();\n    load(filename: string): boolean {\n        let fgroup_indent: string\n        const content = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(content)\n        let lineNumber = 0\n        for (let line of reader) {\n            if (isAlpha(line.charAt(0))) {\n                fgroup_indent = line.split(\",\")[0].trim()\n            } else {\n                let data: FGroup = {\n                    visible: true,\n                    facesIndexes: line.split(\" \").map(it => parseInt(it))\n                }\n                this.set(fgroup_indent!, data)\n            }\n        }\n\n        console.log(`loaded ${this.size} face groups from ${filename}`)\n\n        // there's some code for 'visibilities' but there ain't no ones in base.parts\n        return true\n    }\n}\n","/*\n *  The TOAD JavaScript/TypeScript GUI Library\n *  Copyright (C) 2018-2023 Mark-Andr Hopf <mhopf@mark13.org>\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\nexport class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map((a) => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        element.replaceChildren(...this);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\n// https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== \"string\") {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case \"children\":\n                break;\n            case \"action\":\n                ;\n                element.setAction(value);\n                break;\n            case \"model\":\n                ;\n                element.setModel(value);\n                break;\n            case \"class\":\n                element.classList.add(value); // FIXME: value is whitespace separated list\n                break;\n            case \"style\":\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    if (typeof svalue === \"number\") {\n                        svalue = `${svalue}`;\n                    }\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case \"set\":\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substring(2), value);\n                }\n                else {\n                    if (typeof value === \"string\" || typeof value === \"number\" || typeof value === \"boolean\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        appendChildren(element, props.children);\n    }\n}\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n// the FunctionConstructor is a hack for <></>\n// actually it would be nice if we could support value objects too, eg. <TableView> instead of <toad-table>\n// export function createElement(name: string, props: JSX.HTMLElementProps, ...children: any): Element\n// export function createElement(name: FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Fragment\n// export function createElement(name: string | FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Element | Fragment {\n// }\n// backward compability\nexport function createElement(nameOrConstructor, props, ...children) {\n    // console.log(`createElement(${nameOrConstructor}, ${JSON.stringify(props)}, ${children}`)\n    // props: remove 'key', add 'children'\n    let key;\n    if (props !== null) {\n        if (\"key\" in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","export function css(strings, ...values) {\n    let str = strings[0];\n    values.forEach((s, i) => {\n        str = str.concat(s).concat(strings[i + 1]);\n    });\n    return str;\n}\nexport function html(strings, ...values) {\n    let str = strings[0];\n    values.forEach((s, i) => {\n        str = str.concat(s).concat(strings[i + 1]);\n    });\n    return str;\n}\nexport function element(type, children) {\n    const element = document.createElement(type);\n    for (let i = 0; i < children.length; ++i) {\n        let child = children[i];\n        if (child instanceof Array) {\n            children.splice(i, 1, ...child);\n            child = children[i];\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n    return element;\n}\nexport function array(times, create) {\n    let a = [];\n    for (let i = 0; i < times; ++i) {\n        const c = create(i);\n        if (c instanceof Array) {\n            a.push(...c);\n        }\n        else {\n            a.push(c);\n        }\n    }\n    return a;\n}\nexport function text(text) { return document.createTextNode(text); }\nexport const div = (...children) => element(\"div\", children);\nexport const span = (...children) => element(\"span\", children);\nexport const slot = (...children) => element(\"slot\", children);\nexport const form = (...children) => element(\"form\", children);\nexport const input = (...children) => element(\"input\", children);\nexport const button = (...children) => element(\"button\", children);\nexport const label = (...children) => element(\"label\", children);\nexport const ul = (...children) => element(\"ul\", children);\nexport const ol = (...children) => element(\"ol\", children);\nexport const li = (...children) => element(\"li\", children);\nexport const table = (...children) => element(\"table\", children);\nexport const thead = (...children) => element(\"thead\", children);\nexport const th = (...children) => element(\"th\", children);\nexport const tbody = (...children) => element(\"tbody\", children);\nexport const td = (...children) => element(\"td\", children);\nexport const tr = (...children) => element(\"tr\", children);\nconst ns = \"http://www.w3.org/2000/svg\";\nexport function svg(child) {\n    const s = document.createElementNS(ns, \"svg\");\n    if (child !== undefined) {\n        s.appendChild(child);\n    }\n    return s;\n}\nexport function path(d) {\n    const p = document.createElementNS(ns, \"path\");\n    if (d !== undefined) {\n        p.setAttributeNS(null, \"d\", d);\n    }\n    return p;\n}\nexport function rect(x, y, width, height, stroke, fill) {\n    const r = document.createElementNS(ns, \"rect\");\n    r.setAttributeNS(null, \"x\", `${x}`);\n    r.setAttributeNS(null, \"y\", `${y}`);\n    r.setAttributeNS(null, \"width\", `${width}`);\n    r.setAttributeNS(null, \"height\", `${height}`);\n    if (stroke !== undefined) {\n        r.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        r.setAttributeNS(null, \"fill\", fill);\n    }\n    return r;\n}\nexport function line(x1, y1, x2, y2, stroke, fill) {\n    const l = document.createElementNS(ns, \"line\");\n    l.setAttributeNS(null, \"x1\", `${x1}`);\n    l.setAttributeNS(null, \"y1\", `${y1}`);\n    l.setAttributeNS(null, \"x2\", `${x2}`);\n    l.setAttributeNS(null, \"y2\", `${y2}`);\n    if (stroke !== undefined) {\n        l.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        l.setAttributeNS(null, \"fill\", fill);\n    }\n    return l;\n}\nexport function svgAndUse(ref) {\n    const ns = \"http://www.w3.org/2000/svg\";\n    const s = document.createElementNS(ns, \"svg\");\n    const u = document.createElementNS(ns, \"use\");\n    u.setAttributeNS(ns, \"href\", ref);\n    u.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', ref);\n    s.appendChild(u);\n    return s;\n}\n//# sourceMappingURL=lsx.js.map","export class SignalLink {\n    constructor(callback, id) {\n        this.callback = callback;\n        this.id = id;\n    }\n}\nexport class Signal {\n    constructor() {\n        this.locked = false;\n        this.busy = false;\n    }\n    add(callback, id) {\n        if (!this.callbacks)\n            this.callbacks = new Array();\n        this.callbacks.push(new SignalLink(callback, id));\n    }\n    remove(id) {\n        if (!this.callbacks)\n            return;\n        for (let i = this.callbacks.length - 1; i >= 0; --i) {\n            if (this.callbacks[i].id === id)\n                this.callbacks.splice(i, 1);\n        }\n    }\n    count() {\n        if (!this.callbacks)\n            return 0;\n        return this.callbacks.length;\n    }\n    lock() {\n        this.locked = true;\n    }\n    unlock() {\n        this.locked = false;\n        if (this.triggered) {\n            let data = this.triggered.data;\n            this.triggered = undefined;\n            this.trigger(data);\n        }\n    }\n    withLock(closure) {\n        this.lock();\n        const r = closure();\n        this.unlock();\n        return r;\n    }\n    trigger(data) {\n        if (this.busy) {\n            return;\n        }\n        this.busy = true;\n        if (this.locked) {\n            this.triggered = { data: data };\n            this.busy = false;\n            return;\n        }\n        if (!this.callbacks) {\n            this.busy = false;\n            return;\n        }\n        let error;\n        for (let i = 0; i < this.callbacks.length; ++i) {\n            try {\n                this.callbacks[i].callback(data);\n            }\n            catch (e) {\n                error = e;\n            }\n        }\n        this.busy = false;\n        if (error !== undefined) {\n            throw error;\n        }\n    }\n}\n//# sourceMappingURL=Signal.js.map","import { Signal } from \"../Signal.js\";\nexport var ModelReason;\n(function (ModelReason) {\n    ModelReason[ModelReason[\"ALL\"] = 0] = \"ALL\";\n    ModelReason[ModelReason[\"VALUE\"] = 1] = \"VALUE\";\n    ModelReason[ModelReason[\"ENABLED\"] = 2] = \"ENABLED\";\n    ModelReason[ModelReason[\"COLOR\"] = 3] = \"COLOR\";\n    ModelReason[ModelReason[\"LABEL\"] = 4] = \"LABEL\";\n    ModelReason[ModelReason[\"DESCRIPTION\"] = 5] = \"DESCRIPTION\";\n    ModelReason[ModelReason[\"ERROR\"] = 6] = \"ERROR\";\n    ModelReason[ModelReason[\"MAX_REASON\"] = 7] = \"MAX_REASON\";\n})(ModelReason || (ModelReason = {}));\nexport class Model {\n    constructor(options) {\n        this.modified = new Signal();\n        this.options = options;\n    }\n    set enabled(enabled) {\n        if (this.options?.enabled === enabled)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.enabled = enabled;\n        this.modified.trigger(ModelReason.ENABLED);\n    }\n    get enabled() { return this.options?.enabled !== false; }\n    set color(color) {\n        if (this.options?.color === color)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.color = color;\n        this.modified.trigger(ModelReason.COLOR);\n    }\n    get color() { return this.options?.color; }\n    set label(label) {\n        if (this.options?.label === label)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.label = label;\n        this.modified.trigger(ModelReason.LABEL);\n    }\n    get label() { return this.options?.label; }\n    set description(description) {\n        if (this.options?.description === description)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.description = description;\n        this.modified.trigger(ModelReason.DESCRIPTION);\n    }\n    get description() { return this.options?.description; }\n    set error(error) {\n        if (this.options?.error === error)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.error = error;\n        this.modified.trigger(ModelReason.ERROR);\n    }\n    get error() { return this.options?.error; }\n    applyStyle(element) {\n        if (this.enabled) {\n            element.removeAttribute(\"disabled\");\n        }\n        else {\n            element.setAttribute(\"disabled\", \"disabled\");\n        }\n        if (this.color !== undefined) {\n            element.style.fontStyle = \"\";\n            element.style.fontWeight = \"\";\n            element.style.color = \"\";\n            switch (this.color) {\n                case \"italic\":\n                    element.style.fontStyle = \"italic\";\n                    break;\n                case \"bold\":\n                    element.style.fontWeight = \"bold\";\n                    break;\n                default:\n                    element.style.color = this.color;\n            }\n        }\n        else {\n            element.style.color = \"\";\n            element.style.fontStyle = \"\";\n            element.style.fontWeight = \"\";\n        }\n        if (this.error !== undefined) {\n            element.classList.add(\"tx-error\");\n        }\n        else {\n            element.classList.remove(\"tx-error\");\n        }\n    }\n}\n//# sourceMappingURL=Model.js.map","import { Model, ModelReason } from \"./Model.js\";\nexport var ValueModelReason;\n(function (ValueModelReason) {\n    ValueModelReason[ValueModelReason[\"DEFAULT\"] = 7] = \"DEFAULT\";\n    ValueModelReason[ValueModelReason[\"MAX_REASON\"] = 8] = \"MAX_REASON\";\n})(ValueModelReason || (ValueModelReason = {}));\nexport class AbstractValueModel extends Model {\n    set default(aDefault) {\n        if (this.options?.default === aDefault)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.default = aDefault;\n        this.modified.trigger(ValueModelReason.DEFAULT);\n    }\n    get default() {\n        return this.options?.default;\n    }\n    resetToDefault() {\n        const d = this.default;\n        if (d !== undefined) {\n            this.value = d;\n        }\n    }\n}\nexport class ValueModel extends AbstractValueModel {\n    constructor(value, options) {\n        super(options);\n        this._value = value;\n    }\n    set value(value) {\n        if (this._value === value)\n            return;\n        this._value = value;\n        this.modified.trigger(ModelReason.VALUE);\n    }\n    get value() {\n        return this._value;\n    }\n}\n//# sourceMappingURL=ValueModel.js.map","import { ValueModel } from \"./ValueModel.js\";\nimport { BigDecimal } from \"../util/BigDecimal.js\";\nimport { expression } from \"../util/expressions/expression.js\";\nexport var NumberModelReason;\n(function (NumberModelReason) {\n    NumberModelReason[NumberModelReason[\"MIN\"] = 8] = \"MIN\";\n    NumberModelReason[NumberModelReason[\"MAX\"] = 9] = \"MAX\";\n    NumberModelReason[NumberModelReason[\"STEP\"] = 10] = \"STEP\";\n    NumberModelReason[NumberModelReason[\"AUTOCORRECT\"] = 11] = \"AUTOCORRECT\";\n    NumberModelReason[NumberModelReason[\"MAX_REASON\"] = 12] = \"MAX_REASON\";\n})(NumberModelReason || (NumberModelReason = {}));\nexport class NumberModel extends ValueModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n    increment() {\n        if (this.step !== undefined) {\n            const value = new BigDecimal(this.value);\n            const step = new BigDecimal(this.step);\n            this.value = this.clip(parseFloat(value.add(step).toString()));\n        }\n    }\n    decrement() {\n        if (this.step !== undefined) {\n            const value = new BigDecimal(this.value);\n            const step = new BigDecimal(this.step);\n            this.value = this.clip(parseFloat(value.sub(step).toString()));\n        }\n    }\n    set value(value) {\n        let number;\n        if (typeof value === \"string\") {\n            const ex = expression(value);\n            number = ex.eval();\n        }\n        else {\n            number = value;\n        }\n        this.modified.withLock(() => {\n            if (this.autocorrect) {\n                super.value = this.clip(number);\n            }\n            else {\n                super.value = number;\n                this.error = this.check(number);\n            }\n        });\n    }\n    get value() {\n        return super.value;\n    }\n    set min(min) {\n        if (this.options?.min === min)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.min = min;\n        this.modified.trigger(NumberModelReason.MIN);\n    }\n    get min() {\n        return this.options?.min;\n    }\n    set max(max) {\n        if (this.options?.max === max)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.max = max;\n        this.modified.trigger(NumberModelReason.MAX);\n    }\n    get max() {\n        return this.options?.max;\n    }\n    set step(step) {\n        if (this.options?.step === step)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.step = step;\n        this.modified.trigger(NumberModelReason.STEP);\n    }\n    get step() {\n        return this.options?.step;\n    }\n    set autocorrect(autocorrect) {\n        if (this.options?.autocorrect === autocorrect)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.autocorrect = autocorrect;\n        this.modified.trigger(NumberModelReason.AUTOCORRECT);\n    }\n    get autocorrect() {\n        return this.options?.autocorrect === true;\n    }\n    clip(value) {\n        if (this.min !== undefined && value < this.min) {\n            value = this.min;\n        }\n        if (this.max !== undefined && value > this.max) {\n            value = this.max;\n        }\n        return value;\n    }\n    check(value) {\n        if (this.min !== undefined && value < this.min) {\n            return `The value must not be below ${this.min}.`;\n        }\n        if (this.max !== undefined && value > this.max) {\n            if (this.autocorrect) {\n                value = this.max;\n            }\n            else {\n                return `The value must not be above ${this.max}.`;\n            }\n        }\n        return undefined;\n    }\n}\n//# sourceMappingURL=NumberModel.js.map","import { ValueModel } from \"./ValueModel.js\";\nexport class BooleanModel extends ValueModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n}\n//# sourceMappingURL=BooleanModel.js.map","export class BigDecimal {\n    constructor(value) {\n        this._n = 0n;\n        if (value instanceof BigDecimal)\n            return value;\n        let [ints, decis] = String(value).split(\".\").concat(\"\");\n        this._n = BigInt(ints + decis.padEnd(BigDecimal.DECIMALS, \"0\")\n            .slice(0, BigDecimal.DECIMALS))\n            + BigInt(BigDecimal.ROUNDED && decis[BigDecimal.DECIMALS] >= \"5\");\n    }\n    static fromBigInt(bigint) {\n        return Object.assign(Object.create(BigDecimal.prototype), { _n: bigint });\n    }\n    add(num) {\n        return BigDecimal.fromBigInt(this._n + new BigDecimal(num)._n);\n    }\n    sub(num) {\n        return BigDecimal.fromBigInt(this._n - new BigDecimal(num)._n);\n    }\n    static _divRound(dividend, divisor) {\n        return BigDecimal.fromBigInt(dividend / divisor\n            + (BigDecimal.ROUNDED ? dividend * 2n / divisor % 2n : 0n));\n    }\n    mul(num) {\n        return BigDecimal._divRound(this._n * new BigDecimal(num)._n, BigDecimal.SHIFT);\n    }\n    div(num) {\n        return BigDecimal._divRound(this._n * BigDecimal.SHIFT, new BigDecimal(num)._n);\n    }\n    toString() {\n        const s = this._n.toString().padStart(BigDecimal.DECIMALS + 1, \"0\");\n        return s.slice(0, -BigDecimal.DECIMALS) + \".\" + s.slice(-BigDecimal.DECIMALS)\n            .replace(/\\.?0+$/, \"\");\n    }\n}\nBigDecimal.DECIMALS = 18;\nBigDecimal.ROUNDED = true;\nBigDecimal.SHIFT = BigInt(\"1\" + \"0\".repeat(BigDecimal.DECIMALS));\n//# sourceMappingURL=BigDecimal.js.map","export class ExpressionNode {\n    constructor(value) {\n        this.value = value;\n    }\n    eval(model) {\n        if (typeof this.value === \"number\") {\n            return this.value;\n        }\n        if (this.value instanceof Array) {\n            if (model === undefined) {\n                throw Error(`yikes: no model to get cell [${this.value[0]},${this.value[1]}]`);\n            }\n            return model.getCell(this.value[0], this.value[1])._calculatedValue;\n        }\n        switch (this.value) {\n            case '+':\n                return this.down.eval(model) + this.down.next.eval(model);\n            case '-':\n                if (this.down?.next) {\n                    return this.down.eval(model) - this.down.next.eval(model);\n                }\n                return -this.down.eval(model);\n            case '*':\n                return this.down.eval(model) * this.down.next.eval(model);\n            case '/':\n                return this.down.eval(model) / this.down.next.eval(model);\n            default:\n                throw Error(`unexpected token '${this.value}'`);\n        }\n    }\n    append(node) {\n        if (this.down === undefined) {\n            this.down = node;\n        }\n        else {\n            let n = this.down;\n            while (n.next) {\n                n = n.next;\n            }\n            n.next = node;\n        }\n    }\n    dependencies(deps = []) {\n        if (this.value instanceof Array) {\n            deps.push(this.value);\n        }\n        if (this.next) {\n            this.next.dependencies(deps);\n        }\n        if (this.down) {\n            this.down.dependencies(deps);\n        }\n        return deps;\n    }\n    toString() {\n        return this._toString();\n    }\n    _toString(out = \"\\n\", indent = 0) {\n        for (let i = 0; i < indent; ++i) {\n            out += \"    \";\n        }\n        out += this.value;\n        out += \"\\n\";\n        for (let n = this.down; n; n = n.next) {\n            out = n._toString(out, indent + 1);\n        }\n        return out;\n    }\n}\n//# sourceMappingURL=ExpressionNode.js.map","import { ExpressionNode } from \"./ExpressionNode.js\";\nexport class Lexer {\n    constructor(str) {\n        this.i = 0;\n        this.stack = [];\n        this.str = str;\n    }\n    isspace(c) {\n        return c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == '\\t';\n    }\n    isnumber(c) {\n        const code = c.charCodeAt(0);\n        return code >= 0x30 && code <= 0x39;\n    }\n    isalpha(c) {\n        const code = c.charCodeAt(0);\n        return code >= 0x41 && code <= 0x5a || code >= 0x91 && code <= 0x7a;\n    }\n    isalnum(c) {\n        return this.isnumber(c) || this.isalpha(c);\n    }\n    unlex(node) {\n        this.stack.push(node);\n    }\n    lex() {\n        if (this.stack.length > 0) {\n            return this.stack.pop();\n        }\n        let col = 0, row = 0;\n        let state = 0;\n        if (this.i >= this.str.length) {\n            return undefined;\n        }\n        const start = this.i;\n        while (true) {\n            let c = this.str.at(this.i);\n            switch (state) {\n                case 0:\n                    if (c === undefined) {\n                        return undefined;\n                    }\n                    if (this.isspace(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    if (this.isnumber(c)) {\n                        ++this.i;\n                        state = 1;\n                        break;\n                    }\n                    if (this.isalpha(c)) {\n                        col = 0;\n                        state = 3;\n                        break;\n                    }\n                    switch (c) {\n                        case '+':\n                        case '-':\n                        case '*':\n                        case '/':\n                        case '(':\n                        case ')':\n                        case '=':\n                            ++this.i;\n                            return new ExpressionNode(c);\n                    }\n                    return undefined;\n                case 1:\n                    if (c !== undefined && this.isnumber(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    if (c === '.' || c == 'e' || c == 'E') {\n                        ++this.i;\n                        state = 2;\n                        break;\n                    }\n                    return new ExpressionNode(parseFloat(this.str.substring(start, this.i)));\n                case 2:\n                    if (c !== undefined && this.isnumber(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    return new ExpressionNode(parseFloat(this.str.substring(start, this.i)));\n                case 3:\n                    if (c !== undefined) {\n                        const code = c.charCodeAt(0);\n                        if (code >= 0x30 && code <= 0x39) {\n                            row = code - 0x30;\n                            state = 4;\n                            ++this.i;\n                            break;\n                        }\n                        if (code >= 0x41 && code <= 0x5a) {\n                            col *= 26;\n                            col += code - 0x40;\n                            ++this.i;\n                            break;\n                        }\n                        if (code >= 0x91 && code <= 0x7a) {\n                            col *= 26;\n                            col += code - 0x90;\n                            ++this.i;\n                            break;\n                        }\n                    }\n                    return new ExpressionNode(this.str.substring(start, this.i));\n                case 4:\n                    if (c !== undefined) {\n                        const code = c.charCodeAt(0);\n                        if (code >= 0x30 && code <= 0x39) {\n                            row *= 10;\n                            row += code - 0x30;\n                            ++this.i;\n                            break;\n                        }\n                    }\n                    return new ExpressionNode([col - 1, row - 1]);\n            }\n        }\n    }\n}\n//# sourceMappingURL=Lexer.js.map","import { Lexer } from \"./Lexer.js\";\nexport function assignmentExpression(expr) {\n    const lexer = new Lexer(expr);\n    const n0 = lexer.lex();\n    if (n0 === undefined || n0.value !== '=') {\n        return undefined;\n    }\n    return additive_expression(lexer);\n}\nexport function expression(expr) {\n    const lexer = new Lexer(expr);\n    return additive_expression(lexer);\n}\nfunction additive_expression(lexer) {\n    const n0 = multiplicative_expression(lexer);\n    if (n0 === undefined) {\n        return undefined;\n    }\n    const n1 = lexer.lex();\n    if (n1 === undefined) {\n        return n0;\n    }\n    if (n1.value === \"+\" || n1.value === \"-\") {\n        const n2 = additive_expression(lexer);\n        if (n2 === undefined) {\n            lexer.unlex(n1);\n            return n0;\n        }\n        n1.append(n0);\n        n1.append(n2);\n        return n1;\n    }\n    lexer.unlex(n1);\n    return n0;\n}\nfunction multiplicative_expression(lexer) {\n    const n0 = unary_expression(lexer);\n    if (n0 === undefined) {\n        return undefined;\n    }\n    const n1 = lexer.lex();\n    if (n1 === undefined) {\n        return n0;\n    }\n    if (n1.value === \"*\" || n1.value === \"/\") {\n        const n2 = multiplicative_expression(lexer);\n        if (n2 === undefined) {\n            throw Error(`expexted expression after ${n1.value}`);\n        }\n        n1.append(n0);\n        n1.append(n2);\n        return n1;\n    }\n    lexer.unlex(n1);\n    return n0;\n}\nfunction unary_expression(lexer) {\n    const n0 = lexer.lex();\n    if (n0 === undefined) {\n        return undefined;\n    }\n    if (typeof n0.value === \"number\") {\n        return n0;\n    }\n    if (n0.value instanceof Array) {\n        return n0;\n    }\n    if (n0.value === \"(\") {\n        const n1 = additive_expression(lexer);\n        if (n1 === undefined) {\n            throw Error(\"Unexpected end after '(\");\n        }\n        const n2 = lexer.lex();\n        if (n2?.value !== ')') {\n            throw Error(\"Excepted ')\");\n        }\n        return n1;\n    }\n    if (n0.value === \"-\") {\n        const n1 = unary_expression(lexer);\n        if (n1 !== undefined) {\n            n0.append(n1);\n            return n0;\n        }\n    }\n    lexer.unlex(n0);\n    return undefined;\n}\n//# sourceMappingURL=expression.js.map","import { ModelReason } from \"./Model.js\";\nimport { AbstractValueModel } from \"./ValueModel.js\";\nexport class TextModel extends AbstractValueModel {\n    constructor(value = \"\", options) {\n        super(options);\n        this.value = value;\n    }\n    set promise(promise) {\n        this._value = promise;\n        this.modified.trigger(ModelReason.VALUE);\n    }\n    get promise() {\n        if (typeof this._value === \"string\") {\n            const value = this._value;\n            return () => {\n                return value;\n            };\n        }\n        return this._value;\n    }\n    set value(value) {\n        if (this._value === value) {\n            return;\n        }\n        if (typeof value !== \"string\") {\n            console.trace(`TextModel.set value(value: string): ${typeof value} is not type string`);\n            return;\n        }\n        this.modified.withLock(() => {\n            this.error = undefined;\n            this._value = value;\n            this.modified.trigger(ModelReason.VALUE);\n        });\n    }\n    get value() {\n        switch (typeof this._value) {\n            case \"number\":\n            case \"string\":\n                this._value = `${this._value}`;\n                break;\n            case \"function\":\n                this._value = this._value();\n                break;\n        }\n        return this._value;\n    }\n}\n//# sourceMappingURL=TextModel.js.map","import { TextModel } from \"./TextModel.js\";\nexport class HtmlModel extends TextModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n}\n//# sourceMappingURL=HtmlModel.js.map","import { Model } from \"./Model.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Action extends Model {\n    constructor(callback) {\n        super();\n        this.signal = new Signal();\n        this.signal.add(callback);\n    }\n    set value(_) {\n        throw Error(\"Action.value can not be assigned a value\");\n    }\n    get value() {\n        throw Error(\"Action.value can not return a value\");\n    }\n    trigger(data) {\n        if (!this.enabled) {\n            return;\n        }\n        this.signal.trigger(data);\n    }\n}\n//# sourceMappingURL=Action.js.map","export function instantiateTemplate(name) {\n    return tmpl(name);\n}\nexport function tmpl(name) {\n    let t = document.querySelector('template[id=\"' + name + '\"]');\n    if (!t) {\n        throw new Error(\"failed to find template '\" + name + \"'\");\n    }\n    let x = t;\n    let z = x.content;\n    let y = document.importNode(z, true);\n    return y;\n}\nexport function find(node, selector) {\n    return node.querySelector(selector);\n}\nexport function tag(name) {\n    return document.createElement(name);\n}\nexport function txt(txt) {\n    return document.createTextNode(txt);\n}\nexport function img(src) {\n    let img = document.createElement(\"img\");\n    img.src = src;\n    return img;\n}\nexport function add(n0, n1) {\n    n0.appendChild(n1);\n}\nexport function remove(n) {\n    if (!n.parentNode)\n        throw Error(\"element has no parent\");\n    n.parentNode.removeChild(n);\n}\nexport function erase(n) {\n    n.replaceChildren();\n}\nexport function hasFocus(element) {\n    let active = document.activeElement;\n    while (active !== null) {\n        if (active === element) {\n            return true;\n        }\n        if (active.shadowRoot === null)\n            break;\n        active = active.shadowRoot.activeElement;\n    }\n    return false;\n}\nexport function grabMouse(event) {\n    let target = event.target;\n    let documentMouseMove = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mousemove\", event));\n        event.stopPropagation();\n    };\n    let documentMouseUp = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mouseup\", event));\n        document.removeEventListener(\"mousemove\", documentMouseMove, { capture: true });\n        document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n        document.body.style.pointerEvents = \"auto\";\n        event.stopPropagation();\n    };\n    document.addEventListener(\"mousemove\", documentMouseMove, { capture: true });\n    document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n    document.body.style.pointerEvents = \"none\";\n    event.preventDefault();\n    event.stopPropagation();\n}\nexport function attribute(element, name) {\n    let attribute = element.getAttribute(name);\n    if (attribute === null) {\n        console.log(\"missing attribute '\" + name + \"' in \", element);\n        throw Error(\"missing attribute '\" + name + \"' in \" + element.nodeName);\n    }\n    return attribute;\n}\nexport function attributeOrUndefined(element, name) {\n    let attribute = element.getAttribute(name);\n    return attribute === null ? undefined : attribute;\n}\nexport function isNodeBeforeNode(first, second) {\n    let node;\n    let firstPrevious = first;\n    node = first;\n    let parentsOfFirstNode = new Map();\n    while (true) {\n        firstPrevious = node;\n        node = node.parentNode;\n        if (!node)\n            break;\n        parentsOfFirstNode.set(node, firstPrevious);\n    }\n    let secondPrevious = second;\n    node = second;\n    while (node) {\n        secondPrevious = node;\n        node = node.parentNode;\n        if (!node) {\n            throw Error(`isNodeBeforeNode(first, second): nodes have no common parent`);\n        }\n        let lookup = parentsOfFirstNode.get(node);\n        if (lookup) {\n            firstPrevious = lookup;\n            break;\n        }\n    }\n    for (let child of node.childNodes) {\n        if (child === firstPrevious)\n            return true;\n        if (child === secondPrevious)\n            return false;\n    }\n    throw Error(\"isNodeBeforeNode(first, second): couldn't determine order of nodes\");\n}\nexport function pixelToNumber(pixel) {\n    if (pixel === \"\")\n        return 0;\n    if (pixel.substr(pixel.length - 2) !== \"px\")\n        throw Error(`pixelToNumber('${pixel}') expected 'px' suffix`);\n    return Number.parseFloat(pixel.substr(0, pixel.length - 2));\n}\nexport function getPropertyValue(element, propertyName) {\n    let elementStyle = window.getComputedStyle(element, undefined);\n    let property = elementStyle.getPropertyValue(propertyName);\n    return pixelToNumber(property);\n}\nexport function horizontalPadding(element) {\n    return getPropertyValue(element, \"padding-left\") + getPropertyValue(element, \"padding-right\");\n}\nexport function verticalPadding(element) {\n    return getPropertyValue(element, \"padding-top\") + getPropertyValue(element, \"padding-bottom\");\n}\n//# sourceMappingURL=dom.js.map","import { Controller } from \"./Controller.js\";\nexport let globalController = new Controller();\nexport function bindModel(modelId, model) {\n    globalController.bind(modelId, model);\n}\nexport function action(actionId, action) {\n    return globalController.registerAction(actionId, action);\n}\nexport function unbind() {\n    globalController.clear();\n}\nexport function text(modelId, value) {\n    return globalController.text(modelId, value);\n}\nexport function boolean(modelId, value) {\n    return globalController.boolean(modelId, value);\n}\n//# sourceMappingURL=globalController.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { Action } from \"../model/Action.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Controller {\n    constructor() {\n        this.modelId2Models = new Map();\n        this.modelId2Views = new Map();\n        this.view2ModelIds = new Map();\n        this.sigChanged = new Signal();\n    }\n    registerAction(actionId, callback) {\n        let action = new Action(callback);\n        action.signal.add(callback);\n        this._registerModel(\"A:\" + actionId, action);\n        return action;\n    }\n    registerModel(modelId, model) {\n        this._registerModel(\"M:\" + modelId, model);\n    }\n    _registerModel(modelId, model) {\n        let modelsForModelId = this.modelId2Models.get(modelId);\n        if (!modelsForModelId) {\n            modelsForModelId = new Set();\n            this.modelId2Models.set(modelId, modelsForModelId);\n        }\n        modelsForModelId.add(model);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId)\n            return;\n        for (let view of viewsForModelId) {\n            view.setModel(model);\n        }\n    }\n    registerView(modelId, view) {\n        if (view.controller && view.controller !== this) {\n            console.log(\"error: attempt to register view more than once at different controllers\");\n            return;\n        }\n        view.controller = this;\n        let modelIdsForView = this.view2ModelIds.get(view);\n        if (!modelIdsForView) {\n            modelIdsForView = new Set();\n            this.view2ModelIds.set(view, modelIdsForView);\n        }\n        modelIdsForView.add(modelId);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId) {\n            viewsForModelId = new Set();\n            this.modelId2Views.set(modelId, viewsForModelId);\n        }\n        viewsForModelId.add(view);\n        let modelsForView = this.modelId2Models.get(modelId);\n        if (!modelsForView)\n            return;\n        for (let model of modelsForView) {\n            view.setModel(model);\n        }\n    }\n    unregisterView(view) {\n        if (!view.controller)\n            return;\n        if (view.controller !== this)\n            throw Error(\"attempt to unregister view from wrong controller\");\n        let modelIds = this.view2ModelIds.get(view);\n        if (!modelIds)\n            return;\n        for (let modelId of modelIds) {\n            let views = this.modelId2Views.get(modelId);\n            if (!views)\n                continue;\n            views.delete(view);\n            if (views.size === 0) {\n                this.modelId2Views.delete(modelId);\n            }\n            view.setModel(undefined);\n        }\n    }\n    clear() {\n        for (let entry of this.view2ModelIds) {\n            entry[0].setModel(undefined);\n        }\n        this.modelId2Models.clear();\n        this.modelId2Views.clear();\n        this.view2ModelIds.clear();\n    }\n    bind(modelId, model) {\n        this.registerModel(modelId, model);\n    }\n    action(actionId, callback) {\n        return this.registerAction(actionId, callback);\n    }\n    text(modelId, value) {\n        let model = new TextModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    html(modelId, value) {\n        let model = new HtmlModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    boolean(modelId, value) {\n        let model = new BooleanModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    number(modelId, value, options) {\n        let model = new NumberModel(value, options);\n        this.bind(modelId, model);\n        return model;\n    }\n}\n//# sourceMappingURL=Controller.js.map","export class AnimationBase {\n    constructor() {\n        this._stop = false;\n        this._firstFrame = this._firstFrame.bind(this);\n        this._animationFrame = this._animationFrame.bind(this);\n    }\n    start() {\n        this.prepare();\n        if (this._stop === true)\n            return;\n        this.requestAnimationFrame(this._firstFrame);\n    }\n    stop() {\n        this._stop = true;\n        if (this.animator?.current === this) {\n            this.animator.clearCurrent();\n        }\n    }\n    replace(animation) {\n        this.next = animation;\n        this.animationFrame(1);\n        this.lastFrame();\n        animation.prepare();\n    }\n    prepare() { }\n    firstFrame() { }\n    animationFrame(value) { }\n    lastFrame() { }\n    requestAnimationFrame(callback) {\n        window.requestAnimationFrame(callback);\n    }\n    _firstFrame(time) {\n        this.startTime = time;\n        this.firstFrame();\n        if (this._stop)\n            return;\n        this.animationFrame(0);\n        this.requestAnimationFrame(this._animationFrame);\n    }\n    _animationFrame(time) {\n        if (this.next) {\n            this.next._firstFrame(time);\n            return;\n        }\n        let elapsed = AnimationBase.animationFrameCount > 0 ? (time - this.startTime) / AnimationBase.animationFrameCount : 1;\n        elapsed = elapsed > 1 ? 1 : elapsed;\n        const value = this.ease(elapsed);\n        this.animationFrame(value);\n        if (this._stop) {\n            return;\n        }\n        if (value < 1.0) {\n            this.requestAnimationFrame(this._animationFrame.bind(this));\n        }\n        else {\n            this.lastFrame();\n            if (this.animator && this.animator._current === this) {\n                this.animator.clearCurrent();\n            }\n        }\n    }\n    ease(k) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n}\nAnimationBase.animationFrameCount = 468;\nclass AnimationWrapper extends AnimationBase {\n    constructor(animation) {\n        super();\n        this.animation = animation;\n    }\n    prepare() {\n        this.animation.prepare();\n    }\n    firstFrame() {\n        this.animation.firstFrame();\n    }\n    animationFrame(value) {\n        this.animation.animationFrame(value);\n    }\n    lastFrame() {\n        this.animation.lastFrame();\n    }\n}\nexport class Animator {\n    get current() {\n        if (this._current === undefined) {\n            return undefined;\n        }\n        if (this._current instanceof AnimationWrapper) {\n            return this._current.animation;\n        }\n        return this._current;\n    }\n    clearCurrent() {\n        this._current = undefined;\n    }\n    run(animation) {\n        let animationBase;\n        if (!(animation instanceof AnimationBase)) {\n            animationBase = new AnimationWrapper(animation);\n        }\n        else {\n            animationBase = animation;\n        }\n        const previousAnimation = this._current;\n        this._current = animationBase;\n        animationBase.animator = this;\n        if (previousAnimation) {\n            previousAnimation.animator = undefined;\n            previousAnimation.replace(animationBase);\n        }\n        else {\n            if (Animator.halt) {\n                return;\n            }\n            animationBase.start();\n        }\n    }\n}\nAnimator.halt = false;\n//# sourceMappingURL=animation.js.map","import { globalController } from \"../controller/globalController.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nexport class View extends HTMLElement {\n    static define(name, view, options) {\n        const element = window.customElements.get(name);\n        if (element === undefined) {\n            window.customElements.define(name, view, options);\n        }\n        else {\n            if (element !== view) {\n                for (let i = 0; i < 255; ++i) {\n                    const dname = `${name}-duplicate-${i}`;\n                    if (window.customElements.get(dname) === undefined) {\n                        console.log(`View::define(${name}, ...) with different constructor, using ${dname} instead (known issue on Safari and Edge)`);\n                        window.customElements.define(dname, view, options);\n                        return;\n                    }\n                }\n                console.error(`View::define(${name}, ...): attempt to redefine view with different constructor (known issue on Safari and Edge), giving up after 255 times`);\n            }\n        }\n    }\n    constructor(props) {\n        super();\n        setInitialProperties(this, props);\n    }\n    setModel(model) {\n        console.trace(`Please note that View.setModel(model) has no implementation.`);\n    }\n    getModelId() {\n        if (!this.hasAttribute(\"model\"))\n            throw Error(\"no 'model' attribute\");\n        let modelId = this.getAttribute(\"model\");\n        if (!modelId)\n            throw Error(\"no model id\");\n        return \"M:\" + modelId;\n    }\n    getActionId() {\n        if (!this.hasAttribute(\"action\"))\n            throw Error(\"no 'action' attribute\");\n        let actionId = this.getAttribute(\"action\");\n        if (!actionId)\n            throw Error(\"no action id\");\n        return \"A:\" + actionId;\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        let modelId = \"\";\n        try {\n            modelId = this.getModelId();\n        }\n        catch (error) {\n        }\n        if (modelId != \"\")\n            globalController.registerView(modelId, this);\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n}\n//# sourceMappingURL=View.js.map","import { ModelReason } from \"../model/Model.js\";\nimport { View } from \"./View.js\";\nexport class ModelView extends View {\n    constructor(init) {\n        super(init);\n        this.model = undefined;\n        if (init?.model !== undefined) {\n            this.setModel(init.model);\n        }\n    }\n    updateModel() { }\n    updateView(reason) { }\n    setModel(model) {\n        if (model === this.model)\n            return;\n        const view = this;\n        if (this.model) {\n            this.model.modified.remove(view);\n        }\n        if (model) {\n            model.modified.add((reason) => view.updateView(reason), view);\n        }\n        this.model = model;\n        if (this.isConnected) {\n            this.updateView(ModelReason.ALL);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model) {\n            this.updateView(ModelReason.ALL);\n        }\n    }\n}\n//# sourceMappingURL=ModelView.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { ModelReason } from \"../model/Model.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { Action } from \"../model/Action.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class ActionView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    connectedCallback() {\n        if (this.controller) {\n            this.updateView(ModelReason.ALL);\n            return;\n        }\n        try {\n            globalController.registerView(this.getActionId(), this);\n        }\n        catch (e) { }\n        try {\n            globalController.registerView(this.getModelId(), this);\n        }\n        catch (e) { }\n        this.updateView(ModelReason.ALL);\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (model === undefined) {\n            if (this.model)\n                this.model.modified.remove(this);\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView(ModelReason.ALL);\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView(ModelReason.ALL);\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n            this.model.modified.add(() => {\n                this.updateView(ModelReason.ALL);\n            }, this);\n        }\n        else {\n            if (typeof model === \"object\") {\n                throw Error(`unexpected model of type ${model.constructor.name}`);\n            }\n            else {\n                throw Error(`unexpected model of type ${typeof model}`);\n            }\n        }\n        this.updateView(ModelReason.ALL);\n    }\n    setAction(value) {\n        if (value instanceof Function) {\n            this.setModel(new Action(value));\n        }\n        else {\n            this.setModel(value);\n        }\n    }\n    isEnabled() {\n        return this.action !== undefined && this.action.enabled;\n    }\n}\n//# sourceMappingURL=ActionView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host {\n    display: inline-block;\n}\n\n.tx-text {\n    width: 100%;\n    box-shadow: none;\n    box-sizing: border-box;\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n\n    /* we use the border instead of an outline to indicate the focus */\n    outline: none;\n    border-width: var(--tx-border-width);\n    border-style: solid;\n    border-color: var(--tx-border-color);\n    border-radius: var(--tx-border-radius);\n\n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n\n    padding: 4px 8px 4px 8px;\n    text-indent: 0;\n    vertical-align: top;\n    margin: 0;\n    overflow: visible;\n    text-overflow: ellipsis;\n}\n.tx-text:hover {\n    border-color: var(--tx-border-color-hover);\n}\n.tx-text:disabled {\n    color: var(--tx-fg-color-disabled);\n    background-color: var(--tx-bg-color-disabled);\n    border-color: var(--tx-bg-color-disabled);\n}\n.tx-text::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n.tx-text:hover::placeholder {\n    color: var(--tx-placeholder-fg-color-hover);\n}\n.tx-text:focus {\n    border-color: var(--tx-outline-color);\n}\n.tx-text.tx-error {\n    border-color: var(--tx-warning-color)\n}\n`);\n//# sourceMappingURL=tx-text.js.map","import { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class TextField extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = document.createElement(\"input\");\n        this.input.classList.add(\"tx-text\");\n        this.input.onkeydown = (e) => {\n            if (e.key === \"Enter\" && this.model instanceof NumberModel) {\n                this.updateModel();\n            }\n        };\n        this.input.onblur = (e) => {\n            if (this.model instanceof NumberModel) {\n                this.updateModel();\n            }\n        };\n        this.input.oninput = (e) => {\n            if (!(this.model instanceof NumberModel)) {\n                this.updateModel();\n            }\n        };\n        this.wheel = this.wheel.bind(this);\n        this.input.onwheel = this.wheel;\n        this.input.ondblclick = () => {\n            this.model?.resetToDefault();\n        };\n        this.attachShadow({ mode: \"open\", delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txText];\n        this.shadowRoot.appendChild(this.input);\n        this.updateView();\n    }\n    wheel(e) {\n        if (this.model instanceof NumberModel) {\n            e.preventDefault();\n            if (e.deltaY > 0) {\n                this.model.decrement();\n            }\n            if (e.deltaY < 0) {\n                this.model.increment();\n            }\n        }\n    }\n    focus() {\n        this.input.focus();\n    }\n    blur() {\n        this.input.blur();\n    }\n    static get observedAttributes() { return ['value']; }\n    attributeChangedCallback(name, oldValue, newValue) {\n        switch (name) {\n            case \"value\":\n                if (this.model && newValue !== undefined) {\n                    this.model.value = newValue;\n                }\n                break;\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.value;\n        }\n        this.setAttribute(\"value\", this.input.value);\n    }\n    updateView() {\n        if (!this.model) {\n            this.setAttribute(\"disabled\", \"disabled\");\n            this.input.setAttribute(\"disabled\", \"disabled\");\n            return;\n        }\n        if (this.model.enabled) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n        this.model.applyStyle(this.input);\n        const strValue = `${this.model.value}`;\n        if (this.input.value !== strValue) {\n            this.input.value = strValue;\n            this.setAttribute(\"value\", strValue);\n        }\n    }\n    get value() {\n        return this.input.value;\n    }\n    set value(value) {\n        this.input.value = value;\n        this.updateModel();\n    }\n}\nTextField.define(\"tx-text\", TextField);\n//# sourceMappingURL=TextField.js.map","import { css } from \"../util/lsx.js\";\nexport const textAreaStyle = new CSSStyleSheet();\ntextAreaStyle.replaceSync(css `\n\n/* try to follow material ui: when active render button labels in black, otherwise in gray */\nsvg .fill {\n  fill: var(--tx-gray-700);\n  stroke: var(--tx-gray-700);\n}\nsvg .stroke {\n  fill: none;\n  stroke: var(--tx-gray-700);\n}\nsvg .strokeFill {\n  fill: var(--tx-gray-200);\n  stroke: var(--tx-gray-700);\n}\n\n/*\nthese don't seem to be in use anymore\n.toolbar.active svg .fill {\n  fill: #000;\n  stroke: #000;\n}\n.toolbar.active svg .stroke {\n  fill: none;\n  stroke: #000;\n}\n.toolbar.active svg .strokeFill {\n  fill: #fff;\n  stroke: #000;\n}\n*/\n\n.toolbar button {\n    background: var(--tx-gray-75);\n    color: var(--tx-gray-800);\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    padding: 5;\n    margin: 0;\n    vertical-align: middle;\n    height: 22px;\n}\n\n.toolbar button:active:hover {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n}\n\n.toolbar button.left {\n    border-style: solid;\n    border-radius: 3px 0 0 3px;\n}\n\n.toolbar button.right {\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    border-radius: 0 3px 3px 0;\n}\n\n.toolbar button.active {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n    border: 1px var(--tx-global-blue-500) solid;\n    color: var(--tx-gray-900);\n}\n\ndiv.textarea {\n  font-family: var(--tx-font-family);\n  font-size: var(--tx-font-size);\n  border: 1px var(--tx-gray-400) solid;\n  border-radius: 3px;\n  margin: 2px;\n  padding: 4px 5px;\n  outline-offset: -2px;\n}\n\ndiv.textarea h1 {\n  font-size: 22px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h2 {\n  font-size: 18px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h3 {\n  font-size: 16px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h4 {\n  font-size: 14px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea div {\n  padding: 2px 0 2px 0;\n}\n`);\n//# sourceMappingURL=textAreaStyle.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { textAreaStyle } from \"./textAreaStyle.js\";\nexport class TextTool extends ModelView {\n    constructor() {\n        super();\n        TextTool.texttool = this;\n        let toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonH1 = _jsx(\"button\", { class: \"left\", children: \"H1\" });\n        this.buttonH1.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h1>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH1);\n        this.buttonH2 = _jsx(\"button\", { children: \"H2\" });\n        this.buttonH2.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h2>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH2);\n        this.buttonH3 = _jsx(\"button\", { children: \"H3\" });\n        this.buttonH3.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h3>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH3);\n        this.buttonH4 = _jsx(\"button\", { class: \"right\", children: \"H4\" });\n        this.buttonH4.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h4>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH4);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonBold = _jsx(\"button\", { class: \"left\", children: _jsx(\"b\", { children: \"B\" }) });\n        this.buttonBold.onclick = () => {\n            document.execCommand(\"bold\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonBold);\n        this.buttonItalic = _jsx(\"button\", { children: _jsx(\"i\", { children: \"I\" }) });\n        this.buttonItalic.onclick = () => {\n            document.execCommand(\"italic\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonItalic);\n        this.buttonUnderline = _jsx(\"button\", { children: _jsx(\"u\", { children: \"U\" }) });\n        this.buttonUnderline.onclick = () => {\n            document.execCommand(\"underline\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonUnderline);\n        this.buttonStrikeThrough = _jsx(\"button\", { children: _jsx(\"strike\", { children: \"S\" }) });\n        this.buttonStrikeThrough.onclick = () => {\n            document.execCommand(\"strikeThrough\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonStrikeThrough);\n        this.buttonSubscript = _jsx(\"button\", { children: \"x\\u2082\" });\n        this.buttonSubscript.onclick = () => {\n            document.execCommand(\"subscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSubscript);\n        this.buttonSuperscript = _jsx(\"button\", { class: \"right\", children: \"x\\u00B2\" });\n        this.buttonSuperscript.onclick = () => {\n            document.execCommand(\"superscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSuperscript);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonJustifyLeft = _jsx(\"button\", { class: \"left\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"2.5\", x2: \"6\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"6.5\", x2: \"6\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyLeft.onclick = () => {\n            document.execCommand(\"justifyLeft\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyLeft);\n        this.buttonJustifyCenter = _jsx(\"button\", { children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"2.5\", x2: \"8\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"8\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyCenter.onclick = () => {\n            document.execCommand(\"justifyCenter\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyCenter);\n        this.buttonJustifyRight = _jsx(\"button\", { class: \"right\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"2.5\", x2: \"10\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"6.5\", x2: \"10\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyRight.onclick = () => {\n            document.execCommand(\"justifyRight\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyRight);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [textAreaStyle];\n        this.shadowRoot.appendChild(toolbar);\n    }\n    update() {\n        this.buttonH1.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h1\");\n        this.buttonH2.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h2\");\n        this.buttonH3.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h3\");\n        this.buttonH4.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h4\");\n        this.buttonBold.classList.toggle(\"active\", document.queryCommandState(\"bold\"));\n        this.buttonItalic.classList.toggle(\"active\", document.queryCommandState(\"italic\"));\n        this.buttonUnderline.classList.toggle(\"active\", document.queryCommandState(\"underline\"));\n        this.buttonStrikeThrough.classList.toggle(\"active\", document.queryCommandState(\"strikeThrough\"));\n        this.buttonSubscript.classList.toggle(\"active\", document.queryCommandState(\"subscript\"));\n        this.buttonSuperscript.classList.toggle(\"active\", document.queryCommandState(\"superscript\"));\n        this.buttonJustifyLeft.classList.toggle(\"active\", document.queryCommandState(\"justifyLeft\"));\n        this.buttonJustifyCenter.classList.toggle(\"active\", document.queryCommandState(\"justifyCenter\"));\n        this.buttonJustifyRight.classList.toggle(\"active\", document.queryCommandState(\"justifyRight\"));\n    }\n}\nTextTool.define(\"tx-texttool\", TextTool);\n//# sourceMappingURL=TextTool.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextTool } from \"./TextTool.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class TextArea extends ModelView {\n    constructor(init) {\n        super(init);\n        let content = document.createElement(\"div\");\n        this.content = content;\n        content.classList.add(\"tx-text\");\n        content.contentEditable = \"true\";\n        content.oninput = (event) => {\n            if (this.model instanceof HtmlModel) {\n                let firstChild = event.target.firstChild;\n                if (firstChild && firstChild.nodeType === 3) {\n                    document.execCommand(\"formatBlock\", false, `<div>`);\n                }\n                else if (content.innerHTML === \"<br>\") {\n                    content.innerHTML = \"\";\n                }\n            }\n            this.updateModel();\n        };\n        content.onkeydown = (event) => {\n            if (!(this.model instanceof HtmlModel)) {\n                return;\n            }\n            if (event.metaKey === true && event.key === \"b\") {\n                event.preventDefault();\n                document.execCommand(\"bold\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"i\") {\n                event.preventDefault();\n                document.execCommand(\"italic\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"u\") {\n                event.preventDefault();\n                document.execCommand(\"underline\", false);\n                this.updateTextTool();\n            }\n            else if (event.key === \"Tab\") {\n                event.preventDefault();\n            }\n            else if (event.key === \"Enter\" &&\n                event.shiftKey !== true &&\n                document.queryCommandValue(\"formatBlock\") === \"blockquote\") {\n                document.execCommand(\"formatBlock\", false, \"<p>\");\n            }\n        };\n        content.onkeyup = () => {\n            this.updateTextTool();\n        };\n        content.onmouseup = () => {\n            this.updateTextTool();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txText];\n        this.shadowRoot.appendChild(content);\n    }\n    updateTextTool() {\n        if (TextTool.texttool !== undefined)\n            TextTool.texttool.update();\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.promise = () => {\n                if (this.model instanceof HtmlModel) {\n                    return this.content.innerHTML;\n                }\n                else {\n                    return this.content.innerText;\n                }\n            };\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            if (this.content.innerHTML !== this.model.value) {\n                this.content.innerHTML = this.model.value;\n            }\n        }\n        else {\n            if (this.content.innerText !== this.model.value) {\n                this.content.innerText = this.model.value;\n            }\n        }\n    }\n}\nTextArea.define(\"tx-textarea\", TextArea);\n//# sourceMappingURL=TextArea.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nexport class Display extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.innerText = \"\";\n            return;\n        }\n        if (this.model instanceof TextModel) {\n            this.innerText = this.model.value;\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            this.innerHTML = this.model.value;\n            return;\n        }\n        if (this.model instanceof NumberModel) {\n            this.innerText = `${this.model.value}`;\n            return;\n        }\n    }\n}\nDisplay.define(\"tx-display\", Display);\n//# sourceMappingURL=Display.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-button {\n    padding: 2px 14px 2px 14px;\n    margin: 0;\n    color: var(--tx-gray-800);\n    transition: background-color 130ms ease-in-out;\n    background-color: var(--tx-gray-300);\n    border: 0 none;\n    height: 28px;\n    border-radius: 16px;\n    box-shadow: none;\n    font-family: inherit;\n}\n\n.tx-button:hover, .tx-button:active {\n    color: var(--tx-gray-900);\n    background-color: var(--tx-gray-400);\n}\n\n.tx-button:hover:active > span {\n    transition: transform 130ms ease-in-out;\n}\n:host > .tx-button:hover:active {\n    transform: translate(1px, 1px);\n}\n:host([disabled]) > .tx-button:hover:active {\n    transform: translate(0px, 0px);\n}\n\n/* accent */\n\n.tx-button.tx-accent {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-600);\n}\n.tx-button.tx-accent:hover, .tx-button.tx-accent:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-700);\n}\n.tx-button.tx-accent:hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-500);\n}\n\n/* negative */\n\n.tx-button.tx-negative {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-600);\n}\n.tx-button.tx-negative:hover, .tx-button.tx-negative:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-700);\n}\n.tx-button.tx-negative:hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-500);\n}\n\n/* primary */\n\n.tx-button.tx-default {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-800);\n}\n\n.tx-button.tx-default:hover, .tx-button.tx-default:hover:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-button.tx-default:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-label {\n    font-weight: bold;\n    padding: 4px 0 6px 0;\n    /* override parent flex/grid's align-items property to align in the center */\n    align-self: center;\n    /* adjust sides in container to look centered...? */\n    justify-self: center;\n    /* align children in the center */\n    text-align: center;\n}\n\n:host([disabled]) > .tx-button, :host([disabled]) > .tx-button:active {\n    color: var(--tx-fg-color-disabled);\n    background-color: var(--tx-gray-200);\n}\n`);\n//# sourceMappingURL=tx-button.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ActionView } from \"./ActionView.js\";\nimport { button, span } from \"../util/lsx.js\";\nimport { style as txButton } from \"../style/tx-button.js\";\nexport var ButtonVariant;\n(function (ButtonVariant) {\n    ButtonVariant[ButtonVariant[\"PRIMARY\"] = 0] = \"PRIMARY\";\n    ButtonVariant[ButtonVariant[\"SECONDARY\"] = 1] = \"SECONDARY\";\n    ButtonVariant[ButtonVariant[\"ACCENT\"] = 2] = \"ACCENT\";\n    ButtonVariant[ButtonVariant[\"NEGATIVE\"] = 3] = \"NEGATIVE\";\n})(ButtonVariant || (ButtonVariant = {}));\nexport class Button extends ActionView {\n    constructor(init) {\n        super(init);\n        this.button = button(this.label = span());\n        this.button.classList.add(\"tx-button\");\n        this.label.classList.add(\"tx-label\");\n        this.button.onclick = () => {\n            if (this.action)\n                this.action.trigger();\n        };\n        switch (this.getAttribute(\"variant\")) {\n            case \"primary\":\n                this.button.classList.add(\"tx-default\");\n                break;\n            case \"secondary\":\n                break;\n            case \"accent\":\n                this.button.classList.add(\"tx-accent\");\n                break;\n            case \"negative\":\n                this.button.classList.add(\"tx-negative\");\n                break;\n        }\n        switch (init?.variant) {\n            case ButtonVariant.PRIMARY:\n                this.button.classList.add(\"tx-default\");\n                break;\n            case ButtonVariant.SECONDARY:\n                break;\n            case ButtonVariant.ACCENT:\n                this.button.classList.add(\"tx-accent\");\n                break;\n            case ButtonVariant.NEGATIVE:\n                this.button.classList.add(\"tx-negative\");\n                break;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txButton];\n        this.shadowRoot.appendChild(this.button);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.children.length !== 0) {\n            return;\n        }\n        this._observer = new MutationObserver((record, observer) => {\n            if (this._timer !== undefined)\n                clearTimeout(this._timer);\n            this._timer = window.setTimeout(() => {\n                this._timer = undefined;\n                this.updateView();\n            }, 100);\n        });\n        this._observer.observe(this, {\n            childList: true,\n            subtree: true,\n            characterData: true\n        });\n    }\n    updateView() {\n        if (!this.isConnected)\n            return;\n        if (this.model && this.model.value) {\n            if (this.model instanceof HtmlModel)\n                this.label.innerHTML = this.model.value;\n            else\n                this.label.innerText = this.model.value;\n        }\n        else {\n            this.label.innerHTML = this.innerHTML;\n        }\n        if (this.isEnabled()) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n    }\n}\nButton.define(\"tx-button\", Button);\n//# sourceMappingURL=Button.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class BooleanView extends ModelView {\n    setModel(model) {\n        if (model !== undefined && !(model instanceof BooleanModel)) {\n            throw Error(`BooleanView.setModel(): model is not of type BooleanModel`);\n        }\n        super.setModel(model);\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.checked;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.value;\n        }\n    }\n}\n//# sourceMappingURL=BooleanView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-checkbox) {\n    display: inline-block;\n    position: relative;\n    box-shadow: none;\n    box-sizing: border-box;\n    padding: 0;\n    margin: 2px; /* leave space for the focus ring */\n    border: none 0;\n    height: 14px;\n    width: 14px;\n}\n\n:host(.tx-checkbox) > input {\n    box-sizing: border-box;\n    width: 14px;\n    height: 14px;\n    outline: none;\n    padding: 0;\n    margin: 0;\n    border: 2px solid;\n    border-radius: 2px;\n    border-color: var(--tx-gray-700);\n    /* border-radius: var(--tx-border-radius); */\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n    -webkit-appearance: none;\n}\n\n/* this is a svg 2 feature, works with firefox, chrome and edge, but not safari */\n/* :host(.tx-checkbox) > svg > path {\n    d: path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\");\n} */\n\n/* focus ring */\n:host(.tx-checkbox) > input:focus-visible {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n:host(.tx-checkbox) > svg {\n    position: absolute;\n    left: 2px;\n    top: 2px;\n    stroke: none;\n    fill: var(--tx-edit-bg-color);\n    width: 10px;\n    height: 10px;\n    pointer-events: none;\n}\n\n:host(.tx-checkbox) > input:hover {\n    border-color: var(--tx-gray-800);\n}\n.tx-checkbox > input:focus {\n    border-color: var(--tx-outline-color);\n}\n\n:host(.tx-checkbox) > input:checked {\n    background-color: var(--tx-gray-700);\n}\n:host(.tx-checkbox) > input:hover:checked {\n    background-color: var(--tx-gray-800);\n}\n\n:host(.tx-checkbox) > input:disabled {\n    color: var(--tx-gray-400);\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-checkbox) > input:checked:disabled {\n    background-color: var(--tx-gray-400);\n}\n`);\n//# sourceMappingURL=tx-checkbox.js.map","import { BooleanView } from \"./BooleanView.js\";\nimport { input, svg, path } from \"../util/lsx.js\";\nimport { style as txCheckbox } from \"../style/tx-checkbox.js\";\nexport class Checkbox extends BooleanView {\n    constructor(init) {\n        super(init);\n        this.classList.add(\"tx-checkbox\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.updateModel = this.updateModel.bind(this);\n        this.input.onchange = this.updateModel;\n        const checkmark = svg(path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\"));\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txCheckbox];\n        this.shadowRoot.replaceChildren(this.input, checkmark);\n    }\n}\nCheckbox.define(\"tx-checkbox\", Checkbox);\n//# sourceMappingURL=Checkbox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-search {\n    display: inline-block;\n    position: relative;\n}\n.tx-search > div {\n    display: inline-flex;\n    position: relative;\n}\n.tx-search > div > svg {\n    display: block;\n    position: absolute;\n    height: 18px;\n    width: 18px;\n    top: 7px;\n    left: 10px;\n    pointer-events: none;\n    overflow: hidden;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input {\n    box-sizing: border-box;\n    padding: 3px 12px 5px 35px;\n    margin: 0;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    -webkit-appearance: none;\n    outline-offset: -2px;\n    outline: none;\n    width: 100%;\n    height: 32px;\n    overflow: visible;\n    background: var(--tx-gray-50);\n\n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n}\n/* the button is transparent so that the border of the input field remains visible */\n.tx-search > button {\n    display: inline-flex;\n    position: absolute;\n    box-sizing: border-box;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 32px;\n    padding: 0;\n    margin: 1px;\n    border: none;\n    align-items: center;\n    justify-content: center;\n    overflow: visible;\n    vertical-align: top;\n    cursor: pointer;\n    border-radius: 0 4px 4px 0;\n    text-align: center;\n    outline: none;\n\n    background-color: var(--tx-gray-50);\n    border-radius: 0 4px 4px 0;\n\n}\n.tx-search > button > svg {\n    display: inline-block;\n    pointer-events: none;\n    height: 10px;\n    width: 10px;\n    padding: 0;\n    margin: 0;\n    border: none;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input:hover {\n    border-color: var(--tx-gray-500);\n}\n\n.tx-search > div > input:focus {\n    border-color: var(--tx-outline-color);\n}\n.tx-search > button:focus > svg {\n    fill: var(--tx-outline-color);\n}\n\n.tx-search > div > input:disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled {\n    background-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled > svg {\n    fill: var(--tx-gray-400);\n}`);\n//# sourceMappingURL=tx-search.js.map","import { ModelView } from \"./ModelView.js\";\nimport { form, input, button, svg, path, div } from \"../util/lsx.js\";\nimport { style as txSearch } from \"../style/tx-search.js\";\nexport class Search extends ModelView {\n    constructor(init) {\n        super(init);\n        let s0, s1, b, i, p;\n        const f = form(div(s0 = svg(p = path(\"M33.173 30.215L25.4 22.443a12.826 12.826 0 10-2.957 2.957l7.772 7.772a2.1 2.1 0 002.958-2.958zM6 15a9 9 0 119 9 9 9 0 01-9-9z\")), i = input()), b = button(s1 = svg(path(\"M6.548 5L9.63 1.917A1.094 1.094 0 008.084.371L5.001 3.454 1.917.37A1.094 1.094 0 00.371 1.917L3.454 5 .37 8.085A1.094 1.094 0 101.917 9.63l3.084-3.083L8.084 9.63a1.094 1.094 0 101.547-1.546z\"))));\n        s0.setAttributeNS(null, \"width\", \"100%\");\n        s0.setAttributeNS(null, \"height\", \"100%\");\n        p.setAttributeNS(null, \"transform\", \"scale(0.5, 0.5)\");\n        s1.setAttributeNS(null, \"width\", \"100%\");\n        s1.setAttributeNS(null, \"height\", \"100%\");\n        i.type = \"search\";\n        i.placeholder = \"Search\";\n        i.autocomplete = \"off\";\n        f.classList.add(\"tx-search\");\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txSearch];\n        this.shadowRoot.appendChild(f);\n    }\n}\nSearch.define(\"tx-search\", Search);\n//# sourceMappingURL=Search.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n/* a div on top serves as the container for elements used for the switch*/\n:host(.tx-switch) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n/* an invisible checkbox will overlay everything, handling input and state */\n:host(.tx-switch) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n/* the span provides the visual appearance */\n:host(.tx-switch) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 0;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 0px none;\n    border-radius: 7px;\n\n    width: 26px;\n    height: 14px;\n    background: var(--tx-gray-300);\n}\n\n/* focus ring */\n:host(.tx-switch) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n/* this is the knob on the switch */\n:host(.tx-switch) > span:before {\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 14px;\n    height: 14px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: transform 130ms ease-in-out;\n}\n:host(.tx-switch) > input:hover + span:before {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked + span:before {\n    /* border-color: var(--tx-gray-700); */\n    transform: translateX(calc(100% - 2px));\n}\n\n:host(.tx-switch) > input:checked + span {\n    background: var(--tx-gray-700);\n}\n:host(.tx-switch) > input:checked:hover + span {\n    background: var(--tx-gray-900);\n}\n:host(.tx-switch) > input:hover + span + label {\n    color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked:disabled + span {\n    background: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span:before {\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span + label {\n    color: var(--tx-gray-400);\n}`);\n//# sourceMappingURL=tx-switch.js.map","import { BooleanView } from \"./BooleanView.js\";\nimport { style as txSwitch } from \"../style/tx-switch.js\";\nimport { input, span } from \"../util/lsx.js\";\nexport class Switch extends BooleanView {\n    constructor(init) {\n        super(init);\n        this.classList.add(\"tx-switch\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.input.onchange = () => {\n            this.updateModel();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txSwitch];\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(span());\n    }\n}\nSwitch.define(\"tx-switch\", Switch);\n//# sourceMappingURL=Switch.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-radio) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n    padding: 2px;\n}\n/* an invisible radiobutton will overlay everything, handling input and state */\n:host(.tx-radio) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n\n/* the span provides the visual appearance */\n:host(.tx-radio) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 2px;\n    margin-right: 3px;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n\n    width: 14px;\n    height: 14px;\n    background: none;\n}\n\n/* focus ring */\n:host(.tx-radio) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n/* this is the knob on the switch */\n:host(.tx-radio) > span:before {\n    display: block;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    width: 10px;\n    height: 10px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-75);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: opacity 130ms ease-in-out;\n}\n:host(.tx-radio) > input:checked + span:before {\n    background: var(--tx-gray-700);\n}\n:host(.tx-radio) > input:checked:hover + span:before {\n    background: var(--tx-gray-900);\n}\n:host(.tx-radio) > input:hover + span {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-radio) > input:checked:disabled + span:before {\n    background: var(--tx-gray-500);\n}\n:host(.tx-radio) > input:disabled + span {\n    border-color: var(--tx-gray-500);\n}\n:host(.tx-radio) > input:disabled + span + label {\n    color: var(--tx-gray-500);\n}\n`);\n//# sourceMappingURL=tx-radio.js.map","import { ModelView } from \"./ModelView.js\";\nimport { input, label, slot, span } from \"../util/lsx.js\";\nimport { style as txRadio } from \"../style/tx-radio.js\";\nexport class RadioButton extends ModelView {\n    constructor(init) {\n        super(init);\n        this.value = init?.value;\n        this.updateModel = this.updateModel.bind(this);\n        this.updateView = this.updateView.bind(this);\n        this.classList.add(\"tx-radio\");\n        this.input = input();\n        this.input.type = \"radio\";\n        this.input.onchange = this.updateModel;\n        this.input.disabled = true;\n        this.label = label();\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txRadio];\n        this.shadowRoot.replaceChildren(this.input, span(), this.label);\n    }\n    updateModel() {\n        if (this.input.checked && this.model !== undefined) {\n            this.model.value = this.value;\n        }\n    }\n    updateView() {\n        if (this.model !== undefined) {\n            let radioGroup = RadioButton.radioGroups.get(this.model);\n            if (radioGroup === undefined) {\n                radioGroup = ++RadioButton.radioGroupCounter;\n                RadioButton.radioGroups.set(this.model, radioGroup);\n            }\n            this.input.name = `tx-radio-group-${radioGroup}`;\n            this.input.value = `${this.model.indexOf(this.value)}`;\n            if (this.childNodes.length > 0) {\n                this.label.replaceChildren(slot());\n            }\n            else {\n                this.label.replaceChildren(this.model.labelOf(this.value));\n            }\n        }\n        else {\n            this.input.name = \"\";\n        }\n        if (!this.model || !this.model.enabled || !this.model.isEnabledOf(this.value)) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.value === this.value;\n        }\n    }\n}\nRadioButton.radioGroupCounter = 0;\nRadioButton.radioGroups = new WeakMap();\nRadioButton.define(\"tx-radio\", RadioButton);\n//# sourceMappingURL=RadioButton.js.map","export var MenuState;\n(function (MenuState) {\n    MenuState[MenuState[\"WAIT\"] = 0] = \"WAIT\";\n    MenuState[MenuState[\"DOWN\"] = 1] = \"DOWN\";\n    MenuState[MenuState[\"UP_N_HOLD\"] = 2] = \"UP_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_HOLD\"] = 3] = \"DOWN_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_OUTSIDE\"] = 4] = \"DOWN_N_OUTSIDE\";\n    MenuState[MenuState[\"DOWN_N_INSIDE_AGAIN\"] = 5] = \"DOWN_N_INSIDE_AGAIN\";\n})(MenuState || (MenuState = {}));\n//# sourceMappingURL=MenuState.js.map","import { View } from \"../view/View.js\";\nimport { MenuState } from \"./MenuState.js\";\nexport class MenuButtonContainer extends View {\n    constructor(props) {\n        super(props);\n        this.vertical = true;\n        this.closeOnClose = false;\n        this.state = MenuState.WAIT;\n    }\n}\n//# sourceMappingURL=MenuHelper.js.map","import { View } from \"../view/View.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nexport class PopupMenu extends MenuButtonContainer {\n    constructor(root, parent) {\n        super();\n        this.vertical = true;\n        this.root = root;\n        this.parentButton = parent;\n        this.popup = document.createElement(\"div\");\n        this.popup.classList.add(\"menu-popup\");\n        let node = root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.popup);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.appendChild(this.popup);\n        this.show();\n    }\n    show() {\n        if (!this.parentButton.master.vertical)\n            placePopupVertical(this.parentButton, this.popup);\n        else\n            placePopupHorizontal(this.parentButton, this.popup);\n        this.style.display = \"\";\n    }\n    hide() {\n        this.style.display = \"none\";\n    }\n}\nexport function placePopupVertical(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + \"px\";\n    popup.style.top = parentBoundary.top + parentBoundary.height + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + parentBoundary.height + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            const top = parentBoundary.top - popupBoundary.height;\n            if (top > 0 || -top < popupBottom - window.innerHeight) {\n                popup.style.top = `${top}px`;\n            }\n        }\n        let popupRight = parentBoundary.left + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = parentBoundary.left + parentBoundary.width - popupBoundary.width + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nexport function placePopupHorizontal(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + parentBoundary.width + \"px\";\n    popup.style.top = parentBoundary.top + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = parentBoundary.top + parentBoundary.height - popupBoundary.height + \"px\";\n        }\n        let popupRight = parentBoundary.left + parentBoundary.width + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = parentBoundary.left - popupBoundary.width + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nView.define(\"tx-popupmenu\", PopupMenu);\n//# sourceMappingURL=PopupMenu.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-combobox) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n:host(.tx-combobox) > :first-child {\n    box-sizing: border-box;\n    width: 100%;\n    height: 32px;\n    line-height: 30px; /* center text vertically */\n    overflow: hidden; /* children shall not overlap our border */\n    margin: 0;\n    padding: 0;\n    vertical-align: top;\n    text-align: left;\n    outline: none;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    background-color: var(--tx-gray-50);\n    \n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n}\n:host(.tx-combobox) > input:first-child {\n    padding: 4px 32px 4px 11px;\n}\n:host(.tx-combobox) > :first-child > :first-child {\n    padding-left: 7px;\n}\n:host(.tx-combobox) > :first-child::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n:host(.tx-combobox) > button {\n    position: absolute;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-style: none;\n    box-sizing: border-box;\n    overflow: visible;\n    margin: 0;\n    text-transform: none;\n\n    width: 32px;\n    height: 32px;\n    background-color: var(--tx-gray-75);\n    border-radius: 0 4px 4px 0;\n    border: 1px solid var(--tx-gray-400);\n}\n:host(.tx-combobox) > button > svg {\n    fill: var(--tx-gray-700);\n    transform: rotate(90deg) translate(5px, 8px);\n}\n\n:host(.tx-combobox) > :first-child:hover {\n    border-color: var(--tx-gray-500);\n}\n:host(.tx-combobox) > button:hover {\n    border-color: var(--tx-gray-500);\n    background-color: var(--tx-gray-50);\n}\n:host(.tx-combobox) > button:hover > svg {\n    fill: var(--tx-gray-900);\n}\n\n:host(.tx-combobox) > :first-child:focus {\n    border-color: var(--tx-outline-color);\n}\n:host(.tx-combobox) > :first-child:focus + button {\n    border-color: var(--tx-outline-color);\n}\n/* spectrum use a 1px focus ring when the focus was set by mouse\n * and a 2px focus ring when the focus was set by keyboard\n * no clue how to do that with css\n *\n/* :host(.tx-combobox) > input:focus-visible {\n    outline: 1px solid var(--tx-outline-color);\n}\n:host(.tx-combobox) > input:focus-visible + button {\n    outline: 1px solid var(--tx-outline-color);\n    border-left: none;\n} */\n\n:host(.tx-combobox) > :first-child.tx-disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled > * {\n    color: var(--tx-gray-500);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled + button {\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled + button > svg {\n    fill: var(--tx-gray-400);\n}\n:host(.tx-combobox) > :first-child.tx-error {\n    color: var(--tx-warning-color);\n    border-color: var(--tx-warning-color)\n}\n:host(.tx-combobox) > :first-child.tx-error + button {\n    border-color: var(--tx-warning-color)\n}\n`);\n//# sourceMappingURL=tx-combobox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-popover {\n    background-color: var(--tx-gray-50);\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    display: inline-flex;\n    flex-direction: column;\n    filter: drop-shadow(rgba(0, 0, 0, 0.5) 0px 1px 4px);\n}\n.tx-menu {\n    display: inline-block;\n    padding: 0;\n    margin: 2px 0 2px 0;\n}\n.tx-menu > li {\n    cursor: pointer;\n    display: flex;\n    border: none;\n    border-left: 2px solid var(--tx-gray-50);\n    margin-right: 2px;\n    padding: 0;\n    margin: 0;\n    font-weight: 500;\n    outline: none;\n}\n.tx-menu > li:first-child {\n    border-top-right-radius: 4px;\n    overflow: hidden;\n}\n.tx-menu > li:last-child {\n    border-bottom-right-radius: 4px;\n    overflow: hidden;\n}\n.tx-menu > li > :first-child {\n    padding: 7px 11px 7px 10px;\n}\n.tx-menu > li:hover {\n    background-color: var(--tx-gray-100);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li.tx-hover {\n    filter: brightness(1.2);\n    backdrop-filter: brightness(1.2);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li:focus {\n    border-left-color: var(--tx-outline-color);\n}\n.tx-menu > li[role=separator] {\n    display: block;\n    box-sizing: content-box;\n    overflow: visible;\n    cursor: default;\n    height: 2px;\n    padding: 0px;\n    margin: 1.5px 7px 1.5px 7px;\n    background-color: var(--tx-gray-100);\n    white-space: pre;\n    list-style-type: none;\n}\n.tx-menu > li.tx-disabled {\n    color: var(--tx-gray-500);\n}\n.tx-menu > li.tx-disabled:hover {\n    background-color: var(--tx-gray-50);\n}`);\n//# sourceMappingURL=tx-menu.js.map","import { jsx as _jsx } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { input, button, svg, path, div, li } from \"../util/lsx.js\";\nimport { placePopupVertical } from \"../menu/PopupMenu.js\";\nimport { style as txCombobox } from \"../style/tx-combobox.js\";\nimport { style as txMenu } from \"../style/tx-menu.js\";\nexport class SelectBase extends ModelView {\n    constructor(init) {\n        super(init);\n        this.pointerup = this.pointerup.bind(this);\n        this.pointermove = this.pointermove.bind(this);\n        this.pointerdown = this.pointerdown.bind(this);\n        this.wheel = this.wheel.bind(this);\n        this.keydown = this.keydown.bind(this);\n        let s;\n        const b = button((s = svg(path(\"M3 9.95a.875.875 0 01-.615-1.498L5.88 5 2.385 1.547A.875.875 0 013.615.302L7.74 4.377a.876.876 0 010 1.246L3.615 9.698A.872.872 0 013 9.95z\"))));\n        this.button = b;\n        b.tabIndex = -1;\n        b.style.outline = \"none\";\n        s.style.width = \"100%\";\n        s.style.height = \"100%\";\n        b.onpointerdown = this.pointerdown;\n        b.onpointermove = this.pointermove;\n        b.onpointerup = this.pointerup;\n        this.classList.add(\"tx-combobox\");\n        this.attachShadow({ mode: \"open\" });\n        this.shadowRoot.adoptedStyleSheets = [\n            txCombobox,\n            txMenu,\n        ];\n    }\n    finalize() {\n        this.displayElement.onwheel = this.button.onwheel = this.wheel;\n        this.shadowRoot.replaceChildren(this.displayElement, this.button);\n    }\n    keydown(ev) {\n        ev.preventDefault();\n        if (this.model) {\n            switch (ev.key) {\n                case \"ArrowUp\":\n                    this.model.prev();\n                    break;\n                case \"ArrowDown\":\n                    this.model.next();\n                    break;\n                case \"Enter\":\n                    this.togglePopup();\n                    break;\n                case \"Escape\":\n                    if (this.popup !== undefined) {\n                        this.close();\n                    }\n                    break;\n            }\n        }\n    }\n    wheel(ev) {\n        ev.preventDefault();\n        if (this.model === undefined || !this.model.enabled) {\n            return;\n        }\n        this.displayElement.focus();\n        if (ev.deltaY > 0) {\n            this.model.next();\n        }\n        if (ev.deltaY < 0) {\n            this.model.prev();\n        }\n    }\n    pointerdown(ev) {\n        ev.preventDefault();\n        if (this.model === undefined || !this.model.enabled) {\n            return;\n        }\n        if (this.popup) {\n            this.close();\n            return;\n        }\n        this.displayElement.focus();\n        this.open();\n        this.button.setPointerCapture(ev.pointerId);\n    }\n    pointermove(ev) {\n        if (this.popup === undefined) {\n            return;\n        }\n        let newHover = this.findMenuItem(ev);\n        if (this.hover !== newHover) {\n            if (this.hover) {\n                this.hover.classList.remove(\"tx-hover\");\n            }\n            this.hover = newHover;\n            if (this.hover) {\n                this.hover.classList.add(\"tx-hover\");\n            }\n        }\n    }\n    findMenuItem(ev) {\n        let e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n        while (e) {\n            if (e.nodeName === \"LI\" &&\n                e.parentElement?.classList.contains(\"tx-menu\") &&\n                e.parentElement?.parentElement?.classList.contains(\"tx-popover\")) {\n                break;\n            }\n            e = e?.parentElement;\n        }\n        return (e ? e : undefined);\n    }\n    pointerup(ev) {\n        if (this.hover) {\n            const idx = parseInt(this.hover.dataset[\"idx\"]);\n            this.close();\n            this.select(idx);\n            return;\n        }\n        const e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n        if (this.displayElement.contains(e) || this.button.contains(e)) {\n            return;\n        }\n        this.close();\n    }\n    togglePopup() {\n        if (this.popup) {\n            this.close();\n        }\n        else {\n            this.open();\n        }\n    }\n    open() {\n        this.popup = div();\n        if (this.model) {\n            this.popup.replaceChildren(_jsx(\"ul\", { class: \"tx-menu\", \"aria-roledescription\": \"listbox\", children: this.model.map((value, key, idx) => {\n                    const l = li(this.model.asHtml(key));\n                    l.tabIndex = 0;\n                    l.ariaRoleDescription = \"option\";\n                    l.dataset[\"idx\"] = `${idx}`;\n                    l.onpointerdown = (ev) => {\n                        this.button.setPointerCapture(ev.pointerId);\n                        this.hover = l;\n                        ev.preventDefault();\n                    };\n                    l.onkeydown = this.keydown;\n                    return l;\n                }) }));\n        }\n        this.popup.classList.add(\"tx-popover\");\n        this.popup.style.position = \"fixed\";\n        this.popup.style.zIndex = \"99\";\n        this.shadowRoot.appendChild(this.popup);\n        placePopupVertical(this, this.popup);\n        this.focusToItem();\n    }\n    focusToItem() {\n        if (this.popup && this.model) {\n            const index = this.model.index;\n            if (index !== undefined) {\n                ;\n                this.popup.children[0].children[this.model.index].focus();\n            }\n        }\n    }\n    close() {\n        this.hover = undefined;\n        if (this.popup !== undefined) {\n            this.shadowRoot.removeChild(this.popup);\n            this.popup = undefined;\n            this.displayElement.focus();\n        }\n    }\n    select(index) {\n        if (this.model) {\n            this.model.index = index;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.displayElement.classList.add(\"tx-disabled\");\n            this.displayElement.setAttribute(\"disabled\", \"\");\n            this.button.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.displayElement.classList.remove(\"tx-disabled\");\n            this.displayElement.removeAttribute(\"disabled\");\n            this.button.removeAttribute(\"disabled\");\n        }\n        if (this.model?.error !== undefined) {\n            this.displayElement.classList.add(\"tx-error\");\n        }\n        else {\n            this.displayElement.classList.remove(\"tx-error\");\n        }\n    }\n}\nexport class Select extends SelectBase {\n    constructor(init) {\n        super(init);\n        this.displayElement = div();\n        this.displayElement.tabIndex = 0;\n        this.displayElement.style.minWidth = \"200px\";\n        this.displayElement.onpointerdown = this.pointerdown;\n        this.displayElement.onkeydown = this.keydown;\n        this.finalize();\n    }\n    updateView() {\n        super.updateView();\n        if (this.model !== undefined) {\n            this.displayElement.replaceChildren(this.model.html);\n        }\n        this.focusToItem();\n    }\n}\nexport class ComboBox extends SelectBase {\n    constructor(init) {\n        super(init);\n        this.textModel = init?.text;\n        this.displayElement = input();\n        this.displayElement.type = \"text\";\n        this.displayElement.onkeydown = (ev) => {\n            if (ev.key === \"Enter\" || this.popup !== undefined) {\n                this.keydown(ev);\n            }\n        };\n        this.displayElement.oninput = () => {\n            this.updateModel();\n        };\n        this.finalize();\n    }\n    close() {\n        super.close();\n        if (this.popup === undefined) {\n            this.displayElement.focus();\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            if (typeof this.model.value === \"number\") {\n                this.model.value = Number.parseFloat(this.displayElement.value);\n            }\n            else {\n                this.model.value = this.displayElement.value;\n            }\n        }\n        if (this.textModel) {\n            this.textModel.value = this.displayElement.value;\n        }\n    }\n    updateView() {\n        super.updateView();\n        if (this.model !== undefined) {\n            this.displayElement.value = `${this.model.value}`;\n        }\n        this.focusToItem();\n    }\n}\nSelect.define(\"tx-select\", Select);\nComboBox.define(\"tx-combobox\", ComboBox);\n//# sourceMappingURL=Select.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    :host {\n        position: relative;\n        box-sizing: content-box;\n        display: inline-block;\n    }\n\n    :host(:not([orientation=\"vertical\"])) {\n        height: 4px;\n        width: 100%;\n        padding-top: 8px;\n        padding-bottom: 8px;\n    }\n\n    :host([orientation=\"vertical\"]) {\n        width: 4px;\n        height: 100%;\n        padding-left: 8px;\n        padding-right: 8px;\n    }\n\n    .tx-space {\n        position: absolute;\n        box-sizing: content-box;\n        padding: 0;\n        margin: 0;\n        border: 0;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-space {\n        left: 8px;\n        right: 8px;\n        top: 0;\n        bottom: 0;\n    }\n\n    :host([orientation=\"vertical\"]) .tx-space {\n        left: 0;\n        right: 0;\n        top: 8px;\n        bottom: 8px;\n    }\n\n    .tx-rail {\n        background-color: var(--tx-gray-300);\n        position: absolute;\n        display: block;\n        border-radius: 2px;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-rail {\n        top: 50%;\n        width: 100%;\n        height: 2px;\n        transform: translateY(-50%);\n    }\n\n    :host([orientation=\"vertical\"]) .tx-rail {\n        left: 50%;\n        height: 100%;\n        width: 2px;\n        transform: translateX(-50%);\n    }\n\n    :host([disabled]) .tx-rail {\n        background-color: var(--tx-gray-100);\n    }\n    :host([disabled]) .tx-track {\n        background-color: var(--tx-gray-100);\n    }\n    :host([disabled]) .tx-thumb {\n        border-color: var(--tx-gray-500);\n    }\n    .tx-track {\n        background-color: var(--tx-gray-700);\n        position: absolute;\n        display: block;\n        border-radius: 2px;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-track {  \n        top: 50%;\n        height: 2px;\n        transform: translateY(-50%);\n    }\n\n    :host([orientation=\"vertical\"]) .tx-track {  \n        left: 50%;\n        width: 2px;\n        transform: translateX(-50%);\n    }\n\n    .tx-thumb {\n        border: 2px solid var(--tx-gray-700); /* knob border */\n        border-radius: 50%;\n        background: var(--tx-gray-75); /* inside knob */\n        cursor: pointer;\n        position: absolute;\n        display: flex;\n        width: 14px;\n        height: 14px;\n        box-sizing: border-box;\n        outline-width: 0px;\n        border-radius: 50%;\n        transform: translate(-50%, -50%);\n    }\n    .tx-thumb:hover {\n        border-color: var(--tx-gray-800)\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-thumb { \n        top: 50%;\n    }\n    :host([orientation=\"vertical\"]) .tx-thumb { \n        left: 50%;\n    }\n\n    .tx-focus {\n        outline: 2px solid;\n        outline-color: var(--tx-outline-color);\n        outline-offset: 1px;\n    }\n\n    .tx-thumb>input {\n        border: 0;\n        clip: rect(0, 0, 0, 0);\n        width: 100%;\n        height: 100%;\n        margin: -1px;\n        /* this hides most of the slider and centers the thumb */\n        overflow: hidden;\n        position: absolute;\n        white-space: nowrap;\n        direction: ltr;\n    }\n`);\n//# sourceMappingURL=tx-slider.js.map","export function hsv2rgb(h, s, v) {\n    const f = (n, k = (n + h / 60) % 6) => v - v * s * Math.max(Math.min(k, 4 - k, 1), 0);\n    return { r: f(5), g: f(3), b: f(1) };\n}\nexport function rgb2hsv(r, g, b) {\n    let v = Math.max(r, g, b), c = v - Math.min(r, g, b);\n    let h = c && (v == r ? (g - b) / c : v == g ? 2 + (b - r) / c : 4 + (r - g) / c);\n    return { h: 60 * (h < 0 ? h + 6 : h), s: v && c / v, v };\n}\nexport function rgb2hsl(rgb) {\n    const hsl = _rgb2hsl(rgb.r / 255, rgb.g / 255, rgb.b / 255);\n    return { h: hsl[0], s: hsl[1], l: hsl[2] };\n}\nfunction _hsl2rgb(h, s, l) {\n    let a = s * Math.min(l, 1 - l);\n    let f = (n, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n    return [f(0), f(8), f(4)];\n}\nfunction _rgb2hsl(r, g, b) {\n    let v = Math.max(r, g, b), c = v - Math.min(r, g, b), f = 1 - Math.abs(v + v - c - 1);\n    let h = c && (v == r ? (g - b) / c : v == g ? 2 + (b - r) / c : 4 + (r - g) / c);\n    return [60 * (h < 0 ? h + 6 : h), f ? c / f : 0, (v + v - c) / 2];\n}\nexport function parseColor(color) {\n    let m, r, g, b, a;\n    color = color.trim();\n    m = color.match(/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/);\n    if (m !== null) {\n        r = parseInt(m[1], 16);\n        g = parseInt(m[2], 16);\n        b = parseInt(m[3], 16);\n        r = r * 16 + r;\n        g = g * 16 + g;\n        b = b * 16 + b;\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/);\n    if (m !== null) {\n        r = parseInt(m[1], 16);\n        g = parseInt(m[2], 16);\n        b = parseInt(m[3], 16);\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n    if (m !== null) {\n        r = parseInt(m[1]);\n        g = parseInt(m[2]);\n        b = parseInt(m[3]);\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^rgba\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n    if (m !== null) {\n        r = parseInt(m[1]);\n        g = parseInt(m[2]);\n        b = parseInt(m[3]);\n        a = parseInt(m[4]);\n        return { r, g, b, a };\n    }\n    return undefined;\n}\n//# sourceMappingURL=color.js.map","import { ModelView } from \"./ModelView.js\";\nimport { style as txSlider } from \"../style/tx-slider.js\";\nimport { div, input, span } from \"../util/lsx.js\";\nimport { parseColor } from \"../util/color.js\";\nexport class Slider extends ModelView {\n    constructor(init) {\n        super(init);\n        this.vertical = init ? init.orientation === \"vertical\" : this.getAttribute(\"orientation\") === \"vertical\";\n        let container, rail, track, thumb, slider;\n        container =\n            div(rail = span(), track = span(), thumb = span(slider = input()));\n        container.classList.add(\"tx-space\");\n        rail.classList.add('tx-rail');\n        track.classList.add('tx-track');\n        thumb.classList.add('tx-thumb');\n        slider.type = \"range\";\n        this.input = slider;\n        this.rail = rail;\n        this.track = track;\n        this.thumb = thumb;\n        const minColor = init ? init.minColor : this.getAttribute(\"minColor\");\n        const maxColor = init ? init.maxColor : this.getAttribute(\"maxColor\");\n        if (minColor) {\n            this.minColor = parseColor(minColor);\n        }\n        if (maxColor) {\n            this.maxColor = parseColor(maxColor);\n        }\n        this.setGradient();\n        this.updateView();\n        slider.onfocus = () => {\n            thumb.classList.add(\"tx-focus\");\n        };\n        slider.onblur = () => {\n            thumb.classList.remove(\"tx-focus\");\n        };\n        slider.oninput = () => {\n            if (this.model) {\n                this.model.value = parseFloat(slider.value);\n            }\n        };\n        let skew = undefined;\n        thumb.onpointerdown = (ev) => {\n            if (this.model?.enabled !== true) {\n                return;\n            }\n            thumb.setPointerCapture(ev.pointerId);\n            const value = parseFloat(slider.value);\n            const b = this.getBoundingClientRect();\n            const min = parseFloat(slider.min);\n            const max = parseFloat(slider.max);\n            if (this.vertical) {\n                const v = max - (ev.clientY - b.y) / b.height * (max - min);\n                skew = value - v;\n            }\n            else {\n                const v = (ev.clientX - b.x) / b.width * (max - min) + min;\n                skew = value - v;\n            }\n        };\n        thumb.onpointermove = (ev) => {\n            if (skew === undefined) {\n                return;\n            }\n            ev.preventDefault();\n            const b = this.getBoundingClientRect();\n            const min = parseFloat(slider.min);\n            const max = parseFloat(slider.max);\n            let v;\n            if (this.vertical) {\n                v = max - (ev.clientY - b.y) / b.height * (max - min);\n            }\n            else {\n                v = (ev.clientX - b.x) / b.width * (max - min) + min + skew;\n            }\n            if (v < min) {\n                v = min;\n            }\n            if (v > max) {\n                v = max;\n            }\n            if (this.model) {\n                this.model.value = v;\n            }\n        };\n        thumb.onpointerup = (ev) => {\n            if (skew === undefined) {\n                return;\n            }\n            thumb.onpointermove(ev);\n            skew = undefined;\n        };\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txSlider];\n        this.shadowRoot.replaceChildren(container);\n    }\n    setGradient() {\n        if (this.minColor && this.maxColor) {\n            if (this.model?.enabled === true) {\n                const rot = this.vertical ? \"0deg\" : \"90deg\";\n                const a = this.minColor;\n                const b = this.maxColor;\n                this.rail.style.backgroundImage = `linear-gradient(${rot}, rgb(${a.r},${a.g},${a.b}), rgb(${b.r},${b.g},${b.b}))`;\n            }\n            else {\n                this.rail.style.backgroundImage = \"\";\n            }\n            this.track.style.display = \"none\";\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = Number.parseFloat(this.input.value);\n        }\n    }\n    updateView() {\n        this.setGradient();\n        if (!this.model) {\n            this.setAttribute(\"disabled\", \"disabled\");\n            return;\n        }\n        if (this.model.enabled) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n        if (this.model.step === undefined && this.model.min !== undefined && this.model.max !== undefined) {\n            this.input.step = `${(this.model.max - this.model.min) / 100}`;\n        }\n        else {\n            this.input.step = String(this.model.step);\n        }\n        this.input.min = String(this.model.min);\n        this.input.max = String(this.model.max);\n        this.input.value = String(this.model.value);\n        const min = this.model.min;\n        const max = this.model.max;\n        const value = this.model.value;\n        let v = (value - min) / (max - min);\n        if (this.minColor && this.maxColor) {\n            if (this.model?.enabled !== true) {\n                this.thumb.style.backgroundColor = \"\";\n            }\n            else {\n                const f = `rgb(${(this.maxColor.r - this.minColor.r) * v + this.minColor.r},${(this.maxColor.g - this.minColor.g) * v + this.minColor.g},${(this.maxColor.b - this.minColor.b) * v + this.minColor.b})`;\n                this.thumb.style.backgroundColor = f;\n            }\n        }\n        v *= 100;\n        if (this.vertical) {\n            this.track.style.top = `${100 - v}%`;\n            this.track.style.height = `${v}%`;\n            this.thumb.style.top = `${100 - v}%`;\n        }\n        else {\n            this.track.style.left = `0%`;\n            this.track.style.width = `${v}%`;\n            this.thumb.style.left = `${v}%`;\n        }\n    }\n}\nSlider.define(\"tx-slider\", Slider);\n//# sourceMappingURL=Slider.js.map","import { View } from \"./View.js\";\nexport class GenericTool extends View {\n    static focusIn(view) {\n        const viewParents = new Map();\n        for (let parent = view.parentElement, distance = 0; parent !== null; parent = parent.parentElement, ++distance) {\n            viewParents.set(parent, distance);\n        }\n        let closestToolDistance = Number.MAX_SAFE_INTEGER;\n        let closestParent;\n        let closestToolList = new Array();\n        for (const tool of this.allTools.values()) {\n            if (!tool.canHandle(view))\n                continue;\n            for (let toolParent = tool.parentElement, depth = 0; toolParent !== null; toolParent = toolParent.parentElement, ++depth) {\n                const toolDistance = viewParents.get(toolParent);\n                if (toolDistance === undefined)\n                    continue;\n                if (closestToolDistance < toolDistance)\n                    continue;\n                if (closestToolDistance > toolDistance) {\n                    closestToolList.length = 0;\n                }\n                closestToolDistance = toolDistance;\n                closestParent = toolParent;\n                closestToolList.push(tool);\n            }\n        }\n        if (!closestParent) {\n            return;\n        }\n        let closestTool;\n        const viewIndex = GenericTool.getIndex(view, closestParent);\n        let closestNextSiblingIndex = Number.MIN_SAFE_INTEGER;\n        for (let tool of closestToolList) {\n            const toolIndex = GenericTool.getIndex(tool, closestParent);\n            if (toolIndex < viewIndex && toolIndex > closestNextSiblingIndex) {\n                closestNextSiblingIndex = toolIndex;\n                closestTool = tool;\n            }\n        }\n        this.setActive(closestTool, view);\n    }\n    static getIndex(view, parent) {\n        if (parent === undefined) {\n            console.trace(`GenericTool.getIndex(${view}, ${parent})`);\n        }\n        let element = view;\n        while (element.parentElement !== parent)\n            element = element.parentElement;\n        return Array.from(parent.childNodes).indexOf(element);\n    }\n    static setActive(tool, view) {\n        if (this.activeTool)\n            this.activeTool.deactivate();\n        this.activeTool = tool;\n        this.activeView = view;\n        if (tool)\n            tool.activate();\n    }\n    static focusOut(view) {\n        if (this.activeView === view) {\n            this.setActive(undefined, undefined);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        GenericTool.allTools.add(this);\n    }\n    disconnectedCallback() {\n        if (GenericTool.activeTool === this) {\n            GenericTool.setActive(undefined, undefined);\n        }\n        GenericTool.allTools.delete(this);\n        super.disconnectedCallback();\n    }\n}\nGenericTool.allTools = new Set();\nwindow.addEventListener(\"focusin\", (event) => {\n    if (event.target instanceof GenericTool)\n        return;\n    if (event.relatedTarget instanceof View) {\n        GenericTool.focusOut(event.relatedTarget);\n    }\n    if (event.target instanceof View) {\n        GenericTool.focusIn(event.target);\n    }\n});\n//# sourceMappingURL=GenericTool.js.map","import { ModelView } from \"./ModelView.js\";\nimport { css } from \"../util/lsx.js\";\nexport const toolbuttonStyle = new CSSStyleSheet();\ntoolbuttonStyle.replaceSync(css `\n:host {\n    display: inline-block;\n    overflow: hidden;\n    box-sizing: border-box;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 3px;\n    background: var(--tx-gray-400);\n    color: var(--tx-gray-900);\n    width: 24px;\n    height: 22px;\n    margin: 0;\n    padding: 0;\n}\n\n:host([selected]) {\n    background-color: var(--tx-gray-100);\n    border: 1px solid var(--tx-gray-100);\n}\n\n:host([disabled]) {\n    opacity: 0.5;\n}\n\n:host([disabled]) img {\n    opacity: 0.5;\n}\n`);\nexport class ToolButton extends ModelView {\n    constructor(init) {\n        super(init);\n        if (!init) {\n            init = {\n                value: this.getAttribute(\"value\"),\n            };\n        }\n        else {\n            this.setAttribute(\"value\", `${init.value}`);\n        }\n        this.value = init?.value;\n        this.onpointerdown = (event) => {\n            if (this.hasAttribute(\"disabled\")) {\n                return;\n            }\n            this.focus();\n            event.preventDefault();\n            if (this.model !== undefined) {\n                this.model.value = this.value;\n            }\n        };\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [toolbuttonStyle];\n        this.shadowRoot.appendChild(document.createElement(\"slot\"));\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n        }\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n            this.removeAttribute(\"selected\");\n            return;\n        }\n        if (this.model.enabled && this.model.isEnabledOf(this.value)) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"\");\n        }\n        if (this.model.value === this.value) {\n            this.setAttribute(\"selected\", \"\");\n        }\n        else {\n            this.removeAttribute(\"selected\");\n        }\n    }\n}\nToolButton.define(\"tx-toolbutton\", ToolButton);\n//# sourceMappingURL=ToolButton.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class SlotView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        let value = this.model.value === undefined ? \"\" : this.model.value;\n        if (this.model instanceof HtmlModel)\n            this.innerHTML = value;\n        else\n            this.innerText = value;\n    }\n}\nSlotView.define(\"tx-slot\", SlotView);\n//# sourceMappingURL=SlotView.js.map","import { ModelView } from \"./ModelView.js\";\nexport class ToadIf extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (this.model) {\n            this.style.display = this.model.value ? \"\" : \"none\";\n        }\n    }\n}\nToadIf.define(\"tx-if\", ToadIf);\n//# sourceMappingURL=ToadIf.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    /*\n     * tabs, line, content\n     */\n    :host {\n        /* position: relative; */\n        display: grid;\n        /* flex-wrap: nowrap; */\n        /* box-sizing: border-box; */\n        margin: 0;\n        padding: 0;\n    }\n    :host(:not(.tx-vertical)) {\n        /* flex-direction: column; */\n        /* display: grid; */\n        /* height: */\n        grid-template-rows: 0 max-content auto;\n        grid-template-columns: 1;\n        /* https://stackoverflow.com/questions/43311943/prevent-content-from-expanding-grid-items */\n        /* https://www.w3.org/TR/css3-grid-layout/#min-size-auto */\n        min-width: 0;\n    }\n    :host(.tx-vertical) {\n        grid-template-rows: 1;\n        grid-template-columns: 0 max-content auto;\n        min-height: 0;\n    }\n\n    /*\n     * tabs\n     */\n    :host > ul {\n        display: flex;\n        flex-wrap: nowrap;\n        list-style: none;\n        box-sizing: border-box;\n        padding: 0;\n        margin: 0;\n    }\n    :host(:not(.tx-vertical)) > ul {\n        flex-direction: row;\n        border-bottom: 2px solid var(--tx-gray-200);\n    }\n    :host(.tx-vertical) > ul {\n        flex-direction: column;\n         border-left: 2px solid var(--tx-gray-200);\n    }\n    :host > ul > li {\n        box-sizing: border-box;\n        list-style: none;\n    }\n\n    /*\n     * label\n     */\n    :host > ul > li > span {\n        display: block;\n        list-style: none;\n        font-weight: 500;\n        margin: 8px 12px 8px 12px;\n        color: var(--tx-gray-700);\n        cursor: pointer;\n    }\n    :host(.tx-vertical) > ul > li > span {\n        margin: 0;\n        padding: 12px 8px 12px 8px;\n    }\n    :host > ul > li > span.active {\n        color: var(--tx-gray-900);\n    }\n    :host > ul > li > span:hover {\n        color: var(--tx-gray-900);\n    }\n\n    /*\n     * line\n     */\n    .line-container {\n        position: relative;\n        overflow: none;\n    }\n    :host > .line-container > .line {\n        position: absolute;\n        background-color: var(--tx-gray-900);\n        pointer-events: none;\n    }\n    :host(:not(.tx-vertical)) > .line-container > .line {\n        transition: left 0.5s ease-in-out, width 0.5s 0.1s;\n        /* position: relative; below labels */\n        top: 0px;\n        height: 2px;\n        left: 12px;\n        width: 0px;\n    }\n    :host(.tx-vertical) > .line-container > .line {\n        transition: top 0.5s ease-in-out, width 0.5s 0.1s;\n        /* position: absolute; */\n        left: 0; /* before labels */\n        height: 0px;\n        width: 2px;\n    }\n\n    /*\n     * content\n     */\n    .content {\n        overflow: auto;\n    }\n`);\n//# sourceMappingURL=tx-tabs.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    ::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n    }\n    ::-webkit-scrollbar-thumb {\n        border-radius: 5px;\n    }\n    ::-webkit-scrollbar-track {\n        background: #1e1e1e;\n    }\n    ::-webkit-scrollbar-corner {\n        background: #1e1e1e;\n    }\n    ::-webkit-scrollbar-thumb {\n        background: var(--tx-gray-500);\n    }\n`);\n//# sourceMappingURL=tx-scrollbar.js.map","import { View } from \"../view/View.js\";\nimport { ul, li, span, text, div, slot } from \"../util/lsx.js\";\nimport { style as txTabs } from \"../style/tx-tabs.js\";\nimport { style as txScrollbar } from \"../style/tx-scrollbar.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class Tabs extends ModelView {\n    constructor(init) {\n        super(init);\n        this.labelMap = new Map();\n        this.activateTab = this.activateTab.bind(this);\n        this.classList.add(\"tx-tabs\");\n        this.vertical = this.hasAttribute(\"vertical\") || init?.orientation === \"vertical\";\n        if (this.vertical) {\n            this.classList.add(\"tx-vertical\");\n        }\n        let lineContainer, tabContainer;\n        const children = [\n            lineContainer = span(this.markerLine = div()),\n            tabContainer = ul(),\n            this.content = div(slot())\n        ];\n        lineContainer.classList.add(\"line-container\");\n        this.markerLine.classList.add(\"line\");\n        this.content.classList.add(\"content\");\n        let activeLabel = this.activeLabel, activePanel = this.activePanel;\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (!(child instanceof Tab)) {\n                console.log(`unexpected <${child.nodeName.toLowerCase()}> within <Tabs>`);\n                continue;\n            }\n            const panel = child;\n            if (typeof panel.value !== typeof this.model?.value) {\n                console.log(`Type error: Tab<${typeof panel.value}>({label=\"${panel.label}\", value=${panel.value}}) differs from Tabs<${typeof this.model?.value}>({model.value=${this.model?.value}})`);\n            }\n            let tabLabel;\n            tabContainer.appendChild(li((tabLabel = span(text(panel.getAttribute(\"label\"))))));\n            tabLabel.onpointerdown = (ev) => {\n                ev.stopPropagation();\n                ev.preventDefault();\n                this.activateTab(tabLabel, panel);\n            };\n            this.labelMap.set(panel, tabLabel);\n            if (activeLabel === undefined && (this.model === undefined || this.model.value === panel.value)) {\n                activeLabel = tabLabel;\n                activePanel = panel;\n            }\n            else {\n                panel.style.display = \"none\";\n            }\n        }\n        this.attachShadow({ mode: \"open\" });\n        this.shadowRoot.adoptedStyleSheets = [txTabs, txScrollbar];\n        this.shadowRoot.replaceChildren(...children);\n        if (activeLabel !== undefined) {\n            this.activateTab(activeLabel, activePanel);\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (!(child instanceof Tab)) {\n                console.log(`unexpected <${child.nodeName.toLowerCase()}> within <Tabs>`);\n                continue;\n            }\n            const tab = child;\n            if (this.model.value === tab.value) {\n                this.activateTab(this.labelMap.get(tab), tab);\n                break;\n            }\n        }\n    }\n    activateTab(tabLabel, panel) {\n        if (this.activePanel === panel) {\n            return;\n        }\n        if (this.activeLabel !== undefined && this.activePanel !== undefined) {\n            this.activeLabel.classList.remove(\"active\");\n            this.activePanel.style.display = \"none\";\n            this.activePanel.close();\n        }\n        this.activeLabel = tabLabel;\n        this.activePanel = panel;\n        this.activePanel.open();\n        this.activeLabel.classList.add(\"active\");\n        this.activePanel.style.display = \"\";\n        setTimeout(() => this.adjustLine(), 0);\n        if (this.model && panel.value !== undefined) {\n            this.model.value = panel.value;\n        }\n    }\n    adjustLine() {\n        const line = this.markerLine;\n        const label = this.activeLabel;\n        if (label !== undefined) {\n            if (this.vertical) {\n                line.style.top = `${label.offsetTop - this.offsetTop}px`;\n                line.style.height = `${label.clientHeight}px`;\n            }\n            else {\n                line.style.top = `-2px`;\n                line.style.left = `${label.offsetLeft - this.offsetLeft}px`;\n                line.style.width = `${label.clientWidth}px`;\n            }\n        }\n    }\n}\nTabs.define(\"tx-tabs\", Tabs);\nexport class Tab extends View {\n    constructor(init) {\n        super(init);\n        this.value = init?.value;\n        this.label = init?.label;\n        this.content = init?.content;\n    }\n    open() {\n        if (this.childNodes.length === 0 && this.content !== undefined) {\n            const content = this.content();\n            if (content instanceof Promise) {\n                content.then((module) => {\n                    if (typeof module === \"object\" && \"default\" in module) {\n                        const viewOrViewFunction = module.default;\n                        if (typeof viewOrViewFunction === \"function\") {\n                            const viewOrPromise = viewOrViewFunction();\n                            if (viewOrPromise instanceof Promise) {\n                                viewOrPromise.then((s) => {\n                                    appendChildren(this, s);\n                                });\n                            }\n                            else {\n                                appendChildren(this, viewOrPromise);\n                            }\n                        }\n                        else {\n                            appendChildren(this, viewOrViewFunction);\n                        }\n                    }\n                });\n            }\n            else {\n                appendChildren(this, this.content());\n            }\n        }\n    }\n    close() { }\n}\nView.define(\"tx-tab\", Tab);\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n//# sourceMappingURL=Tab.js.map","import { css } from \"../util/lsx.js\";\nexport const menuStyle = new CSSStyleSheet();\nmenuStyle.replaceSync(css `\n  :host(.menu-button) {\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-edit-font-size);\n    font-weight: var(--tx-edit-font-weight);\n    padding: 7px;\n    vertical-align: center;\n  \n    background: var(--tx-gray-200);\n    color: var(--tx-gray-900);\n    cursor: default;\n  }\n  :host(.menu-button:hover) {\n    background: var(--tx-gray-300);\n  }\n  :host(.menu-button.active) {\n    background: var(--tx-gray-400);\n    color: var(--tx-gray-900);\n  }\n  :host(.menu-button.disabled) {\n    color: var(--tx-gray-500);\n  }\n  :host(.menu-button.active.disabled) {\n    color: var(--tx-gray-700);\n  }\n  :host(.menu-button.menu-down) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-down) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.menu-side) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-side) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  .menu-bar {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n    background-color: var(--tx-gray-200);\n  }\n  .menu-popup {\n    position: fixed;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 2px 2px 5px var(--tx-gray-50);\n  }\n`);\n//# sourceMappingURL=menuStyle.js.map","import { Action } from \"../model/Action.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nimport { MenuState } from \"./MenuState.js\";\nimport { PopupMenu } from \"./PopupMenu.js\";\nexport class MenuButton extends ModelView {\n    constructor(master, node) {\n        super();\n        this.master = master;\n        this.node = node;\n        let menuButton = this;\n        this.classList.add(\"menu-button\");\n        if (node.down) {\n            if (master.vertical)\n                this.classList.add(\"menu-side\");\n            else\n                this.classList.add(\"menu-down\");\n        }\n        this.updateView();\n        this.onmousedown = (event) => {\n            event.stopPropagation();\n            let documentMouseUp = function (event) {\n                document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n                event.preventDefault();\n                setTimeout(() => {\n                    if (MenuButton.buttonDown)\n                        menuButton.dispatchEvent(new MouseEvent(\"mouseup\", event));\n                }, 0);\n            };\n            document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n            MenuButton.buttonDown = true;\n            if (!this.master)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                    this.master.state = MenuState.DOWN;\n                    this.activate();\n                    break;\n                case MenuState.UP_N_HOLD:\n                    if (this.master.active !== this) {\n                        this.master.state = MenuState.DOWN;\n                        this.activate();\n                    }\n                    else {\n                        this.master.state = MenuState.DOWN_N_HOLD;\n                    }\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseup = (event) => {\n            event.stopPropagation();\n            if (!MenuButton.buttonDown)\n                return;\n            MenuButton.buttonDown = false;\n            if (!this.master)\n                throw Error(\"yikes\");\n            if (!this.node)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                    if (this.node.isEnabled() && !this.node.down) {\n                        this.trigger();\n                        this.master.state = MenuState.WAIT;\n                    }\n                    else {\n                        this.master.state = MenuState.UP_N_HOLD;\n                        if (MenuButton.documentMouseDown) {\n                            document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                        }\n                        MenuButton.documentMouseDown = function (event) {\n                            if (MenuButton.documentMouseDown)\n                                document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, {\n                                    capture: false,\n                                });\n                            MenuButton.documentMouseDown = undefined;\n                            let tagName = event.target.tagName;\n                            if (tagName !== \"TOAD-MENUBUTTON\") {\n                                menuButton.collapse();\n                            }\n                        };\n                        document.addEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                    }\n                    break;\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                    this.master.state = MenuState.WAIT;\n                    this.deactivate();\n                    this.collapse();\n                    if (this.master.closeOnClose) {\n                    }\n                    break;\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.trigger();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseout = (event) => {\n            event.stopPropagation();\n            if (!this.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = undefined;\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                    break;\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.master.state = MenuState.DOWN_N_OUTSIDE;\n                    this.updateView();\n                    break;\n                default:\n                    throw Error(\"unexpected state\");\n            }\n            return false;\n        };\n        this.onmouseover = (event) => {\n            event.stopPropagation();\n            if (!menuButton.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = menuButton;\n            switch (menuButton.master.state) {\n                case MenuState.WAIT:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    if (!MenuButton.buttonDown)\n                        break;\n                    if (!this.master)\n                        throw Error(\"yikes\");\n                    if (this.master.active)\n                        this.master.active.deactivate();\n                    this.master.state = MenuState.DOWN_N_INSIDE_AGAIN;\n                    this.activate();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + menuButton.master.state);\n            }\n            return false;\n        };\n        this.attachShadow({ mode: \"open\" });\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        this.shadowRoot.adoptedStyleSheets = [menuStyle];\n        if (!this.node.modelId) {\n            this.shadowRoot.appendChild(document.createTextNode(node.label));\n        }\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        if (this.node.down === undefined) {\n            let actionId = this.node.title;\n            for (let node = this.node.parent; node; node = node.parent) {\n                if (!node.title.length)\n                    break;\n                actionId = node.title + \"|\" + actionId;\n            }\n            actionId = \"A:\" + actionId;\n            globalController.registerView(actionId, this);\n        }\n        if (this.node.modelId !== undefined) {\n            if (typeof this.node.modelId === \"string\") {\n                let modelId = \"M:\" + this.node.modelId;\n                globalController.registerView(modelId, this);\n            }\n            else {\n                this.setModel(this.node.modelId);\n            }\n        }\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n        }\n        else {\n            if (typeof model === \"object\") {\n                throw Error(`unexpected model of type ${model.constructor.name}`);\n            }\n            else {\n                throw Error(`unexpected model of type ${typeof model}`);\n            }\n        }\n        this.updateView();\n    }\n    updateView() {\n        if (this.model && this.model.value) {\n            if (!this.shadowRoot)\n                throw Error(\"yikes\");\n            let span = document.createElement(\"span\");\n            if (this.model instanceof HtmlModel)\n                span.innerHTML = this.model.value;\n            else\n                span.innerText = this.model.value;\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.removeChild(this.shadowRoot.children[1]);\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.insertBefore(span, this.shadowRoot.children[1]);\n            else\n                this.shadowRoot.appendChild(span);\n        }\n        if (!this.master)\n            throw Error(\"yikes\");\n        let active = false;\n        if (this.master.active == this) {\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    active = true;\n                    break;\n                case MenuState.DOWN_N_OUTSIDE:\n                    if (!this.node)\n                        throw Error(\"yikes\");\n                    active = this.node.down !== undefined && this.node.isEnabled();\n                    break;\n            }\n        }\n        this.classList.toggle(\"active\", active);\n        this.classList.toggle(\"disabled\", !this.isEnabled());\n    }\n    isEnabled() {\n        if (this.node.down !== undefined)\n            return true;\n        return this.action !== undefined && this.action.enabled;\n    }\n    trigger() {\n        this.collapse();\n        if (!this.action)\n            return;\n        this.action.trigger();\n    }\n    collapse() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.parentButton)\n            this.master.parentButton.collapse();\n        else\n            this.deactivate();\n    }\n    openPopup() {\n        if (!this.node)\n            return;\n        if (!this.node.down)\n            return;\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        if (!this.popup) {\n            this.popup = new PopupMenu(this.node, this);\n            this.shadowRoot.appendChild(this.popup);\n        }\n        else {\n            this.popup.show();\n        }\n    }\n    closePopup() {\n        if (!this.popup)\n            return;\n        if (this.popup.active)\n            this.popup.active.deactivate();\n        this.popup.hide();\n    }\n    activate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (!this.node)\n            throw Error(\"yikes\");\n        let oldActive = this.master.active;\n        this.master.active = this;\n        if (oldActive && oldActive !== this) {\n            oldActive.closePopup();\n            oldActive.updateView();\n        }\n        this.updateView();\n        this.openPopup();\n    }\n    deactivate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.active !== this)\n            return;\n        this.master.active.closePopup();\n        this.master.active = undefined;\n        this.master.state = MenuState.WAIT;\n        this.updateView();\n    }\n}\nMenuButton.define(\"tx-menubutton\", MenuButton);\n//# sourceMappingURL=MenuButton.js.map","import { MenuButton } from \"./MenuButton.js\";\nexport class MenuNode {\n    constructor(title, label, shortcut, type, modelId) {\n        this.title = title;\n        this.label = label;\n        this.shortcut = shortcut;\n        this.type = type ? type : \"entry\";\n        this.modelId = modelId;\n    }\n    isEnabled() {\n        return true;\n    }\n    isAvailable() {\n        return true;\n    }\n    createWindowAt(parent, parentView) {\n        if (this.type == \"spacer\") {\n            let span = document.createElement(\"span\");\n            span.style.flexGrow = \"1\";\n            parentView.appendChild(span);\n            return;\n        }\n        this.view = new MenuButton(parent, this);\n        parentView.appendChild(this.view);\n    }\n    deleteWindow() {\n    }\n}\n//# sourceMappingURL=MenuNode.js.map","import * as dom from \"../util/dom.js\";\nimport { MenuNode } from \"./MenuNode.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nexport class Menu extends MenuButtonContainer {\n    constructor(props) {\n        super(props);\n        this.config = props?.config;\n        this.vertical = false;\n        this.root = new MenuNode(\"\", \"\", undefined, undefined);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.tabIndex = 0;\n        if (this.config) {\n            this.config2nodes(this.config, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n            return;\n        }\n        if (this.children.length === 0) {\n            this._observer = new MutationObserver((record, observer) => {\n                if (this._timer !== undefined)\n                    clearTimeout(this._timer);\n                this._timer = window.setTimeout(() => {\n                    this._timer = undefined;\n                    this.layout2nodes(this.children, this.root);\n                    this.referenceActions();\n                    this.createShadowDOM();\n                }, 100);\n            });\n            this._observer.observe(this, {\n                childList: true,\n                subtree: true\n            });\n        }\n        else {\n            this.layout2nodes(this.children, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n        }\n    }\n    layout2nodes(children, parent) {\n        let node = parent.down;\n        for (let child of children) {\n            let newnode = undefined;\n            switch (child.nodeName) {\n                case \"TX-MENUSPACER\":\n                    newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n                    break;\n                case \"TX-MENUENTRY\":\n                    newnode = new MenuNode(dom.attribute(child, \"name\"), dom.attribute(child, \"label\"), dom.attributeOrUndefined(child, \"shortcut\"), dom.attributeOrUndefined(child, \"type\"), dom.attributeOrUndefined(child, \"model\"));\n                    break;\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            this.layout2nodes(child.children, node);\n        }\n    }\n    config2nodes(config, parent) {\n        let node = parent.down;\n        for (let child of config) {\n            let newnode = undefined;\n            if (child.space === true) {\n                newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n            }\n            else {\n                newnode = new MenuNode(child.name, child.label, child.shortcut, child.type, child.model);\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            if (child.sub)\n                this.config2nodes(child.sub, node);\n        }\n    }\n    referenceActions() {\n    }\n    findNode(str, parent) {\n        let strpos = str.indexOf(\"|\");\n        let left = strpos == -1 ? str : str.substr(0, strpos);\n        let right = strpos == -1 ? \"\" : str.substr(strpos + 1);\n        if (!parent)\n            parent = this.root;\n        for (let n = parent.down; n; n = n.next) {\n            if (n.title == left) {\n                if (!n.down) {\n                    return n;\n                }\n                return this.findNode(right, n);\n            }\n        }\n        return undefined;\n    }\n    createShadowDOM() {\n        this.view = document.createElement(\"div\");\n        this.view.classList.add(\"menu-bar\");\n        let node = this.root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.view);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [menuStyle];\n        this.shadowRoot.appendChild(this.view);\n    }\n}\nMenu.define(\"tx-menu\", Menu);\n//# sourceMappingURL=Menu.js.map","import { View } from \"../view/View.js\";\nexport class MenuSpacer extends HTMLElement {\n}\nView.define(\"tx-menuspacer\", MenuSpacer);\n//# sourceMappingURL=MenuSpacer.js.map","import { Model } from \"../../model/Model.js\";\nexport class TableModel extends Model {\n    isEmpty() { return this.colCount === 0 && this.rowCount === 0; }\n}\n//# sourceMappingURL=TableModel.js.map","export var TableEditMode;\n(function (TableEditMode) {\n    TableEditMode[TableEditMode[\"EDIT_CELL\"] = 0] = \"EDIT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_CELL\"] = 1] = \"SELECT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_ROW\"] = 2] = \"SELECT_ROW\";\n})(TableEditMode || (TableEditMode = {}));\n//# sourceMappingURL=TableEditMode.js.map","import { TypedTableModel } from \"../model/TypedTableModel.js\";\nexport var EditMode;\n(function (EditMode) {\n    EditMode[EditMode[\"EDIT_ON_FOCUS\"] = 0] = \"EDIT_ON_FOCUS\";\n    EditMode[EditMode[\"EDIT_ON_ENTER\"] = 1] = \"EDIT_ON_ENTER\";\n})(EditMode || (EditMode = {}));\nexport class TableAdapterConfig {\n    constructor() {\n        this.editMode = EditMode.EDIT_ON_FOCUS;\n        this.seamless = false;\n        this.expandColumn = false;\n        this.expandRow = false;\n    }\n}\nexport class TableAdapter {\n    constructor(model) {\n        this.config = new TableAdapterConfig();\n        this.model = model;\n    }\n    get colCount() { return this.model === undefined ? 0 : this.model.colCount; }\n    get rowCount() { return this.model === undefined ? 0 : this.model.rowCount; }\n    getColumnHead(col) { return undefined; }\n    getRowHead(row) { return undefined; }\n    showCell(pos, cell) { }\n    saveCell(pos, cell) { }\n    editCell(pos, cell) { }\n    isViewCompact() { return false; }\n    static register(adapter, model, data) {\n        let typeToModel = TableAdapter.modelToAdapter.get(model);\n        if (typeToModel === undefined) {\n            typeToModel = new Map();\n            TableAdapter.modelToAdapter.set(model, typeToModel);\n        }\n        if (data !== undefined) {\n            if (typeToModel.has(data)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(data, adapter);\n        }\n        else {\n            if (typeToModel.has(null)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(null, adapter);\n        }\n    }\n    static unbind() {\n        TableAdapter.modelToAdapter.clear();\n    }\n    static lookup(model) {\n        let dataType;\n        if (model instanceof TypedTableModel) {\n            dataType = model.nodeClass;\n        }\n        else {\n            dataType = null;\n        }\n        const typeToAdapter = TableAdapter.modelToAdapter.get(Object.getPrototypeOf(model).constructor);\n        let adapter = typeToAdapter?.get(dataType);\n        if (adapter === undefined) {\n            for (let baseClass of TableAdapter.modelToAdapter.keys()) {\n                if (model instanceof baseClass) {\n                    adapter = TableAdapter.modelToAdapter.get(baseClass)?.get(dataType);\n                    break;\n                }\n            }\n        }\n        if (adapter === undefined) {\n            let msg = `TableAdapter.lookup(): Did not find an adapter for model of type ${model.constructor.name}`;\n            msg += `\\n    Requested adapter: model=${model.constructor.name}, type=${dataType?.name}\\n    Available adapters:`;\n            if (TableAdapter.modelToAdapter.size === 0) {\n                msg += \" none.\";\n            }\n            else {\n                for (const [modelX, typeToAdapterX] of TableAdapter.modelToAdapter) {\n                    for (const [typeX, adapterX] of typeToAdapterX) {\n                        msg += `\\n        model=${modelX.name}`;\n                        if (typeX !== undefined && typeX !== null) {\n                            msg += `, type=${typeX.name}`;\n                        }\n                    }\n                }\n            }\n            throw Error(msg);\n        }\n        return adapter;\n    }\n}\nTableAdapter.modelToAdapter = new Map();\n//# sourceMappingURL=TableAdapter.js.map","export var TableEventType;\n(function (TableEventType) {\n    TableEventType[TableEventType[\"INSERT_ROW\"] = 0] = \"INSERT_ROW\";\n    TableEventType[TableEventType[\"REMOVE_ROW\"] = 1] = \"REMOVE_ROW\";\n    TableEventType[TableEventType[\"INSERT_COL\"] = 2] = \"INSERT_COL\";\n    TableEventType[TableEventType[\"REMOVE_COL\"] = 3] = \"REMOVE_COL\";\n    TableEventType[TableEventType[\"CELL_CHANGED\"] = 4] = \"CELL_CHANGED\";\n    TableEventType[TableEventType[\"RESIZE_ROW\"] = 5] = \"RESIZE_ROW\";\n    TableEventType[TableEventType[\"RESIZE_COL\"] = 6] = \"RESIZE_COL\";\n    TableEventType[TableEventType[\"CHANGED\"] = 7] = \"CHANGED\";\n})(TableEventType || (TableEventType = {}));\n//# sourceMappingURL=TableEventType.js.map","export class TablePos {\n    constructor(col, row) {\n        this.col = col;\n        this.row = row;\n    }\n    toString() {\n        return `TablePos { col:${this.col}, row:${this.row} }`;\n    }\n}\n//# sourceMappingURL=TablePos.js.map","import { Model } from \"../../model/Model.js\";\nimport { TableEditMode } from \"../TableEditMode.js\";\nimport { TablePos } from \"../TablePos.js\";\nexport class SelectionModel extends Model {\n    constructor(mode = TableEditMode.EDIT_CELL) {\n        super();\n        this.mode = mode;\n        this._value = new TablePos(0, 0);\n    }\n    set col(col) {\n        if (this._value.col === col)\n            return;\n        this._value.col = col;\n        this.modified.trigger();\n    }\n    get col() {\n        return this._value.col;\n    }\n    set row(row) {\n        if (this._value.row === row)\n            return;\n        this._value.row = row;\n        this.modified.trigger();\n    }\n    get row() {\n        return this._value.row;\n    }\n    set value(value) {\n        if (this._value.col === value.col && this._value.row === value.row)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n    toString() {\n        return `SelectionModel {enabled: ${this.enabled}, mode: ${TableEditMode[this.mode]}, value: ${this._value}}`;\n    }\n}\n//# sourceMappingURL=SelectionModel.js.map","import { TableModel } from \"./TableModel.js\";\nexport class TypedTableModel extends TableModel {\n    constructor(nodeClass, root) {\n        super();\n        this.nodeClass = nodeClass;\n    }\n}\n//# sourceMappingURL=TypedTableModel.js.map","import { TableEventType } from \"./TableEventType.js\";\nexport class TableEvent {\n    constructor(type, index, size) {\n        this.type = type;\n        this.index = index;\n        this.size = size;\n    }\n    get col() {\n        return this.index;\n    }\n    get row() {\n        return this.size;\n    }\n    toString() {\n        return `TableEvent {type: ${TableEventType[this.type]}, index: ${this.index}, size: ${this.size}}`;\n    }\n}\n//# sourceMappingURL=TableEvent.js.map","export class TableFriend {\n    constructor(table) {\n        this.table = table;\n    }\n    get logger() {\n        return this.table.logger;\n    }\n    get adapter() {\n        return this.table.adapter;\n    }\n    get root() {\n        return this.table.root;\n    }\n    get measure() {\n        return this.table.measure;\n    }\n    focus() {\n        this.table.focus();\n    }\n    getStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.bodyStaging;\n    }\n    getHeadStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.headStaging;\n    }\n    get body() {\n        return this.table.body;\n    }\n    get splitBody() {\n        return this.table.splitBody;\n    }\n    get colHeads() {\n        return this.table.colHeads;\n    }\n    set colHeads(div) {\n        this.table.colHeads = div;\n    }\n    get rowHeads() {\n        return this.table.rowHeads;\n    }\n    set rowHeads(div) {\n        this.table.rowHeads = div;\n    }\n    get colResizeHandles() {\n        return this.table.colResizeHandles;\n    }\n    set colResizeHandles(div) {\n        this.table.colResizeHandles = div;\n    }\n    get rowResizeHandles() {\n        return this.table.rowResizeHandles;\n    }\n    set rowResizeHandles(div) {\n        this.table.rowResizeHandles = div;\n    }\n    set animationDone(animationDone) {\n        this.table.animationDone = animationDone;\n    }\n    get selection() {\n        return this.table.selection;\n    }\n    get style() {\n        return this.table.style;\n    }\n    setCellSize(span, x, y, w, h) {\n        this.table.setCellSize(span, x, y, w, h);\n    }\n    clearAnimation() {\n        this.table.animation = undefined;\n    }\n}\n//# sourceMappingURL=TableFriend.js.map","import { Table } from \"../Table.js\";\nimport { TableFriend } from \"./TableFriend.js\";\nimport { div, span } from \"../../util/lsx.js\";\nexport class TableAnimation extends TableFriend {\n    constructor(table) {\n        super(table);\n    }\n    prepareStagingWithRows() {\n        this.prepareBodyStaging();\n        this.prepareRowHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareStagingWithColumns() {\n        this.prepareBodyStaging();\n        this.prepareColHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareBodyStaging() {\n        this.bodyStaging = div();\n        this.bodyStaging.className = \"staging\";\n        this.bodyStaging.style.left = this.body.style.left;\n        this.bodyStaging.style.top = this.body.style.top;\n    }\n    prepareRowHeadStaging() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.style.top = this.rowHeads.style.top;\n        this.headStaging.style.width = this.rowHeads.style.width;\n    }\n    prepareColHeadStaging() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.classList.add(\"colHack\");\n        this.headStaging.style.left = this.colHeads.style.left;\n        this.headStaging.style.height = this.colHeads.style.height;\n    }\n    disposeStaging() {\n        this.table.removeStaging(this.bodyStaging, this.headStaging);\n    }\n    scrollStaging() {\n    }\n    makeRowMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.top = `${start}px`;\n        mask.style.height = `${size}px`;\n        mask.style.left = `0`;\n        mask.style.right = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n    makeColumnMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.left = `${start}px`;\n        mask.style.width = `${size}px`;\n        mask.style.top = `0`;\n        mask.style.bottom = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n}\n//# sourceMappingURL=TableAnimation.js.map","import { TableAnimation } from \"./TableAnimation.js\";\nexport class InsertAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.event = event;\n    }\n    prepare() {\n        this.prepareCellsToBeMeasured();\n        this.prepareStaging();\n    }\n    firstFrame() {\n        this.arrangeInStaging();\n        this.split();\n    }\n    animationFrame(n) {\n        this.animate(this.animationStart + n * this.totalSize);\n    }\n    lastFrame() {\n        this.animate(this.animationStart + this.totalSize);\n        this.join();\n        this.disposeStaging();\n    }\n    join() {\n        if (this.done) {\n            return;\n        }\n        this.done = true;\n        this.joinHeader();\n        this.joinBody();\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n}\n//# sourceMappingURL=InsertAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nimport { span, div } from \"../../util/lsx.js\";\nexport class InsertRowAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.join = this.join.bind(this);\n        this.initialRowCount = this.adapter.rowCount - event.size;\n        InsertRowAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithRows();\n    }\n    animate(pos) {\n        this.splitBody.style.top = `${pos}px`;\n        this.mask.style.top = `${pos}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${pos}px`;\n            this.headMask.style.top = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let rowHeaders = new Array(this.event.size);\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row - this.event.index] = content;\n        }\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.colHeads === undefined && this.adapter.colCount === this.event.size) {\n            let colHeaders = new Array(this.adapter.colCount);\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const content = this.adapter.getColumnHead(col);\n                if (this.colHeads === undefined && content !== undefined) {\n                    this.colHeads = div();\n                    this.colHeads.className = \"cols\";\n                    this.root.appendChild(this.colHeads);\n                    this.colResizeHandles = div();\n                    this.colResizeHandles.className = \"cols\";\n                    this.root.appendChild(this.colResizeHandles);\n                }\n                colHeaders[col] = content;\n            }\n            if (this.colHeads !== undefined) {\n                for (let col = 0; col < this.adapter.colCount; ++col) {\n                    const cell = span(colHeaders[col]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.table.createCell();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let top = 0;\n        let idx = this.event.index * this.adapter.colCount;\n        if (this.body.children.length !== 0) {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                top = px2float(cell.style.top);\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                top = px2float(cell.style.top) + b.height - overlap;\n            }\n        }\n        let colWidth = new Array(this.adapter.colCount);\n        if (this.body.children.length > 0) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.body.children[col];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = bounds.width;\n                if (this.adapter.config.seamless) {\n                    colWidth[col] += 2;\n                }\n            }\n        }\n        else {\n            colWidth.fill(this.table.minCellWidth);\n        }\n        let rowHeadWidth = this.table.minCellWidth;\n        if (this.rowHeads && this.rowHeads.children.length > 0) {\n            const cell = this.rowHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            if (this.adapter.config.seamless) {\n                rowHeadWidth += 2;\n            }\n        }\n        let rowHeight = new Array(this.event.size);\n        rowHeight.fill(this.table.minCellHeight);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        let colHeadHeight = 0;\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            colHeadHeight = this.table.minCellHeight;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width - this.table.WIDTH_ADJUST);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height - this.table.HEIGHT_ADJUST);\n            }\n        }\n        else {\n            if (this.colHeads !== undefined) {\n                const b = this.colHeads.children[0].getBoundingClientRect();\n                colHeadHeight = b.height - this.table.HEIGHT_ADJUST;\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        if (this.rowHeads) {\n            if (colHeadHeight === 0) {\n                this.rowHeads.style.top = `0px`;\n            }\n            else {\n                this.rowHeads.style.top = `${colHeadHeight + this.table.HEIGHT_ADJUST - overlap}px`;\n            }\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n        }\n        for (let row = 0; row < this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                if (this.adapter.config.expandColumn) {\n                    colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width));\n                }\n                else {\n                    if (row === 0 && this.body.children.length === 0) {\n                        colWidth[col] = Math.ceil(bounds.width);\n                    }\n                }\n            }\n            this.totalSize += rowHeight[row] - overlap;\n        }\n        if (this.adapter.config.expandColumn) {\n            idx = 0;\n            let x = 0;\n            let col = 0;\n            while (idx < this.body.children.length) {\n                const cell = this.body.children[idx];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n                ++col;\n                ++idx;\n                if (col >= this.adapter.colCount) {\n                    x = 0;\n                    col = 0;\n                }\n            }\n        }\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let y = top;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, 0, y, rowHeadWidth, rowHeight[row]);\n                this.headStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n        }\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                cell.style.height = `${colHeadHeight}px`;\n                this.colHeads.appendChild(cell);\n                x += colWidth[col] - overlap;\n            }\n            colHeadHeight += this.table.HEIGHT_ADJUST;\n            this.body.style.top = `${colHeadHeight - overlap}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.headStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n        }\n        y = top;\n        for (let row = 0; row < this.event.size; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, colWidth[col], rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n            y += rowHeight[row] - overlap;\n            if (this.adapter.config.seamless) {\n                y -= 2;\n            }\n        }\n        this.mask = this.makeRowMask(top, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads !== undefined) {\n            this.headMask = this.makeRowMask(top, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n        if (this.initialRowCount !== 0) {\n            const overlap = this.adapter.config.seamless ? 0 : 1;\n            this.totalSize -= overlap;\n        }\n    }\n    split() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.animationStart = px2float(this.splitBody.style.top);\n    }\n    joinHeader() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.rowHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.rowHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let top = px2float(this.splitHead.style.top);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.rowHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        while (this.bodyStaging.children.length > 0) {\n            this.body.appendChild(this.bodyStaging.children[0]);\n        }\n        if (this.splitBody.children.length > 0) {\n            let top = px2float(this.splitBody.style.top);\n            while (this.splitBody.children.length > 0) {\n                const cell = this.splitBody.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.body.appendChild(cell);\n            }\n        }\n    }\n}\n//# sourceMappingURL=InsertRowAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveRowAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.event = event;\n        this.joinHorizontal = this.joinHorizontal.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialHeight = 0;\n        }\n        else {\n            const bottomCell = this.body.children[this.body.children.length - 1];\n            const top = px2float(bottomCell.style.top);\n            const bounds = bottomCell.getBoundingClientRect();\n            this.initialHeight = top + bounds.height;\n        }\n        this.overlap = this.adapter.config.seamless ? 0 : 1;\n        this.removeAll = this.event.index >= this.adapter.rowCount;\n        RemoveRowAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithRows();\n        this.arrangeRowsInStaging();\n        this.splitHorizontal();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        this.splitBody.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n        this.mask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n            this.headMask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        }\n    }\n    lastFrame() {\n        this.joinHorizontal();\n        this.disposeStaging();\n    }\n    arrangeRowsInStaging() {\n        const idx = this.event.index * this.adapter.colCount;\n        const cellCount = this.event.size * this.adapter.colCount;\n        const start = px2float(this.body.children[idx].style.top);\n        for (let i = 0; i < cellCount; ++i) {\n            this.bodyStaging.appendChild(this.body.children[idx]);\n        }\n        let bottomOfStaging;\n        if (idx < this.body.children.length) {\n            bottomOfStaging = px2float(this.body.children[idx].style.top);\n        }\n        else {\n            const cell = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n            bottomOfStaging = px2float(cell.style.top) + px2float(cell.style.height) + this.table.HEIGHT_ADJUST;\n        }\n        this.animationHeight = bottomOfStaging - start;\n        this.mask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.rowHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitHorizontal() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.topSplitBody = px2float(this.splitBody.style.top);\n        this.topMask = px2float(this.mask.style.top);\n    }\n    joinHorizontal() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.rowHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.rowHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitHead.style.top);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.rowHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitBody.style.top);\n        while (this.splitBody.children.length > 0) {\n            const cell = this.splitBody.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.body.appendChild(cell);\n        }\n    }\n}\n//# sourceMappingURL=RemoveRowAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { span, div } from \"../../util/lsx.js\";\nimport { px2int, px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nexport class InsertColumnAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.event = event;\n        this.join = this.join.bind(this);\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        InsertColumnAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithColumns();\n    }\n    animate(pos) {\n        this.mask.style.left = `${pos}px`;\n        this.splitBody.style.left = `${pos}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${pos}px`;\n            this.headMask.style.left = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let colHeaders = new Array(this.event.size);\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            colHeaders[col - this.event.index] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(colHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.rowHeads === undefined && this.adapter.rowCount === this.event.size) {\n            let rowHeaders = new Array(this.adapter.rowCount);\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const content = this.adapter.getRowHead(row);\n                if (this.rowHeads === undefined && content !== undefined) {\n                    this.rowHeads = div();\n                    this.rowHeads.className = \"rows\";\n                    this.root.appendChild(this.rowHeads);\n                    this.rowResizeHandles = div();\n                    this.rowResizeHandles.className = \"rows\";\n                    this.root.appendChild(this.rowResizeHandles);\n                }\n                rowHeaders[row] = content;\n            }\n            if (this.rowHeads !== undefined) {\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    const cell = span(rowHeaders[row]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = span();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const previousColCount = this.colCount - this.event.size;\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let left;\n        let idx = this.event.index;\n        if (idx < previousColCount) {\n            let cell = this.body.children[idx];\n            left = px2int(cell.style.left);\n        }\n        else {\n            if (this.body.children.length === 0) {\n                left = 0;\n            }\n            else {\n                const cell = this.body.children[previousColCount - 1];\n                left = px2int(cell.style.left) + px2int(cell.style.width) + this.table.WIDTH_ADJUST - overlap;\n            }\n        }\n        this.animationStart = left;\n        let rowHeight = new Array(this.adapter.rowCount);\n        if (this.body.children.length !== 0) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.body.children[row * previousColCount];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = bounds.height;\n                if (this.adapter.config.seamless) {\n                    rowHeight[row] += 2;\n                }\n            }\n        }\n        else {\n            rowHeight.fill(this.table.minCellHeight);\n        }\n        let colHeadHeight = this.table.minCellHeight;\n        if (this.colHeads && this.colHeads.children.length > 0) {\n            const cell = this.colHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            colHeadHeight = bounds.height;\n            if (this.adapter.config.seamless) {\n                colHeadHeight += 2;\n            }\n        }\n        let colWidth = new Array(this.event.size);\n        colWidth.fill(this.table.minCellWidth);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let rowHeadWidth = 0;\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            rowHeadWidth = this.table.minCellWidth;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height - this.table.HEIGHT_ADJUST);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width - this.table.WIDTH_ADJUST);\n            }\n        }\n        else {\n            if (this.rowHeads !== undefined) {\n                const b = this.rowHeads.children[0].getBoundingClientRect();\n                rowHeadWidth = b.width - this.table.WIDTH_ADJUST;\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        if (this.colHeads) {\n            if (rowHeadWidth === 0) {\n                this.colHeads.style.left = `0px`;\n            }\n            else {\n                this.colHeads.style.left = `${rowHeadWidth + this.table.WIDTH_ADJUST + 2 - overlap}px`;\n            }\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n            this.body.style.top = `${colHeadHeight - 1}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - 1}px`;\n        }\n        for (let col = 0; col < this.event.size; ++col) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width) - 2);\n                if (this.adapter.config.expandRow) {\n                    rowHeight[col] = Math.ceil(Math.max(rowHeight[row], bounds.height));\n                }\n                else {\n                    if (col === 0 && this.body.children.length === 0) {\n                        rowHeight[row] = Math.ceil(bounds.height);\n                    }\n                }\n            }\n            this.totalSize += colWidth[col] - overlap;\n        }\n        colWidth.forEach((v, i) => colWidth[i] = v + 4);\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let x = left;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, 0, colWidth[col], colHeadHeight);\n                this.headStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n        }\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            let y = 0;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                cell.style.top = `${y}px`;\n                cell.style.height = `${rowHeight[row] - this.table.HEIGHT_ADJUST}px`;\n                cell.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.appendChild(cell);\n                y += rowHeight[row] - overlap;\n            }\n            rowHeadWidth += this.table.WIDTH_ADJUST;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.headStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n        }\n        let totalWidth = 0;\n        x = left;\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            let columnWidth = colWidth[col - this.event.index];\n            let y = 0;\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, columnWidth, rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n            x += columnWidth - overlap - 2;\n            if (!this.adapter.config.seamless) {\n                x += 2;\n            }\n            totalWidth += columnWidth - 2;\n        }\n        this.totalSize = totalWidth + 2;\n        this.mask = this.makeColumnMask(left, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads !== undefined) {\n            this.headMask = this.makeColumnMask(left, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n    }\n    split() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n    }\n    joinHeader() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.colHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.colHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let left = px2float(this.splitHead.style.left);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                this.colHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        const totalWidth = this.adapter.model.colCount;\n        const bodyWidth = this.event.index;\n        const stagingWidth = this.event.size;\n        const splitWidth = totalWidth - stagingWidth - this.event.index;\n        for (let col = 0; col < stagingWidth; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.bodyStaging.children[0];\n                const idx = row * (bodyWidth + stagingWidth) + bodyWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n        let left = this.totalSize + this.animationStart;\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < splitWidth; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * totalWidth + bodyWidth + stagingWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=InsertColumnAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveColumnAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        this.event = event;\n        this.joinVertical = this.joinVertical.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialWidth = 0;\n        }\n        else {\n            const cell = this.body.children[this.body.children.length - 1];\n            const left = px2float(cell.style.left);\n            const bounds = cell.getBoundingClientRect();\n            this.initialWidth = left + bounds.width;\n        }\n        RemoveColumnAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithColumns();\n        this.arrangeColumnsInStaging();\n        this.splitVertical();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        let a = 0;\n        if (this.adapter.config.seamless) {\n            a = 1;\n        }\n        this.splitBody.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n        this.mask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n            this.headMask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        }\n    }\n    lastFrame() {\n        this.joinVertical();\n        this.disposeStaging();\n    }\n    arrangeColumnsInStaging() {\n        let idx = this.event.index;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.event.size; ++col) {\n                this.bodyStaging.appendChild(this.body.children[idx]);\n            }\n            idx += this.colCount;\n        }\n        const firstCellOfStaging = this.bodyStaging.children[0];\n        const lastCellOfStaging = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n        let rightOfStaging = px2float(lastCellOfStaging.style.left) + px2float(lastCellOfStaging.style.width) + this.table.WIDTH_ADJUST;\n        rightOfStaging -= 1;\n        let w = rightOfStaging - px2float(firstCellOfStaging.style.left);\n        this.animationWidth = w;\n        this.mask = this.makeColumnMask(rightOfStaging, w);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.colHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeColumnMask(rightOfStaging, w);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitVertical() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n        const left = px2float(this.splitBody.style.left);\n        this.splitBody.style.width = `${this.initialWidth - left - 1}px`;\n        this.leftSplitBody = left;\n        this.leftMask = px2float(this.mask.style.left);\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${left}px`;\n            this.splitHead.style.width = `${this.initialWidth - left - 1}px`;\n        }\n    }\n    joinVertical() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.colHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.colHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitHead.style.left);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.left = `${px2float(cell.style.left) + left}px`;\n            this.colHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitBody.style.left);\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < this.colCount - this.event.index; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * this.adapter.colCount + this.event.index + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=RemoveColumnAnimation.js.map","let animationFrameCount = 468;\nexport function setAnimationFrameCount(frames) {\n    animationFrameCount = frames;\n}\nexport function scrollIntoView(element) {\n    if (element === undefined)\n        return;\n    const scrollableParent = findScrollableParent(element);\n    if (scrollableParent === undefined)\n        return;\n    const parentRect = scrollableParent.getBoundingClientRect();\n    const clientRect = element.getBoundingClientRect();\n    if (scrollableParent !== document.body) {\n        const { x, y } = calculateScrollGoal(scrollableParent, parentRect, clientRect);\n        smoothScroll(scrollableParent, x, y);\n        if (window.getComputedStyle(scrollableParent).position !== 'fixed') {\n            window.scrollBy({\n                left: parentRect.left,\n                top: parentRect.top,\n                behavior: 'smooth'\n            });\n        }\n    }\n    else {\n        window.scrollBy({\n            left: clientRect.left,\n            top: clientRect.top,\n            behavior: 'smooth'\n        });\n    }\n}\nfunction calculateScrollGoal(scrollableParent, parentRect, clientRect) {\n    const GAP = 16;\n    const clientLeft = clientRect.left + scrollableParent.scrollLeft - parentRect.left - GAP;\n    const clientRight = clientRect.right + scrollableParent.scrollLeft - parentRect.left + GAP;\n    const clientTop = clientRect.top + scrollableParent.scrollTop - parentRect.top - GAP;\n    const clientBottom = clientRect.bottom + scrollableParent.scrollTop - parentRect.top + GAP;\n    const parentWidth = scrollableParent.clientWidth;\n    const parentHeight = scrollableParent.clientHeight;\n    var x = scrollableParent.scrollLeft;\n    var y = scrollableParent.scrollTop;\n    if (clientRight - clientLeft - 2 * GAP > parentWidth)\n        x = clientLeft;\n    else if (clientRight > scrollableParent.scrollLeft + parentWidth)\n        x = clientRight - parentWidth;\n    else if (clientLeft < scrollableParent.scrollLeft)\n        x = clientLeft;\n    if (clientBottom - clientTop - 2 * GAP > parentHeight)\n        y = clientTop;\n    else if (clientBottom > scrollableParent.scrollTop + parentHeight)\n        y = clientBottom - parentHeight;\n    else if (clientTop < scrollableParent.scrollTop)\n        y = clientTop;\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n    return { x, y };\n}\nconst concurrentScroll = new Map();\nfunction smoothScroll(scrollable, x, y) {\n    let activeGoal = concurrentScroll.get(scrollable);\n    if (activeGoal === undefined) {\n        activeGoal = { x: x, y: y };\n        concurrentScroll.set(scrollable, activeGoal);\n    }\n    else {\n        activeGoal.x = x;\n        activeGoal.y = y;\n    }\n    let startX, startY;\n    if (scrollable === document.body) {\n        startX = window.scrollX || window.pageXOffset;\n        startY = window.scrollY || window.pageYOffset;\n    }\n    else {\n        startX = scrollable.scrollLeft;\n        startY = scrollable.scrollTop;\n    }\n    const deltaX = x - startX;\n    const deltaY = y - startY;\n    if (deltaX === 0 && deltaY === 0) {\n        concurrentScroll.delete(scrollable);\n        return;\n    }\n    animate((value) => {\n        if (activeGoal.x !== x || activeGoal.y !== y) {\n            return false;\n        }\n        const nx = startX + value * deltaX;\n        const ny = startY + value * deltaY;\n        if (scrollable === document.body) {\n            window.scrollTo(nx, ny);\n        }\n        else {\n            scrollable.scrollLeft = nx;\n            scrollable.scrollTop = ny;\n        }\n        if (value === 1) {\n            concurrentScroll.delete(scrollable);\n        }\n        return true;\n    });\n}\nlet idSource = 0;\nexport function animate(callback) {\n    setTimeout(() => { window.requestAnimationFrame(animateStep.bind(window, callback, undefined, undefined)); }, 0);\n}\nfunction animateStep(callback, startTime, id) {\n    if (startTime === undefined) {\n        startTime = Date.now();\n        id = ++idSource;\n    }\n    const time = Date.now();\n    let elapsed = animationFrameCount > 0 ? (time - startTime) / animationFrameCount : 1;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n    const value = ease(elapsed);\n    if (callback(value) === false)\n        return;\n    if (value < 1.0) {\n        window.requestAnimationFrame(animateStep.bind(window, callback, startTime, id));\n    }\n}\nfunction ease(k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n}\nvar ROUNDING_TOLERANCE = isMicrosoftBrowser(window.navigator.userAgent) ? 1 : 0;\nfunction isMicrosoftBrowser(userAgent) {\n    const userAgentPatterns = ['MSIE ', 'Trident/', 'Edge/'];\n    return new RegExp(userAgentPatterns.join('|')).test(userAgent);\n}\nexport function findScrollableParent(el) {\n    while (el !== document.body && isScrollable(el) === false) {\n        if (el.parentElement === null)\n            return undefined;\n        el = el.parentElement;\n    }\n    return el;\n}\nexport function isScrollable(el) {\n    const isScrollableY = hasScrollableSpace(el, \"Y\") && canOverflow(el, \"Y\");\n    const isScrollableX = hasScrollableSpace(el, \"X\") && canOverflow(el, \"X\");\n    return isScrollableY || isScrollableX;\n}\nfunction hasScrollableSpace(el, axis) {\n    if (axis === 'X')\n        return el.clientWidth + ROUNDING_TOLERANCE < el.scrollWidth;\n    else\n        return el.clientHeight + ROUNDING_TOLERANCE < el.scrollHeight;\n}\nfunction canOverflow(el, axis) {\n    const style = window.getComputedStyle(el, null);\n    const overflowValue = style['overflow' + axis];\n    return overflowValue === 'auto' || overflowValue === 'scroll';\n}\n//# sourceMappingURL=scrollIntoView.js.map","import { css } from \"../../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host {\n    position: relative;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-300);\n    border-radius: 3px;\n    /* outline-offset: -2px; */\n    outline: none;\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-font-size);\n    background: #1e1e1e;\n\n    /* not sure about these */\n    /*\n    width: 100%;\n    width: -moz-available;\n    width: -webkit-fill-available;\n    width: fill-available;\n    height: 100%;\n    height: -moz-available;\n    height: -webkit-fill-available;\n    height: fill-available;\n    */\n\n    min-height: 50px;\n    min-width: 50px;\n}\n\n.staging, .body, .splitBody, .cols, .rows {\n    position: absolute;\n}\n\n.cols {\n    right: 0;\n    top: 0;\n}\n\n.rows {\n    left: 0;\n    bottom: 0;\n}\n\n.staging {\n    overflow: hidden;\n    inset: 0;\n}\n\n.body {\n    overflow: auto;\n    inset: 0;\n}\n\n.cols, .rows {\n    overflow: hidden;\n}\n\n.body > span,\n.splitBody > span,\n.cols > span,\n.rows > span,\n.measure > span,\n.staging > span {\n    position: absolute;\n    box-sizing: content-box;\n    white-space: nowrap;\n    outline: none;\n    border: solid 1px var(--tx-gray-200);\n    padding: 0 2px 0 2px;\n    margin: 0;\n    background-color: #080808;\n    font-weight: 400;\n    overflow: hidden;\n    cursor: default;\n    caret-color: transparent;\n}\n\n.seamless > .body > span,\n.seamless > .body > .splitBody > span,\n.seamless > .cols > span,\n.seamless > .rows > span,\n.seamless > .cols > .splitBody > span,\n.seamless > .rows > .splitBody > span,\n.seamless > .measure > span,\n.seamless > .staging > span {\n    border: none 0px;\n}\n\n.body > span:hover {\n    background: #1a1a1a;\n}\n\n.body > span.error, .splitBody > span.error {\n    border-color: var(--tx-global-red-600);\n    z-index: 1;\n}\n\n.body > span:focus, .splitBody > span:focus {\n    background: #0e2035;\n    border-color: #2680eb;\n    z-index: 2;\n}\n\n.body > span:focus:hover {\n    background: #112d4d;\n}\n\n.body > span.error, .splitBody > span.error {\n    background-color: #522426;\n}\n\n.body > span.error:hover {\n    background: #401111;\n}\n\n.cols > span.handle,\n.rows > span.handle {\n    padding: 0;\n    border: 0 none;\n    opacity: 0;\n    background-color: #08f;\n}\n.fill {\n    opacity: 0;\n}\n\n.cols > span.handle {\n    cursor: col-resize;\n}\n.rows > span.handle {\n    cursor: row-resize;\n}\n\n.staging span.head,\n.cols span.head,\n.rows span.head,\n.measure span.head {\n    background: #1e1e1e;\n    font-weight: 600;\n}\n\n.colHack > span,\n.cols > span {\n    text-align: center;\n}\n\n.measure {\n    position: absolute;\n    opacity: 0;\n}\n\n.body > span.edit, .splitBody > span.edit, .body > span.edit:hover, .splitBody > span.edit:hover {\n    caret-color: currentcolor;\n}\n`);\n//# sourceMappingURL=tx-table.js.map","import { View } from \"../view/View.js\";\nimport { TableModel } from \"./model/TableModel.js\";\nimport { SelectionModel } from \"./model/SelectionModel.js\";\nimport { EditMode, TableAdapter } from \"./adapter/TableAdapter.js\";\nimport { TableEvent } from \"./TableEvent.js\";\nimport { TablePos } from \"./TablePos.js\";\nimport { TableEditMode } from \"./TableEditMode.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { Animator } from \"../util/animation.js\";\nimport { TableAnimation } from \"./private/TableAnimation.js\";\nimport { InsertRowAnimation } from \"./private/InsertRowAnimation.js\";\nimport { RemoveRowAnimation } from \"./private/RemoveRowAnimation.js\";\nimport { InsertColumnAnimation } from \"./private/InsertColumnAnimation.js\";\nimport { RemoveColumnAnimation } from \"./private/RemoveColumnAnimation.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nimport { span, div, text } from \"../util/lsx.js\";\nimport { scrollIntoView } from \"../util/scrollIntoView.js\";\nimport { style as txTable } from \"./style/tx-table.js\";\nimport { style as txScrollbar } from \"../style/tx-scrollbar.js\";\nimport { hasFocus } from \"../util/dom.js\";\nexport class NullLogger {\n    log(_) { }\n    print() { }\n}\nexport class MemoryLogger {\n    constructor() {\n        this.logs = [];\n    }\n    log(msg) {\n        this.logs.push(msg);\n    }\n    print() {\n        console.log(`MemoryLogger collected ${this.logs.length} logs`);\n        this.logs.forEach(msg => console.log(msg));\n    }\n}\nexport function px2int(s) {\n    return parseInt(s.substring(0, s.length - 2));\n}\nexport function px2float(s) {\n    return parseFloat(s.substring(0, s.length - 2));\n}\nfunction isVisible(e) {\n    if (e.isConnected === false) {\n        return false;\n    }\n    if (window.getComputedStyle(e).display === \"none\") {\n        return false;\n    }\n    if (e.parentElement) {\n        return isVisible(e.parentElement);\n    }\n    return true;\n}\nexport class Table extends View {\n    constructor(props) {\n        super();\n        this.WIDTH_ADJUST = 6;\n        this.HEIGHT_ADJUST = 2;\n        this.HANDLE_SIZE = 5;\n        this.HANDLE_SKEW = 3;\n        this.visible = false;\n        this.prepareInProgress = false;\n        this.animator = new Animator();\n        this.logger = new Table.loggerType();\n        this.logger.log(\"Table::constructor()\");\n        this.arrangeAllMeasuredInGrid = this.arrangeAllMeasuredInGrid.bind(this);\n        this.hostKeyDown = this.hostKeyDown.bind(this);\n        this.cellKeyDown = this.cellKeyDown.bind(this);\n        this.cellFocus = this.cellFocus.bind(this);\n        this.focusIn = this.focusIn.bind(this);\n        this.focusOut = this.focusOut.bind(this);\n        this.pointerDown = this.pointerDown.bind(this);\n        this.handleDown = this.handleDown.bind(this);\n        this.handleMove = this.handleMove.bind(this);\n        this.handleUp = this.handleUp.bind(this);\n        this.setHeadingFillerSizeToScrollbarSize = this.setHeadingFillerSizeToScrollbarSize.bind(this);\n        this.selectionChanged = this.selectionChanged.bind(this);\n        this.modelChanged = this.modelChanged.bind(this);\n        this.root = div((this.body = div()));\n        this.root.className = \"root\";\n        this.body.className = \"body\";\n        this.measure = div();\n        this.measure.classList.add(\"measure\");\n        this.onkeydown = this.hostKeyDown;\n        this.addEventListener(\"focusin\", this.focusIn);\n        this.addEventListener(\"focusout\", this.focusOut);\n        this.body.onresize = this.setHeadingFillerSizeToScrollbarSize;\n        this.body.onscroll = () => {\n            if (this.animator.current && this.animator.current instanceof TableAnimation) {\n                this.animator.current.scrollStaging();\n            }\n            this.setHeadingFillerSizeToScrollbarSize();\n            if (this.colHeads) {\n                this.colHeads.scrollLeft = this.body.scrollLeft;\n                this.colResizeHandles.scrollLeft = this.body.scrollLeft;\n            }\n            if (this.rowHeads) {\n                this.rowHeads.scrollTop = this.body.scrollTop;\n                this.rowResizeHandles.scrollTop = this.body.scrollTop;\n            }\n        };\n        this.body.onpointerdown = this.pointerDown;\n        this.attachShadow({ mode: \"open\", delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txTable, txScrollbar];\n        this.shadowRoot.appendChild(this.root);\n        this.shadowRoot.appendChild(this.measure);\n        if (props) {\n            setInitialProperties(this, props);\n            if (props.selectionModel) {\n                this.setModel(props.selectionModel);\n            }\n        }\n        if (Table.observer === undefined) {\n            Table.observer = new MutationObserver((mutations, observer) => {\n                Table.allTables.forEach((table) => {\n                    if (isVisible(table)) {\n                        this.logger.log(`Table.observer => table became visible => prepareCells()`);\n                        Table.allTables.delete(table);\n                        table.prepareCells();\n                    }\n                });\n            });\n            Table.observer.observe(document.body, {\n                attributes: true,\n                subtree: true,\n            });\n        }\n    }\n    connectedCallback() {\n        this.logger.log(`Table::connectedCallback()`);\n        setTimeout(() => {\n            if (isVisible(this)) {\n                this.logger.log(`Table::connectedCallback() => is visible => prepareCells()`);\n                this.prepareCells();\n            }\n            else {\n                this.logger.log(`Table::connectedCallback() => is not visible => track in Table.allTables`);\n                Table.allTables.add(this);\n            }\n        }, 0);\n        super.connectedCallback();\n        if (this.selection === undefined) {\n            this.selection = new SelectionModel(TableEditMode.SELECT_CELL);\n            this.selection.modified.add(this.selectionChanged, this);\n        }\n    }\n    disconnectedCallback() {\n        this.logger.log(`Table::disconnectedCallback()`);\n        Table.allTables.delete(this);\n    }\n    addStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.insertBefore(element, this.root.children[0]);\n        }\n    }\n    removeStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.removeChild(element);\n        }\n    }\n    hostKeyDown(ev) {\n        this.logger.log(`Table::hostKeyDown(ev): ${ev.key}, mode: ${TableEditMode[this.selection.mode]}, adapter edit mode ${EditMode[this.adapter.config.editMode]}, editing=${this.editing}`);\n        if (!this.selection)\n            return;\n        switch (this.selection.mode) {\n            case TableEditMode.SELECT_ROW:\n                {\n                    let row = this.selection.value.row;\n                    switch (ev.key) {\n                        case \"ArrowDown\":\n                            if (row + 1 < this.adapter.rowCount)\n                                ++row;\n                            break;\n                        case \"ArrowUp\":\n                            if (row > 0)\n                                --row;\n                            break;\n                    }\n                    this.selection.row = row;\n                }\n                break;\n            case TableEditMode.SELECT_CELL:\n                {\n                    let pos = { col: this.selection.col, row: this.selection.row };\n                    switch (ev.key) {\n                        case \"ArrowRight\":\n                            if (this.editing === undefined && pos.col + 1 < this.adapter.colCount) {\n                                ++pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowLeft\":\n                            if (this.editing === undefined && pos.col > 0) {\n                                --pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowDown\":\n                            if (pos.row + 1 < this.adapter.rowCount) {\n                                ++pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowUp\":\n                            if (pos.row > 0) {\n                                --pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"Enter\":\n                            if (this.editing === undefined) {\n                                if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                                    this.editCell();\n                                }\n                            }\n                            else {\n                                this.saveCell();\n                                if (pos.row + 1 < this.adapter.rowCount) {\n                                    ++pos.row;\n                                    this.selection.value = pos;\n                                    this.editCell();\n                                }\n                            }\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                            break;\n                    }\n                    this.selection.value = pos;\n                }\n                break;\n            case TableEditMode.EDIT_CELL:\n                let pos = { col: this.selection.col, row: this.selection.row };\n                switch (ev.key) {\n                    case \"ArrowDown\":\n                        if (pos.row + 1 < this.adapter.rowCount) {\n                            ++pos.row;\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                        }\n                        break;\n                    case \"ArrowUp\":\n                        if (pos.row > 0) {\n                            --pos.row;\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                        }\n                        break;\n                    case \"Enter\":\n                        if (this.editing === undefined) {\n                            if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                                this.editCell();\n                            }\n                        }\n                        else {\n                            this.saveCell();\n                            this.editCell();\n                        }\n                        ev.preventDefault();\n                        ev.stopPropagation();\n                        break;\n                }\n                this.selection.value = pos;\n                break;\n        }\n    }\n    cellKeyDown(ev) {\n        this.logger.log(`Table::cellKeyDown()`);\n        const cell = ev.target;\n        if (ev.key === \"Enter\") {\n            this.hostKeyDown(ev);\n            ev.preventDefault();\n            return;\n        }\n        if (!cell.classList.contains(\"edit\") && this.editing === undefined) {\n            switch (ev.key) {\n                case \"ArrowDown\":\n                case \"ArrowUp\":\n                case \"ArrowRight\":\n                case \"ArrowLeft\":\n                case \"Tab\":\n                case \"Enter\":\n                    break;\n                default:\n                    if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                        ev.preventDefault();\n                    }\n            }\n        }\n        else {\n        }\n    }\n    cellFocus(event) {\n        this.logger.log(\"Table::cellFocus(event)\");\n        const cell = event.target;\n        if (cell instanceof HTMLElement) {\n            const b = cell.getBoundingClientRect();\n            const p = this.clientPosToTablePos(b.x + b.width / 2, b.y + b.height / 2);\n            if (p !== undefined) {\n                this.selection.value = p;\n            }\n            if (this.selection?.mode === TableEditMode.SELECT_CELL &&\n                this.adapter?.config.editMode === EditMode.EDIT_ON_FOCUS) {\n                this.editCell();\n            }\n        }\n    }\n    focusIn(event) {\n    }\n    focusOut(event) {\n    }\n    editCell() {\n        const col = this.selection.value.col;\n        const row = this.selection.value.row;\n        this.logger.log(`Table.editCell(): cell[${col}, ${row}]`);\n        if (this.editing !== undefined) {\n            if (this.editing.col === this.selection.value.col && this.editing.row === this.selection.value.row) {\n                return;\n            }\n        }\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        this.editing = new TablePos(col, row);\n        cell.classList.add(\"edit\");\n        this.adapter.editCell(this.editing, cell);\n    }\n    saveCell() {\n        if (this.editing === undefined) {\n            return;\n        }\n        const col = this.editing.col;\n        const row = this.editing.row;\n        this.logger.log(`Table::saveCell(): cell[${col}, ${row}]`);\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        cell.classList.remove(\"edit\");\n        this.adapter.saveCell(this.editing, cell);\n        this.editing = undefined;\n        this.focus();\n    }\n    pointerDown(ev) {\n    }\n    getModel() {\n        return this.model;\n    }\n    setModel(model) {\n        if (model === undefined) {\n            this.logger.log(`Table::setModel(undefined) => remove all models`);\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.model = undefined;\n            this.selection = new SelectionModel();\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof SelectionModel) {\n            this.logger.log(`Table::setModel(SelectionModel) => set selection model`);\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.selection = model;\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof TableModel) {\n            this.logger.log(`Table::setModel(TableModel) => set table model`);\n            this.model = model;\n            this.model.modified.add(this.modelChanged, this);\n            const adapter = TableAdapter.lookup(model);\n            try {\n                this.adapter = new adapter(model);\n            }\n            catch (e) {\n                console.log(`Table.setModel(): failed to instantiate table adapter: ${e}`);\n                console.log(`setting TypeScript's target to 'es6' might help`);\n                throw e;\n            }\n            this.prepareCells();\n            return;\n        }\n        if (model instanceof Object) {\n            this.logger.log(`Table::setModel(TableModel) => unexpected model of type ${model.constructor.name}`);\n            throw Error(`Table.setModel(): unexpected model of type ${model.constructor.name}`);\n        }\n    }\n    selectionChanged() {\n        this.logger.log(`Table::selectionChanged(): ${this.selection?.col}, ${this.selection?.row}, mode=${this.selection ? TableEditMode[this.selection.mode] : \"undefined\"}`);\n        if (this.selection === undefined) {\n            return;\n        }\n        this.saveCell();\n        switch (this.selection.mode) {\n            case TableEditMode.EDIT_CELL:\n                {\n                    if (document.activeElement === this) {\n                        const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                        if (!hasFocus(cell)) {\n                            cell.focus();\n                        }\n                        scrollIntoView(cell);\n                        if (this.adapter?.config.editMode === EditMode.EDIT_ON_FOCUS) {\n                            this.editCell();\n                        }\n                    }\n                }\n                break;\n            case TableEditMode.SELECT_CELL:\n            case TableEditMode.SELECT_ROW:\n                {\n                    if (document.activeElement === this) {\n                        const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                        cell.focus();\n                        scrollIntoView(cell);\n                    }\n                }\n                break;\n        }\n    }\n    modelChanged(event) {\n        this.logger.log(`Table::modelChanged(${event})`);\n        if (!this.visible && this.body.children.length === 0) {\n            return;\n        }\n        if (event instanceof TableEvent) {\n            switch (event.type) {\n                case TableEventType.CELL_CHANGED:\n                    {\n                        const index = event.col + event.row * this.adapter.colCount;\n                        const cell = this.body.children[index];\n                        if (cell === undefined) {\n                            console.log(`Table::modelChanged(): failed to find cell ${event.col}, ${event.row} (${index}) (body has ${this.body.children.length} children and table has parent ${this.parentElement})`);\n                            return;\n                        }\n                        if (cell instanceof HTMLSpanElement) {\n                            this.showCell(event, cell);\n                        }\n                    }\n                    break;\n                case TableEventType.INSERT_ROW:\n                    this.animator.run(new InsertRowAnimation(this, event));\n                    break;\n                case TableEventType.REMOVE_ROW:\n                    this.animator.run(new RemoveRowAnimation(this, event));\n                    break;\n                case TableEventType.INSERT_COL:\n                    this.animator.run(new InsertColumnAnimation(this, event));\n                    break;\n                case TableEventType.REMOVE_COL:\n                    this.animator.run(new RemoveColumnAnimation(this, event));\n                    break;\n                default:\n            }\n        }\n    }\n    prepareCells() {\n        if (this.adapter === undefined) {\n            this.logger.log(`Table::prepareCells(): no adapter => abort`);\n            return;\n        }\n        if (this.adapter.colCount === 0 || this.adapter.rowCount === 0) {\n            this.logger.log(`Table::prepareCells(): col and/or row count is zero => abort`);\n            return;\n        }\n        this.visible = isVisible(this);\n        if (!this.visible) {\n            this.logger.log(`Table::prepareCells(): not visible, can not calculate layout => abort`);\n            return;\n        }\n        if (this.prepareInProgress) {\n            this.logger.log(`Table::prepareCells(): prepareInProgress => abort`);\n            return;\n        }\n        this.prepareInProgress = true;\n        this.logger.log(`Table::prepareCells(): start`);\n        if (this.adapter.config.seamless) {\n            this.root.classList.add(\"seamless\");\n        }\n        this.prepareMinCellSize();\n        this.prepareColumnHeads();\n        this.prepareRowHeads();\n        this.prepareBody();\n        this.logger.log(`Table::prepareCells(): finish, schedule arrangeAllMeasuredInGrid()`);\n        setTimeout(this.arrangeAllMeasuredInGrid, 0);\n    }\n    arrangeAllMeasuredInGrid() {\n        this.logger.log(`Table::arrangeAllMeasuredInGrid(): begin`);\n        this.calculateMinCellSize();\n        let { colWidths, colHeadHeight } = this.calculateColumnWidths();\n        let { rowHeights, rowHeadWidth } = this.calculateRowHeights();\n        this.placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth);\n        this.placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth);\n        this.placeBody(rowHeadWidth, colHeadHeight);\n        this.placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth);\n        this.setHeadingFillerSizeToScrollbarSize();\n        this.prepareInProgress = false;\n        this.logger.log(`Table::arrangeAllMeasuredInGrid(): finish`);\n    }\n    prepareMinCellSize() {\n        this.logger.log(`Table::prepareMinCellSize()`);\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = span(text(\"Tg\"));\n        this.measure.appendChild(measureLineHeight);\n    }\n    calculateMinCellSize() {\n        this.logger.log(`Table::calculateMinCellSize()`);\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = this.measure.children[0];\n        const b = measureLineHeight.getBoundingClientRect();\n        this.minCellWidth = Math.ceil(b.width - this.WIDTH_ADJUST);\n        this.minCellHeight = Math.ceil(b.height - this.HEIGHT_ADJUST);\n        this.measure.removeChild(measureLineHeight);\n    }\n    prepareColumnHeads() {\n        this.logger.log(`Table::prepareColumnHeads()`);\n        const columnHeaders = new Array(this.adapter.colCount);\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            columnHeaders[col] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = span(columnHeaders[col]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareRowHeads() {\n        this.logger.log(`Table::prepareRowHeads()`);\n        let rowHeaders = new Array(this.adapter.rowCount);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row] = content;\n        }\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareBody() {\n        this.logger.log(`Table::prepareBody()`);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.createCell();\n                this.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    createCell() {\n        const cell = span();\n        cell.onfocus = this.cellFocus;\n        cell.onkeydown = this.cellKeyDown;\n        cell.tabIndex = 0;\n        cell.setAttribute(\"contenteditable\", \"\");\n        return cell;\n    }\n    setCellSize(span, x, y, w, h) {\n        span.style.left = `${x}px`;\n        span.style.top = `${y}px`;\n        span.style.width = `${w - this.WIDTH_ADJUST}px`;\n        span.style.height = `${h - this.HEIGHT_ADJUST}px`;\n    }\n    showCell(pos, cell) {\n        this.adapter.showCell(pos, cell);\n        if (cell.children.length !== 0) {\n            cell.style.caretColor = \"currentcolor\";\n        }\n    }\n    calculateRowHeights() {\n        this.logger.log(`Table::calculateRowHeights()`);\n        let idx = this.colHeads ? this.adapter.colCount : 0;\n        let rowHeadWidth = 0;\n        const rowHeights = Array(this.adapter.rowCount);\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const child = this.measure.children[idx++];\n                const bounds = child.getBoundingClientRect();\n                rowHeights[row] = Math.max(bounds.height, this.minCellHeight);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        else {\n            rowHeights.fill(this.minCellHeight);\n        }\n        idx = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let rh = rowHeights[row];\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[idx + col + row * this.adapter.colCount];\n                const bounds = child.getBoundingClientRect();\n                rh = Math.max(rh, bounds.height);\n            }\n            rowHeights[row] = Math.ceil(rh);\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        return { rowHeights, rowHeadWidth };\n    }\n    calculateColumnWidths(withinBody = false) {\n        this.logger.log(`Table::calculateColumnWidths(withinBody = ${withinBody})`);\n        let colHeadHeight = 0;\n        const colWidths = Array(this.adapter.colCount);\n        if (this.colHeads) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[col];\n                const bounds = child.getBoundingClientRect();\n                colWidths[col] = Math.max(bounds.width, this.minCellWidth);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        else {\n            colWidths.fill(this.minCellWidth);\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let idxStart;\n        if (withinBody) {\n            idxStart = 0;\n        }\n        else {\n            idxStart = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        }\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            let cw = colWidths[col];\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                let child;\n                let idx = idxStart + col + row * this.adapter.colCount;\n                if (withinBody) {\n                    child = this.body.children[idx];\n                }\n                else {\n                    child = this.measure.children[idx];\n                }\n                const bounds = child.getBoundingClientRect();\n                cw = Math.max(cw, bounds.width);\n            }\n            colWidths[col] = Math.ceil(cw);\n        }\n        return { colWidths, colHeadHeight };\n    }\n    placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeColumnHeads(...)`);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let x = 0;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, x, 0, colWidths[col], colHeadHeight);\n            this.colHeads.appendChild(child);\n            x += colWidths[col] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colHeads.appendChild(filler);\n        this.colResizeHandles.style.left = `${rowHeadWidth}px`;\n        this.colResizeHandles.style.height = `${colHeadHeight}px`;\n        x = -this.HANDLE_SKEW;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            x += colWidths[col] - 1;\n            const handle = this.createHandle(col, x, 0, this.HANDLE_SIZE, colHeadHeight);\n            this.colResizeHandles.appendChild(handle);\n        }\n        x += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colResizeHandles.appendChild(filler);\n    }\n    placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeRowHeads(...)`);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, 0, y, rowHeadWidth, rowHeights[row]);\n            this.rowHeads.appendChild(child);\n            y += rowHeights[row] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowHeads.appendChild(filler);\n        this.rowResizeHandles.style.top = `${colHeadHeight}px`;\n        this.rowResizeHandles.style.width = `${rowHeadWidth}px`;\n        y = -this.HANDLE_SKEW;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            y += rowHeights[row] - 1;\n            const rowHandle = this.createHandle(row, 0, y, rowHeadWidth, this.HANDLE_SIZE);\n            this.rowResizeHandles.appendChild(rowHandle);\n        }\n        y += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}0px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowResizeHandles.appendChild(filler);\n    }\n    placeBody(rowHeadWidth, colHeadHeight) {\n        this.logger.log(`Table::placeBody(...)`);\n        if (this.colHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.colHeads.style.height = `${colHeadHeight - 2}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.colHeads.style.height = `${colHeadHeight}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 1)}px`;\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.rowHeads.style.width = `${rowHeadWidth - 2}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.rowHeads.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 1)}px`;\n            }\n        }\n        --rowHeadWidth;\n        --colHeadHeight;\n        if (this.adapter?.config.seamless) {\n            --rowHeadWidth;\n            --colHeadHeight;\n        }\n        if (rowHeadWidth < 0) {\n            rowHeadWidth = 0;\n        }\n        if (colHeadHeight < 0) {\n            colHeadHeight = 0;\n        }\n        this.body.style.left = `${rowHeadWidth}px`;\n        this.body.style.top = `${colHeadHeight}px`;\n        return { rowHeadWidth, colHeadHeight };\n    }\n    placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeBodyCells(...)`);\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[0];\n                this.setCellSize(child, x, y, colWidths[col], rowHeights[row]);\n                this.body.appendChild(child);\n                x += colWidths[col] - 2 + seam;\n            }\n            y += rowHeights[row] - 2 + seam;\n        }\n    }\n    createHandle(idx, x, y, w, h) {\n        const handle = span();\n        handle.className = \"handle\";\n        handle.style.left = `${x}px`;\n        handle.style.top = `${y}px`;\n        handle.style.width = `${w}px`;\n        handle.style.height = `${h}px`;\n        handle.dataset[\"idx\"] = `${idx}`;\n        handle.onpointerdown = this.handleDown;\n        handle.onpointermove = this.handleMove;\n        handle.onpointerup = this.handleUp;\n        return handle;\n    }\n    handleDown(ev) {\n        ev.preventDefault();\n        this.handle = ev.target;\n        this.handleIndex = parseInt(this.handle.dataset[\"idx\"]) + 1;\n        this.handle.setPointerCapture(ev.pointerId);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            this.deltaHandle = ev.clientX - px2int(this.handle.style.left);\n            this.deltaSplitBody = ev.clientX;\n            this.deltaSplitHead = ev.clientX - px2float(this.body.style.left);\n            const cell = this.colHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientX - px2float(cell.style.width);\n            this.splitVertical(this.handleIndex);\n        }\n        else {\n            this.deltaHandle = ev.clientY - px2float(this.handle.style.top);\n            this.deltaSplitBody = ev.clientY;\n            this.deltaSplitHead = ev.clientY - px2float(this.body.style.top);\n            const cell = this.rowHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientY - px2float(cell.style.height);\n            this.splitHorizontal(this.handleIndex);\n        }\n    }\n    handleMove(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.handle.style.left = `${clientX - this.deltaHandle}px`;\n            this.splitHead.style.left = `${clientX - this.deltaSplitHead}px`;\n            this.splitBody.style.left = `${clientX - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.colHeads.children[h - 1].style.width = `${clientX - this.deltaColumn}px`;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                ;\n                this.body.children[h - 1 + row * h].style.width = `${clientX - this.deltaColumn}px`;\n            }\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.handle.style.top = `${clientY - this.deltaHandle}px`;\n            this.splitHead.style.top = `${clientY - this.deltaSplitHead}px`;\n            this.splitBody.style.top = `${clientY - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.rowHeads.children[h - 1].style.height = `${clientY - this.deltaColumn}px`;\n            let idx = (h - 1) * this.adapter.colCount;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                ;\n                this.body.children[idx + col].style.height = `${clientY - this.deltaColumn}px`;\n            }\n        }\n    }\n    handleUp(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        this.handleMove(ev);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.joinVertical(this.handleIndex, clientX - this.deltaSplitBody);\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.joinHorizontal(this.handleIndex, clientY - this.deltaSplitBody);\n        }\n        this.handle = undefined;\n    }\n    splitVerticalNew(splitCol) {\n        this.logger.log(`Table.splitVerticalNew(splitCol = ${splitCol})`);\n        this.splitHeadVertical(splitCol);\n        this.splitBodyVertical(splitCol);\n    }\n    splitHeadVertical(splitCol) {\n        this.logger.log(`Table.splitHeadVertical(splitCol = ${splitCol})`);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody colHack\";\n        this.splitHead.style.top = `0`;\n        this.splitHead.style.bottom = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitCol;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.left = `0px`;\n            this.splitHead.style.width = `1px`;\n        }\n        else {\n            if (idx < this.colHeads.children.length) {\n                let cell = this.colHeads.children[idx];\n                let width = 0;\n                const left = px2float(cell.style.left);\n                while (idx < this.colHeads.children.length) {\n                    cell = this.colHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    width += b.width - overlap;\n                    let x = px2float(cell.style.left);\n                    cell.style.left = `${x - left}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    width += overlap;\n                }\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.colHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + b.width - overlap;\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `1px`;\n            }\n        }\n        this.colHeads.appendChild(this.splitHead);\n    }\n    splitBodyVertical(splitCol) {\n        this.logger.log(`Table.splitBodyVertical(splitCol=${splitCol})`);\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.top = `0`;\n        this.splitBody.style.bottom = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.left = `0px`;\n            this.splitBody.style.width = `1px`;\n        }\n        else {\n            const previousColCount = this.body.children.length / this.adapter.rowCount;\n            if (splitCol < previousColCount) {\n                let cell = this.body.children[splitCol];\n                const left = px2float(cell.style.left);\n                let width = 0;\n                const colsInBody = this.body.children.length / this.adapter.rowCount;\n                const colsToSplit = colsInBody - splitCol;\n                let idx = splitCol;\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    for (let col = 0; col < colsToSplit; ++col) {\n                        cell = this.body.children[idx];\n                        if (row === 0) {\n                            const b = cell.getBoundingClientRect();\n                            width += b.width - overlap;\n                        }\n                        cell.style.left = `${px2float(cell.style.left) - left}px`;\n                        this.splitBody.appendChild(cell);\n                    }\n                    idx += splitCol;\n                }\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let boundary = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + boundary.width - overlap;\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitVertical(splitColumn, extra = 0) {\n        this.logger.log(`Table::splitVertical(splitColumn=${splitColumn}, extra=${extra})`);\n        if (this.colHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"cols\";\n            this.splitHead.style.left = this.colHeads.style.left;\n            this.splitHead.style.height = this.colHeads.style.height;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.colHeads.scrollTop;\n                this.splitHead.scrollLeft = this.colHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const bodyWidth = splitColumn;\n        const splitBodyColumns = this.adapter.colCount - splitColumn + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyColumns; ++i) {\n                this.splitHead.appendChild(this.colHeads.children[splitColumn]);\n            }\n            this.splitHead.appendChild(this.colHeads.children[this.colHeads.children.length - 1].cloneNode());\n        }\n        let idx = splitColumn;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n            idx += bodyWidth;\n        }\n    }\n    joinVertical(splitCol, delta, extra = 0, colCount, rowCount) {\n        this.logger.log(`Table::joinVertical(splitCol=${splitCol}, delta=${delta}, extra=${extra}, colCount = ${colCount}, rowCount = ${rowCount})`);\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyColumns = colCount - splitCol + extra;\n        let idx = splitCol - extra;\n        if (this.colHeads !== undefined) {\n            const filler = this.colHeads.children[this.colHeads.children.length - 1];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitHead.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.colHeads.insertBefore(cell, filler);\n            }\n            const fillerLeft = filler.style.left;\n            const left = px2float(fillerLeft);\n            filler.style.left = `${left + delta}px`;\n            for (let col = idx; col <= colCount; ++col) {\n                const cell = this.colResizeHandles.children[col];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n            }\n        }\n        for (let row = 0; row < rowCount; ++row) {\n            let beforeChild = this.body.children[idx];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitBody.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.body.insertBefore(cell, beforeChild);\n            }\n            idx += colCount;\n        }\n        if (this.colHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    splitHorizontalNew(splitRow) {\n        this.logger.log(`Table.splitHorizontalNew(splitRow = ${splitRow})`);\n        this.splitHeadHorizontal(splitRow);\n        this.splitBodyHorizontal(splitRow);\n    }\n    splitHeadHorizontal(splitRow) {\n        this.logger.log(`Table.splitHeadHorizontal(splitRow = ${splitRow})`);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody\";\n        this.splitHead.style.left = `0`;\n        this.splitHead.style.right = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitRow;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.top = `0px`;\n            this.splitHead.style.height = `1px`;\n        }\n        else {\n            if (idx < this.rowHeads.children.length) {\n                let cell = this.rowHeads.children[idx];\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.rowHeads.children.length) {\n                    cell = this.rowHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    height += b.height - overlap;\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    height += overlap;\n                }\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `${height}px`;\n            }\n            else {\n                let cell = this.rowHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let top = px2float(cell.style.top) + b.height - overlap;\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `1px`;\n            }\n        }\n        this.rowHeads.appendChild(this.splitHead);\n    }\n    splitBodyHorizontal(splitRow) {\n        this.logger.log(`Table.splitBodyHorizontal(splitRow = ${splitRow})`);\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.left = `0`;\n        this.splitBody.style.right = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        const idx = splitRow * this.adapter.colCount;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.top = `0px`;\n            this.splitBody.style.height = `1px`;\n        }\n        else {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                let col = this.adapter.colCount;\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.body.children.length) {\n                    cell = this.body.children[idx];\n                    --col;\n                    if (col === 0) {\n                        const b = cell.getBoundingClientRect();\n                        height += b.height - overlap;\n                        col = this.adapter.colCount;\n                    }\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitBody.appendChild(cell);\n                }\n                height += overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `${height}px`;\n            }\n            else {\n                let cellAtBottom = this.body.children[this.body.children.length - 1];\n                let b = cellAtBottom.getBoundingClientRect();\n                let top = px2float(cellAtBottom.style.top) + b.height - overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitHorizontal(splitRow, extra = 0, event) {\n        this.logger.log(`Table.splitHorizontal(splitRow = ${splitRow}, extra = ${extra}, event = ...)`);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"rows\";\n            this.splitHead.style.top = this.rowHeads.style.top;\n            this.splitHead.style.width = this.rowHeads.style.width;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.rowHeads.scrollTop;\n                this.splitHead.scrollLeft = this.rowHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.backgroundColor = \"rgba(255,128,0,0.5)\";\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const splitBodyRows = this.adapter.rowCount - splitRow + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyRows; ++i) {\n                this.splitHead.appendChild(this.rowHeads.children[splitRow]);\n            }\n            this.splitHead.appendChild(this.rowHeads.children[this.rowHeads.children.length - 1].cloneNode());\n        }\n        let idx = this.adapter.colCount * splitRow;\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n        }\n        if (this.splitBody.children.length > 0) {\n            idx = this.splitBody.children.length - 1;\n            const last = this.splitBody.children[idx];\n            const top = px2int(last.style.top);\n            for (let i = 0; i < this.splitBody.children.length; ++i) {\n                const c = this.splitBody.children[i];\n                const y = px2int(c.style.top);\n                c.style.top = `${y - top}px`;\n            }\n            this.splitBody.style.backgroundColor = \"#f80\";\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (event !== undefined && this.body.children.length > 0) {\n            idx = event.index * this.adapter.colCount;\n            const last = this.body.children[idx];\n            const top = px2int(last.style.top);\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (this.body.children.length > 0) {\n            const filler = span();\n            idx = this.body.children.length - 2;\n            const last = this.body.children[idx];\n            const bf = this.body.children[idx].getBoundingClientRect();\n            filler.style.border = \"none\";\n            filler.style.backgroundColor = \"#1e1e1e\";\n            const top = px2int(last.style.top) + bf.height;\n            filler.style.top = `${top}px`;\n            filler.style.left = `0px`;\n            filler.style.width = `${b.width - 2}px`;\n            filler.style.height = `${b.height - top}px`;\n            this.splitBody.appendChild(filler);\n        }\n        else {\n        }\n    }\n    joinHorizontal(splitRow, delta, extra = 0, colCount, rowCount) {\n        this.logger.log(`Table. joinHorizontal(splitRow = ${splitRow}, delta = ${delta}, extra = ${extra}, colCount = ${colCount}, rowCount = ${rowCount}`);\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyRows = rowCount - splitRow + extra;\n        if (this.rowHeads !== undefined) {\n            const filler = this.rowHeads.children[this.rowHeads.children.length - 1];\n            for (let row = 0; row < splitBodyRows; ++row) {\n                const cell = this.splitHead.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.rowHeads.insertBefore(cell, filler);\n            }\n            const fillerTop = filler.style.top;\n            const top = px2float(fillerTop);\n            filler.style.top = `${top + delta}px`;\n            let idx = splitRow;\n            for (let row = idx; row <= rowCount; ++row) {\n                const cell = this.rowResizeHandles.children[row];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n            }\n        }\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < colCount; ++col) {\n                const cell = this.splitBody.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.body.appendChild(cell);\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    setHeadingFillerSizeToScrollbarSize() {\n        this.logger.log(`Table.setHeadingFillerSizeToScrollbarSize()`);\n        const bounds = this.body.getBoundingClientRect();\n        if (this.colHeads !== undefined) {\n            const w = Math.ceil(bounds.width - this.body.clientWidth);\n            this.colHeads.children[this.colHeads.children.length - 1].style.width = `${w}px`;\n            this.colHeads.style.right = `${w}px`;\n        }\n        if (this.rowHeads !== undefined) {\n            const h = Math.ceil(bounds.height - this.body.clientHeight);\n            this.rowHeads.children[this.rowHeads.children.length - 1].style.height = `${h}px`;\n            this.rowHeads.style.bottom = `${h}px`;\n        }\n    }\n    clientPosToTablePos(x, y) {\n        let col, row;\n        for (col = 0; col < this.adapter.colCount; ++col) {\n            const b = this.body.children[col].getBoundingClientRect();\n            if (b.x <= x && x < b.x + b.width)\n                break;\n        }\n        if (col >= this.adapter.colCount) {\n            return undefined;\n        }\n        let idx = 0;\n        for (row = 0; row < this.adapter.rowCount; ++row) {\n            const b = this.body.children[idx].getBoundingClientRect();\n            if (b.y <= y && y < b.y + b.height)\n                break;\n            idx += this.adapter.colCount;\n        }\n        if (row >= this.adapter.rowCount) {\n            return undefined;\n        }\n        return new TablePos(col, row);\n    }\n}\nTable.maskColor = `#1e1e1e`;\nTable.splitColor = `#1e1e1e`;\nTable.allTables = new Set();\nTable.loggerType = NullLogger;\nTable.define(\"tx-table\", Table);\n//# sourceMappingURL=Table.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { View } from \"../view/View.js\";\nimport { GenericTool } from \"../view/GenericTool.js\";\nimport { textAreaStyle } from \"../view/textAreaStyle.js\";\nimport { Table } from \"./Table.js\";\nexport class TableTool extends GenericTool {\n    constructor() {\n        super();\n        this.toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonAddRowAbove = _jsx(\"button\", { class: \"left\", title: \"add row above\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"8.5\", x2: \"4.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"8.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"2\", x2: \"6.5\", y2: \"7\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"4.5\", x2: \"9\", y2: \"4.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowAbove.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowAbove);\n        this.buttonAddRowBelow = _jsx(\"button\", { title: \"add row below\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"6\", x2: \"6.5\", y2: \"11\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"8.5\", x2: \"9\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowBelow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowBelow);\n        this.buttonDeleteRow = _jsx(\"button\", { class: \"right\", title: \"delete row\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"5.5\", y1: \"3.5\", x2: \"11.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"11.5\", y1: \"3.5\", x2: \"5.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteRow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.removeRow(selection.row, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteRow);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddColumnLeft = _jsx(\"button\", { class: \"left\", title: \"add column left\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"7\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"4\", x2: \"4.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnLeft.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnLeft);\n        this.buttonAddColumnRight = _jsx(\"button\", { title: \"add column right\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"4.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6\", y1: \"6.5\", x2: \"11\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4\", x2: \"8.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnRight.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnRight);\n        this.buttonDeleteColumn = _jsx(\"button\", { class: \"right\", title: \"delete column\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"5.5\", x2: \"9.5\", y2: \"11.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11.5\", x2: \"9.5\", y2: \"5.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteColumn.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.removeColumn(selection.col, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteColumn);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddNodeAbove = _jsx(\"button\", { class: \"left\", title: \"add node above\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeAbove);\n        this.buttonAddNodeBelow = _jsx(\"button\", { title: \"add node below\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11\", x2: \"3.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"12.5\", x2: \"5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"16\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeBelow);\n        this.buttonAddNodeParent = _jsx(\"button\", { title: \"add node parent\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.buttonAddNodeParent.onclick = () => {\n        };\n        this.toolbar.appendChild(this.buttonAddNodeParent);\n        this.buttonAddNodeChild = _jsx(\"button\", { title: \"add node child\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"11\", x2: \"9.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8\", y1: \"12.5\", x2: \"11\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeChild);\n        this.buttonDeleteNode = _jsx(\"button\", { class: \"right\", title: \"delete node\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 17\", width: \"10\", height: \"17\", children: [_jsx(\"rect\", { x: \"1.5\", y: \"5.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"2\", x2: \"4.5\", y2: \"5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"12\", x2: \"4.5\", y2: \"15\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"0.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.toolbar.appendChild(this.buttonDeleteNode);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [textAreaStyle];\n        this.shadowRoot.appendChild(this.toolbar);\n    }\n    canHandle(view) {\n        return view instanceof Table;\n    }\n    activate() {\n        this.lastActiveTable = GenericTool.activeView;\n        this.toolbar.classList.add(\"active\");\n    }\n    deactivate() {\n        this.lastActiveTable = undefined;\n        this.toolbar.classList.remove(\"active\");\n    }\n}\nView.define(\"tx-tabletool\", TableTool);\nfunction isRowEditInterface(model) {\n    return model !== undefined && 'insertRow' in model && \"removeRow\" in model;\n}\nfunction isColumnEditInterface(model) {\n    return model !== undefined && 'insertColumn' in model && \"removeColumn\" in model;\n}\n//# sourceMappingURL=TableTool.js.map","import { FaceVector } from \"./FaceVector\"\nimport { VertexVector } from \"./VertexVector\"\nimport { DirectoryList, FileType } from \"./DirectoryList\"\nimport { TargetEntry } from \"./TargetEntry\"\nimport { PoseEntry } from \"./PoseEntry\"\nimport { FaceGroup } from \"./FaceGroup\"\nimport { PoseTarget } from \"./PoseTarget\"\nimport { PoseTranslation } from \"./PoseTranslation\"\nimport { PoseRotation, RotateAxis } from \"./PoseRotation\"\nimport { mat4, vec3 } from \"gl-matrix\"\nimport { Signal } from \"toad.js\"\nimport { Target } from \"./Target\"\n\nclass TargetMap extends Map<string, TargetEntry> {}\nclass PoseMap extends Map<string, PoseEntry> {}\n\nenum Mode {\n    MORPH,\n    POSE,\n}\n\n// animorph-0.3/src/Mesh.cpp\nexport class Mesh {\n    changed = new Signal()\n    private dirty = false\n    private poseChanged = false\n    private mode = Mode.MORPH\n\n    private vertexBase = new VertexVector() // vertices as loaded from file\n    private vertexMorphed!: VertexVector // morphed vertices\n    private vertexPosed!: VertexVector // morphed and posed vertices\n\n    // user settings for posing\n    private poses = new BodySettings()\n    private bodyset = new BodySettings()\n\n    // faces\n    facevector = new FaceVector()\n    facegroup = new FaceGroup()\n    targetmap = new TargetMap()\n    posemap = new PoseMap()\n\n    morphMode() {\n        this.mode = Mode.MORPH\n        this.markDirty()\n    }\n    poseMode() {\n        this.initPoses()\n        this.mode = Mode.POSE\n        this.poseChanged = true\n        this.markDirty()\n    }\n    getVertexes(): VertexVector {\n        switch (this.mode) {\n            case Mode.MORPH:\n                return this.vertexMorphed\n            case Mode.POSE:\n                return this.vertexPosed\n        }\n    }\n    clear() {\n        switch (this.mode) {\n            case Mode.MORPH:\n                this.clearMorph()\n                break\n            case Mode.POSE:\n                this.clearPose()\n                break\n        }\n    }\n    clearMorph() {\n        if (this.bodyset.size === 0) {\n            return\n        }\n        this.vertexMorphed.setFrom(this.vertexBase)\n        this.bodyset.clear()\n        this.markDirty()\n    }\n    clearPose() {\n        if (this.poses.size === 0) {\n            return\n        }\n        this.poses.clear()\n        this.poseChanged = true\n        this.markDirty()\n    }\n    private markDirty() {\n        if (this.dirty === false) {\n            this.dirty = true\n            this.changed.trigger()\n        }\n    }\n    update() {\n        this.updatePose()\n        this.dirty = false\n    }\n\n    loadMeshFactory(meshFilename: string, facesFilename: string) {\n        this.vertexBase.load(meshFilename)\n        this.facevector.loadGeometry(facesFilename)\n        this.vertexMorphed = this.vertexBase.clone()\n    }\n    loadGroupsFactory(groups_filename: string) {\n        return this.facegroup.load(groups_filename)\n    }\n    loadTargetsFactory(targetRootPath: string, recursiveLevel = 1, preload = false, clearmap = true) {\n        if (clearmap) {\n            this.targetmap.clear()\n        }\n\n        // reading all the targets recursively\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(targetRootPath)\n        dir_list.setRecursive(recursiveLevel)\n        dir_list.setFileFilter(\".target\")\n\n        const files = dir_list.getDirectoryList()\n        for (const file of files) {\n            const target_name = file.substring(targetRootPath.length + 1)\n            const targetEntry = new TargetEntry(file, preload)\n            this.targetmap.set(target_name, targetEntry)\n        }\n        console.log(`${preload ? \"loaded\" : \"referenced\"} ${files.length} morph targets from ${targetRootPath}/`)\n    }\n    loadPoseTargetsFactory(targetRootPath: string, recursiveLevel = 1) {\n        this.posemap.clear()\n\n        // reading all the targets recursively\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(targetRootPath)\n        dir_list.setRecursive(recursiveLevel)\n        dir_list.setFileType(FileType.DIRECTORY)\n\n        const files = dir_list.getDirectoryList()\n        let counter = 0\n        for (const file of files) {\n            const target_name = file.substring(targetRootPath.length + 1)\n            if (target_name.indexOf(\"/\") === -1) {\n                continue\n            }\n            this.posemap.set(target_name, new PoseEntry(target_name, file, false))\n            ++counter\n        }\n        console.log(`referenced ${counter} pose targets from ${targetRootPath}/`)\n    }\n    // loadCharactersFactory(charactersRootPath: string, recursiveLevel = 1) {\n    //     throw Error(\"not implemented yet\")\n    // }\n\n    //\n    // POSE\n    //\n    private initPoses() {\n        this.vertexPosed = this.vertexMorphed.clone()\n        this.posemap.forEach((poseEntry) => {\n            if (!poseEntry.isLoaded()) {\n                return\n            }\n            const tmp = poseEntry.getTarget()!\n            tmp.calcRotationsCenteroids(this.vertexMorphed)\n            tmp.calcTranslationsFormFactors(this.vertexMorphed)\n            tmp.calcNormalizations()\n        })\n\n        // for (std::vector <SkinVertex>::iterator skin_it = skin.begin ();\n        //     skin_it != skin.end ();\n        //     skin_it++)\n        // {\n        //     SkinVertex &skinVertex = (*skin_it);\n\n        //     Vector3f centeroid(calcCenteroid(skinVertex.getLinkedMuscles(), vertexvector_morph));\n\n        //     Vector3f oriDist = vertexvector_morph[skinVertex.getSkinVertex()].co - centeroid;\n        //     skinVertex.setOriginalDist(oriDist.getMagnitude());\n        // }\n    }\n\n    setPose(target_name: string, morph_value: number) {\n        const poseTarget = this.getPoseTargetForName(target_name)\n        if (poseTarget === undefined) {\n            throw Error(`unknown pose target ${target_name}`)\n        }\n        if (morph_value < poseTarget.getMinAngle()) {\n            morph_value = poseTarget.getMinAngle()\n        }\n        if (morph_value > poseTarget.getMaxAngle()) {\n            morph_value = poseTarget.getMaxAngle()\n        }\n        if (!this.posemap.has(target_name)) {\n            throw new Error(`a pose target with name \"${target_name}\" wasn't found in posemap`)\n        }\n\n        if (morph_value === 0) {\n            if (!this.poses.has(target_name)) {\n                return morph_value\n            }\n            this.poses.delete(target_name)\n        } else {\n            if (this.poses.get(target_name) === morph_value) {\n                return morph_value\n            }\n            this.poses.set(target_name, morph_value)\n        }\n\n        if (this.poseChanged === false) {\n            this.poseChanged = true\n            this.markDirty()\n        }\n        return morph_value\n    }\n    getPose(target_name: string): number {\n        const p = this.poses.get(target_name)\n        return p === undefined ? 0 : p\n    }\n    updatePose() {\n        if (this.poseChanged === false) {\n            return\n        }\n        this.poseChanged = false\n\n        this.vertexPosed!.setFrom(this.vertexMorphed!)\n\n        // Map is not sorted but poses must be applied sorted by target_name\n        ;[...this.poses.keys()].sort().forEach((target_name) => {\n            const poseTarget = this.getPoseTargetForName(target_name)\n            const morph_value = this.poses.get(target_name)!\n            this.doPose(target_name, morph_value, poseTarget!.getModVertex())\n        })\n        // applySkin();\n        // applySmooth(2);\n    }\n\n    getTargetForName(target_name: string): Target | undefined {\n        return this.targetmap.get(target_name)?.getTarget()\n    }\n    getPoseTargetForName(target_name: string): PoseTarget | undefined {\n        const poseEntry = this.posemap.get(target_name)!\n        if (poseEntry === undefined) {\n            return undefined\n        }\n        let target\n        if (!poseEntry.isLoaded()) {\n            target = poseEntry.getTarget()!\n            target.calcRotationsCenteroids(this.vertexMorphed)\n            target.calcTranslationsFormFactors(this.vertexMorphed)\n            target.calcNormalizations()\n        } else {\n            target = poseEntry.getTarget()!\n        }\n        return target\n    }\n\n    doPose(target_name: string, morph_value: number, modVertex: Set<number>) {\n        const cat = \"00\"\n        const poseTarget = this.getPoseTargetForName(target_name)!\n        const rotations = morph_value < 0 ? poseTarget.getNegativeRotations() : poseTarget.getPositiveRotations()\n        const translations =\n            morph_value < 0 ? poseTarget.getNegativeTranslations() : poseTarget.getPositiveTranslations()\n        for (const pt of translations) {\n            if (cat !== pt.getCat()) {\n                throw Error(`not implemented yet`)\n            }\n            this.doPoseTranslation(pt, morph_value, modVertex)\n        }\n        for (const pr of rotations) {\n            this.doPoseRotation(pr, morph_value, modVertex)\n        }\n    }\n    doPoseTranslation(pt: PoseTranslation, morph_value: number, modVertex: Set<number>) {\n        const tmpTarget = pt.getTarget()\n        const formFactor = pt.getFormFactor()\n        let real_value = 0.0\n\n        if (pt.getNormalize()) {\n            if (morph_value < 0) {\n                if (morph_value < pt.getMaxAngle()) {\n                    real_value = Math.max(morph_value, pt.getMinAngle()) - pt.getMaxAngle()\n                }\n            } else {\n                if (morph_value > pt.getMinAngle()) {\n                    real_value = Math.min(morph_value, pt.getMaxAngle()) - pt.getMinAngle()\n                }\n            }\n        } else {\n            real_value = morph_value\n        }\n\n        for (const td of tmpTarget) {\n            if (!modVertex.has(td.vertex_number)) {\n                continue\n            }\n            const co = this.vertexPosed[td.vertex_number].co\n            vec3.add(\n                co,\n                co,\n                vec3.fromValues(\n                    formFactor[0] * td.morph_vector[0] * real_value,\n                    formFactor[1] * td.morph_vector[1] * real_value,\n                    formFactor[2] * td.morph_vector[2] * real_value\n                )\n            )\n        }\n    }\n    doPoseRotation(pr: PoseRotation, morph_value: number, modVertex: Set<number>) {\n        let real_value = 0\n        let rotMatrix = mat4.create()\n\n        if (pr.getNormalize()) {\n            if (morph_value < 0) {\n                if (morph_value < pr.getMaxAngle()) {\n                    real_value = Math.max(morph_value, pr.getMinAngle()) - pr.getMaxAngle()\n                }\n            } else {\n                if (morph_value > pr.getMinAngle()) {\n                    real_value = Math.min(morph_value, pr.getMaxAngle()) - pr.getMinAngle()\n                }\n            }\n        } else {\n            real_value = morph_value\n        }\n\n        const axis = pr.getAxis()\n        const M_PI_180 = Math.PI / 180.0\n\n        for (const td of pr) {\n            if (!modVertex.has(td.vertex_number)) {\n                continue\n            }\n            const theta = real_value * td.rotation * M_PI_180\n            mat4.identity(rotMatrix)\n            switch (axis) {\n                case RotateAxis.X_AXIS:\n                    mat4.rotateX(rotMatrix, rotMatrix, theta)\n                    break\n                case RotateAxis.Y_AXIS:\n                    mat4.rotateY(rotMatrix, rotMatrix, theta)\n                    break\n                case RotateAxis.Z_AXIS:\n                    mat4.rotateZ(rotMatrix, rotMatrix, theta)\n                    break\n            }\n            const co = this.vertexPosed[td.vertex_number].co\n            if (co === undefined) {\n                throw Error()\n            }\n            vec3.sub(co, co, pr.getCenter())\n            vec3.transformMat4(co, co, rotMatrix)\n            vec3.add(co, co, pr.getCenter())\n        }\n    }\n\n    //\n    // MORPH\n    //\n\n    doMorph(target_name: string, morph_value: number) {\n        if (morph_value < 0) {\n            morph_value = 0\n        }\n        if (morph_value > 1) {\n            morph_value = 1\n        }\n\n        if (!this.targetmap.has(target_name)) {\n            throw new Error(`a morph target with name \"${target_name}\" wasn't found in targetmap`)\n        }\n\n        let real_morph_value\n        let bs_morph_value = this.getMorph(target_name)\n        if (morph_value === 0) {\n            real_morph_value = -bs_morph_value\n        } else {\n            real_morph_value = morph_value - bs_morph_value\n        }\n\n        const target = this.getTargetForName(target_name)!\n\n        for (const td of target) {\n            const co = this.vertexMorphed[td.vertex_number].co\n            const mv = vec3.scale(vec3.create(), td.morph_vector, real_morph_value)\n            vec3.add(co, co, mv)\n        }\n\n        if (morph_value === 0) {\n            if (!this.bodyset.has(target_name)) {\n                return morph_value\n            }\n            this.bodyset.delete(target_name)\n        } else {\n            if (this.bodyset.get(target_name) === morph_value) {\n                return morph_value\n            }\n            this.bodyset.set(target_name, morph_value)\n        }\n\n        this.markDirty()\n        return morph_value\n    }\n    getMorph(target_name: string): number {\n        const p = this.bodyset.get(target_name)\n        return p === undefined ? 0 : p\n    }\n}\n\nclass BodySettings extends Map<string, number> {}\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            if (split) {\n                this.b.set(chunk.subarray(0, split), this.s.z);\n                this.s.z = this.b.length;\n                this.p(this.b, false);\n            }\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            if (this.p.length)\n                this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this_1 = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, function (offset) { return _this_1.onmember && _this_1.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.o = StrmOpt.call(this, opts, cb) || {};\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_2 = this;\n                // enables reuse of this method by AsyncDecompress\n                var cb = function () { _this_2.ondata.apply(_this_2, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o, cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o, cb)\n                        : new this.Z(this.o, cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        Decompress.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","import { AbstractFileSystemAdapter } from \"./AbstractFileSystemAdapter\"\nimport { unzlibSync } from \"fflate\"\n\ninterface FileInfo {\n    file: string\n    isDir: boolean\n    dir?: string[]\n}\n\nexport class HTTPFSAdapter implements AbstractFileSystemAdapter {\n    static debug = false\n    static directoryCache = new Map<string, FileInfo>()\n\n    readFile(pathname: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        if (pathname.endsWith(\".z\")) {\n            if (HTTPFSAdapter.debug) {\n                console.log(`load compressed file ${pathname}`)\n            }\n            const req = new XMLHttpRequest()\n            req.overrideMimeType(\"text/plain; charset=x-user-defined\")\n            req.open(\"GET\", `data/${pathname}`, false)\n            req.send(null)\n            if (req.status > 400) {\n                throw new Error(`Request failed for '${pathname}': ${req.statusText}`)\n            }\n            const ab = new ArrayBuffer(req.responseText.length)\n            const ua = new Uint8Array(ab)\n            for (let i = 0; i < req.responseText.length; ++i) {\n                ua[i] = req.responseText.charCodeAt(i)\n            }\n            const dec = new TextDecoder(\"utf-8\")\n            return dec.decode(unzlibSync(ua))\n        }\n        if (pathname.endsWith(\"/directory.json\")) {\n            if (HTTPFSAdapter.debug) {\n                console.log(`load uncompressed file ${pathname}`)\n            }\n            const req = new XMLHttpRequest()\n            req.open(\"GET\", `data/${pathname}`, false)\n            req.send(null)\n            if (req.status < 400) {\n                return req.responseText\n            }\n            throw new Error(`Request failed for '${pathname}': ${req.statusText}`)\n        }\n        return this.readFile(`${pathname}.z`)\n    }\n    exists(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.exits('${pathname}')`)\n        }\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            try {\n                this.listDir(pathname)\n            } catch (e) {\n                return false\n            }\n            info = HTTPFSAdapter.directoryCache.get(pathname)\n        }\n        if (info === undefined) {\n            return false\n        }\n        return true\n    }\n    isFile(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            try {\n                this.listDir(pathname)\n            } catch (e) {\n                throw Error(`HTTPFSAdapter.isFile('${pathname}')\": failed to load directory ${pathname}`)\n            }\n            info = HTTPFSAdapter.directoryCache.get(pathname)\n        }\n        if (info === undefined) {\n            throw Error(`HTTPFSAdapter.isFile('${pathname}'): info === undefined`)\n        }\n        return !info.isDir\n    }\n    isDir(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.isDir('${pathname}')`)\n        }\n        const info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            const slash = pathname.lastIndexOf(\"/\")\n            if (slash >= 0) {\n                const i = HTTPFSAdapter.directoryCache.get(pathname.substring(0, slash))\n                if (i !== undefined) {\n                    if (i.dir?.includes(pathname.substring(slash + 1))) {\n                        return true\n                    }\n                }\n            }\n            throw Error(`HTTPFSAdapter.isFile('${pathname}')`)\n        }\n        return info.isDir\n    }\n    listDir(pathname: string): string[] {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.listDir('${pathname}')`)\n        }\n\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info !== undefined && info.dir !== undefined) {\n            return info.dir\n        }\n\n        if (info === undefined) {\n            info = { file: \"\", isDir: true, dir: undefined }\n        }\n\n        const d = this.readFile(`${pathname}/directory.json`)\n        const j = JSON.parse(d)\n        info.dir = []\n        for (const x of j) {\n            const fullfile = `${pathname}/${x.file}`\n            // console.log(`${pathname}/${x.file}`)\n            info.dir.push(x.file)\n            if (!x.isDir) {\n                HTTPFSAdapter.directoryCache.set(fullfile, { file: x.file, isDir: false })\n            }\n        }\n        HTTPFSAdapter.directoryCache.set(pathname, info)\n        return info.dir\n    }\n    realPath(pathname: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.realPath('${pathname}')`)\n        }\n        // throw Error()\n        return pathname\n    }\n    joinPath(pathname1: string, pathname2: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.joinPath('${pathname1}', '${pathname2}')`)\n        }\n        return `${pathname1}/${pathname2}`\n    }\n}\n","import { mat4 } from 'gl-matrix'\n\nexport abstract class AbstractShader {\n    protected gl: WebGL2RenderingContext\n    protected program: WebGLProgram\n\n    protected vertexPosition: number\n    protected vertexNormal: number\n    protected textureCoord?: number\n\n    projectionMatrix: WebGLUniformLocation\n    protected modelViewMatrix: WebGLUniformLocation\n    protected normalMatrix: WebGLUniformLocation\n\n    constructor(gl: WebGL2RenderingContext, vertexShaderSrc: string, fragmentShaderSrc: string) {\n        const program = gl.createProgram()\n        if (program === null) {\n            throw Error('Unable to create WebGLProgram')\n        }\n        const vertexShader = AbstractShader.compileShader(gl, gl.VERTEX_SHADER, vertexShaderSrc)\n        const fragmentShader = AbstractShader.compileShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSrc)\n        gl.attachShader(program, vertexShader)\n        gl.attachShader(program, fragmentShader)\n        gl.linkProgram(program)\n\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n            throw Error(`Unable to initialize WebGLProgram: ${gl.getProgramInfoLog(program)}`)\n        }\n        this.gl = gl\n        this.program = program\n\n        this.vertexPosition = gl.getAttribLocation(this.program, 'aVertexPosition')\n        this.vertexNormal = gl.getAttribLocation(this.program, 'aVertexNormal')\n\n        this.projectionMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uProjectionMatrix')\n        this.modelViewMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uModelViewMatrix')\n        this.normalMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uNormalMatrix')\n    }\n\n    bind(indices: WebGLBuffer, vertices: WebGLBuffer, normales: WebGLBuffer, texture?: WebGLBuffer) {\n        const numComponents = 3, type = this.gl.FLOAT, normalize = false, stride = 0, offset = 0\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, vertices)\n        this.gl.vertexAttribPointer(this.vertexPosition, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(this.vertexPosition)\n\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, normales)\n        this.gl.vertexAttribPointer(this.vertexNormal, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(this.vertexNormal)\n\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, indices)\n    }\n\n    init(projectionMatrix: mat4, modelViewMatrix: mat4, normalMatrix: mat4) {\n        this.initProgram()\n        this.initProjectionMatrix(projectionMatrix)\n        this.initModelViewMatrix(modelViewMatrix)\n        this.initNormalMatrix(normalMatrix)\n    }\n\n    initProgram() {\n        this.gl.useProgram(this.program)\n    }\n\n    initProjectionMatrix(projectionMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.projectionMatrix, false, projectionMatrix)\n    }\n\n    initModelViewMatrix(modelViewMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.modelViewMatrix, false, modelViewMatrix)\n    }\n\n    initNormalMatrix(normalMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.normalMatrix, false, normalMatrix)\n    }\n\n    static compileShader(gl: WebGL2RenderingContext, type: GLenum, source: string): WebGLShader {\n        const shader = gl.createShader(type)\n        if (shader === null)\n            throw Error('Unable to create WebGLShader')\n        gl.shaderSource(shader, source)\n        gl.compileShader(shader)\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            gl.deleteShader(shader)\n            throw Error(`An error occurred compiling the ${type} WebGLShader: ${gl.getShaderInfoLog(shader)}`)\n        }\n        return shader\n    }\n\n    static getUniformLocation(gl: WebGL2RenderingContext, program: WebGLProgram, name: string): WebGLUniformLocation {\n        const location = gl.getUniformLocation(program, name)\n        if (location === null)\n            throw Error(`Internal Error: Failed to get uniform location for ${name}`)\n        return location\n    }\n}\n\n\n","import { AbstractShader } from './AbstractShader'\n\nexport class RGBAShader extends AbstractShader {\n    protected _color: WebGLUniformLocation\n    constructor(gl: WebGL2RenderingContext) {\n        super(gl, rgbaVertexShaderSrc, rgbaFragmentShaderSrc)\n        this._color = AbstractShader.getUniformLocation(gl, this.program, 'uColor')\n    }\n    // set RGBA color\n    setColor(rgba: number[]) {\n        this.gl.uniform4fv(this._color, rgba)\n    }\n}\nconst rgbaVertexShaderSrc = `\n// this is our input per vertex\nattribute vec4 aVertexPosition;\nattribute vec3 aVertexNormal;\n\n// input for all vertices (uniform for the whole shader program)\nuniform mat4 uNormalMatrix;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uColor;\n\n// data exchanged with other graphic pipeline stages\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n\n  highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n  highp vec3 directionalLightColor = vec3(1, 1, 1);\n  highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));\n\n  highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n\n  highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n  vLighting = ambientLight + (directionalLightColor * directional);\n\n  vColor = uColor;\n}`\nconst rgbaFragmentShaderSrc = `\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\nvoid main(void) {\n  gl_FragColor = vec4(vec3(vColor[0],vColor[1],vColor[2]) * vLighting, vColor[3]);\n}`\n","/*\n *  The TOAD JavaScript/TypeScript GUI Library\n *  Copyright (C) 2018-2023 Mark-Andr Hopf <mhopf@mark13.org>\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\nexport class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value, writable: true });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue, writable: true });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map((a) => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        element.replaceChildren(...this);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\n// https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== \"string\") {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case \"children\":\n                break;\n            case \"action\":\n                ;\n                element.setAction(value);\n                break;\n            case \"model\":\n                ;\n                element.setModel(value);\n                break;\n            case \"class\":\n                element.classList.add(value); // FIXME: value is whitespace separated list\n                break;\n            case \"style\":\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    if (typeof svalue === \"number\") {\n                        svalue = `${svalue}`;\n                    }\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case \"set\":\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element, writable: true });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substring(2), value);\n                }\n                else {\n                    if (typeof value === \"string\" || typeof value === \"number\" || typeof value === \"boolean\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        appendChildren(element, props.children);\n    }\n}\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n// the FunctionConstructor is a hack for <></>\n// actually it would be nice if we could support value objects too, eg. <TableView> instead of <toad-table>\n// export function createElement(name: string, props: JSX.HTMLElementProps, ...children: any): Element\n// export function createElement(name: FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Fragment\n// export function createElement(name: string | FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Element | Fragment {\n// }\n// backward compability\nexport function createElement(nameOrConstructor, props, ...children) {\n    // console.log(`createElement(${nameOrConstructor}, ${JSON.stringify(props)}, ${children}`)\n    // props: remove 'key', add 'children'\n    let key;\n    if (props !== null) {\n        if (\"key\" in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","import { Mesh } from \"animorph/Mesh\"\nimport { Reference } from \"toad.jsx/lib/jsx-runtime\"\n\ninterface RefTypes {\n    details: HTMLElement\n}\nconst refs: RefTypes = {} as any\n\ninterface Tile {\n    targetName?: string\n    img?: HTMLImageElement\n}\nlet tiles: Tile[]\n\nlet selectedJoint: number | undefined = undefined\n\nexport function posesBodyPanel(mesh: Mesh) {\n    mesh.poseMode()\n    const panel: HTMLElement[] = []\n    tiles = new Array<Tile>(poseTargets.length)\n    for (let jointIdx = 1; jointIdx < poseTargets.length; ++jointIdx) {\n        panel.push(createTile(mesh, jointIdx))\n    }\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Poses</div>\n            <div id=\"panel\" style={{ lineHeight: \"0\" }}>\n                {...panel}\n            </div>\n            <div id=\"details\" set={new Reference(refs, \"details\")}></div>\n        </>\n    )\n}\n\nfunction createTile(mesh: Mesh, jointIdx: number): HTMLElement {\n    const target = poseTargets[jointIdx]\n    tiles[jointIdx] = { targetName: target }\n\n    const tileImg = (\n        <img src={`images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}.png`} />\n    ) as HTMLImageElement\n    tiles[jointIdx].img = tileImg\n\n    if (target === undefined) {\n        return tileImg\n    }\n    const title = target.at(4)!.toUpperCase() + target.substring(5).replaceAll(\"_\", \" \")\n    tileImg.title = title\n    tileImg.onpointerenter = () => {\n        tileImg.src = `images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}_over.png`\n    }\n    tileImg.onpointerleave = () => {\n        if (selectedJoint !== jointIdx) {\n            tileImg.src = `images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}.png`\n        }\n    }\n    tileImg.onpointerdown = () => {\n        if (jointIdx < tiles.length) {\n            const details = (\n                <>\n                    <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>{title}</div>\n                </>\n            )\n            mesh.posemap.forEach((poseEntry, name) => {\n                if (name.startsWith(`${tiles[jointIdx].targetName}/`)) {\n                    details.push(createKnob(mesh, name))\n                }\n            })\n            refs.details.replaceChildren(...details)\n            if (selectedJoint !== undefined && selectedJoint !== jointIdx) {\n                tiles[selectedJoint].img!.src = `images/ui/rotations_${selectedJoint.toString().padStart(2, \"0\")}.png`\n            }\n            selectedJoint = jointIdx\n        }\n    }\n    return tileImg\n}\n\n// value changes on: drag left & right / wheel\n// white: default, red: changed\nfunction createKnob(mesh: Mesh, name: string) {\n    const img0 = `images/rot/${name}.png`\n    const img1 = `images/rot/${name}_over.png`\n\n    const detail = (\n        <div style={{ display: \"inline-block\", textAlign: \"center\" }}>\n            <img width=\"64\" height=\"64\" title={name} src={img0} />\n            <div></div>\n        </div>\n    ) as HTMLElement\n\n    let lastValue = 0,\n        downX: number | undefined\n\n    const img = detail.children[0] as HTMLImageElement\n    const txt = detail.children[1] as HTMLDivElement\n    const setValue = (value: number) => {\n        const v = mesh.setPose(name, value)\n        txt.innerText = Math.round(v).toString()\n        if (value !== 0) {\n            txt.style.color = \"#f00\"\n        } else {\n            txt.style.color = \"\"\n        }\n    }\n    setValue(mesh.getPose(name))\n\n    img.onpointerenter = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.src = img1\n    }\n    img.onpointerleave = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.src = img0\n    }\n    img.oncontextmenu = (ev: MouseEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.setPointerCapture(ev.pointerId)\n        switch (ev.button) {\n            case 0:\n                downX = ev.x\n                lastValue = mesh.getPose(name)\n                break\n            case 2:\n                setValue(0)\n                break\n        }\n    }\n    img.onpointerup = (ev: PointerEvent) => {\n        ev.preventDefault()\n        downX = undefined\n    }\n    img.onpointermove = (ev: PointerEvent) => {\n        ev.preventDefault()\n        if (downX !== undefined) {\n            setValue(lastValue! + ev.x - downX)\n        }\n    }\n\n    return detail\n}\n\n// the body pose panel consists of 6x14 tiles\nconst poseTargets: (string | undefined)[] = [\n    undefined,\n    \"260_right_collar\",\n    \"300_head\",\n    \"280_left_collar\",\n    \"070_left_ringfinger_3\",\n    \"067_left_middlefinger_3\",\n    \"064_left_forefinger_3\",\n\n    \"220_right_upper_arm\",\n    \"320_neck\",\n    \"240_left_upper_arm\",\n    \"071_left_ringfinger_2\",\n    \"068_left_middlefinger_2\",\n    \"065_left_forefinger_2\",\n\n    undefined,\n    \"360_torso\",\n    undefined,\n    \"073_left_littlefinger_3\",\n    \"069_left_middlefinger_1\",\n    \"066_left_forefinger_1\",\n\n    \"140_right_lower_arm\",\n    \"380_pivot\",\n    \"160_left_lower_arm\",\n    \"074_left_littlefinger_2\",\n    \"072_left_ringfinger_1\",\n    \"061_left_pollex_3\",\n\n    \"060_right_hand\",\n    undefined,\n    \"080_left_hand\",\n    \"075_left_littlefinger_1\",\n    \"063_left_pollex_1\",\n    \"062_left_pollex_2\",\n\n    \"180_right_upper_leg\",\n    undefined,\n    \"200_left_upper_leg\",\n    \"044_right_forefinger_3\",\n    \"047_right_middlefinger_3\",\n    \"050_right_ringfinger_3\",\n\n    \"100_right_lower_leg\",\n    undefined,\n    \"120_left_lower_leg\",\n    \"045_right_forefinger_2\",\n    \"048_right_middlefinger_2\",\n    \"051_right_ringfinger_2\",\n\n    undefined,\n    undefined,\n    undefined,\n    \"046_right_forefinger_1\",\n    \"049_right_middlefinger_1\",\n    \"053_right_littlefinger_3\",\n\n    \"020_right_foot\",\n    undefined,\n    \"040_left_foot\",\n    \"041_right_pollex_3\",\n    \"052_right_ringfinger_1\",\n    \"054_right_littlefinger_2\",\n\n    undefined,\n    undefined,\n    undefined,\n    \"042_right_pollex_2\",\n    \"043_right_pollex_1\",\n    \"055_right_littlefinger_1\",\n\n    \"002_right_footfinger_4_2\",\n    \"000_right_footfinger_5_2\",\n    \"001_right_footfinger_5_1\",\n    \"022_left_footfinger_5_1\",\n    \"021_left_footfinger_5_2\",\n    \"023_left_footfinger_4_2\",\n\n    \"004_right_footfinger_3_2\",\n    \"005_right_footfinger_3_1\",\n    \"003_right_footfinger_4_1\",\n    \"024_left_footfinger_4_1\",\n    \"026_left_footfinger_3_1\",\n    \"025_left_footfinger_3_2\",\n\n    \"006_right_footfinger_2_2\",\n    \"007_right_footfinger_2_1\",\n    \"009_right_footfinger_1_1\",\n    \"030_left_footfinger_1_1\",\n    \"028_left_footfinger_2_1\",\n    \"027_left_footfinger_2_2\",\n\n    \"008_right_footfinger_1_2\",\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    \"029_left_footfinger_1_2\",\n]\n","import { Mesh } from \"animorph/Mesh\"\nimport { Reference } from \"toad.jsx/lib/jsx-runtime\"\n\ninterface RefTypes {\n    details: HTMLElement\n}\nexport const refs: RefTypes = {} as any\n\ninterface Tile {\n    // title: string\n    targetName?: string\n    img?: HTMLImageElement\n    imgSrc?: string\n    imgSrcOver?: string\n}\nlet tiles: Tile[]\n\nlet selectedTile: number | undefined = undefined\n\nexport function bodyDetailsPanel(mesh: Mesh) {\n    mesh.morphMode()\n    const panel: HTMLElement[] = []\n    tiles = new Array<Tile>(detailTargets.length)\n    for (let tileIdx = 0; tileIdx < detailTargets.length; ++tileIdx) {\n        panel.push(createTile(mesh, tileIdx))\n    }\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Body Details</div>\n            <div id=\"panel\" style={{ lineHeight: \"0\" }}>\n                {...panel}\n            </div>\n            <div id=\"details\" set={new Reference(refs, \"details\")}></div>\n        </>\n    )\n}\n\nfunction createTile(mesh: Mesh, tileIdx: number): HTMLElement {\n    const target = detailTargets[tileIdx]\n    tiles[tileIdx] = { targetName: target }\n    const row = Math.floor(tileIdx / 6)\n    const col = tileIdx % 6\n    let src: string\n    let num\n    if (col < 2) {\n        src = \"body\"\n        num = 1 + col + row * 2\n    } else {\n        if (row < 6) {\n            src = \"face\"\n            num = 1 + col - 2 + row * 4\n        } else {\n            src = \"hands\"\n            num = 1 + col - 2 + (row - 6) * 4\n        }\n    }\n    src = `${src}_${num.toString().padStart(2, \"0\")}`\n    tiles[tileIdx].imgSrc = `images/ui/${src}.png`\n    tiles[tileIdx].imgSrcOver = `images/ui/${src}_over.png`\n\n    const tileImg = (<img src={tiles[tileIdx].imgSrc} />) as HTMLImageElement\n    const name = detailTargets[tileIdx]\n    if (name !== undefined) {\n        const title = name.at(0)!.toUpperCase() + name.substring(1).replace(\"_\", \" \")\n        tileImg.title = title\n        tileImg.onpointerenter = () => {\n            tileImg.src = tiles[tileIdx].imgSrcOver!\n        }\n        tileImg.onpointerleave = () => {\n            if (selectedTile !== tileIdx) {\n                tileImg.src = tiles[tileIdx].imgSrc!\n            }\n        }\n        tileImg.onpointerdown = () => {\n            const details = (\n                <>\n                    <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>{title}</div>\n                </>\n            )\n            mesh.targetmap.forEach((targetEntry, name) => {\n                if (name.startsWith(`${tiles[tileIdx].targetName}/`)) {\n                    details.push(createKnob(mesh, name))\n                }\n            })\n            refs.details.replaceChildren(...details)\n\n            if (selectedTile !== undefined && selectedTile !== tileIdx) {\n                tiles[selectedTile].img!.src = tiles[selectedTile].imgSrc!\n            }\n            selectedTile = tileIdx\n        }\n    }\n    tiles[tileIdx].img = tileImg\n    return tileImg\n}\n\nfunction createKnob(mesh: Mesh, name: string) {\n    const imgSrc = `images/target/${name.substring(0, name.length - 7)}.png`\n\n    const detail = (\n        <div style={{ display: \"inline-block\", textAlign: \"center\" }}>\n            <img width=\"64\" height=\"64\" title={name} src={imgSrc} />\n            <div></div>\n        </div>\n    ) as HTMLElement\n\n    let lastValue = 0,\n        downX: number | undefined\n\n    const img = detail.children[0] as HTMLImageElement\n    const txt = detail.children[1] as HTMLDivElement\n    const setValue = (value: number) => {\n        value /= 100.0\n        const v = mesh.doMorph(name, value)\n        txt.innerText = v.toPrecision(2)\n        if (isZero(value)) {\n            value = 0\n        }\n        if (isEqual(value, 1)) {\n            value = 1\n        }\n        if (v !== 0) {\n            txt.style.color = \"#f00\"\n        } else {\n            txt.style.color = \"\"\n        }\n    }\n    setValue(mesh.getMorph(name) * 100)\n\n    img.onpointerenter = (ev: PointerEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerleave = (ev: PointerEvent) => {\n        ev.preventDefault()\n    }\n    img.oncontextmenu = (ev: MouseEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.setPointerCapture(ev.pointerId)\n        switch (ev.button) {\n            case 0:\n                lastValue = mesh.getMorph(name) * 100\n                downX = ev.x\n                break\n            case 2:\n                setValue(0)\n                break\n        }\n    }\n    img.onpointerup = (ev: PointerEvent) => {\n        ev.preventDefault()\n        downX = undefined\n    }\n    img.onpointermove = (ev: PointerEvent) => {\n        ev.preventDefault()\n        if (downX !== undefined) {\n            setValue(lastValue! + ev.x - downX)\n        }\n    }\n\n    return detail\n}\n\nconst epsilon = 0.00001\n\nfunction isZero(a: number): boolean {\n    return Math.abs(a) <= epsilon\n}\nfunction isEqual(a: number, b: number) {\n    return isZero(a - b)\n}\n\n// prettier-ignore\nconst detailTargets: (string | undefined)[] = [\n    \"torso\", \"head\", undefined, undefined, undefined, undefined, \n    \"shoulders\", \"neck\", undefined, \"forehead\", undefined, undefined,\n    \"upper_arms\", undefined, undefined, \"eyes\", undefined, undefined,\n    \"lower_arms\", \"abdomen\", \"nose\", \"cheek\", \"ears\", undefined,\n    \"hands\", \"pelvis\", \"mouth\", undefined, undefined, undefined,\n    \"upper_legs\", undefined, \"chin_jaw\", undefined, undefined, undefined,\n    undefined, undefined, \"forefinger\", \"middlefinger\", \"ringfinger\", undefined,\n    \"lower_legs\", undefined, \"pollex\", undefined, \"littlefinger\", undefined,\n    \"feet\", undefined, undefined, undefined, undefined, undefined\n]\n","import { Mesh } from \"animorph/Mesh\"\nimport { SelectorListener } from \"SelectorListener\"\nimport { Selector } from \"Selector\"\n\nfunction createSelectorView(listener: SelectorListener, selector: Selector, name: string) {\n    const view = (\n        <div style={{ position: \"relative\" }}>\n            <div\n                style={{\n                    pointerEvents: \"none\",\n                    position: \"absolute\",\n                    left: `${selector.cursorPos.x - 3}px`,\n                    top: `${104 - selector.cursorPos.y - 3}px`,\n                    width: \"6px\",\n                    height: \"6px\",\n                    border: \"0\",\n                    background: \"#f00\",\n                }}\n            ></div>\n            <img src={`images/ui/${name}_selector.png`} />\n        </div>\n    ) as HTMLDivElement\n    const caret = view.children[0] as HTMLDivElement\n    const set = (ev: PointerEvent) => {\n        selector.setCursorPos(ev.offsetX, 104 - ev.offsetY)\n        caret.style.left = `${selector.cursorPos.x - 3}px`\n        caret.style.top = `${104 - selector.cursorPos.y - 3}px`\n        listener.calcWidgetTargets()\n    }\n    view.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        view.setPointerCapture(ev.pointerId)\n        set(ev)\n    }\n    view.onpointermove = (ev: PointerEvent) => {\n        if (ev.buttons !== 0) {\n            set(ev)\n        }\n    }\n    return view\n}\n\nexport function characterPanel(mesh: Mesh, mgr: SelectorListener) {\n    mesh.morphMode()\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Character</div>\n            {createSelectorView(mgr, mgr.age, \"age\")}\n            {createSelectorView(mgr, mgr.muscleSize, \"muscle_size\")}\n            {createSelectorView(mgr, mgr.breast, \"breast\")}\n            {createSelectorView(mgr, mgr.shape, \"shape\")}\n        </>\n    )\n}\n","import { posesBodyPanel } from \"PosePanel\"\nimport { Mesh } from \"animorph/Mesh\"\nimport { bodyDetailsPanel } from \"DetailPanel\"\nimport { Fragment, Reference } from \"toad.jsx/lib/jsx-runtime\"\nimport { characterPanel } from \"CharacterPanel\"\nimport { SelectorListener } from \"SelectorListener\"\n\ninterface RefTypes {\n    panel: HTMLDivElement\n}\nconst refs: RefTypes = {} as any\n\nenum TAB {\n    LOAD,\n    SAVE,\n    CHARACTER,\n    DETAILS,\n    POSE,\n}\n\ninterface ToolDef {\n    id: TAB\n    file: string\n    desc: string\n    img?: HTMLImageElement\n    render?: (mesh: Mesh, mgr: SelectorListener) => Fragment\n}\n\nconst toolbarDefinition: ToolDef[] = [\n    { id: TAB.LOAD, file: \"load\", desc: \"Load body setting\" },\n    { id: TAB.SAVE, file: \"save\", desc: \"Save body setting\" },\n    {\n        id: TAB.CHARACTER,\n        file: \"charac_sett\",\n        desc: \"Character setting (somatypes, shapes, age, etc...)\",\n        render: (mesh: Mesh, mgr: SelectorListener) => characterPanel(mesh, mgr),\n    },\n    {\n        id: TAB.DETAILS,\n        file: \"body_det_real\",\n        desc: \"Body details (realistic morphings)\",\n        render: (mesh: Mesh) => bodyDetailsPanel(mesh),\n    },\n    { id: TAB.POSE, file: \"poses\", desc: \"Reset mesh\", render: (mesh: Mesh) => posesBodyPanel(mesh) },\n]\n\nlet activeTab: ToolDef | undefined\nfunction setTab(mesh: Mesh, mgr: SelectorListener, tab: ToolDef) {\n    if (activeTab) {\n        activeTab.img!.src = `images/ui/toolbar_${activeTab.file}.png`\n    }\n    activeTab = tab\n    activeTab.img!.src = `images/ui/toolbar_${activeTab.file}_over.png`\n    if (tab.render !== undefined) {\n        refs.panel.replaceChildren(...tab.render(mesh, mgr))\n    } else {\n        refs.panel.replaceChildren()\n    }\n}\n\nfunction toolbarPanel(mesh: Mesh, mgr: SelectorListener): HTMLElement[] {\n    return toolbarDefinition.map((it) => {\n        const img = (<img src={`images/ui/toolbar_${it.file}.png`} title={it.desc} />) as HTMLImageElement\n        it.img = img\n        img.onpointerenter = () => {\n            img.src = `images/ui/toolbar_${it.file}_over.png`\n        }\n        img.onpointerleave = () => {\n            if (it !== activeTab) {\n                img.src = `images/ui/toolbar_${it.file}.png`\n            }\n        }\n        img.onpointerdown = () => {\n            setTab(mesh, mgr, it)\n        }\n        return img\n    })\n}\n\nexport default (mesh: Mesh, mgr: SelectorListener) => {\n    const page = (\n        <>\n            <div\n                style={{\n                    position: \"absolute\",\n                    display: \"block\",\n                    left: \"0\",\n                    top: \"0\",\n                    bottom: \"0\",\n                    width: \"192px\",\n                }}\n            >\n                <div id=\"toolbar\" style={{ lineHeight: \"0\" }}>\n                    {...toolbarPanel(mesh, mgr)}\n                    <img src=\"images/ui/toolbar_reset.png\" title=\"Reset mesh\" onpointerdown={() => mesh.clear()} />\n                </div>\n                <div set={new Reference(refs, \"panel\")}></div>\n            </div>\n            <div\n                style={{\n                    position: \"absolute\",\n                    left: \"192px\",\n                    top: \"0px\",\n                    bottom: \"0px\",\n                    right: \"0px\",\n                }}\n            >\n                <canvas\n                    style={{\n                        width: \"100%\",\n                        height: \"100%\",\n                    }}\n                />\n            </div>\n        </>\n    ) as Fragment\n\n    setTab(mesh, mgr, toolbarDefinition[2])\n\n    return page\n}\n","import { Point } from \"Point\"\n\nexport class Selector {\n    height = 104;\n    width = 192;\n    cursorPos: Point = { x: 96/2, y: 54 };\n    rows: number\n    cols: number\n    maxValue: number\n    cellRatio: number\n    points: Point[] = [];\n    labels: string[]\n    private dists?: number[]\n\n    constructor(rows: number, cols: number, labels: string[]) {\n        this.rows = rows\n        this.cols = cols\n        this.labels = labels\n\n        const cellWidth = this.width / (cols - 1)\n        const cellHeight = this.height / (rows - 1)\n        this.cellRatio = cellWidth / cellHeight\n        this.maxValue = Math.min(cellWidth, cellHeight * this.cellRatio)\n\n        for (let i = 0; i < rows; ++i) {\n            for (let j = 0; j < cols; ++j) {\n                this.points.push({\n                    x: j * cellWidth,\n                    y: i * cellHeight,\n                })\n            }\n        }\n    }\n    setCursorPos(x: number, y: number) {\n        this.dists = undefined\n        x = Math.max(Math.min(x, this.width), 0)\n        y = Math.max(Math.min(y, this.height), 0)\n        this.cursorPos.x = x\n        this.cursorPos.y = y\n    }\n    getDists() {\n        if (this.dists !== undefined) {\n            return this.dists\n        }\n        this.dists = []\n        \n        let x = this.cursorPos.x, y = this.cursorPos.y\n\n        for (const tmp of this.points) {\n            const dist = Math.sqrt(\n                Math.pow(tmp.x - x, 2) + Math.pow((tmp.y - y) * this.cellRatio, 2)\n            )\n            const value = 1 - dist / this.maxValue\n            if (value > 0) {\n                this.dists.push(value)\n            } else {\n                this.dists.push(0)\n            }\n        }\n        return this.dists\n    }\n}\n","import { Selector } from \"Selector\"\nimport { Mesh } from \"animorph/Mesh\"\n\nexport class SelectorListener {\n    mesh: Mesh\n\n    age: Selector\n    muscleSize: Selector\n    breast: Selector\n    shape: Selector\n\n    constructor(mesh: Mesh) {\n        this.mesh = mesh\n\n        // prettier-ignore\n        this.age = new Selector(2, 5, [\n            \"female_10\", \"female_30\", \"female_50\", \"female_70\", \"female_90\",\n            \"male_10\", \"male_30\", \"male_50\", \"male_70\", \"male_90\"\n        ])\n        // prettier-ignore\n        this.muscleSize = new Selector(2, 2, [\n            \"skinny_nomuscle\", \"big_nomuscle\",\n            \"skinny_muscle\", \"big_muscle\"\n        ])\n        // prettier-ignore\n        this.breast = new Selector(2, 2, [\n            \"cone_little\", \"cone_big\",\n            \"sphere_little\", \"sphere_big\"\n        ])\n        this.breast.setCursorPos(96, 54)\n        // prettier-ignore\n        this.shape = new Selector(2, 2, [\n            \"brevilinear_vshape\", \"brevilinear_peershape\",\n            \"longilinear_vshape\", \"longilinear_peershape\"\n        ])\n        // this.calcWidgetTargets() // FIXME: when called here, UI stops working\n    }\n\n    doMorph(target_name: string, morph_value: number) {\n        this.mesh.doMorph(target_name, morph_value)\n    }\n\n    calcWidgetTargets() {\n        const ageDists = this.age.getDists()\n        const muscleSizeDists = this.muscleSize.getDists()\n        const breastDists = this.breast.getDists()\n        const shapeDists = this.shape.getDists()\n\n        let i: number, j: number, k: number\n\n        i = 0\n        for (const di_it of ageDists) {\n            if (i < this.age.labels.length) {\n                const tmpTargetName = `ages/${this.age.labels[i++]}.target`\n                this.doMorph(tmpTargetName, di_it)\n            }\n        }\n\n        j = 0\n        for (const ms_it of muscleSizeDists) {\n            i = 0\n            for (const di_it of ageDists) {\n                if (j < this.muscleSize.labels.length && i < this.age.labels.length) {\n                    const tmpTargetName = `muscleSize/${this.age.labels[i]}_${this.muscleSize.labels[j]}.target`\n                    const tmpTargetValue = di_it * ms_it\n                    this.doMorph(tmpTargetName, tmpTargetValue)\n                }\n                k = 0\n                if (i <= 4) {\n                    for (const br_it of breastDists) {\n                        if (k < this.breast.labels.length) {\n                            const tmpTargetName = `breast/${this.age.labels[i]}_${this.muscleSize.labels[j]}_${this.breast.labels[k]}.target`\n                            const tmpTargetValue = di_it * ms_it * br_it\n                            this.doMorph(tmpTargetName, tmpTargetValue)\n                        }\n                        ++k\n                    }\n                }\n                ++i\n            }\n            ++j\n        }\n\n        i = 0\n        for (const sh_it of shapeDists) {\n            if (i < this.shape.labels.length) {\n                const tmpTargetName = `shapes/${this.shape.labels[i++]}.target`\n                this.doMorph(tmpTargetName, sh_it)\n            }\n        }\n    }\n}\n","import { RenderMesh } from \"gl/RenderMesh\"\nimport { Mesh } from \"./animorph/Mesh\"\nimport { FileSystemAdapter } from \"./filesystem/FileSystemAdapter\"\nimport { HTTPFSAdapter } from \"./filesystem/HTTPFSAdapter\"\nimport { RGBAShader } from \"gl/shader/RGBAShader\"\nimport {\n    createModelViewMatrix,\n    createNormalMatrix,\n    createProjectionMatrix,\n    adjustCanvasSize,\n    prepareViewport,\n} from \"gl/util\"\nimport screen from \"./screen\"\nimport { SelectorListener } from \"SelectorListener\"\n\nexport function main() {\n    console.log(`mh091rc1a (Makehuman 0.9.1-rc1a clone)`)\n    FileSystemAdapter.setInstance(new HTTPFSAdapter())\n\n    const mesh = new Mesh()\n    mesh.loadMeshFactory(\"base.vertices\", \"base.faces\")\n    // mesh.loadMaterialFactory(\"base.materials\", \"base.colors\")\n    // TextureVector texturevector = mesh.getTextureVectorRef()\n    // texturevector.load(\"base.uv\")\n    mesh.loadGroupsFactory(\"base.parts\")\n    // mesh.loadSubdGroupsFactory(\"subd.parts\")\n    // mesh.loadSkinFactory(\"base.skin\") // muscles? file is empty\n    // mesh.loadClothesFactory(\"base.clothes\")\n    // mesh.loadEdgeStripFactory(\"base.strips\")\n    // mesh.loadSmoothVertexFactory(\"base.smooth\")\n    // mesh.loadSubdFactory(\"base.subde\", \"base.subdo\", \"base.subdf\")\n\n    mesh.loadTargetsFactory(\"targets\")\n    mesh.loadTargetsFactory(\"selectors\", 1, true, false)\n    mesh.loadPoseTargetsFactory(\"rotations\")\n    // mesh.loadCharactersFactory(\"bs_data\")\n\n    const mgr = new SelectorListener(mesh)\n    mgr.calcWidgetTargets()\n\n    // console.log(\"init poses\")\n    // mesh.initPoses()\n\n    // console.log(mesh)\n\n    // console.log(\"set pose\")\n    // mesh.setPose(\"020_right_foot/ROT1\", 60)\n    // mesh.setPose(\"040_left_foot/ROT1\", 60)\n    // mesh.setPose(\"180_right_upper_leg/ROT_BASE1\", 70)\n    // mesh.doMorph(\"pelvis/genital_male_foreskin.target\", 1)\n    // mesh.setPose(\"180_right_upper_leg/ROT_BASE2\", 145);\n    // mesh.update()\n\n    // console.log(\"render\")\n    document.body.style.overflow = \"hidden\"\n    document.body.style.margin = \"0\"\n    document.body.style.padding = \"0\"\n    document.body.replaceChildren(...screen(mesh, mgr))\n\n    mesh.update()\n\n    const canvas = document.body.querySelector(\"canvas\") as HTMLCanvasElement\n    renderMesh(canvas, mesh)\n}\n\ninterface FG {\n    offset: number\n    length: number\n}\n\n// makehuman-0.9.1-rc1a/src/makehuman.cpp, line 923\nfunction renderMesh(canvas: HTMLCanvasElement, mesh: Mesh) {\n    // STEP 1: convert mesh.vertexvector_morph to Float32Array\n    const vertex: number[] = []\n    for (const v of mesh.getVertexes()) {\n        vertex.push(v.co[0], v.co[1], v.co[2])\n    }\n\n    // STEP 2: created faces and as they are a mix of triangles and quads, convert them to triangles\n    const fvertex: number[] = []\n    const faceGroups = new Map<string, FG>()\n    mesh.facegroup.forEach((group, name) => {\n        const offset = fvertex.length\n        for (const faceIdx of group.facesIndexes) {\n            const foo = mesh.facevector[faceIdx]\n            if (foo === undefined) {\n                // FIXME: load creates bogus last entry\n                continue\n            }\n            const face = mesh.facevector[faceIdx].vertices\n            switch (face.length) {\n                case 3:\n                    fvertex.push(...face)\n                    break\n                case 4:\n                    fvertex.push(face[0], face[1], face[2], face[0], face[2], face[3])\n                    break\n                default:\n                    console.log(`skipping face with ${face.length} edges`)\n            }\n        }\n        const length = fvertex.length - offset\n        faceGroups.set(name, { offset: offset, length: length })\n    })\n\n    const gl = (canvas.getContext(\"webgl2\") || canvas.getContext(\"experimental-webgl\")) as WebGL2RenderingContext\n    if (gl == null) {\n        throw Error(\"Unable to initialize WebGL. Your browser or machine may not support it.\")\n    }\n\n    const renderMesh = new RenderMesh(gl, new Float32Array(vertex), fvertex, undefined, undefined, false)\n\n    const programRGBA = new RGBAShader(gl)\n    programRGBA.initProgram()\n\n    renderMesh.bind(programRGBA)\n\n    // flip image pixels into the bottom-to-top order that WebGL expects.\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true)\n    gl.enable(gl.CULL_FACE)\n    gl.cullFace(gl.BACK)\n\n    let lastX = 0,\n        lastY = 0\n\n    const paint = () => {\n        adjustCanvasSize(canvas)\n        const projectionMatrix = createProjectionMatrix(canvas)\n        const modelViewMatrix = createModelViewMatrix(lastX, lastY)\n        const normalMatrix = createNormalMatrix(modelViewMatrix)\n        programRGBA.initModelViewMatrix(modelViewMatrix)\n        programRGBA.initNormalMatrix(normalMatrix)\n        programRGBA.initProjectionMatrix(projectionMatrix)\n        prepareViewport(gl, canvas)\n\n        faceGroups.forEach((group, name) => {\n            switch (name) {\n                case \"body\":\n                case \"head\":\n                    programRGBA.setColor([1, 0.8, 0.7, 1])\n                    break\n                case \"teeth\":\n                    programRGBA.setColor([1, 1, 1, 1])\n                    break\n                case \"tongue\":\n                case \"gums\":\n                    programRGBA.setColor([1, 0, 0, 1])\n                    break\n                case \"eyes\": // the white in the eyes\n                    programRGBA.setColor([1, 1, 1, 1])\n                    break\n                case \"zcornea\": // the cornea in the eyes\n                    programRGBA.setColor([0, 0, 0, 1])\n                    break\n                case \"zeyebrows\":\n                case \"zeyelashes\":\n                    programRGBA.setColor([0, 0, 0, 1])\n                    break\n                default:\n                    console.log(name)\n                    programRGBA.setColor([1, 0, 0, 1])\n            }\n            renderMesh.drawSubset(gl.TRIANGLES, group.offset, group.length)\n        })\n    }\n    paint()\n\n    mesh.changed.add(() => {\n        requestAnimationFrame(() => {\n            mesh.update()\n            const vertex: number[] = []\n            for (const v of mesh.getVertexes()) {\n                vertex.push(v.co[0], v.co[1], v.co[2])\n            }\n            renderMesh.update(new Float32Array(vertex))\n            paint()\n        })\n    })\n\n    new ResizeObserver(paint).observe(canvas)\n    let downX = 0,\n        downY = 0,\n        buttonDown = false\n    canvas.onpointerdown = (ev: PointerEvent) => {\n        canvas.setPointerCapture(ev.pointerId)\n        buttonDown = true\n        // console.log(ev)\n        lastX = downX = ev.x\n        lastY = downY = ev.y\n    }\n    canvas.onpointerup = (ev: PointerEvent) => {\n        buttonDown = false\n    }\n    canvas.onpointermove = (ev: PointerEvent) => {\n        if (buttonDown) {\n            const x = ev.x - downX\n            const y = ev.y - downY\n            if (x !== lastX || y !== lastY) {\n                lastX = x\n                lastY = y\n                requestAnimationFrame(() => paint())\n            }\n        }\n    }\n}\n\ntry {\n    main()\n} catch (e) {\n    console.log(e)\n}\n","import { mat4 } from \"gl-matrix\"\n\nexport function adjustCanvasSize(canvas: HTMLCanvasElement) {\n    if (canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight) {\n        canvas.width = canvas.clientWidth\n        canvas.height = canvas.clientHeight\n    }\n}\n\nexport function prepareViewport(gl: WebGL2RenderingContext, canvas: HTMLCanvasElement) {\n    gl.viewport(0, 0, canvas.width, canvas.height)\n    gl.clearColor(0, 0, 0, 1)\n    gl.clearDepth(1)\n    gl.enable(gl.DEPTH_TEST)\n    gl.depthFunc(gl.LEQUAL)\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n    gl.depthMask(true)\n}\n\nexport function createModelViewMatrix(x: number, y: number) {\n    const D = 180 / Math.PI\n    const modelViewMatrix = mat4.create()\n    mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0, -25])\n    mat4.rotateX(modelViewMatrix, modelViewMatrix, y / D)\n    mat4.rotateY(modelViewMatrix, modelViewMatrix, x / D)\n    return modelViewMatrix\n}\n\nexport function createProjectionMatrix(canvas: HTMLCanvasElement) {\n    const fieldOfView = (45 * Math.PI) / 180 // in radians\n    const aspect = canvas.width / canvas.height\n    const zNear = 0.1\n    const zFar = 100\n    const projectionMatrix = mat4.create()\n    mat4.perspective(projectionMatrix, fieldOfView, aspect, zNear, zFar)\n    return projectionMatrix\n}\n\nexport function createNormalMatrix(modelViewMatrix: mat4) {\n    const normalMatrix = mat4.create()\n    mat4.invert(normalMatrix, modelViewMatrix)\n    mat4.transpose(normalMatrix, normalMatrix)\n    return normalMatrix\n}\n//\n// Initialize a texture and load an image.\n// When the image finished loading copy it into the texture.\n//\nexport function loadTexture(gl: WebGLRenderingContext, url: string) {\n    const texture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n\n    // Because images have to be downloaded over the internet\n    // they might take a moment until they are ready.\n    // Until then put a single pixel in the texture so we can\n    // use it immediately. When the image has finished downloading\n    // we'll update the texture with the contents of the image.\n    const level = 0\n    const internalFormat = gl.RGBA\n    const width = 1\n    const height = 1\n    const border = 0\n    const srcFormat = gl.RGBA\n    const srcType = gl.UNSIGNED_BYTE\n    const pixel = new Uint8Array([0, 0, 255, 255]) // opaque blue\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, width, height, border, srcFormat, srcType, pixel)\n\n    const image = new Image()\n    image.onload = () => {\n        console.log(`texture \"${url}\" has been loaded`)\n        gl.bindTexture(gl.TEXTURE_2D, texture)\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, srcFormat, srcType, image)\n\n        // WebGL1 has different requirements for power of 2 images\n        // vs non power of 2 images so check if the image is a\n        // power of 2 in both dimensions.\n        if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n            // Yes, it's a power of 2. Generate mips.\n            gl.generateMipmap(gl.TEXTURE_2D)\n        } else {\n            // No, it's not a power of 2. Turn off mips and set\n            // wrapping to clamp to edge\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n        }\n    }\n    image.src = url\n\n    return texture\n}\nfunction isPowerOf2(value: number) {\n    return (value & (value - 1)) === 0\n}\n"],"names":["ARRAY_TYPE","Float32Array","Array","create","out","glMatrix.ARRAY_TYPE","rotateX","a","rad","s","Math","sin","c","cos","a10","a11","a12","a13","a20","a21","a22","a23","rotateY","a00","a01","a02","a03","rotateZ","hypot","y","i","arguments","length","sqrt","perspective","fovy","aspect","near","far","nf","f","tan","Infinity","fromValues","x","z","add","b","subtract","scale","normalize","len","cross","ax","ay","az","bx","by","bz","transformMat4","m","w","RecursiveLevel","FileType","RotateAxis","sub","calculateNormalsQuads","normals","vertex","indices","addNormal","index","normal","i1","i2","i3","i4","p1","vec3.fromValues","p2","p3","u","vec3.create","v","n","vec3.subtract","vec3.cross","vec3.normalize","normalIndex","calculateNormalsTriangles","RenderMesh","constructor","gl","fvertex","uvs","fuvs","quads","this","glIndices","createBuffer","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","Uint16Array","glVertex","ARRAY_BUFFER","glNormal","glData","xyz","fxyz","uv","fuv","undefined","Error","uvOut","idxExtra","xyzOutExtra","uvOutExtra","getIndex","decoupleXYZandUV","idxXYZ","xyzIdx","uvIdx","newIdxXYZ","idxXYZIn","push","i0","texcoord","set","glTexture","forEach","update","updateBuffer","draw","programInfo","mode","bind","drawElements","UNSIGNED_SHORT","drawSubset","offset","target","usage","type","data","buffer","bindBuffer","Int16Array","bufferData","Face","size","vertices","v0","v1","v2","v3","material_index","no","FileSystemAdapter","setInstance","instance","readFile","pathname","exists","isFile","isDir","listDir","realPath","joinPath","pathname1","pathname2","StringToLineIterator","next","value","done","nextIndex","indexOf","result","substr","StringToLine","Symbol","iterator","FaceVector","loadGeometry","filename","reader","triangles","line","trim","tokens","split","parseFloat","console","log","Vertex","xOrVertex","co","VertexVector","load","clone","setFrom","src","DirectoryList","file_list","file_filter","path","recursive_level","recursive_counter","file_type","REGULAR_FILE","setFileFilter","setRecursive","setRootPath","setFileType","getDirectoryList","readDirRecursive","dir_str","dname","charAt","dir_file","DIRECTORY","NO_LIMIT","hasFileFilterEnding","file","endsWith","UnsortedUsedVertex","Target","modVertex","td","vertex_number","parseInt","morph_vector","getModVertex","TargetEntry","preload","mTarget","mTargetLoadTry","mFilename","loadFromFile","getTarget","PoseRotation","hasCenter","minAngle","maxAngle","cat","clear","info","map","it","str","minMax","rotation","axis","X_AXIS","Y_AXIS","Z_AXIS","centerVertexNumbers","getCenterVertexNumbers","getCenter","center","setCenter","getAxis","getHasCenter","setHasCenter","getMinAngle","getMaxAngle","getNormalize","setNormalize","inNormalize","getCat","setCat","inCat","setLimb","limb","mbLimb","getLimb","MultiSet","order","array","entries","last","eraseLast","first","eraseFirst","splice","insert","k","firstIndex","lastIndex","middleIndex","floor","PoseTranslation","formFactor","inFilename","originalSize","calcFormFactor","vertexvector","minXSet","maxXSet","minYSet","maxYSet","minZSet","maxZSet","counter","n_vertex","tmpTarget","FF_VERTEX_N","minX","maxX","minY","maxY","minZ","maxZ","xsize","ysize","zsize","getFormFactor","getFilename","calcCenteroid","vertexNumbers","vn","vec3.add","vec3.scale","PoseTarget","targetName","fullpath","positiveTranslations","negativeTranslations","positiveRotations","negativeRotations","negative","positive","normalizationInited","Set","fullPath","dir_list","files","target_name","substring","tmpRotation","idx","min","max","tmpTranslation","calcRotationsCenteroids","rotations","rotations_it","calcTranslationsFormFactors","translations","translations_it","calcNormalizations","hasNegative","hasPositive","getPositiveTranslations","getNegativeTranslations","getPositiveRotations","getNegativeRotations","PoseEntry","mFullPath","isLoaded","FaceGroup","Map","loaded","vertexes","fgroup_indent","content","ch","visible","facesIndexes","jsx","nameOrConstructor","props","key","children","jsxs","namespace","name","tag","document","createElementNS","setInitialProperties","element","Object","setAction","setModel","classList","skey","svalue","regex","replace","upperCase","toLowerCase","style","setProperty","defineProperty","object","attribute","addEventListener","setAttributeNS","appendChildren","child","appendChild","createTextNode","css","strings","values","concat","createElement","text","div","span","slot","input","button","ul","li","ns","svg","d","p","SignalLink","callback","id","Signal","locked","busy","callbacks","remove","count","lock","unlock","triggered","trigger","withLock","closure","r","error","e","ModelReason","ValueModelReason","NumberModelReason","Model","options","modified","enabled","ENABLED","color","COLOR","label","LABEL","description","DESCRIPTION","ERROR","applyStyle","removeAttribute","setAttribute","fontStyle","fontWeight","AbstractValueModel","aDefault","default","DEFAULT","resetToDefault","ValueModel","super","_value","VALUE","BooleanModel","BigDecimal","_n","ints","decis","String","BigInt","padEnd","DECIMALS","slice","ROUNDED","fromBigInt","bigint","assign","prototype","num","_divRound","dividend","divisor","mul","SHIFT","toString","padStart","repeat","ExpressionNode","eval","model","getCell","_calculatedValue","down","append","node","dependencies","deps","_toString","indent","Lexer","stack","isspace","isnumber","code","charCodeAt","isalpha","isalnum","unlex","lex","pop","col","row","state","start","at","additive_expression","lexer","n0","multiplicative_expression","n1","n2","unary_expression","NumberModel","increment","step","clip","decrement","number","ex","autocorrect","check","MIN","MAX","STEP","AUTOCORRECT","TextModel","promise","trace","HtmlModel","Action","signal","_","getAttribute","nodeName","attributeOrUndefined","globalController","modelId2Models","modelId2Views","view2ModelIds","sigChanged","registerAction","actionId","action","_registerModel","registerModel","modelId","modelsForModelId","get","viewsForModelId","view","registerView","controller","modelIdsForView","modelsForView","unregisterView","modelIds","views","delete","entry","html","boolean","AnimationBase","_stop","_firstFrame","_animationFrame","prepare","requestAnimationFrame","stop","animator","current","clearCurrent","animation","animationFrame","lastFrame","firstFrame","window","time","startTime","elapsed","animationFrameCount","ease","_current","PI","AnimationWrapper","Animator","run","animationBase","previousAnimation","halt","View","HTMLElement","define","customElements","getModelId","hasAttribute","getActionId","connectedCallback","disconnectedCallback","ModelView","init","updateModel","updateView","reason","isConnected","ALL","ActionView","Function","isEnabled","CSSStyleSheet","replaceSync","TextField","onkeydown","onblur","oninput","wheel","onwheel","ondblclick","attachShadow","delegatesFocus","shadowRoot","adoptedStyleSheets","txText","preventDefault","deltaY","focus","blur","observedAttributes","attributeChangedCallback","oldValue","newValue","strValue","textAreaStyle","TextTool","texttool","toolbar","_jsx","class","buttonH1","onclick","execCommand","buttonH2","buttonH3","buttonH4","buttonBold","buttonItalic","buttonUnderline","buttonStrikeThrough","buttonSubscript","buttonSuperscript","buttonJustifyLeft","_jsxs","viewBox","width","height","x1","y1","x2","y2","buttonJustifyCenter","buttonJustifyRight","toggle","queryCommandValue","queryCommandState","TextArea","contentEditable","event","firstChild","nodeType","innerHTML","metaKey","updateTextTool","shiftKey","onkeyup","onmouseup","innerText","Display","ButtonVariant","Button","variant","PRIMARY","SECONDARY","ACCENT","NEGATIVE","txButton","_observer","MutationObserver","record","observer","_timer","clearTimeout","setTimeout","observe","childList","subtree","characterData","BooleanView","checked","Checkbox","onchange","checkmark","txCheckbox","replaceChildren","Search","s0","s1","form","placeholder","autocomplete","txSearch","Switch","txSwitch","RadioButton","disabled","txRadio","radioGroup","radioGroups","radioGroupCounter","childNodes","labelOf","isEnabledOf","MenuState","WeakMap","MenuButtonContainer","vertical","closeOnClose","WAIT","PopupMenu","root","parent","parentButton","popup","isAvailable","createWindowAt","deleteWindow","show","master","parentBoundary","getBoundingClientRect","opacity","left","top","popupBoundary","innerHeight","innerWidth","placePopupHorizontal","placePopupVertical","display","hide","popupBottom","SelectBase","pointerup","pointermove","pointerdown","keydown","tabIndex","outline","onpointerdown","onpointermove","onpointerup","txCombobox","txMenu","finalize","displayElement","ev","prev","togglePopup","close","open","setPointerCapture","pointerId","newHover","findMenuItem","hover","elementFromPoint","clientX","clientY","parentElement","contains","dataset","select","l","asHtml","ariaRoleDescription","position","zIndex","focusToItem","removeChild","Select","minWidth","ComboBox","textModel","Number","parseColor","g","match","Slider","container","rail","track","thumb","slider","orientation","minColor","maxColor","skew","setGradient","onfocus","txSlider","rot","backgroundImage","backgroundColor","GenericTool","focusIn","viewParents","distance","closestParent","closestTool","closestToolDistance","MAX_SAFE_INTEGER","closestToolList","tool","allTools","canHandle","toolParent","depth","toolDistance","viewIndex","closestNextSiblingIndex","MIN_SAFE_INTEGER","toolIndex","setActive","from","activeTool","deactivate","activeView","activate","focusOut","relatedTarget","toolbuttonStyle","ToolButton","SlotView","ToadIf","Tabs","lineContainer","tabContainer","labelMap","activateTab","markerLine","activeLabel","activePanel","Tab","panel","tabLabel","stopPropagation","txTabs","txScrollbar","tab","adjustLine","offsetTop","clientHeight","offsetLeft","clientWidth","Promise","then","module","viewOrViewFunction","viewOrPromise","menuStyle","btoa","MenuButton","menuButton","onmousedown","documentMouseUp","removeEventListener","capture","buttonDown","dispatchEvent","MouseEvent","DOWN","UP_N_HOLD","active","DOWN_N_HOLD","documentMouseDown","tagName","collapse","DOWN_N_OUTSIDE","DOWN_N_INSIDE_AGAIN","onmouseout","inside","onmouseover","title","insertBefore","openPopup","closePopup","oldActive","MenuNode","shortcut","parentView","flexGrow","Menu","config","config2nodes","referenceActions","createShadowDOM","layout2nodes","newnode","dom.attribute","dom.attributeOrUndefined","space","findNode","strpos","right","MenuSpacer","TableModel","isEmpty","colCount","rowCount","TableEditMode","EditMode","TableEventType","TablePos","SelectionModel","EDIT_CELL","TypedTableModel","nodeClass","TableAdapterConfig","editMode","EDIT_ON_FOCUS","seamless","expandColumn","expandRow","TableAdapter","getColumnHead","getRowHead","showCell","pos","cell","saveCell","editCell","isViewCompact","register","adapter","typeToModel","modelToAdapter","has","unbind","lookup","dataType","typeToAdapter","getPrototypeOf","baseClass","keys","msg","modelX","typeToAdapterX","typeX","adapterX","TableEvent","TableFriend","table","logger","measure","getStaging","bodyStaging","getHeadStaging","headStaging","body","splitBody","colHeads","rowHeads","colResizeHandles","rowResizeHandles","animationDone","selection","setCellSize","h","clearAnimation","TableAnimation","prepareStagingWithRows","prepareBodyStaging","prepareRowHeadStaging","addStaging","scrollStaging","prepareStagingWithColumns","prepareColHeadStaging","className","disposeStaging","removeStaging","makeRowMask","mask","boxSizing","border","Table","maskColor","makeColumnMask","bottom","InsertAnimation","prepareCellsToBeMeasured","prepareStaging","arrangeInStaging","animate","animationStart","totalSize","join","joinHeader","joinBody","InsertRowAnimation","initialRowCount","splitHead","headMask","prepareMinCellSize","rowHeaders","colHeaders","createCell","calculateMinCellSize","overlap","px2float","colWidth","bounds","fill","minCellWidth","rowHeadWidth","rowHeight","minCellHeight","ceil","colHeadHeight","WIDTH_ADJUST","HEIGHT_ADJUST","splitHorizontalNew","lastElementChild","RemoveRowAnimation","joinHorizontal","initialHeight","bottomCell","removeAll","arrangeRowsInStaging","splitHorizontal","topSplitBody","animationHeight","topMask","cellCount","bottomOfStaging","moveSplitBodyToBody","moveSplitHeadToHead","InsertColumnAnimation","previousColCount","px2int","totalWidth","columnWidth","splitVerticalNew","bodyWidth","stagingWidth","splitWidth","bodyInsertAt","beforeChild","RemoveColumnAnimation","joinVertical","initialWidth","arrangeColumnsInStaging","splitVertical","leftSplitBody","animationWidth","leftMask","firstCellOfStaging","lastCellOfStaging","rightOfStaging","scrollIntoView","scrollableParent","el","isScrollable","findScrollableParent","parentRect","clientRect","GAP","clientLeft","scrollLeft","clientRight","clientTop","scrollTop","clientBottom","parentWidth","parentHeight","calculateScrollGoal","scrollable","startX","startY","activeGoal","concurrentScroll","scrollX","pageXOffset","scrollY","pageYOffset","deltaX","nx","ny","scrollTo","animateStep","smoothScroll","getComputedStyle","scrollBy","behavior","idSource","Date","now","userAgent","ROUNDING_TOLERANCE","navigator","RegExp","test","isScrollableY","hasScrollableSpace","canOverflow","isScrollableX","scrollWidth","scrollHeight","overflowValue","isVisible","HANDLE_SIZE","HANDLE_SKEW","prepareInProgress","loggerType","arrangeAllMeasuredInGrid","hostKeyDown","cellKeyDown","cellFocus","pointerDown","handleDown","handleMove","handleUp","setHeadingFillerSizeToScrollbarSize","selectionChanged","modelChanged","onresize","onscroll","txTable","selectionModel","mutations","allTables","prepareCells","attributes","SELECT_CELL","elements","editing","SELECT_ROW","EDIT_ON_ENTER","clientPosToTablePos","getModel","activeElement","hasFocus","CELL_CHANGED","HTMLSpanElement","INSERT_ROW","REMOVE_ROW","INSERT_COL","REMOVE_COL","prepareColumnHeads","prepareRowHeads","prepareBody","colWidths","calculateColumnWidths","rowHeights","calculateRowHeights","placeColumnHeads","placeRowHeads","placeBody","placeBodyCells","measureLineHeight","columnHeaders","caretColor","rh","withinBody","idxStart","cw","seam","filler","handle","createHandle","rowHandle","handleIndex","deltaHandle","deltaSplitBody","deltaSplitHead","deltaColumn","xLimit","yLimit","splitCol","splitHeadVertical","splitBodyVertical","splitColor","colsToSplit","boundary","splitColumn","extra","splitBodyColumns","cloneNode","delta","splitRow","splitHeadHorizontal","splitBodyHorizontal","cellAtBottom","splitBodyRows","bf","print","isRowEditInterface","isColumnEditInterface","buttonAddRowAbove","lastActiveTable","insertRow","buttonAddRowBelow","buttonDeleteRow","removeRow","buttonAddColumnLeft","insertColumn","buttonAddColumnRight","buttonDeleteColumn","removeColumn","buttonAddNodeAbove","buttonAddNodeBelow","buttonAddNodeParent","buttonAddNodeChild","buttonDeleteNode","TargetMap","PoseMap","Mode","Mesh","changed","dirty","poseChanged","MORPH","vertexBase","poses","BodySettings","bodyset","facevector","facegroup","targetmap","posemap","morphMode","markDirty","poseMode","initPoses","POSE","getVertexes","vertexMorphed","vertexPosed","clearMorph","clearPose","updatePose","loadMeshFactory","meshFilename","facesFilename","loadGroupsFactory","groups_filename","loadTargetsFactory","targetRootPath","recursiveLevel","clearmap","targetEntry","loadPoseTargetsFactory","poseEntry","tmp","setPose","morph_value","poseTarget","getPoseTargetForName","getPose","sort","doPose","getTargetForName","_a","pt","doPoseTranslation","pr","doPoseRotation","real_value","rotMatrix","mat4.create","M_PI_180","theta","mat4.rotateX","mat4.rotateY","mat4.rotateZ","vec3.sub","vec3.transformMat4","doMorph","real_morph_value","bs_morph_value","getMorph","u8","Uint8Array","u16","i32","Int32Array","fleb","fdeb","clim","freb","eb","j","fl","revfl","fd","rev","hMap","cd","mb","le","rvb","sv","r_1","flt","fdt","flrm","fdrm","bits","o","bits16","ec","err","ind","nt","captureStackTrace","inflt","dat","st","buf","dict","sl","dl","noBuf","resize","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","t","subarray","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","end","shift","dend","slc","et","unzlibSync","opts","dictionary","TextDecoder","decode","stream","HTTPFSAdapter","debug","req","XMLHttpRequest","overrideMimeType","send","status","statusText","ab","ArrayBuffer","responseText","ua","directoryCache","slash","lastIndexOf","dir","includes","JSON","parse","fullfile","AbstractShader","vertexShaderSrc","fragmentShaderSrc","program","createProgram","vertexShader","compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","vertexPosition","getAttribLocation","vertexNormal","projectionMatrix","getUniformLocation","modelViewMatrix","normalMatrix","normales","texture","FLOAT","vertexAttribPointer","enableVertexAttribArray","initProgram","initProjectionMatrix","initModelViewMatrix","initNormalMatrix","useProgram","uniformMatrix4fv","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","deleteShader","getShaderInfoLog","location","RGBAShader","rgbaVertexShaderSrc","rgbaFragmentShaderSrc","_color","setColor","rgba","uniform4fv","Reference","writable","fromString","outValue","Fragment","replaceIn","appendTo","refs","tiles","selectedJoint","createTile","mesh","jointIdx","poseTargets","tileImg","img","toUpperCase","replaceAll","onpointerenter","onpointerleave","details","_Fragment","padding","startsWith","img0","img1","detail","textAlign","downX","lastValue","txt","setValue","round","oncontextmenu","createKnob","selectedTile","tileIdx","detailTargets","imgSrc","imgSrcOver","toPrecision","isZero","epsilon","abs","createSelectorView","listener","selector","pointerEvents","cursorPos","background","caret","setCursorPos","offsetX","offsetY","calcWidgetTargets","buttons","TAB","toolbarDefinition","LOAD","desc","SAVE","CHARACTER","render","mgr","age","muscleSize","breast","shape","characterPanel","DETAILS","lineHeight","bodyDetailsPanel","posesBodyPanel","activeTab","setTab","toolbarPanel","Selector","rows","cols","labels","points","cellWidth","cellHeight","cellRatio","maxValue","dists","getDists","pow","SelectorListener","ageDists","muscleSizeDists","breastDists","shapeDists","di_it","tmpTargetName","ms_it","tmpTargetValue","br_it","sh_it","main","overflow","margin","page","screen","canvas","faceGroups","group","faceIdx","face","getContext","renderMesh","programRGBA","pixelStorei","UNPACK_FLIP_Y_WEBGL","enable","CULL_FACE","cullFace","BACK","lastX","lastY","paint","adjustCanvasSize","fieldOfView","mat4.perspective","createProjectionMatrix","D","mat4.translate","createModelViewMatrix","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","mat4.transpose","createNormalMatrix","viewport","clearColor","clearDepth","DEPTH_TEST","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","depthMask","prepareViewport","TRIANGLES","ResizeObserver","downY","querySelector"],"mappings":"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","x_google_ignoreList":[0,1,2,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,101,105]}