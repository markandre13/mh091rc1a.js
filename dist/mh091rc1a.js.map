{"version":3,"file":"mh091rc1a.js","sources":["../src/filesystem/FileSystemAdapter.ts","../node_modules/fflate/esm/browser.js","../src/filesystem/HTTPFSAdapter.ts","../node_modules/gl-matrix/esm/common.js","../node_modules/gl-matrix/esm/mat4.js","../node_modules/gl-matrix/esm/vec3.js","../src/animorph/DirectoryList.ts","../src/animorph/PoseRotation.ts","../src/animorph/Face.ts","../src/lib/StringToLineIterator.ts","../src/lib/StringToLine.ts","../src/animorph/FaceVector.ts","../src/animorph/Vertex.ts","../src/animorph/VertexVector.ts","../src/animorph/UnsortedUsedVertex.ts","../src/animorph/Target.ts","../src/animorph/TargetEntry.ts","../src/lib/MultiSet.ts","../src/animorph/PoseTranslation.ts","../src/animorph/PoseTarget.ts","../src/animorph/PoseEntry.ts","../src/animorph/FaceGroup.ts","../node_modules/toad.js/node_modules/toad.jsx/lib/jsx-runtime.js","../node_modules/toad.js/lib/src/util/lsx.js","../node_modules/toad.js/lib/src/Signal.js","../node_modules/toad.js/lib/src/model/Model.js","../node_modules/toad.js/lib/src/model/ValueModel.js","../node_modules/toad.js/lib/src/model/NumberModel.js","../node_modules/toad.js/lib/src/model/BooleanModel.js","../node_modules/toad.js/lib/src/util/BigDecimal.js","../node_modules/toad.js/lib/src/util/expressions/ExpressionNode.js","../node_modules/toad.js/lib/src/util/expressions/Lexer.js","../node_modules/toad.js/lib/src/util/expressions/expression.js","../node_modules/toad.js/lib/src/model/TextModel.js","../node_modules/toad.js/lib/src/model/HtmlModel.js","../node_modules/toad.js/lib/src/model/Action.js","../node_modules/toad.js/lib/src/util/dom.js","../node_modules/toad.js/lib/src/controller/globalController.js","../node_modules/toad.js/lib/src/controller/Controller.js","../node_modules/toad.js/lib/src/util/animation.js","../node_modules/toad.js/lib/src/view/View.js","../node_modules/toad.js/lib/src/view/ModelView.js","../node_modules/toad.js/lib/src/view/ActionView.js","../node_modules/toad.js/lib/src/style/tx-text.js","../node_modules/toad.js/lib/src/view/TextField.js","../node_modules/toad.js/lib/src/view/textAreaStyle.js","../node_modules/toad.js/lib/src/view/TextTool.js","../node_modules/toad.js/lib/src/view/TextArea.js","../node_modules/toad.js/lib/src/view/Display.js","../node_modules/toad.js/lib/src/style/tx-button.js","../node_modules/toad.js/lib/src/view/Button.js","../node_modules/toad.js/lib/src/view/BooleanView.js","../node_modules/toad.js/lib/src/style/tx-checkbox.js","../node_modules/toad.js/lib/src/view/Checkbox.js","../node_modules/toad.js/lib/src/style/tx-search.js","../node_modules/toad.js/lib/src/view/Search.js","../node_modules/toad.js/lib/src/style/tx-switch.js","../node_modules/toad.js/lib/src/view/Switch.js","../node_modules/toad.js/lib/src/style/tx-radio.js","../node_modules/toad.js/lib/src/view/RadioButton.js","../node_modules/toad.js/lib/src/menu/MenuState.js","../node_modules/toad.js/lib/src/menu/MenuHelper.js","../node_modules/toad.js/lib/src/menu/PopupMenu.js","../node_modules/toad.js/lib/src/style/tx-combobox.js","../node_modules/toad.js/lib/src/style/tx-menu.js","../node_modules/toad.js/lib/src/view/Select.js","../node_modules/toad.js/lib/src/style/tx-slider.js","../node_modules/toad.js/lib/src/util/color.js","../node_modules/toad.js/lib/src/view/Slider.js","../node_modules/toad.js/lib/src/view/GenericTool.js","../node_modules/toad.js/lib/src/view/ToolButton.js","../node_modules/toad.js/lib/src/view/SlotView.js","../node_modules/toad.js/lib/src/view/ToadIf.js","../node_modules/toad.js/lib/src/style/tx-tabs.js","../node_modules/toad.js/lib/src/style/tx-scrollbar.js","../node_modules/toad.js/lib/src/view/Tab.js","../node_modules/toad.js/lib/src/menu/menuStyle.js","../node_modules/toad.js/lib/src/menu/MenuButton.js","../node_modules/toad.js/lib/src/menu/MenuNode.js","../node_modules/toad.js/lib/src/menu/Menu.js","../node_modules/toad.js/lib/src/menu/MenuSpacer.js","../node_modules/toad.js/lib/src/table/model/TableModel.js","../node_modules/toad.js/lib/src/table/TableEditMode.js","../node_modules/toad.js/lib/src/table/adapter/TableAdapter.js","../node_modules/toad.js/lib/src/table/TableEventType.js","../node_modules/toad.js/lib/src/table/TablePos.js","../node_modules/toad.js/lib/src/table/model/SelectionModel.js","../node_modules/toad.js/lib/src/table/model/TypedTableModel.js","../node_modules/toad.js/lib/src/table/TableEvent.js","../node_modules/toad.js/lib/src/table/private/TableFriend.js","../node_modules/toad.js/lib/src/table/private/TableAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertRowAnimation.js","../node_modules/toad.js/lib/src/table/private/RemoveRowAnimation.js","../node_modules/toad.js/lib/src/table/private/InsertColumnAnimation.js","../node_modules/toad.js/lib/src/table/private/RemoveColumnAnimation.js","../node_modules/toad.js/lib/src/util/scrollIntoView.js","../node_modules/toad.js/lib/src/table/style/tx-table.js","../node_modules/toad.js/lib/src/table/Table.js","../node_modules/toad.js/lib/src/table/TableTool.js","../src/Selector.tsx","../src/SelectorListener.tsx","../src/animorph/VectorArray.ts","../src/animorph/Mesh.ts","../src/gl/calculateNormals.ts","../src/gl/RenderMesh.ts","../src/gl/shader/AbstractShader.ts","../src/gl/shader/RGBAShader.ts","../src/renderMesh.ts","../src/gl/util.ts","../node_modules/toad.jsx/lib/jsx-runtime.js","../src/PosePanel.tsx","../src/DetailPanel.tsx","../src/CharacterPanel.tsx","../src/screen.tsx","../src/main.ts"],"sourcesContent":["import { AbstractFileSystemAdapter } from \"./AbstractFileSystemAdapter\"\n\nexport class FileSystemAdapter {\n    private static instance?: AbstractFileSystemAdapter\n\n    static setInstance(instance: AbstractFileSystemAdapter) {\n        FileSystemAdapter.instance = instance\n    }\n    static readFile(pathname: string): string {\n        return FileSystemAdapter.instance!.readFile(pathname)\n    }\n    static exists(pathname: string): boolean {\n        return FileSystemAdapter.instance!.exists(pathname)\n    }\n    static isFile(pathname: string): boolean {\n        return FileSystemAdapter.instance!.isFile(pathname)\n    }\n    static isDir(pathname: string): boolean {\n        return FileSystemAdapter.instance!.isDir(pathname)\n    }\n    static listDir(pathname: string): string[] {\n        return FileSystemAdapter.instance!.listDir(pathname)\n    }\n    static realPath(pathname: string): string {\n        return FileSystemAdapter.instance!.realPath(pathname)\n    }\n    static joinPath(pathname1: string, pathname2: string): string {\n        return FileSystemAdapter.instance!.joinPath(pathname1, pathname2)\n    }\n}\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            if (split) {\n                this.b.set(chunk.subarray(0, split), this.s.z);\n                this.s.z = this.b.length;\n                this.p(this.b, false);\n            }\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            if (this.p.length)\n                this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this_1 = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, function (offset) { return _this_1.onmember && _this_1.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.o = StrmOpt.call(this, opts, cb) || {};\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_2 = this;\n                // enables reuse of this method by AsyncDecompress\n                var cb = function () { _this_2.ondata.apply(_this_2, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o, cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o, cb)\n                        : new this.Z(this.o, cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        Decompress.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","import { AbstractFileSystemAdapter } from \"./AbstractFileSystemAdapter\"\nimport { unzlibSync } from \"fflate\"\n\ninterface FileInfo {\n    file: string\n    isDir: boolean\n    dir?: string[]\n}\n\nexport class HTTPFSAdapter implements AbstractFileSystemAdapter {\n    static debug = false\n    static directoryCache = new Map<string, FileInfo>()\n\n    readFile(pathname: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        if (pathname.endsWith(\".z\")) {\n            if (HTTPFSAdapter.debug) {\n                console.log(`load compressed file ${pathname}`)\n            }\n            const req = new XMLHttpRequest()\n            req.overrideMimeType(\"text/plain; charset=x-user-defined\")\n            req.open(\"GET\", `data/${pathname}`, false)\n            req.send(null)\n            if (req.status > 400) {\n                throw new Error(`Request failed for '${pathname}': ${req.statusText}`)\n            }\n            const ab = new ArrayBuffer(req.responseText.length)\n            const ua = new Uint8Array(ab)\n            for (let i = 0; i < req.responseText.length; ++i) {\n                ua[i] = req.responseText.charCodeAt(i)\n            }\n            const dec = new TextDecoder(\"utf-8\")\n            return dec.decode(unzlibSync(ua))\n        }\n        if (pathname.endsWith(\"/directory.json\")) {\n            if (HTTPFSAdapter.debug) {\n                console.log(`load uncompressed file ${pathname}`)\n            }\n            const req = new XMLHttpRequest()\n            req.open(\"GET\", `data/${pathname}`, false)\n            req.send(null)\n            if (req.status < 400) {\n                return req.responseText\n            }\n            throw new Error(`Request failed for '${pathname}': ${req.statusText}`)\n        }\n        return this.readFile(`${pathname}.z`)\n    }\n    exists(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.exits('${pathname}')`)\n        }\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            try {\n                this.listDir(pathname)\n            } catch (e) {\n                return false\n            }\n            info = HTTPFSAdapter.directoryCache.get(pathname)\n        }\n        if (info === undefined) {\n            return false\n        }\n        return true\n    }\n    isFile(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            try {\n                this.listDir(pathname)\n            } catch (e) {\n                throw Error(`HTTPFSAdapter.isFile('${pathname}')\": failed to load directory ${pathname}`)\n            }\n            info = HTTPFSAdapter.directoryCache.get(pathname)\n        }\n        if (info === undefined) {\n            throw Error(`HTTPFSAdapter.isFile('${pathname}'): info === undefined`)\n        }\n        return !info.isDir\n    }\n    isDir(pathname: string): boolean {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.isDir('${pathname}')`)\n        }\n        const info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info === undefined) {\n            const slash = pathname.lastIndexOf(\"/\")\n            if (slash >= 0) {\n                const i = HTTPFSAdapter.directoryCache.get(pathname.substring(0, slash))\n                if (i !== undefined) {\n                    if (i.dir?.includes(pathname.substring(slash + 1))) {\n                        return true\n                    }\n                }\n            }\n            throw Error(`HTTPFSAdapter.isFile('${pathname}')`)\n        }\n        return info.isDir\n    }\n    listDir(pathname: string): string[] {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.listDir('${pathname}')`)\n        }\n\n        let info = HTTPFSAdapter.directoryCache.get(pathname)\n        if (info !== undefined && info.dir !== undefined) {\n            return info.dir\n        }\n\n        if (info === undefined) {\n            info = { file: \"\", isDir: true, dir: undefined }\n        }\n\n        const d = this.readFile(`${pathname}/directory.json`)\n        const j = JSON.parse(d)\n        info.dir = []\n        for (const x of j) {\n            const fullfile = `${pathname}/${x.file}`\n            // console.log(`${pathname}/${x.file}`)\n            info.dir.push(x.file)\n            if (!x.isDir) {\n                HTTPFSAdapter.directoryCache.set(fullfile, { file: x.file, isDir: false })\n            }\n        }\n        HTTPFSAdapter.directoryCache.set(pathname, info)\n        return info.dir\n    }\n    realPath(pathname: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.realPath('${pathname}')`)\n        }\n        // throw Error()\n        return pathname\n    }\n    joinPath(pathname1: string, pathname2: string): string {\n        if (HTTPFSAdapter.debug) {\n            console.log(`HTTPFSAdapter.joinPath('${pathname1}', '${pathname2}')`)\n        }\n        return `${pathname1}/${pathname2}`\n    }\n}\n","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\n\nenum RecursiveLevel {\n    NO_LIMIT = -1, // read directories recursive without limit\n    NO_RECURSIVE = 0, // read only the base directory without recursion\n}\n\nexport enum FileType {\n    REGULAR_FILE, // only regular files\n    DIRECTORY, // only directories\n}\n\nexport class DirectoryList {\n    private file_list: string[] = []\n    private file_filter: string = \"\"\n    private path: string = \"\"\n    private recursive_level: number = -1\n    private recursive_counter: number = 0\n    private file_type: FileType = FileType.REGULAR_FILE\n\n    setFileFilter(file_filter: string) {\n        this.file_filter = file_filter\n    }\n    setRecursive(recursive_level: number): void {\n        this.recursive_level = recursive_level\n    }\n    setRootPath(path: string): void {\n        this.path = path\n    }\n    setFileType(file_type: FileType) {\n        this.file_type = file_type\n    }\n    getDirectoryList(): string[] {\n        this.readDirRecursive(this.path)\n        this.recursive_counter = 0\n        return this.file_list\n    }\n    private readDirRecursive(dir_str: string) {\n        for (const dname of FileSystemAdapter.listDir(dir_str)) {\n            if (dir_str.charAt(0) === \".\") {\n                continue\n            }\n            const dir_file = `${dir_str}/${dname}`\n            if (FileSystemAdapter.isDir(dir_file)) {\n                if (this.file_type === FileType.DIRECTORY) {\n                    this.file_list.push(dir_file)\n                }\n                if (this.recursive_counter < this.recursive_level || this.recursive_level == RecursiveLevel.NO_LIMIT) {\n                    ++this.recursive_counter\n                    this.readDirRecursive(dir_file)\n                    --this.recursive_counter\n                }\n            } else {\n                if (this.hasFileFilterEnding(dir_file)) {\n                    this.file_list.push(dir_file)\n                }\n            }\n        }\n    }\n    private hasFileFilterEnding(file: string): boolean {\n        if (this.file_filter.length > file.length) {\n            return false\n        }\n        return file.endsWith(this.file_filter)\n    }\n}\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { UnsortedUsedVertex } from \"./PoseTarget\"\n\nexport interface PoseTargetData {\n    vertex_number: number\n    rotation: number\n}\n\nexport enum RotateAxis {\n    X_AXIS,\n    Y_AXIS,\n    Z_AXIS,\n}\n\nexport class PoseRotation extends Array<PoseTargetData> {\n    /// Used to calculate center\n    private centerVertexNumbers!: number[]\n    /// Will be used as parameter for Matrix::setRoation()\n    private axis!: RotateAxis\n    /// Set of all indices in the \".rot\" file\n    private modVertex: UnsortedUsedVertex = [];\n    /// Currently unused\n    private hasCenter: boolean = false\n    /// Minimum angle in radians\n    private minAngle: number = 0\n    /// Maximum angle in radians\n    private maxAngle: number = 0\n    /// will be set to true by PoseTarget::calcNormalizations() if our (min|max)Angle != PoseTarget::(min|max)Angle\n    private normalize: boolean = false\n    //string inFilename;\n    /* \\brief \"Category\"? Currently always \"00\"\n     * First two characters of the filename, eg . \"00\" for \"00_Z_LIMB_SPINE1.rot\"\n     */\n    private cat: string = \"\"\n\n    /* \\brief Centroid of centerVertexNumbers\n     * Is initialized by PoseTarget::calcRotationsCenteroids()\n     */\n    private center!: vec3\n    ///Limb rotation Type\n    private mbLimb!: boolean\n\n    clear() {\n        this.length = 0\n    }\n\n    load(filename: string): boolean {\n        this.clear()\n\n        const info = FileSystemAdapter.readFile(`${filename}.info`)\n            .split(\"\\n\")\n            .map((it) => it.trim())\n        if (info.length < 3) {\n            return false\n        }\n        const str = info[0]\n        const ax = info[1].charAt(0) // axis X,Y,Z\n        const minMax = info[2].split(\",\")\n        this.minAngle = parseFloat(minMax[0])\n        this.maxAngle = parseFloat(minMax[1])\n\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 2) {\n                const td: PoseTargetData = {\n                    vertex_number: parseInt(tokens[0]),\n                    rotation: parseFloat(tokens[1]),\n                }\n                this.modVertex.push(td.vertex_number)\n                this.push(td)\n            }\n        }\n\n        switch (ax) {\n            case \"X\":\n                this.axis = RotateAxis.X_AXIS\n                break\n            case \"Y\":\n                this.axis = RotateAxis.Y_AXIS\n                break\n            case \"Z\":\n                this.axis = RotateAxis.Z_AXIS\n                break\n            default:\n                throw Error(`unknown axis ${ax}`)\n        }\n        this.centerVertexNumbers = str.split(\",\").map((it) => parseInt(it))\n        return true\n    }\n    getCenterVertexNumbers() {\n        return this.centerVertexNumbers\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n    getCenter() {\n        return this.center\n    }\n    setCenter(c: vec3) {\n        this.center = c\n    }\n\n    getAxis() {\n        return this.axis\n    }\n    getHasCenter() {\n        return this.hasCenter\n    }\n    setHasCenter(c: boolean) {\n        this.hasCenter = c\n    }\n\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n    getNormalize() {\n        return this.normalize\n    }\n    setNormalize(inNormalize: boolean) {\n        this.normalize = inNormalize\n    }\n\n    //const string &getFilename() const {return inFilename;}\n    getCat() {\n        return this.cat\n    }\n    setCat(inCat: string) {\n        this.cat = inCat\n    }\n\n    setLimb(limb: boolean) {\n        this.mbLimb = limb\n    }\n    getLimb() {\n        return this.mbLimb\n    }\n}\n","import { vec3 } from \"gl-matrix\"\n\nexport class Face {\n    vertices: number[]\n    get size() {\n        return this.vertices.length\n    }\n    material_index: number\n    no: vec3\n\n    constructor(v0: number, v1: number, v2: number, v3?: number) {\n        if (v3 !== undefined) {\n            this.vertices = [v0, v1, v2, v3]\n        } else {\n            this.vertices = [v0, v1, v2]\n        }\n        this.material_index = -1\n        this.no = vec3.create()\n    }\n}\n","export class StringToLineIterator implements Iterator<string> {\n    private data: string\n    private index: number\n\n    constructor(data: string) {\n        this.data = data\n        this.index = 0\n    }\n\n    next(): IteratorResult<string> {\n        if (this.data.length === 0 || this.index === -1)\n            return { value: undefined, done: true }\n        const nextIndex = this.data.indexOf('\\n', this.index)\n        let length: number | undefined\n        if (nextIndex === -1) {\n            length = undefined\n        } else {\n            length = nextIndex - this.index\n        }\n        const result = this.data.substr(this.index, length)\n        if (nextIndex === -1) {\n            this.index = -1\n        } else {\n            this.index = nextIndex + 1\n        }\n        return { value: result, done: false }\n    }\n\n}\n","import { StringToLineIterator } from './StringToLineIterator'\n\nexport class StringToLine implements Iterable<string> {\n    data: string;\n    constructor(data: string) {\n        this.data = data\n    }\n\n    [Symbol.iterator](): Iterator<string> {\n        return new StringToLineIterator(this.data)\n    }\n}\n","import { Face } from \"./Face\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\n\nexport class FaceVector extends Array<Face> {\n    loadGeometry(filename: string) {\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0, triangles = 0, quads = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            switch (tokens.length) {\n                case 3:\n                    ++triangles\n                    this.push(new Face(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2])))\n                    break\n                case 4:\n                    ++quads\n                    this.push(new Face(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2]), parseFloat(tokens[3])))\n                    break\n            }\n        }\n        console.log(`loaded ${triangles} triangles and ${quads} quads from ${filename}`)\n    }\n}\n","import { vec3 } from \"gl-matrix\"\n\nexport class Vertex {\n    co: vec3\n    constructor(x: number, y: number, z: number)\n    constructor(vertex: Vertex)\n    constructor(xOrVertex: number | Vertex, y?: number, z?: number) {\n        if (xOrVertex instanceof Vertex) {\n            this.co = vec3.clone(xOrVertex.co)\n        } else {\n            this.co = vec3.fromValues(xOrVertex, y!, z!)\n        }\n    }\n}\n","import { Vertex } from \"./Vertex\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { vec3 } from \"gl-matrix\"\n\nexport class VertexVector extends Array<Vertex> {\n    load(filename: string) {\n        const data = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 3) {\n                this.push(new Vertex(parseFloat(tokens[0]), parseFloat(tokens[1]), parseFloat(tokens[2])))\n            }\n        }\n        console.log(`loaded ${this.length} vertices from ${filename}`)\n    }\n    clone() {\n        const clone = new VertexVector(this.length)\n        for (let i = 0; i < this.length; ++i) {\n            const v = this[i]\n            clone[i] = new Vertex(v)\n        }\n        return clone\n    }\n    setFrom(src: VertexVector) {\n        if (this.length !== src.length) {\n            throw Error(`length must be the same`)\n        }\n        for (let i = 0; i < this.length; ++i) {\n            vec3.copy(this[i].co, src[i].co)\n        }\n    }\n}\n","export class UnsortedUsedVertex extends Array<number> { }\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\nimport { TargetData } from \"./TargetData\"\nimport { UnsortedUsedVertex } from \"./UnsortedUsedVertex\"\n\nexport class Target extends Array<TargetData> {\n    private modVertex = new UnsortedUsedVertex()\n    load(filename: string): boolean {\n        const data = FileSystemAdapter.readFile(`${filename}`)\n        const reader = new StringToLine(data)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            line = line.trim()\n            const tokens = line.split(/,+/)\n            if (tokens.length === 4) {\n                const td: TargetData = {\n                    vertex_number: parseInt(tokens[0]),\n                    morph_vector: vec3.fromValues(parseFloat(tokens[1]), parseFloat(tokens[2]), parseFloat(tokens[3])),\n                }\n                this.push(td)\n                this.modVertex.push(td.vertex_number)\n            }\n        }\n        // console.log(`loaded ${this.length} vectors for morph target ${filename}`)\n        return true\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n}\n","import { Target } from \"./Target\"\n\nexport class TargetEntry {\n    private mFilename: string\n    private mTarget?: Target = undefined;\n    private mTargetLoadTry: boolean = false;\n\n    constructor(filename: string, preload = false) {\n        this.mFilename = filename\n        if (preload) {\n            this.loadFromFile()\n        }\n    }\n\n    loadFromFile(): boolean {\n        if (this.mTargetLoadTry === false) {\n            this.mTargetLoadTry = true\n            this.mTarget = new Target()\n            if (!this.mTarget.load(this.mFilename)) {\n                this.mTarget = undefined\n            }\n        }\n        return this.mTarget !== undefined\n    }\n\n    getTarget(): Target | undefined {\n        if (!this.mTargetLoadTry) {\n            this.loadFromFile()\n        }\n        return this.mTarget\n    }\n}\n","export class MultiSet<T> {\n    private array: T[] = []\n    private order: (a: T, b: T) => boolean\n    constructor(order: (a: T, b: T) => boolean = (a: T, b: T) => a < b) {\n        this.order = order\n    }\n    get size() {\n        return this.array.length\n    }\n    entries() {\n        return this.array\n    }\n    [Symbol.iterator](): IterableIterator<T> {\n        return this.array[Symbol.iterator]()\n    }\n    last() {\n        return this.array[this.array.length-1]\n    }\n    eraseLast() {\n        this.array.length = this.array.length - 1\n    }\n    first() {\n        return this.array[0]\n    }\n    eraseFirst() {\n        this.array.splice(0, 1)\n    }\n    insert(k: T) {\n        let firstIndex = 0,\n            lastIndex = this.array.length,\n            middleIndex = Math.floor((lastIndex + firstIndex) / 2)\n        while (firstIndex < lastIndex) {\n            if (this.order(k, this.array[middleIndex])) {\n                lastIndex = middleIndex - 1\n            } else {\n                if (this.order(this.array[middleIndex], k)) {\n                    firstIndex = middleIndex + 1\n                } else {\n                    break\n                }\n            }\n            middleIndex = Math.floor((lastIndex + firstIndex) / 2)\n        }\n\n        if (middleIndex >= this.array.length) {\n            this.array.push(k)\n        } else {\n            if (middleIndex < 0) {\n                this.array.splice(0, 0, k)\n            } else {\n                if (this.order(k, this.array[middleIndex])) {\n                    this.array.splice(middleIndex, 0, k)\n                } else {\n                    this.array.splice(middleIndex + 1, 0, k)\n                }\n            }\n        }\n    }\n}\n","import { vec3 } from \"gl-matrix\"\nimport { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { Target } from \"./Target\"\nimport { VertexVector } from \"./VertexVector\"\nimport { MultiSet } from \"lib/MultiSet\"\nimport { VectorArray } from \"./VectorArray\"\n\nconst FF_VERTEX_N = 10\n\nexport class PoseTranslation {\n    private target = new Target()\n    private originalSize!: number[]\n    private formFactor = vec3.fromValues(1, 1, 1)\n    private minAngle: number = 0\n    private maxAngle: number = 0\n    /// flag\n    private normalize: boolean = false\n    inFilename?: string\n    /// Can be used to influence the order of application of rotations and translations\n    private cat: string = \"\"\n\n    private mbLimb: boolean = false\n\n    load(filename: string): boolean {\n        this.inFilename = filename\n        const info = FileSystemAdapter.readFile(`${filename}.info`)\n            .split(\"\\n\")\n            .map((it) => it.trim())\n        if (info.length < 3) {\n            return false\n        }\n        this.originalSize = info[0].split(\",\").map((it) => parseFloat(it))\n        const minMax = info[1].split(\",\")\n        this.minAngle = parseFloat(minMax[0])\n        this.maxAngle = parseFloat(minMax[1])\n        this.target.load(filename)\n        return true\n    }\n\n    getModVertex() {\n        return this.target.getModVertex()\n    }\n    calcFormFactor(vertexvector: VectorArray) {\n        // these are meant to be c++ multiset, meaning they can have duplicate values and are sorted\n        // prettier-ignore\n        let minXSet = new MultiSet<number>(), maxXSet = new MultiSet<number>(),\n            minYSet = new MultiSet<number>(), maxYSet = new MultiSet<number>(),\n            minZSet = new MultiSet<number>(), maxZSet = new MultiSet<number>()\n\n        let counter = 0\n        let n_vertex = FF_VERTEX_N\n        //         pair< set<float>::iterator, bool > pr;\n\n        const tmpTarget = this.getTarget()\n\n        if (tmpTarget.length < FF_VERTEX_N * 2) {\n            n_vertex = Math.floor(tmpTarget.length / 2)\n        }\n\n        for (const td of tmpTarget) {\n            const co = vertexvector.getVec3(td.vertex_number)\n            if (counter < n_vertex) {\n                minXSet.insert(co[0])\n                maxXSet.insert(co[0])\n                minYSet.insert(co[1])\n                maxYSet.insert(co[1])\n                minZSet.insert(co[2])\n                maxZSet.insert(co[2])\n                ++counter\n            } else {\n                if (co[0] < minXSet.last()) {\n                    minXSet.insert(co[0])\n                    minXSet.eraseLast()\n                }\n                if (co[0] > maxXSet.first()) {\n                    maxXSet.insert(co[0])\n                    maxXSet.eraseFirst()\n                }\n                if (co[1] < minYSet.last()) {\n                    minYSet.insert(co[1])\n                    minYSet.eraseLast()\n                }\n                if (co[1] > maxYSet.first()) {\n                    maxYSet.insert(co[1])\n                    maxYSet.eraseFirst()\n                }\n                if (co[2] < minZSet.last()) {\n                    minZSet.insert(co[2])\n                    minZSet.eraseLast()\n                }\n                if (co[2] > maxZSet.first()) {\n                    maxZSet.insert(co[2])\n                    maxZSet.eraseFirst()\n                }\n            }\n        }\n\n        // prettier-ignore\n        let minX = 0, maxX = 0, minY = 0, maxY = 0, minZ = 0, maxZ = 0\n        for (const it of minXSet) {\n            minX += it\n        }\n        for (const it of maxXSet) {\n            maxX += it\n        }\n        for (const it of minYSet) {\n            minY += it\n        }\n        for (const it of maxYSet) {\n            maxY += it\n        }\n        for (const it of minZSet) {\n            minZ += it\n        }\n        for (const it of maxZSet) {\n            maxZ += it\n        }\n\n        let xsize = maxXSet.size,\n            ysize = maxYSet.size,\n            zsize = maxZSet.size\n\n        this.formFactor = vec3.fromValues(\n            (maxX / xsize - minX / xsize) / this.originalSize[0],\n            (maxY / ysize - minY / ysize) / this.originalSize[1],\n            (maxZ / zsize - minZ / zsize) / this.originalSize[2]\n        )\n    }\n    getTarget() {\n        return this.target\n    }\n    getFormFactor() {\n        return this.formFactor\n    }\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n    getNormalize() {\n        return this.normalize\n    }\n    setNormalize(inNormalize: boolean) {\n        this.normalize = inNormalize\n    }\n    getFilename() {\n        return this.inFilename\n    }\n    getCat() {\n        return this.cat\n    }\n    setCat(inCat: string) {\n        this.cat = inCat\n    }\n\n    setLimb(limb: boolean) {\n        this.mbLimb = limb\n    }\n    getLimb() {\n        return this.mbLimb\n    }\n}\n","import { DirectoryList } from \"./DirectoryList\"\nimport { PoseRotation } from \"./PoseRotation\"\nimport { PoseTranslation } from \"./PoseTranslation\"\nimport { vec3 } from \"gl-matrix\"\nimport { VertexVector } from \"./VertexVector\"\nimport { VectorArray } from \"./VectorArray\"\n\nexport class UnsortedUsedVertex extends Array<number> {}\n\nexport function calcCenteroid(vertexNumbers: number[], vertexvector: VectorArray): vec3 {\n    let center = vec3.create()\n    for (const vn of vertexNumbers) {\n        vec3.add(center, center, vertexvector.getVec3(vn))\n    }\n    vec3.scale(center, center, 1 / vertexNumbers.length)\n    return center\n}\n\nexport class PoseTarget {\n    // normally these vectors contain only one element\n    /// Translations to be applied on Mesh::doPose()\n    private positiveTranslations: PoseTranslation[] = []\n    /// Translations to be applied on Mesh::doPose() with morph_value < 0\n    private negativeTranslations: PoseTranslation[] = []\n    /// Rotations to be applied on Mesh::doPose()\n    private positiveRotations: PoseRotation[] = []\n    /// Rotations to be applied on Mesh::doPose() with morph_value < 0\n    private negativeRotations: PoseRotation[] = []\n\n    private targetName: string\n    /// flags whether wehave special transformations for Mesh::doPose() with morph_value < 0\n    private negative: boolean = false\n    private positive: boolean = false\n    /// flag for calcNormalizations()\n    private normalizationInited: boolean = false\n    private fullPath: string\n    private modVertex = new Set<number>()\n    private minAngle: number = 0.0\n    private maxAngle: number = 0.0\n\n    constructor(targetName: string, fullpath: string) {\n        this.targetName = targetName\n        this.fullPath = fullpath\n    }\n    load() {\n        const positive_rotation_type = \".rot\"\n        const negative_rotation_type = \"-.rot\"\n        const positive_translation_type = \".target\"\n        const negative_translation_type = \"-.target\"\n\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(this.fullPath)\n        dir_list.setRecursive(0)\n\n        const files = dir_list.getDirectoryList()\n        for (const file of files) {\n            const target_name = file.substring(this.fullPath.length + 1)\n            if (target_name.endsWith(negative_rotation_type)) {\n                const tmpRotation = new PoseRotation()\n                if (tmpRotation.load(file)) {\n                    tmpRotation.setCat(target_name.substring(0, 2))\n                    tmpRotation.setLimb(target_name.indexOf(\"LIMB\") !== -1)\n                    this.negativeRotations.push(tmpRotation)\n                    tmpRotation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.negative = true\n                    this.minAngle = Math.min(this.minAngle, tmpRotation.getMinAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(positive_rotation_type)) {\n                const tmpRotation = new PoseRotation()\n                if (tmpRotation.load(file)) {\n                    tmpRotation.setCat(target_name.substring(0, 2))\n                    tmpRotation.setLimb(target_name.indexOf(\"LIMB\") !== -1)\n                    this.positiveRotations.push(tmpRotation)\n                    tmpRotation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.positive = true\n                    this.maxAngle = Math.max(this.maxAngle, tmpRotation.getMaxAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(negative_translation_type)) {\n                const tmpTranslation = new PoseTranslation()\n                if (tmpTranslation.load(file)) {\n                    tmpTranslation.setCat(target_name.substring(0, 2))\n                    this.negativeTranslations.push(tmpTranslation)\n                    tmpTranslation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.minAngle = Math.min(this.minAngle, tmpTranslation.getMinAngle())\n                }\n                continue\n            }\n            if (target_name.endsWith(positive_translation_type)) {\n                const tmpTranslation = new PoseTranslation()\n                if (tmpTranslation.load(file)) {\n                    tmpTranslation.setCat(target_name.substring(0, 2))\n                    this.positiveTranslations.push(tmpTranslation)\n                    tmpTranslation.getModVertex().forEach((idx) => this.modVertex.add(idx))\n                    this.maxAngle = Math.max(this.maxAngle, tmpTranslation.getMaxAngle())\n                }\n                continue\n            }\n        }\n    }\n    /// Initializes the center of all rotations with the controid of their centerVertexNumbers\n    calcRotationsCenteroids(vertexvector: VectorArray, rotations?: PoseRotation[]): void {\n        if (rotations === undefined) {\n            if (this.positive) {\n                this.calcRotationsCenteroids(vertexvector, this.positiveRotations)\n            }\n            if (this.negative) {\n                this.calcRotationsCenteroids(vertexvector, this.negativeRotations)\n            }\n        } else {\n            for (const rotations_it of rotations) {\n                rotations_it.setCenter(calcCenteroid(rotations_it.getCenterVertexNumbers(), vertexvector))\n            }\n        }\n    }\n\n    calcTranslationsFormFactors(vertexvector: VectorArray, translations?: PoseTranslation[]): void {\n        if (translations === undefined) {\n            if (this.positive) {\n                this.calcTranslationsFormFactors(vertexvector, this.positiveTranslations)\n            }\n            if (this.negative) {\n                this.calcTranslationsFormFactors(vertexvector, this.negativeTranslations)\n            }\n        } else {\n            for (const translations_it of translations) {\n                translations_it.calcFormFactor(vertexvector)\n            }\n        }\n    }\n    calcNormalizations() {\n        if (this.normalizationInited) {\n            return\n        }\n        for (const rotations_it of this.positiveRotations) {\n            if (rotations_it.getMinAngle() !== this.minAngle || rotations_it.getMaxAngle() !== this.maxAngle) {\n                rotations_it.setNormalize(true)\n            }\n        }\n        for (const rotations_it of this.negativeRotations) {\n            if (rotations_it.getMinAngle() !== this.minAngle || rotations_it.getMaxAngle() !== this.maxAngle) {\n                rotations_it.setNormalize(true)\n            }\n        }\n        for (const translations_it of this.positiveTranslations) {\n            if (translations_it.getMinAngle() !== this.minAngle || translations_it.getMaxAngle() !== this.maxAngle) {\n                translations_it.setNormalize(true)\n            }\n        }\n        for (const translations_it of this.negativeTranslations) {\n            if (translations_it.getMinAngle() !== this.minAngle || translations_it.getMaxAngle() !== this.maxAngle) {\n                translations_it.setNormalize(true)\n            }\n        }\n        this.normalizationInited = true\n    }\n    hasNegative() {\n        return this.negative\n    }\n    hasPositive() {\n        return this.positive\n    }\n    getPositiveTranslations() {\n        return this.positiveTranslations\n    }\n    getNegativeTranslations() {\n        return this.negativeTranslations\n    }\n    getPositiveRotations() {\n        return this.positiveRotations\n    }\n    getNegativeRotations() {\n        return this.negativeRotations\n    }\n    getModVertex() {\n        return this.modVertex\n    }\n    //void showCenters();\n    getMinAngle() {\n        return this.minAngle\n    }\n    getMaxAngle() {\n        return this.maxAngle\n    }\n}\n","import { PoseTarget } from \"./PoseTarget\"\n\nexport class PoseEntry {\n    private mFilename: string\n    private mFullPath: string\n    private mTarget?: PoseTarget\n    private mTargetLoadTry: boolean = false;\n    constructor(filename: string, fullPath: string, preload = false) {\n        this.mFilename = filename\n        this.mFullPath = fullPath\n        if (preload) {\n            this.loadFromFile()\n        }\n    }\n    loadFromFile(): boolean {\n        if (this.mTargetLoadTry === false) {\n            this.mTargetLoadTry = true\n            this.mTarget = new PoseTarget(this.mFilename, this.mFullPath)\n            this.mTarget.load()\n        }\n        return this.mTarget !== undefined\n    }\n    isLoaded() {\n        return this.mTargetLoadTry\n    }\n    getTarget() {\n        if (!this.mTargetLoadTry) {\n            this.loadFromFile()\n        }\n        return this.mTarget\n    }\n}\n","import { FileSystemAdapter } from \"../filesystem/FileSystemAdapter\"\nimport { StringToLine } from \"../lib/StringToLine\"\n\nclass FGroupData extends Array<number> {}\nexport class VertexData extends Map<number, number> {}\n\nexport class FGroup {\n    visible!: boolean\n    /// A vector of ints\n    facesIndexes!: FGroupData\n    facesIndexes_subd?: FGroupData ///subdivision\n}\n\nexport function isAlpha(ch: string){\n    return ch >= \"a\" && ch <= \"z\" || ch >= \"A\" && ch <= \"Z\"\n}\n\nexport class FaceGroup extends Map<string, FGroup> {\n    private loaded: boolean = false;\n    // Maps FaceGroup identifiers via vertex group numbers to vertex indices\n    private vertexes = new Map<string, VertexData>();\n    load(filename: string): boolean {\n        let fgroup_indent: string\n        const content = FileSystemAdapter.readFile(filename)\n        const reader = new StringToLine(content)\n        let lineNumber = 0\n        for (let line of reader) {\n            if (isAlpha(line.charAt(0))) {\n                fgroup_indent = line.split(\",\")[0].trim()\n            } else {\n                let data: FGroup = {\n                    visible: true,\n                    facesIndexes: line.split(\" \").map(it => parseInt(it))\n                }\n                this.set(fgroup_indent!, data)\n            }\n        }\n\n        console.log(`loaded ${this.size} face groups from ${filename}`)\n\n        // there's some code for 'visibilities' but there ain't no ones in base.parts\n        return true\n    }\n}\n","/*\n *  The TOAD JavaScript/TypeScript GUI Library\n *  Copyright (C) 2018-2023 Mark-Andr Hopf <mhopf@mark13.org>\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\nexport class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map((a) => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        element.replaceChildren(...this);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\n// https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== \"string\") {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case \"children\":\n                break;\n            case \"action\":\n                ;\n                element.setAction(value);\n                break;\n            case \"model\":\n                ;\n                element.setModel(value);\n                break;\n            case \"class\":\n                element.classList.add(value); // FIXME: value is whitespace separated list\n                break;\n            case \"style\":\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    if (typeof svalue === \"number\") {\n                        svalue = `${svalue}`;\n                    }\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case \"set\":\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substring(2), value);\n                }\n                else {\n                    if (typeof value === \"string\" || typeof value === \"number\" || typeof value === \"boolean\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        appendChildren(element, props.children);\n    }\n}\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n// the FunctionConstructor is a hack for <></>\n// actually it would be nice if we could support value objects too, eg. <TableView> instead of <toad-table>\n// export function createElement(name: string, props: JSX.HTMLElementProps, ...children: any): Element\n// export function createElement(name: FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Fragment\n// export function createElement(name: string | FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Element | Fragment {\n// }\n// backward compability\nexport function createElement(nameOrConstructor, props, ...children) {\n    // console.log(`createElement(${nameOrConstructor}, ${JSON.stringify(props)}, ${children}`)\n    // props: remove 'key', add 'children'\n    let key;\n    if (props !== null) {\n        if (\"key\" in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","export function css(strings, ...values) {\n    let str = strings[0];\n    values.forEach((s, i) => {\n        str = str.concat(s).concat(strings[i + 1]);\n    });\n    return str;\n}\nexport function html(strings, ...values) {\n    let str = strings[0];\n    values.forEach((s, i) => {\n        str = str.concat(s).concat(strings[i + 1]);\n    });\n    return str;\n}\nexport function element(type, children) {\n    const element = document.createElement(type);\n    for (let i = 0; i < children.length; ++i) {\n        let child = children[i];\n        if (child instanceof Array) {\n            children.splice(i, 1, ...child);\n            child = children[i];\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n    return element;\n}\nexport function array(times, create) {\n    let a = [];\n    for (let i = 0; i < times; ++i) {\n        const c = create(i);\n        if (c instanceof Array) {\n            a.push(...c);\n        }\n        else {\n            a.push(c);\n        }\n    }\n    return a;\n}\nexport function text(text) { return document.createTextNode(text); }\nexport const div = (...children) => element(\"div\", children);\nexport const span = (...children) => element(\"span\", children);\nexport const slot = (...children) => element(\"slot\", children);\nexport const form = (...children) => element(\"form\", children);\nexport const input = (...children) => element(\"input\", children);\nexport const button = (...children) => element(\"button\", children);\nexport const label = (...children) => element(\"label\", children);\nexport const ul = (...children) => element(\"ul\", children);\nexport const ol = (...children) => element(\"ol\", children);\nexport const li = (...children) => element(\"li\", children);\nexport const table = (...children) => element(\"table\", children);\nexport const thead = (...children) => element(\"thead\", children);\nexport const th = (...children) => element(\"th\", children);\nexport const tbody = (...children) => element(\"tbody\", children);\nexport const td = (...children) => element(\"td\", children);\nexport const tr = (...children) => element(\"tr\", children);\nconst ns = \"http://www.w3.org/2000/svg\";\nexport function svg(child) {\n    const s = document.createElementNS(ns, \"svg\");\n    if (child !== undefined) {\n        s.appendChild(child);\n    }\n    return s;\n}\nexport function path(d) {\n    const p = document.createElementNS(ns, \"path\");\n    if (d !== undefined) {\n        p.setAttributeNS(null, \"d\", d);\n    }\n    return p;\n}\nexport function rect(x, y, width, height, stroke, fill) {\n    const r = document.createElementNS(ns, \"rect\");\n    r.setAttributeNS(null, \"x\", `${x}`);\n    r.setAttributeNS(null, \"y\", `${y}`);\n    r.setAttributeNS(null, \"width\", `${width}`);\n    r.setAttributeNS(null, \"height\", `${height}`);\n    if (stroke !== undefined) {\n        r.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        r.setAttributeNS(null, \"fill\", fill);\n    }\n    return r;\n}\nexport function line(x1, y1, x2, y2, stroke, fill) {\n    const l = document.createElementNS(ns, \"line\");\n    l.setAttributeNS(null, \"x1\", `${x1}`);\n    l.setAttributeNS(null, \"y1\", `${y1}`);\n    l.setAttributeNS(null, \"x2\", `${x2}`);\n    l.setAttributeNS(null, \"y2\", `${y2}`);\n    if (stroke !== undefined) {\n        l.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        l.setAttributeNS(null, \"fill\", fill);\n    }\n    return l;\n}\nexport function svgAndUse(ref) {\n    const ns = \"http://www.w3.org/2000/svg\";\n    const s = document.createElementNS(ns, \"svg\");\n    const u = document.createElementNS(ns, \"use\");\n    u.setAttributeNS(ns, \"href\", ref);\n    u.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', ref);\n    s.appendChild(u);\n    return s;\n}\n//# sourceMappingURL=lsx.js.map","export class SignalLink {\n    constructor(callback, id) {\n        this.callback = callback;\n        this.id = id;\n    }\n}\nexport class Signal {\n    constructor() {\n        this.locked = false;\n        this.busy = false;\n    }\n    add(callback, id) {\n        if (!this.callbacks)\n            this.callbacks = new Array();\n        this.callbacks.push(new SignalLink(callback, id));\n    }\n    remove(id) {\n        if (!this.callbacks)\n            return;\n        for (let i = this.callbacks.length - 1; i >= 0; --i) {\n            if (this.callbacks[i].id === id)\n                this.callbacks.splice(i, 1);\n        }\n    }\n    count() {\n        if (!this.callbacks)\n            return 0;\n        return this.callbacks.length;\n    }\n    lock() {\n        this.locked = true;\n    }\n    unlock() {\n        this.locked = false;\n        if (this.triggered) {\n            let data = this.triggered.data;\n            this.triggered = undefined;\n            this.trigger(data);\n        }\n    }\n    withLock(closure) {\n        this.lock();\n        const r = closure();\n        this.unlock();\n        return r;\n    }\n    trigger(data) {\n        if (this.busy) {\n            return;\n        }\n        this.busy = true;\n        if (this.locked) {\n            this.triggered = { data: data };\n            this.busy = false;\n            return;\n        }\n        if (!this.callbacks) {\n            this.busy = false;\n            return;\n        }\n        let error;\n        for (let i = 0; i < this.callbacks.length; ++i) {\n            try {\n                this.callbacks[i].callback(data);\n            }\n            catch (e) {\n                error = e;\n            }\n        }\n        this.busy = false;\n        if (error !== undefined) {\n            throw error;\n        }\n    }\n}\n//# sourceMappingURL=Signal.js.map","import { Signal } from \"../Signal.js\";\nexport var ModelReason;\n(function (ModelReason) {\n    ModelReason[ModelReason[\"ALL\"] = 0] = \"ALL\";\n    ModelReason[ModelReason[\"VALUE\"] = 1] = \"VALUE\";\n    ModelReason[ModelReason[\"ENABLED\"] = 2] = \"ENABLED\";\n    ModelReason[ModelReason[\"COLOR\"] = 3] = \"COLOR\";\n    ModelReason[ModelReason[\"LABEL\"] = 4] = \"LABEL\";\n    ModelReason[ModelReason[\"DESCRIPTION\"] = 5] = \"DESCRIPTION\";\n    ModelReason[ModelReason[\"ERROR\"] = 6] = \"ERROR\";\n    ModelReason[ModelReason[\"MAX_REASON\"] = 7] = \"MAX_REASON\";\n})(ModelReason || (ModelReason = {}));\nexport class Model {\n    constructor(options) {\n        this.modified = new Signal();\n        this.options = options;\n    }\n    set enabled(enabled) {\n        if (this.options?.enabled === enabled)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.enabled = enabled;\n        this.modified.trigger(ModelReason.ENABLED);\n    }\n    get enabled() { return this.options?.enabled !== false; }\n    set color(color) {\n        if (this.options?.color === color)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.color = color;\n        this.modified.trigger(ModelReason.COLOR);\n    }\n    get color() { return this.options?.color; }\n    set label(label) {\n        if (this.options?.label === label)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.label = label;\n        this.modified.trigger(ModelReason.LABEL);\n    }\n    get label() { return this.options?.label; }\n    set description(description) {\n        if (this.options?.description === description)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.description = description;\n        this.modified.trigger(ModelReason.DESCRIPTION);\n    }\n    get description() { return this.options?.description; }\n    set error(error) {\n        if (this.options?.error === error)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.error = error;\n        this.modified.trigger(ModelReason.ERROR);\n    }\n    get error() { return this.options?.error; }\n    applyStyle(element) {\n        if (this.enabled) {\n            element.removeAttribute(\"disabled\");\n        }\n        else {\n            element.setAttribute(\"disabled\", \"disabled\");\n        }\n        if (this.color !== undefined) {\n            element.style.fontStyle = \"\";\n            element.style.fontWeight = \"\";\n            element.style.color = \"\";\n            switch (this.color) {\n                case \"italic\":\n                    element.style.fontStyle = \"italic\";\n                    break;\n                case \"bold\":\n                    element.style.fontWeight = \"bold\";\n                    break;\n                default:\n                    element.style.color = this.color;\n            }\n        }\n        else {\n            element.style.color = \"\";\n            element.style.fontStyle = \"\";\n            element.style.fontWeight = \"\";\n        }\n        if (this.error !== undefined) {\n            element.classList.add(\"tx-error\");\n        }\n        else {\n            element.classList.remove(\"tx-error\");\n        }\n    }\n}\n//# sourceMappingURL=Model.js.map","import { Model, ModelReason } from \"./Model.js\";\nexport var ValueModelReason;\n(function (ValueModelReason) {\n    ValueModelReason[ValueModelReason[\"DEFAULT\"] = 7] = \"DEFAULT\";\n    ValueModelReason[ValueModelReason[\"MAX_REASON\"] = 8] = \"MAX_REASON\";\n})(ValueModelReason || (ValueModelReason = {}));\nexport class AbstractValueModel extends Model {\n    set default(aDefault) {\n        if (this.options?.default === aDefault)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.default = aDefault;\n        this.modified.trigger(ValueModelReason.DEFAULT);\n    }\n    get default() {\n        return this.options?.default;\n    }\n    resetToDefault() {\n        const d = this.default;\n        if (d !== undefined) {\n            this.value = d;\n        }\n    }\n}\nexport class ValueModel extends AbstractValueModel {\n    constructor(value, options) {\n        super(options);\n        this._value = value;\n    }\n    set value(value) {\n        if (this._value === value)\n            return;\n        this._value = value;\n        this.modified.trigger(ModelReason.VALUE);\n    }\n    get value() {\n        return this._value;\n    }\n}\n//# sourceMappingURL=ValueModel.js.map","import { ValueModel } from \"./ValueModel.js\";\nimport { BigDecimal } from \"../util/BigDecimal.js\";\nimport { expression } from \"../util/expressions/expression.js\";\nexport var NumberModelReason;\n(function (NumberModelReason) {\n    NumberModelReason[NumberModelReason[\"MIN\"] = 8] = \"MIN\";\n    NumberModelReason[NumberModelReason[\"MAX\"] = 9] = \"MAX\";\n    NumberModelReason[NumberModelReason[\"STEP\"] = 10] = \"STEP\";\n    NumberModelReason[NumberModelReason[\"AUTOCORRECT\"] = 11] = \"AUTOCORRECT\";\n    NumberModelReason[NumberModelReason[\"MAX_REASON\"] = 12] = \"MAX_REASON\";\n})(NumberModelReason || (NumberModelReason = {}));\nexport class NumberModel extends ValueModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n    increment() {\n        if (this.step !== undefined) {\n            const value = new BigDecimal(this.value);\n            const step = new BigDecimal(this.step);\n            this.value = this.clip(parseFloat(value.add(step).toString()));\n        }\n    }\n    decrement() {\n        if (this.step !== undefined) {\n            const value = new BigDecimal(this.value);\n            const step = new BigDecimal(this.step);\n            this.value = this.clip(parseFloat(value.sub(step).toString()));\n        }\n    }\n    set value(value) {\n        let number;\n        if (typeof value === \"string\") {\n            const ex = expression(value);\n            number = ex.eval();\n        }\n        else {\n            number = value;\n        }\n        this.modified.withLock(() => {\n            if (this.autocorrect) {\n                super.value = this.clip(number);\n            }\n            else {\n                super.value = number;\n                this.error = this.check(number);\n            }\n        });\n    }\n    get value() {\n        return super.value;\n    }\n    set min(min) {\n        if (this.options?.min === min)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.min = min;\n        this.modified.trigger(NumberModelReason.MIN);\n    }\n    get min() {\n        return this.options?.min;\n    }\n    set max(max) {\n        if (this.options?.max === max)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.max = max;\n        this.modified.trigger(NumberModelReason.MAX);\n    }\n    get max() {\n        return this.options?.max;\n    }\n    set step(step) {\n        if (this.options?.step === step)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.step = step;\n        this.modified.trigger(NumberModelReason.STEP);\n    }\n    get step() {\n        return this.options?.step;\n    }\n    set autocorrect(autocorrect) {\n        if (this.options?.autocorrect === autocorrect)\n            return;\n        if (this.options === undefined) {\n            this.options = {};\n        }\n        this.options.autocorrect = autocorrect;\n        this.modified.trigger(NumberModelReason.AUTOCORRECT);\n    }\n    get autocorrect() {\n        return this.options?.autocorrect === true;\n    }\n    clip(value) {\n        if (this.min !== undefined && value < this.min) {\n            value = this.min;\n        }\n        if (this.max !== undefined && value > this.max) {\n            value = this.max;\n        }\n        return value;\n    }\n    check(value) {\n        if (this.min !== undefined && value < this.min) {\n            return `The value must not be below ${this.min}.`;\n        }\n        if (this.max !== undefined && value > this.max) {\n            if (this.autocorrect) {\n                value = this.max;\n            }\n            else {\n                return `The value must not be above ${this.max}.`;\n            }\n        }\n        return undefined;\n    }\n}\n//# sourceMappingURL=NumberModel.js.map","import { ValueModel } from \"./ValueModel.js\";\nexport class BooleanModel extends ValueModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n}\n//# sourceMappingURL=BooleanModel.js.map","export class BigDecimal {\n    constructor(value) {\n        this._n = 0n;\n        if (value instanceof BigDecimal)\n            return value;\n        let [ints, decis] = String(value).split(\".\").concat(\"\");\n        this._n = BigInt(ints + decis.padEnd(BigDecimal.DECIMALS, \"0\")\n            .slice(0, BigDecimal.DECIMALS))\n            + BigInt(BigDecimal.ROUNDED && decis[BigDecimal.DECIMALS] >= \"5\");\n    }\n    static fromBigInt(bigint) {\n        return Object.assign(Object.create(BigDecimal.prototype), { _n: bigint });\n    }\n    add(num) {\n        return BigDecimal.fromBigInt(this._n + new BigDecimal(num)._n);\n    }\n    sub(num) {\n        return BigDecimal.fromBigInt(this._n - new BigDecimal(num)._n);\n    }\n    static _divRound(dividend, divisor) {\n        return BigDecimal.fromBigInt(dividend / divisor\n            + (BigDecimal.ROUNDED ? dividend * 2n / divisor % 2n : 0n));\n    }\n    mul(num) {\n        return BigDecimal._divRound(this._n * new BigDecimal(num)._n, BigDecimal.SHIFT);\n    }\n    div(num) {\n        return BigDecimal._divRound(this._n * BigDecimal.SHIFT, new BigDecimal(num)._n);\n    }\n    toString() {\n        const s = this._n.toString().padStart(BigDecimal.DECIMALS + 1, \"0\");\n        return s.slice(0, -BigDecimal.DECIMALS) + \".\" + s.slice(-BigDecimal.DECIMALS)\n            .replace(/\\.?0+$/, \"\");\n    }\n}\nBigDecimal.DECIMALS = 18;\nBigDecimal.ROUNDED = true;\nBigDecimal.SHIFT = BigInt(\"1\" + \"0\".repeat(BigDecimal.DECIMALS));\n//# sourceMappingURL=BigDecimal.js.map","export class ExpressionNode {\n    constructor(value) {\n        this.value = value;\n    }\n    eval(model) {\n        if (typeof this.value === \"number\") {\n            return this.value;\n        }\n        if (this.value instanceof Array) {\n            if (model === undefined) {\n                throw Error(`yikes: no model to get cell [${this.value[0]},${this.value[1]}]`);\n            }\n            return model.getCell(this.value[0], this.value[1])._calculatedValue;\n        }\n        switch (this.value) {\n            case '+':\n                return this.down.eval(model) + this.down.next.eval(model);\n            case '-':\n                if (this.down?.next) {\n                    return this.down.eval(model) - this.down.next.eval(model);\n                }\n                return -this.down.eval(model);\n            case '*':\n                return this.down.eval(model) * this.down.next.eval(model);\n            case '/':\n                return this.down.eval(model) / this.down.next.eval(model);\n            default:\n                throw Error(`unexpected token '${this.value}'`);\n        }\n    }\n    append(node) {\n        if (this.down === undefined) {\n            this.down = node;\n        }\n        else {\n            let n = this.down;\n            while (n.next) {\n                n = n.next;\n            }\n            n.next = node;\n        }\n    }\n    dependencies(deps = []) {\n        if (this.value instanceof Array) {\n            deps.push(this.value);\n        }\n        if (this.next) {\n            this.next.dependencies(deps);\n        }\n        if (this.down) {\n            this.down.dependencies(deps);\n        }\n        return deps;\n    }\n    toString() {\n        return this._toString();\n    }\n    _toString(out = \"\\n\", indent = 0) {\n        for (let i = 0; i < indent; ++i) {\n            out += \"    \";\n        }\n        out += this.value;\n        out += \"\\n\";\n        for (let n = this.down; n; n = n.next) {\n            out = n._toString(out, indent + 1);\n        }\n        return out;\n    }\n}\n//# sourceMappingURL=ExpressionNode.js.map","import { ExpressionNode } from \"./ExpressionNode.js\";\nexport class Lexer {\n    constructor(str) {\n        this.i = 0;\n        this.stack = [];\n        this.str = str;\n    }\n    isspace(c) {\n        return c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == '\\t';\n    }\n    isnumber(c) {\n        const code = c.charCodeAt(0);\n        return code >= 0x30 && code <= 0x39;\n    }\n    isalpha(c) {\n        const code = c.charCodeAt(0);\n        return code >= 0x41 && code <= 0x5a || code >= 0x91 && code <= 0x7a;\n    }\n    isalnum(c) {\n        return this.isnumber(c) || this.isalpha(c);\n    }\n    unlex(node) {\n        this.stack.push(node);\n    }\n    lex() {\n        if (this.stack.length > 0) {\n            return this.stack.pop();\n        }\n        let col = 0, row = 0;\n        let state = 0;\n        if (this.i >= this.str.length) {\n            return undefined;\n        }\n        const start = this.i;\n        while (true) {\n            let c = this.str.at(this.i);\n            switch (state) {\n                case 0:\n                    if (c === undefined) {\n                        return undefined;\n                    }\n                    if (this.isspace(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    if (this.isnumber(c)) {\n                        ++this.i;\n                        state = 1;\n                        break;\n                    }\n                    if (this.isalpha(c)) {\n                        col = 0;\n                        state = 3;\n                        break;\n                    }\n                    switch (c) {\n                        case '+':\n                        case '-':\n                        case '*':\n                        case '/':\n                        case '(':\n                        case ')':\n                        case '=':\n                            ++this.i;\n                            return new ExpressionNode(c);\n                    }\n                    return undefined;\n                case 1:\n                    if (c !== undefined && this.isnumber(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    if (c === '.' || c == 'e' || c == 'E') {\n                        ++this.i;\n                        state = 2;\n                        break;\n                    }\n                    return new ExpressionNode(parseFloat(this.str.substring(start, this.i)));\n                case 2:\n                    if (c !== undefined && this.isnumber(c)) {\n                        ++this.i;\n                        break;\n                    }\n                    return new ExpressionNode(parseFloat(this.str.substring(start, this.i)));\n                case 3:\n                    if (c !== undefined) {\n                        const code = c.charCodeAt(0);\n                        if (code >= 0x30 && code <= 0x39) {\n                            row = code - 0x30;\n                            state = 4;\n                            ++this.i;\n                            break;\n                        }\n                        if (code >= 0x41 && code <= 0x5a) {\n                            col *= 26;\n                            col += code - 0x40;\n                            ++this.i;\n                            break;\n                        }\n                        if (code >= 0x91 && code <= 0x7a) {\n                            col *= 26;\n                            col += code - 0x90;\n                            ++this.i;\n                            break;\n                        }\n                    }\n                    return new ExpressionNode(this.str.substring(start, this.i));\n                case 4:\n                    if (c !== undefined) {\n                        const code = c.charCodeAt(0);\n                        if (code >= 0x30 && code <= 0x39) {\n                            row *= 10;\n                            row += code - 0x30;\n                            ++this.i;\n                            break;\n                        }\n                    }\n                    return new ExpressionNode([col - 1, row - 1]);\n            }\n        }\n    }\n}\n//# sourceMappingURL=Lexer.js.map","import { Lexer } from \"./Lexer.js\";\nexport function assignmentExpression(expr) {\n    const lexer = new Lexer(expr);\n    const n0 = lexer.lex();\n    if (n0 === undefined || n0.value !== '=') {\n        return undefined;\n    }\n    return additive_expression(lexer);\n}\nexport function expression(expr) {\n    const lexer = new Lexer(expr);\n    return additive_expression(lexer);\n}\nfunction additive_expression(lexer) {\n    const n0 = multiplicative_expression(lexer);\n    if (n0 === undefined) {\n        return undefined;\n    }\n    const n1 = lexer.lex();\n    if (n1 === undefined) {\n        return n0;\n    }\n    if (n1.value === \"+\" || n1.value === \"-\") {\n        const n2 = additive_expression(lexer);\n        if (n2 === undefined) {\n            lexer.unlex(n1);\n            return n0;\n        }\n        n1.append(n0);\n        n1.append(n2);\n        return n1;\n    }\n    lexer.unlex(n1);\n    return n0;\n}\nfunction multiplicative_expression(lexer) {\n    const n0 = unary_expression(lexer);\n    if (n0 === undefined) {\n        return undefined;\n    }\n    const n1 = lexer.lex();\n    if (n1 === undefined) {\n        return n0;\n    }\n    if (n1.value === \"*\" || n1.value === \"/\") {\n        const n2 = multiplicative_expression(lexer);\n        if (n2 === undefined) {\n            throw Error(`expexted expression after ${n1.value}`);\n        }\n        n1.append(n0);\n        n1.append(n2);\n        return n1;\n    }\n    lexer.unlex(n1);\n    return n0;\n}\nfunction unary_expression(lexer) {\n    const n0 = lexer.lex();\n    if (n0 === undefined) {\n        return undefined;\n    }\n    if (typeof n0.value === \"number\") {\n        return n0;\n    }\n    if (n0.value instanceof Array) {\n        return n0;\n    }\n    if (n0.value === \"(\") {\n        const n1 = additive_expression(lexer);\n        if (n1 === undefined) {\n            throw Error(\"Unexpected end after '(\");\n        }\n        const n2 = lexer.lex();\n        if (n2?.value !== ')') {\n            throw Error(\"Excepted ')\");\n        }\n        return n1;\n    }\n    if (n0.value === \"-\") {\n        const n1 = unary_expression(lexer);\n        if (n1 !== undefined) {\n            n0.append(n1);\n            return n0;\n        }\n    }\n    lexer.unlex(n0);\n    return undefined;\n}\n//# sourceMappingURL=expression.js.map","import { ModelReason } from \"./Model.js\";\nimport { AbstractValueModel } from \"./ValueModel.js\";\nexport class TextModel extends AbstractValueModel {\n    constructor(value = \"\", options) {\n        super(options);\n        this.value = value;\n    }\n    set promise(promise) {\n        this._value = promise;\n        this.modified.trigger(ModelReason.VALUE);\n    }\n    get promise() {\n        if (typeof this._value === \"string\") {\n            const value = this._value;\n            return () => {\n                return value;\n            };\n        }\n        return this._value;\n    }\n    set value(value) {\n        if (this._value === value) {\n            return;\n        }\n        if (typeof value !== \"string\") {\n            console.trace(`TextModel.set value(value: string): ${typeof value} is not type string`);\n            return;\n        }\n        this.modified.withLock(() => {\n            this.error = undefined;\n            this._value = value;\n            this.modified.trigger(ModelReason.VALUE);\n        });\n    }\n    get value() {\n        switch (typeof this._value) {\n            case \"number\":\n            case \"string\":\n                this._value = `${this._value}`;\n                break;\n            case \"function\":\n                this._value = this._value();\n                break;\n        }\n        return this._value;\n    }\n}\n//# sourceMappingURL=TextModel.js.map","import { TextModel } from \"./TextModel.js\";\nexport class HtmlModel extends TextModel {\n    constructor(value, options) {\n        super(value, options);\n    }\n}\n//# sourceMappingURL=HtmlModel.js.map","import { Model } from \"./Model.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Action extends Model {\n    constructor(callback) {\n        super();\n        this.signal = new Signal();\n        this.signal.add(callback);\n    }\n    set value(_) {\n        throw Error(\"Action.value can not be assigned a value\");\n    }\n    get value() {\n        throw Error(\"Action.value can not return a value\");\n    }\n    trigger(data) {\n        if (!this.enabled) {\n            return;\n        }\n        this.signal.trigger(data);\n    }\n}\n//# sourceMappingURL=Action.js.map","export function instantiateTemplate(name) {\n    return tmpl(name);\n}\nexport function tmpl(name) {\n    let t = document.querySelector('template[id=\"' + name + '\"]');\n    if (!t) {\n        throw new Error(\"failed to find template '\" + name + \"'\");\n    }\n    let x = t;\n    let z = x.content;\n    let y = document.importNode(z, true);\n    return y;\n}\nexport function find(node, selector) {\n    return node.querySelector(selector);\n}\nexport function tag(name) {\n    return document.createElement(name);\n}\nexport function txt(txt) {\n    return document.createTextNode(txt);\n}\nexport function img(src) {\n    let img = document.createElement(\"img\");\n    img.src = src;\n    return img;\n}\nexport function add(n0, n1) {\n    n0.appendChild(n1);\n}\nexport function remove(n) {\n    if (!n.parentNode)\n        throw Error(\"element has no parent\");\n    n.parentNode.removeChild(n);\n}\nexport function erase(n) {\n    n.replaceChildren();\n}\nexport function hasFocus(element) {\n    let active = document.activeElement;\n    while (active !== null) {\n        if (active === element) {\n            return true;\n        }\n        if (active.shadowRoot === null)\n            break;\n        active = active.shadowRoot.activeElement;\n    }\n    return false;\n}\nexport function grabMouse(event) {\n    let target = event.target;\n    let documentMouseMove = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mousemove\", event));\n        event.stopPropagation();\n    };\n    let documentMouseUp = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mouseup\", event));\n        document.removeEventListener(\"mousemove\", documentMouseMove, { capture: true });\n        document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n        document.body.style.pointerEvents = \"auto\";\n        event.stopPropagation();\n    };\n    document.addEventListener(\"mousemove\", documentMouseMove, { capture: true });\n    document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n    document.body.style.pointerEvents = \"none\";\n    event.preventDefault();\n    event.stopPropagation();\n}\nexport function attribute(element, name) {\n    let attribute = element.getAttribute(name);\n    if (attribute === null) {\n        console.log(\"missing attribute '\" + name + \"' in \", element);\n        throw Error(\"missing attribute '\" + name + \"' in \" + element.nodeName);\n    }\n    return attribute;\n}\nexport function attributeOrUndefined(element, name) {\n    let attribute = element.getAttribute(name);\n    return attribute === null ? undefined : attribute;\n}\nexport function isNodeBeforeNode(first, second) {\n    let node;\n    let firstPrevious = first;\n    node = first;\n    let parentsOfFirstNode = new Map();\n    while (true) {\n        firstPrevious = node;\n        node = node.parentNode;\n        if (!node)\n            break;\n        parentsOfFirstNode.set(node, firstPrevious);\n    }\n    let secondPrevious = second;\n    node = second;\n    while (node) {\n        secondPrevious = node;\n        node = node.parentNode;\n        if (!node) {\n            throw Error(`isNodeBeforeNode(first, second): nodes have no common parent`);\n        }\n        let lookup = parentsOfFirstNode.get(node);\n        if (lookup) {\n            firstPrevious = lookup;\n            break;\n        }\n    }\n    for (let child of node.childNodes) {\n        if (child === firstPrevious)\n            return true;\n        if (child === secondPrevious)\n            return false;\n    }\n    throw Error(\"isNodeBeforeNode(first, second): couldn't determine order of nodes\");\n}\nexport function pixelToNumber(pixel) {\n    if (pixel === \"\")\n        return 0;\n    if (pixel.substr(pixel.length - 2) !== \"px\")\n        throw Error(`pixelToNumber('${pixel}') expected 'px' suffix`);\n    return Number.parseFloat(pixel.substr(0, pixel.length - 2));\n}\nexport function getPropertyValue(element, propertyName) {\n    let elementStyle = window.getComputedStyle(element, undefined);\n    let property = elementStyle.getPropertyValue(propertyName);\n    return pixelToNumber(property);\n}\nexport function horizontalPadding(element) {\n    return getPropertyValue(element, \"padding-left\") + getPropertyValue(element, \"padding-right\");\n}\nexport function verticalPadding(element) {\n    return getPropertyValue(element, \"padding-top\") + getPropertyValue(element, \"padding-bottom\");\n}\n//# sourceMappingURL=dom.js.map","import { Controller } from \"./Controller.js\";\nexport let globalController = new Controller();\nexport function bindModel(modelId, model) {\n    globalController.bind(modelId, model);\n}\nexport function action(actionId, action) {\n    return globalController.registerAction(actionId, action);\n}\nexport function unbind() {\n    globalController.clear();\n}\nexport function text(modelId, value) {\n    return globalController.text(modelId, value);\n}\nexport function boolean(modelId, value) {\n    return globalController.boolean(modelId, value);\n}\n//# sourceMappingURL=globalController.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { Action } from \"../model/Action.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Controller {\n    constructor() {\n        this.modelId2Models = new Map();\n        this.modelId2Views = new Map();\n        this.view2ModelIds = new Map();\n        this.sigChanged = new Signal();\n    }\n    registerAction(actionId, callback) {\n        let action = new Action(callback);\n        action.signal.add(callback);\n        this._registerModel(\"A:\" + actionId, action);\n        return action;\n    }\n    registerModel(modelId, model) {\n        this._registerModel(\"M:\" + modelId, model);\n    }\n    _registerModel(modelId, model) {\n        let modelsForModelId = this.modelId2Models.get(modelId);\n        if (!modelsForModelId) {\n            modelsForModelId = new Set();\n            this.modelId2Models.set(modelId, modelsForModelId);\n        }\n        modelsForModelId.add(model);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId)\n            return;\n        for (let view of viewsForModelId) {\n            view.setModel(model);\n        }\n    }\n    registerView(modelId, view) {\n        if (view.controller && view.controller !== this) {\n            console.log(\"error: attempt to register view more than once at different controllers\");\n            return;\n        }\n        view.controller = this;\n        let modelIdsForView = this.view2ModelIds.get(view);\n        if (!modelIdsForView) {\n            modelIdsForView = new Set();\n            this.view2ModelIds.set(view, modelIdsForView);\n        }\n        modelIdsForView.add(modelId);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId) {\n            viewsForModelId = new Set();\n            this.modelId2Views.set(modelId, viewsForModelId);\n        }\n        viewsForModelId.add(view);\n        let modelsForView = this.modelId2Models.get(modelId);\n        if (!modelsForView)\n            return;\n        for (let model of modelsForView) {\n            view.setModel(model);\n        }\n    }\n    unregisterView(view) {\n        if (!view.controller)\n            return;\n        if (view.controller !== this)\n            throw Error(\"attempt to unregister view from wrong controller\");\n        let modelIds = this.view2ModelIds.get(view);\n        if (!modelIds)\n            return;\n        for (let modelId of modelIds) {\n            let views = this.modelId2Views.get(modelId);\n            if (!views)\n                continue;\n            views.delete(view);\n            if (views.size === 0) {\n                this.modelId2Views.delete(modelId);\n            }\n            view.setModel(undefined);\n        }\n    }\n    clear() {\n        for (let entry of this.view2ModelIds) {\n            entry[0].setModel(undefined);\n        }\n        this.modelId2Models.clear();\n        this.modelId2Views.clear();\n        this.view2ModelIds.clear();\n    }\n    bind(modelId, model) {\n        this.registerModel(modelId, model);\n    }\n    action(actionId, callback) {\n        return this.registerAction(actionId, callback);\n    }\n    text(modelId, value) {\n        let model = new TextModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    html(modelId, value) {\n        let model = new HtmlModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    boolean(modelId, value) {\n        let model = new BooleanModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    number(modelId, value, options) {\n        let model = new NumberModel(value, options);\n        this.bind(modelId, model);\n        return model;\n    }\n}\n//# sourceMappingURL=Controller.js.map","export class AnimationBase {\n    constructor() {\n        this._stop = false;\n        this._firstFrame = this._firstFrame.bind(this);\n        this._animationFrame = this._animationFrame.bind(this);\n    }\n    start() {\n        this.prepare();\n        if (this._stop === true)\n            return;\n        this.requestAnimationFrame(this._firstFrame);\n    }\n    stop() {\n        this._stop = true;\n        if (this.animator?.current === this) {\n            this.animator.clearCurrent();\n        }\n    }\n    replace(animation) {\n        this.next = animation;\n        this.animationFrame(1);\n        this.lastFrame();\n        animation.prepare();\n    }\n    prepare() { }\n    firstFrame() { }\n    animationFrame(value) { }\n    lastFrame() { }\n    requestAnimationFrame(callback) {\n        window.requestAnimationFrame(callback);\n    }\n    _firstFrame(time) {\n        this.startTime = time;\n        this.firstFrame();\n        if (this._stop)\n            return;\n        this.animationFrame(0);\n        this.requestAnimationFrame(this._animationFrame);\n    }\n    _animationFrame(time) {\n        if (this.next) {\n            this.next._firstFrame(time);\n            return;\n        }\n        let elapsed = AnimationBase.animationFrameCount > 0 ? (time - this.startTime) / AnimationBase.animationFrameCount : 1;\n        elapsed = elapsed > 1 ? 1 : elapsed;\n        const value = this.ease(elapsed);\n        this.animationFrame(value);\n        if (this._stop) {\n            return;\n        }\n        if (value < 1.0) {\n            this.requestAnimationFrame(this._animationFrame.bind(this));\n        }\n        else {\n            this.lastFrame();\n            if (this.animator && this.animator._current === this) {\n                this.animator.clearCurrent();\n            }\n        }\n    }\n    ease(k) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n}\nAnimationBase.animationFrameCount = 468;\nclass AnimationWrapper extends AnimationBase {\n    constructor(animation) {\n        super();\n        this.animation = animation;\n    }\n    prepare() {\n        this.animation.prepare();\n    }\n    firstFrame() {\n        this.animation.firstFrame();\n    }\n    animationFrame(value) {\n        this.animation.animationFrame(value);\n    }\n    lastFrame() {\n        this.animation.lastFrame();\n    }\n}\nexport class Animator {\n    get current() {\n        if (this._current === undefined) {\n            return undefined;\n        }\n        if (this._current instanceof AnimationWrapper) {\n            return this._current.animation;\n        }\n        return this._current;\n    }\n    clearCurrent() {\n        this._current = undefined;\n    }\n    run(animation) {\n        let animationBase;\n        if (!(animation instanceof AnimationBase)) {\n            animationBase = new AnimationWrapper(animation);\n        }\n        else {\n            animationBase = animation;\n        }\n        const previousAnimation = this._current;\n        this._current = animationBase;\n        animationBase.animator = this;\n        if (previousAnimation) {\n            previousAnimation.animator = undefined;\n            previousAnimation.replace(animationBase);\n        }\n        else {\n            if (Animator.halt) {\n                return;\n            }\n            animationBase.start();\n        }\n    }\n}\nAnimator.halt = false;\n//# sourceMappingURL=animation.js.map","import { globalController } from \"../controller/globalController.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nexport class View extends HTMLElement {\n    static define(name, view, options) {\n        const element = window.customElements.get(name);\n        if (element === undefined) {\n            window.customElements.define(name, view, options);\n        }\n        else {\n            if (element !== view) {\n                for (let i = 0; i < 255; ++i) {\n                    const dname = `${name}-duplicate-${i}`;\n                    if (window.customElements.get(dname) === undefined) {\n                        console.log(`View::define(${name}, ...) with different constructor, using ${dname} instead (known issue on Safari and Edge)`);\n                        window.customElements.define(dname, view, options);\n                        return;\n                    }\n                }\n                console.error(`View::define(${name}, ...): attempt to redefine view with different constructor (known issue on Safari and Edge), giving up after 255 times`);\n            }\n        }\n    }\n    constructor(props) {\n        super();\n        setInitialProperties(this, props);\n    }\n    setModel(model) {\n        console.trace(`Please note that View.setModel(model) has no implementation.`);\n    }\n    getModelId() {\n        if (!this.hasAttribute(\"model\"))\n            throw Error(\"no 'model' attribute\");\n        let modelId = this.getAttribute(\"model\");\n        if (!modelId)\n            throw Error(\"no model id\");\n        return \"M:\" + modelId;\n    }\n    getActionId() {\n        if (!this.hasAttribute(\"action\"))\n            throw Error(\"no 'action' attribute\");\n        let actionId = this.getAttribute(\"action\");\n        if (!actionId)\n            throw Error(\"no action id\");\n        return \"A:\" + actionId;\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        let modelId = \"\";\n        try {\n            modelId = this.getModelId();\n        }\n        catch (error) {\n        }\n        if (modelId != \"\")\n            globalController.registerView(modelId, this);\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n}\n//# sourceMappingURL=View.js.map","import { ModelReason } from \"../model/Model.js\";\nimport { View } from \"./View.js\";\nexport class ModelView extends View {\n    constructor(init) {\n        super(init);\n        this.model = undefined;\n        if (init?.model !== undefined) {\n            this.setModel(init.model);\n        }\n    }\n    updateModel() { }\n    updateView(reason) { }\n    setModel(model) {\n        if (model === this.model)\n            return;\n        const view = this;\n        if (this.model) {\n            this.model.modified.remove(view);\n        }\n        if (model) {\n            model.modified.add((reason) => view.updateView(reason), view);\n        }\n        this.model = model;\n        if (this.isConnected) {\n            this.updateView(ModelReason.ALL);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model) {\n            this.updateView(ModelReason.ALL);\n        }\n    }\n}\n//# sourceMappingURL=ModelView.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { ModelReason } from \"../model/Model.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { Action } from \"../model/Action.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class ActionView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    connectedCallback() {\n        if (this.controller) {\n            this.updateView(ModelReason.ALL);\n            return;\n        }\n        try {\n            globalController.registerView(this.getActionId(), this);\n        }\n        catch (e) { }\n        try {\n            globalController.registerView(this.getModelId(), this);\n        }\n        catch (e) { }\n        this.updateView(ModelReason.ALL);\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (model === undefined) {\n            if (this.model)\n                this.model.modified.remove(this);\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView(ModelReason.ALL);\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView(ModelReason.ALL);\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n            this.model.modified.add(() => {\n                this.updateView(ModelReason.ALL);\n            }, this);\n        }\n        else {\n            if (typeof model === \"object\") {\n                throw Error(`unexpected model of type ${model.constructor.name}`);\n            }\n            else {\n                throw Error(`unexpected model of type ${typeof model}`);\n            }\n        }\n        this.updateView(ModelReason.ALL);\n    }\n    setAction(value) {\n        if (value instanceof Function) {\n            this.setModel(new Action(value));\n        }\n        else {\n            this.setModel(value);\n        }\n    }\n    isEnabled() {\n        return this.action !== undefined && this.action.enabled;\n    }\n}\n//# sourceMappingURL=ActionView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host {\n    display: inline-block;\n}\n\n.tx-text {\n    width: 100%;\n    box-shadow: none;\n    box-sizing: border-box;\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n\n    /* we use the border instead of an outline to indicate the focus */\n    outline: none;\n    border-width: var(--tx-border-width);\n    border-style: solid;\n    border-color: var(--tx-border-color);\n    border-radius: var(--tx-border-radius);\n\n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n\n    padding: 4px 8px 4px 8px;\n    text-indent: 0;\n    vertical-align: top;\n    margin: 0;\n    overflow: visible;\n    text-overflow: ellipsis;\n}\n.tx-text:hover {\n    border-color: var(--tx-border-color-hover);\n}\n.tx-text:disabled {\n    color: var(--tx-fg-color-disabled);\n    background-color: var(--tx-bg-color-disabled);\n    border-color: var(--tx-bg-color-disabled);\n}\n.tx-text::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n.tx-text:hover::placeholder {\n    color: var(--tx-placeholder-fg-color-hover);\n}\n.tx-text:focus {\n    border-color: var(--tx-outline-color);\n}\n.tx-text.tx-error {\n    border-color: var(--tx-warning-color)\n}\n`);\n//# sourceMappingURL=tx-text.js.map","import { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class TextField extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = document.createElement(\"input\");\n        this.input.classList.add(\"tx-text\");\n        this.input.onkeydown = (e) => {\n            if (e.key === \"Enter\" && this.model instanceof NumberModel) {\n                this.updateModel();\n            }\n        };\n        this.input.onblur = (e) => {\n            if (this.model instanceof NumberModel) {\n                this.updateModel();\n            }\n        };\n        this.input.oninput = (e) => {\n            if (!(this.model instanceof NumberModel)) {\n                this.updateModel();\n            }\n        };\n        this.wheel = this.wheel.bind(this);\n        this.input.onwheel = this.wheel;\n        this.input.ondblclick = () => {\n            this.model?.resetToDefault();\n        };\n        this.attachShadow({ mode: \"open\", delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txText];\n        this.shadowRoot.appendChild(this.input);\n        this.updateView();\n    }\n    wheel(e) {\n        if (this.model instanceof NumberModel) {\n            e.preventDefault();\n            if (e.deltaY > 0) {\n                this.model.decrement();\n            }\n            if (e.deltaY < 0) {\n                this.model.increment();\n            }\n        }\n    }\n    focus() {\n        this.input.focus();\n    }\n    blur() {\n        this.input.blur();\n    }\n    static get observedAttributes() { return ['value']; }\n    attributeChangedCallback(name, oldValue, newValue) {\n        switch (name) {\n            case \"value\":\n                if (this.model && newValue !== undefined) {\n                    this.model.value = newValue;\n                }\n                break;\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.value;\n        }\n        this.setAttribute(\"value\", this.input.value);\n    }\n    updateView() {\n        if (!this.model) {\n            this.setAttribute(\"disabled\", \"disabled\");\n            this.input.setAttribute(\"disabled\", \"disabled\");\n            return;\n        }\n        if (this.model.enabled) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n        this.model.applyStyle(this.input);\n        const strValue = `${this.model.value}`;\n        if (this.input.value !== strValue) {\n            this.input.value = strValue;\n            this.setAttribute(\"value\", strValue);\n        }\n    }\n    get value() {\n        return this.input.value;\n    }\n    set value(value) {\n        this.input.value = value;\n        this.updateModel();\n    }\n}\nTextField.define(\"tx-text\", TextField);\n//# sourceMappingURL=TextField.js.map","import { css } from \"../util/lsx.js\";\nexport const textAreaStyle = new CSSStyleSheet();\ntextAreaStyle.replaceSync(css `\n\n/* try to follow material ui: when active render button labels in black, otherwise in gray */\nsvg .fill {\n  fill: var(--tx-gray-700);\n  stroke: var(--tx-gray-700);\n}\nsvg .stroke {\n  fill: none;\n  stroke: var(--tx-gray-700);\n}\nsvg .strokeFill {\n  fill: var(--tx-gray-200);\n  stroke: var(--tx-gray-700);\n}\n\n/*\nthese don't seem to be in use anymore\n.toolbar.active svg .fill {\n  fill: #000;\n  stroke: #000;\n}\n.toolbar.active svg .stroke {\n  fill: none;\n  stroke: #000;\n}\n.toolbar.active svg .strokeFill {\n  fill: #fff;\n  stroke: #000;\n}\n*/\n\n.toolbar button {\n    background: var(--tx-gray-75);\n    color: var(--tx-gray-800);\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    padding: 5;\n    margin: 0;\n    vertical-align: middle;\n    height: 22px;\n}\n\n.toolbar button:active:hover {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n}\n\n.toolbar button.left {\n    border-style: solid;\n    border-radius: 3px 0 0 3px;\n}\n\n.toolbar button.right {\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    border-radius: 0 3px 3px 0;\n}\n\n.toolbar button.active {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n    border: 1px var(--tx-global-blue-500) solid;\n    color: var(--tx-gray-900);\n}\n\ndiv.textarea {\n  font-family: var(--tx-font-family);\n  font-size: var(--tx-font-size);\n  border: 1px var(--tx-gray-400) solid;\n  border-radius: 3px;\n  margin: 2px;\n  padding: 4px 5px;\n  outline-offset: -2px;\n}\n\ndiv.textarea h1 {\n  font-size: 22px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h2 {\n  font-size: 18px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h3 {\n  font-size: 16px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h4 {\n  font-size: 14px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea div {\n  padding: 2px 0 2px 0;\n}\n`);\n//# sourceMappingURL=textAreaStyle.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { textAreaStyle } from \"./textAreaStyle.js\";\nexport class TextTool extends ModelView {\n    constructor() {\n        super();\n        TextTool.texttool = this;\n        let toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonH1 = _jsx(\"button\", { class: \"left\", children: \"H1\" });\n        this.buttonH1.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h1>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH1);\n        this.buttonH2 = _jsx(\"button\", { children: \"H2\" });\n        this.buttonH2.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h2>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH2);\n        this.buttonH3 = _jsx(\"button\", { children: \"H3\" });\n        this.buttonH3.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h3>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH3);\n        this.buttonH4 = _jsx(\"button\", { class: \"right\", children: \"H4\" });\n        this.buttonH4.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h4>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH4);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonBold = _jsx(\"button\", { class: \"left\", children: _jsx(\"b\", { children: \"B\" }) });\n        this.buttonBold.onclick = () => {\n            document.execCommand(\"bold\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonBold);\n        this.buttonItalic = _jsx(\"button\", { children: _jsx(\"i\", { children: \"I\" }) });\n        this.buttonItalic.onclick = () => {\n            document.execCommand(\"italic\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonItalic);\n        this.buttonUnderline = _jsx(\"button\", { children: _jsx(\"u\", { children: \"U\" }) });\n        this.buttonUnderline.onclick = () => {\n            document.execCommand(\"underline\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonUnderline);\n        this.buttonStrikeThrough = _jsx(\"button\", { children: _jsx(\"strike\", { children: \"S\" }) });\n        this.buttonStrikeThrough.onclick = () => {\n            document.execCommand(\"strikeThrough\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonStrikeThrough);\n        this.buttonSubscript = _jsx(\"button\", { children: \"x\\u2082\" });\n        this.buttonSubscript.onclick = () => {\n            document.execCommand(\"subscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSubscript);\n        this.buttonSuperscript = _jsx(\"button\", { class: \"right\", children: \"x\\u00B2\" });\n        this.buttonSuperscript.onclick = () => {\n            document.execCommand(\"superscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSuperscript);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonJustifyLeft = _jsx(\"button\", { class: \"left\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"2.5\", x2: \"6\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"6.5\", x2: \"6\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyLeft.onclick = () => {\n            document.execCommand(\"justifyLeft\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyLeft);\n        this.buttonJustifyCenter = _jsx(\"button\", { children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"2.5\", x2: \"8\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"8\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyCenter.onclick = () => {\n            document.execCommand(\"justifyCenter\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyCenter);\n        this.buttonJustifyRight = _jsx(\"button\", { class: \"right\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"2.5\", x2: \"10\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"6.5\", x2: \"10\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyRight.onclick = () => {\n            document.execCommand(\"justifyRight\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyRight);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [textAreaStyle];\n        this.shadowRoot.appendChild(toolbar);\n    }\n    update() {\n        this.buttonH1.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h1\");\n        this.buttonH2.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h2\");\n        this.buttonH3.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h3\");\n        this.buttonH4.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h4\");\n        this.buttonBold.classList.toggle(\"active\", document.queryCommandState(\"bold\"));\n        this.buttonItalic.classList.toggle(\"active\", document.queryCommandState(\"italic\"));\n        this.buttonUnderline.classList.toggle(\"active\", document.queryCommandState(\"underline\"));\n        this.buttonStrikeThrough.classList.toggle(\"active\", document.queryCommandState(\"strikeThrough\"));\n        this.buttonSubscript.classList.toggle(\"active\", document.queryCommandState(\"subscript\"));\n        this.buttonSuperscript.classList.toggle(\"active\", document.queryCommandState(\"superscript\"));\n        this.buttonJustifyLeft.classList.toggle(\"active\", document.queryCommandState(\"justifyLeft\"));\n        this.buttonJustifyCenter.classList.toggle(\"active\", document.queryCommandState(\"justifyCenter\"));\n        this.buttonJustifyRight.classList.toggle(\"active\", document.queryCommandState(\"justifyRight\"));\n    }\n}\nTextTool.define(\"tx-texttool\", TextTool);\n//# sourceMappingURL=TextTool.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextTool } from \"./TextTool.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class TextArea extends ModelView {\n    constructor(init) {\n        super(init);\n        let content = document.createElement(\"div\");\n        this.content = content;\n        content.classList.add(\"tx-text\");\n        content.contentEditable = \"true\";\n        content.oninput = (event) => {\n            if (this.model instanceof HtmlModel) {\n                let firstChild = event.target.firstChild;\n                if (firstChild && firstChild.nodeType === 3) {\n                    document.execCommand(\"formatBlock\", false, `<div>`);\n                }\n                else if (content.innerHTML === \"<br>\") {\n                    content.innerHTML = \"\";\n                }\n            }\n            this.updateModel();\n        };\n        content.onkeydown = (event) => {\n            if (!(this.model instanceof HtmlModel)) {\n                return;\n            }\n            if (event.metaKey === true && event.key === \"b\") {\n                event.preventDefault();\n                document.execCommand(\"bold\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"i\") {\n                event.preventDefault();\n                document.execCommand(\"italic\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"u\") {\n                event.preventDefault();\n                document.execCommand(\"underline\", false);\n                this.updateTextTool();\n            }\n            else if (event.key === \"Tab\") {\n                event.preventDefault();\n            }\n            else if (event.key === \"Enter\" &&\n                event.shiftKey !== true &&\n                document.queryCommandValue(\"formatBlock\") === \"blockquote\") {\n                document.execCommand(\"formatBlock\", false, \"<p>\");\n            }\n        };\n        content.onkeyup = () => {\n            this.updateTextTool();\n        };\n        content.onmouseup = () => {\n            this.updateTextTool();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txText];\n        this.shadowRoot.appendChild(content);\n    }\n    updateTextTool() {\n        if (TextTool.texttool !== undefined)\n            TextTool.texttool.update();\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.promise = () => {\n                if (this.model instanceof HtmlModel) {\n                    return this.content.innerHTML;\n                }\n                else {\n                    return this.content.innerText;\n                }\n            };\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            if (this.content.innerHTML !== this.model.value) {\n                this.content.innerHTML = this.model.value;\n            }\n        }\n        else {\n            if (this.content.innerText !== this.model.value) {\n                this.content.innerText = this.model.value;\n            }\n        }\n    }\n}\nTextArea.define(\"tx-textarea\", TextArea);\n//# sourceMappingURL=TextArea.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nexport class Display extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.innerText = \"\";\n            return;\n        }\n        if (this.model instanceof TextModel) {\n            this.innerText = this.model.value;\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            this.innerHTML = this.model.value;\n            return;\n        }\n        if (this.model instanceof NumberModel) {\n            this.innerText = `${this.model.value}`;\n            return;\n        }\n    }\n}\nDisplay.define(\"tx-display\", Display);\n//# sourceMappingURL=Display.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-button {\n    padding: 2px 14px 2px 14px;\n    margin: 0;\n    color: var(--tx-gray-800);\n    transition: background-color 130ms ease-in-out;\n    background-color: var(--tx-gray-300);\n    border: 0 none;\n    height: 28px;\n    border-radius: 16px;\n    box-shadow: none;\n    font-family: inherit;\n}\n\n.tx-button:hover, .tx-button:active {\n    color: var(--tx-gray-900);\n    background-color: var(--tx-gray-400);\n}\n\n.tx-button:hover:active > span {\n    transition: transform 130ms ease-in-out;\n}\n:host > .tx-button:hover:active {\n    transform: translate(1px, 1px);\n}\n:host([disabled]) > .tx-button:hover:active {\n    transform: translate(0px, 0px);\n}\n\n/* accent */\n\n.tx-button.tx-accent {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-600);\n}\n.tx-button.tx-accent:hover, .tx-button.tx-accent:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-700);\n}\n.tx-button.tx-accent:hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-500);\n}\n\n/* negative */\n\n.tx-button.tx-negative {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-600);\n}\n.tx-button.tx-negative:hover, .tx-button.tx-negative:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-700);\n}\n.tx-button.tx-negative:hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-500);\n}\n\n/* primary */\n\n.tx-button.tx-default {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-800);\n}\n\n.tx-button.tx-default:hover, .tx-button.tx-default:hover:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-button.tx-default:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-label {\n    font-weight: bold;\n    padding: 4px 0 6px 0;\n    /* override parent flex/grid's align-items property to align in the center */\n    align-self: center;\n    /* adjust sides in container to look centered...? */\n    justify-self: center;\n    /* align children in the center */\n    text-align: center;\n}\n\n:host([disabled]) > .tx-button, :host([disabled]) > .tx-button:active {\n    color: var(--tx-fg-color-disabled);\n    background-color: var(--tx-gray-200);\n}\n`);\n//# sourceMappingURL=tx-button.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ActionView } from \"./ActionView.js\";\nimport { button, span } from \"../util/lsx.js\";\nimport { style as txButton } from \"../style/tx-button.js\";\nexport var ButtonVariant;\n(function (ButtonVariant) {\n    ButtonVariant[ButtonVariant[\"PRIMARY\"] = 0] = \"PRIMARY\";\n    ButtonVariant[ButtonVariant[\"SECONDARY\"] = 1] = \"SECONDARY\";\n    ButtonVariant[ButtonVariant[\"ACCENT\"] = 2] = \"ACCENT\";\n    ButtonVariant[ButtonVariant[\"NEGATIVE\"] = 3] = \"NEGATIVE\";\n})(ButtonVariant || (ButtonVariant = {}));\nexport class Button extends ActionView {\n    constructor(init) {\n        super(init);\n        this.button = button(this.label = span());\n        this.button.classList.add(\"tx-button\");\n        this.label.classList.add(\"tx-label\");\n        this.button.onclick = () => {\n            if (this.action)\n                this.action.trigger();\n        };\n        switch (this.getAttribute(\"variant\")) {\n            case \"primary\":\n                this.button.classList.add(\"tx-default\");\n                break;\n            case \"secondary\":\n                break;\n            case \"accent\":\n                this.button.classList.add(\"tx-accent\");\n                break;\n            case \"negative\":\n                this.button.classList.add(\"tx-negative\");\n                break;\n        }\n        switch (init?.variant) {\n            case ButtonVariant.PRIMARY:\n                this.button.classList.add(\"tx-default\");\n                break;\n            case ButtonVariant.SECONDARY:\n                break;\n            case ButtonVariant.ACCENT:\n                this.button.classList.add(\"tx-accent\");\n                break;\n            case ButtonVariant.NEGATIVE:\n                this.button.classList.add(\"tx-negative\");\n                break;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txButton];\n        this.shadowRoot.appendChild(this.button);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.children.length !== 0) {\n            return;\n        }\n        this._observer = new MutationObserver((record, observer) => {\n            if (this._timer !== undefined)\n                clearTimeout(this._timer);\n            this._timer = window.setTimeout(() => {\n                this._timer = undefined;\n                this.updateView();\n            }, 100);\n        });\n        this._observer.observe(this, {\n            childList: true,\n            subtree: true,\n            characterData: true\n        });\n    }\n    updateView() {\n        if (!this.isConnected)\n            return;\n        if (this.model && this.model.value) {\n            if (this.model instanceof HtmlModel)\n                this.label.innerHTML = this.model.value;\n            else\n                this.label.innerText = this.model.value;\n        }\n        else {\n            this.label.innerHTML = this.innerHTML;\n        }\n        if (this.isEnabled()) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n    }\n}\nButton.define(\"tx-button\", Button);\n//# sourceMappingURL=Button.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class BooleanView extends ModelView {\n    setModel(model) {\n        if (model !== undefined && !(model instanceof BooleanModel)) {\n            throw Error(`BooleanView.setModel(): model is not of type BooleanModel`);\n        }\n        super.setModel(model);\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.checked;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.value;\n        }\n    }\n}\n//# sourceMappingURL=BooleanView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-checkbox) {\n    display: inline-block;\n    position: relative;\n    box-shadow: none;\n    box-sizing: border-box;\n    padding: 0;\n    margin: 2px; /* leave space for the focus ring */\n    border: none 0;\n    height: 14px;\n    width: 14px;\n}\n\n:host(.tx-checkbox) > input {\n    box-sizing: border-box;\n    width: 14px;\n    height: 14px;\n    outline: none;\n    padding: 0;\n    margin: 0;\n    border: 2px solid;\n    border-radius: 2px;\n    border-color: var(--tx-gray-700);\n    /* border-radius: var(--tx-border-radius); */\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n    -webkit-appearance: none;\n}\n\n/* this is a svg 2 feature, works with firefox, chrome and edge, but not safari */\n/* :host(.tx-checkbox) > svg > path {\n    d: path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\");\n} */\n\n/* focus ring */\n:host(.tx-checkbox) > input:focus-visible {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n:host(.tx-checkbox) > svg {\n    position: absolute;\n    left: 2px;\n    top: 2px;\n    stroke: none;\n    fill: var(--tx-edit-bg-color);\n    width: 10px;\n    height: 10px;\n    pointer-events: none;\n}\n\n:host(.tx-checkbox) > input:hover {\n    border-color: var(--tx-gray-800);\n}\n.tx-checkbox > input:focus {\n    border-color: var(--tx-outline-color);\n}\n\n:host(.tx-checkbox) > input:checked {\n    background-color: var(--tx-gray-700);\n}\n:host(.tx-checkbox) > input:hover:checked {\n    background-color: var(--tx-gray-800);\n}\n\n:host(.tx-checkbox) > input:disabled {\n    color: var(--tx-gray-400);\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-checkbox) > input:checked:disabled {\n    background-color: var(--tx-gray-400);\n}\n`);\n//# sourceMappingURL=tx-checkbox.js.map","import { BooleanView } from \"./BooleanView.js\";\nimport { input, svg, path } from \"../util/lsx.js\";\nimport { style as txCheckbox } from \"../style/tx-checkbox.js\";\nexport class Checkbox extends BooleanView {\n    constructor(init) {\n        super(init);\n        this.classList.add(\"tx-checkbox\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.updateModel = this.updateModel.bind(this);\n        this.input.onchange = this.updateModel;\n        const checkmark = svg(path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\"));\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txCheckbox];\n        this.shadowRoot.replaceChildren(this.input, checkmark);\n    }\n}\nCheckbox.define(\"tx-checkbox\", Checkbox);\n//# sourceMappingURL=Checkbox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-search {\n    display: inline-block;\n    position: relative;\n}\n.tx-search > div {\n    display: inline-flex;\n    position: relative;\n}\n.tx-search > div > svg {\n    display: block;\n    position: absolute;\n    height: 18px;\n    width: 18px;\n    top: 7px;\n    left: 10px;\n    pointer-events: none;\n    overflow: hidden;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input {\n    box-sizing: border-box;\n    padding: 3px 12px 5px 35px;\n    margin: 0;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    -webkit-appearance: none;\n    outline-offset: -2px;\n    outline: none;\n    width: 100%;\n    height: 32px;\n    overflow: visible;\n    background: var(--tx-gray-50);\n\n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n}\n/* the button is transparent so that the border of the input field remains visible */\n.tx-search > button {\n    display: inline-flex;\n    position: absolute;\n    box-sizing: border-box;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 32px;\n    padding: 0;\n    margin: 1px;\n    border: none;\n    align-items: center;\n    justify-content: center;\n    overflow: visible;\n    vertical-align: top;\n    cursor: pointer;\n    border-radius: 0 4px 4px 0;\n    text-align: center;\n    outline: none;\n\n    background-color: var(--tx-gray-50);\n    border-radius: 0 4px 4px 0;\n\n}\n.tx-search > button > svg {\n    display: inline-block;\n    pointer-events: none;\n    height: 10px;\n    width: 10px;\n    padding: 0;\n    margin: 0;\n    border: none;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input:hover {\n    border-color: var(--tx-gray-500);\n}\n\n.tx-search > div > input:focus {\n    border-color: var(--tx-outline-color);\n}\n.tx-search > button:focus > svg {\n    fill: var(--tx-outline-color);\n}\n\n.tx-search > div > input:disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled {\n    background-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled > svg {\n    fill: var(--tx-gray-400);\n}`);\n//# sourceMappingURL=tx-search.js.map","import { ModelView } from \"./ModelView.js\";\nimport { form, input, button, svg, path, div } from \"../util/lsx.js\";\nimport { style as txSearch } from \"../style/tx-search.js\";\nexport class Search extends ModelView {\n    constructor(init) {\n        super(init);\n        let s0, s1, b, i, p;\n        const f = form(div(s0 = svg(p = path(\"M33.173 30.215L25.4 22.443a12.826 12.826 0 10-2.957 2.957l7.772 7.772a2.1 2.1 0 002.958-2.958zM6 15a9 9 0 119 9 9 9 0 01-9-9z\")), i = input()), b = button(s1 = svg(path(\"M6.548 5L9.63 1.917A1.094 1.094 0 008.084.371L5.001 3.454 1.917.37A1.094 1.094 0 00.371 1.917L3.454 5 .37 8.085A1.094 1.094 0 101.917 9.63l3.084-3.083L8.084 9.63a1.094 1.094 0 101.547-1.546z\"))));\n        s0.setAttributeNS(null, \"width\", \"100%\");\n        s0.setAttributeNS(null, \"height\", \"100%\");\n        p.setAttributeNS(null, \"transform\", \"scale(0.5, 0.5)\");\n        s1.setAttributeNS(null, \"width\", \"100%\");\n        s1.setAttributeNS(null, \"height\", \"100%\");\n        i.type = \"search\";\n        i.placeholder = \"Search\";\n        i.autocomplete = \"off\";\n        f.classList.add(\"tx-search\");\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txSearch];\n        this.shadowRoot.appendChild(f);\n    }\n}\nSearch.define(\"tx-search\", Search);\n//# sourceMappingURL=Search.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n/* a div on top serves as the container for elements used for the switch*/\n:host(.tx-switch) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n/* an invisible checkbox will overlay everything, handling input and state */\n:host(.tx-switch) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n/* the span provides the visual appearance */\n:host(.tx-switch) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 0;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 0px none;\n    border-radius: 7px;\n\n    width: 26px;\n    height: 14px;\n    background: var(--tx-gray-300);\n}\n\n/* focus ring */\n:host(.tx-switch) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n/* this is the knob on the switch */\n:host(.tx-switch) > span:before {\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 14px;\n    height: 14px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: transform 130ms ease-in-out;\n}\n:host(.tx-switch) > input:hover + span:before {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked + span:before {\n    /* border-color: var(--tx-gray-700); */\n    transform: translateX(calc(100% - 2px));\n}\n\n:host(.tx-switch) > input:checked + span {\n    background: var(--tx-gray-700);\n}\n:host(.tx-switch) > input:checked:hover + span {\n    background: var(--tx-gray-900);\n}\n:host(.tx-switch) > input:hover + span + label {\n    color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked:disabled + span {\n    background: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span:before {\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span + label {\n    color: var(--tx-gray-400);\n}`);\n//# sourceMappingURL=tx-switch.js.map","import { BooleanView } from \"./BooleanView.js\";\nimport { style as txSwitch } from \"../style/tx-switch.js\";\nimport { input, span } from \"../util/lsx.js\";\nexport class Switch extends BooleanView {\n    constructor(init) {\n        super(init);\n        this.classList.add(\"tx-switch\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.input.onchange = () => {\n            this.updateModel();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [txSwitch];\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(span());\n    }\n}\nSwitch.define(\"tx-switch\", Switch);\n//# sourceMappingURL=Switch.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-radio) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n    padding: 2px;\n}\n/* an invisible radiobutton will overlay everything, handling input and state */\n:host(.tx-radio) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n\n/* the span provides the visual appearance */\n:host(.tx-radio) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 2px;\n    margin-right: 3px;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n\n    width: 14px;\n    height: 14px;\n    background: none;\n}\n\n/* focus ring */\n:host(.tx-radio) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n/* this is the knob on the switch */\n:host(.tx-radio) > span:before {\n    display: block;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    width: 10px;\n    height: 10px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-75);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: opacity 130ms ease-in-out;\n}\n:host(.tx-radio) > input:checked + span:before {\n    background: var(--tx-gray-700);\n}\n:host(.tx-radio) > input:checked:hover + span:before {\n    background: var(--tx-gray-900);\n}\n:host(.tx-radio) > input:hover + span {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-radio) > input:checked:disabled + span:before {\n    background: var(--tx-gray-500);\n}\n:host(.tx-radio) > input:disabled + span {\n    border-color: var(--tx-gray-500);\n}\n:host(.tx-radio) > input:disabled + span + label {\n    color: var(--tx-gray-500);\n}\n`);\n//# sourceMappingURL=tx-radio.js.map","import { ModelView } from \"./ModelView.js\";\nimport { input, label, slot, span } from \"../util/lsx.js\";\nimport { style as txRadio } from \"../style/tx-radio.js\";\nexport class RadioButton extends ModelView {\n    constructor(init) {\n        super(init);\n        this.value = init?.value;\n        this.updateModel = this.updateModel.bind(this);\n        this.updateView = this.updateView.bind(this);\n        this.classList.add(\"tx-radio\");\n        this.input = input();\n        this.input.type = \"radio\";\n        this.input.onchange = this.updateModel;\n        this.input.disabled = true;\n        this.label = label();\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txRadio];\n        this.shadowRoot.replaceChildren(this.input, span(), this.label);\n    }\n    updateModel() {\n        if (this.input.checked && this.model !== undefined) {\n            this.model.value = this.value;\n        }\n    }\n    updateView() {\n        if (this.model !== undefined) {\n            let radioGroup = RadioButton.radioGroups.get(this.model);\n            if (radioGroup === undefined) {\n                radioGroup = ++RadioButton.radioGroupCounter;\n                RadioButton.radioGroups.set(this.model, radioGroup);\n            }\n            this.input.name = `tx-radio-group-${radioGroup}`;\n            this.input.value = `${this.model.indexOf(this.value)}`;\n            if (this.childNodes.length > 0) {\n                this.label.replaceChildren(slot());\n            }\n            else {\n                this.label.replaceChildren(this.model.labelOf(this.value));\n            }\n        }\n        else {\n            this.input.name = \"\";\n        }\n        if (!this.model || !this.model.enabled || !this.model.isEnabledOf(this.value)) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.value === this.value;\n        }\n    }\n}\nRadioButton.radioGroupCounter = 0;\nRadioButton.radioGroups = new WeakMap();\nRadioButton.define(\"tx-radio\", RadioButton);\n//# sourceMappingURL=RadioButton.js.map","export var MenuState;\n(function (MenuState) {\n    MenuState[MenuState[\"WAIT\"] = 0] = \"WAIT\";\n    MenuState[MenuState[\"DOWN\"] = 1] = \"DOWN\";\n    MenuState[MenuState[\"UP_N_HOLD\"] = 2] = \"UP_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_HOLD\"] = 3] = \"DOWN_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_OUTSIDE\"] = 4] = \"DOWN_N_OUTSIDE\";\n    MenuState[MenuState[\"DOWN_N_INSIDE_AGAIN\"] = 5] = \"DOWN_N_INSIDE_AGAIN\";\n})(MenuState || (MenuState = {}));\n//# sourceMappingURL=MenuState.js.map","import { View } from \"../view/View.js\";\nimport { MenuState } from \"./MenuState.js\";\nexport class MenuButtonContainer extends View {\n    constructor(props) {\n        super(props);\n        this.vertical = true;\n        this.closeOnClose = false;\n        this.state = MenuState.WAIT;\n    }\n}\n//# sourceMappingURL=MenuHelper.js.map","import { View } from \"../view/View.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nexport class PopupMenu extends MenuButtonContainer {\n    constructor(root, parent) {\n        super();\n        this.vertical = true;\n        this.root = root;\n        this.parentButton = parent;\n        this.popup = document.createElement(\"div\");\n        this.popup.classList.add(\"menu-popup\");\n        let node = root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.popup);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.appendChild(this.popup);\n        this.show();\n    }\n    show() {\n        if (!this.parentButton.master.vertical)\n            placePopupVertical(this.parentButton, this.popup);\n        else\n            placePopupHorizontal(this.parentButton, this.popup);\n        this.style.display = \"\";\n    }\n    hide() {\n        this.style.display = \"none\";\n    }\n}\nexport function placePopupVertical(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + \"px\";\n    popup.style.top = parentBoundary.top + parentBoundary.height + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + parentBoundary.height + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            const top = parentBoundary.top - popupBoundary.height;\n            if (top > 0 || -top < popupBottom - window.innerHeight) {\n                popup.style.top = `${top}px`;\n            }\n        }\n        let popupRight = parentBoundary.left + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = parentBoundary.left + parentBoundary.width - popupBoundary.width + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nexport function placePopupHorizontal(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + parentBoundary.width + \"px\";\n    popup.style.top = parentBoundary.top + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = parentBoundary.top + parentBoundary.height - popupBoundary.height + \"px\";\n        }\n        let popupRight = parentBoundary.left + parentBoundary.width + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = parentBoundary.left - popupBoundary.width + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nView.define(\"tx-popupmenu\", PopupMenu);\n//# sourceMappingURL=PopupMenu.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host(.tx-combobox) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n:host(.tx-combobox) > :first-child {\n    box-sizing: border-box;\n    width: 100%;\n    height: 32px;\n    line-height: 30px; /* center text vertically */\n    overflow: hidden; /* children shall not overlap our border */\n    margin: 0;\n    padding: 0;\n    vertical-align: top;\n    text-align: left;\n    outline: none;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    background-color: var(--tx-gray-50);\n    \n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n}\n:host(.tx-combobox) > input:first-child {\n    padding: 4px 32px 4px 11px;\n}\n:host(.tx-combobox) > :first-child > :first-child {\n    padding-left: 7px;\n}\n:host(.tx-combobox) > :first-child::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n:host(.tx-combobox) > button {\n    position: absolute;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-style: none;\n    box-sizing: border-box;\n    overflow: visible;\n    margin: 0;\n    text-transform: none;\n\n    width: 32px;\n    height: 32px;\n    background-color: var(--tx-gray-75);\n    border-radius: 0 4px 4px 0;\n    border: 1px solid var(--tx-gray-400);\n}\n:host(.tx-combobox) > button > svg {\n    fill: var(--tx-gray-700);\n    transform: rotate(90deg) translate(5px, 8px);\n}\n\n:host(.tx-combobox) > :first-child:hover {\n    border-color: var(--tx-gray-500);\n}\n:host(.tx-combobox) > button:hover {\n    border-color: var(--tx-gray-500);\n    background-color: var(--tx-gray-50);\n}\n:host(.tx-combobox) > button:hover > svg {\n    fill: var(--tx-gray-900);\n}\n\n:host(.tx-combobox) > :first-child:focus {\n    border-color: var(--tx-outline-color);\n}\n:host(.tx-combobox) > :first-child:focus + button {\n    border-color: var(--tx-outline-color);\n}\n/* spectrum use a 1px focus ring when the focus was set by mouse\n * and a 2px focus ring when the focus was set by keyboard\n * no clue how to do that with css\n *\n/* :host(.tx-combobox) > input:focus-visible {\n    outline: 1px solid var(--tx-outline-color);\n}\n:host(.tx-combobox) > input:focus-visible + button {\n    outline: 1px solid var(--tx-outline-color);\n    border-left: none;\n} */\n\n:host(.tx-combobox) > :first-child.tx-disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled > * {\n    color: var(--tx-gray-500);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled + button {\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > :first-child.tx-disabled + button > svg {\n    fill: var(--tx-gray-400);\n}\n:host(.tx-combobox) > :first-child.tx-error {\n    color: var(--tx-warning-color);\n    border-color: var(--tx-warning-color)\n}\n:host(.tx-combobox) > :first-child.tx-error + button {\n    border-color: var(--tx-warning-color)\n}\n`);\n//# sourceMappingURL=tx-combobox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n.tx-popover {\n    background-color: var(--tx-gray-50);\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    display: inline-flex;\n    flex-direction: column;\n    filter: drop-shadow(rgba(0, 0, 0, 0.5) 0px 1px 4px);\n}\n.tx-menu {\n    display: inline-block;\n    padding: 0;\n    margin: 2px 0 2px 0;\n}\n.tx-menu > li {\n    cursor: pointer;\n    display: flex;\n    border: none;\n    border-left: 2px solid var(--tx-gray-50);\n    margin-right: 2px;\n    padding: 0;\n    margin: 0;\n    font-weight: 500;\n    outline: none;\n}\n.tx-menu > li:first-child {\n    border-top-right-radius: 4px;\n    overflow: hidden;\n}\n.tx-menu > li:last-child {\n    border-bottom-right-radius: 4px;\n    overflow: hidden;\n}\n.tx-menu > li > :first-child {\n    padding: 7px 11px 7px 10px;\n}\n.tx-menu > li:hover {\n    background-color: var(--tx-gray-100);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li.tx-hover {\n    filter: brightness(1.2);\n    backdrop-filter: brightness(1.2);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li:focus {\n    border-left-color: var(--tx-outline-color);\n}\n.tx-menu > li[role=separator] {\n    display: block;\n    box-sizing: content-box;\n    overflow: visible;\n    cursor: default;\n    height: 2px;\n    padding: 0px;\n    margin: 1.5px 7px 1.5px 7px;\n    background-color: var(--tx-gray-100);\n    white-space: pre;\n    list-style-type: none;\n}\n.tx-menu > li.tx-disabled {\n    color: var(--tx-gray-500);\n}\n.tx-menu > li.tx-disabled:hover {\n    background-color: var(--tx-gray-50);\n}`);\n//# sourceMappingURL=tx-menu.js.map","import { jsx as _jsx } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { input, button, svg, path, div, li } from \"../util/lsx.js\";\nimport { placePopupVertical } from \"../menu/PopupMenu.js\";\nimport { style as txCombobox } from \"../style/tx-combobox.js\";\nimport { style as txMenu } from \"../style/tx-menu.js\";\nexport class SelectBase extends ModelView {\n    constructor(init) {\n        super(init);\n        this.pointerup = this.pointerup.bind(this);\n        this.pointermove = this.pointermove.bind(this);\n        this.pointerdown = this.pointerdown.bind(this);\n        this.wheel = this.wheel.bind(this);\n        this.keydown = this.keydown.bind(this);\n        let s;\n        const b = button((s = svg(path(\"M3 9.95a.875.875 0 01-.615-1.498L5.88 5 2.385 1.547A.875.875 0 013.615.302L7.74 4.377a.876.876 0 010 1.246L3.615 9.698A.872.872 0 013 9.95z\"))));\n        this.button = b;\n        b.tabIndex = -1;\n        b.style.outline = \"none\";\n        s.style.width = \"100%\";\n        s.style.height = \"100%\";\n        b.onpointerdown = this.pointerdown;\n        b.onpointermove = this.pointermove;\n        b.onpointerup = this.pointerup;\n        this.classList.add(\"tx-combobox\");\n        this.attachShadow({ mode: \"open\" });\n        this.shadowRoot.adoptedStyleSheets = [\n            txCombobox,\n            txMenu,\n        ];\n    }\n    finalize() {\n        this.displayElement.onwheel = this.button.onwheel = this.wheel;\n        this.shadowRoot.replaceChildren(this.displayElement, this.button);\n    }\n    keydown(ev) {\n        ev.preventDefault();\n        if (this.model) {\n            switch (ev.key) {\n                case \"ArrowUp\":\n                    this.model.prev();\n                    break;\n                case \"ArrowDown\":\n                    this.model.next();\n                    break;\n                case \"Enter\":\n                    this.togglePopup();\n                    break;\n                case \"Escape\":\n                    if (this.popup !== undefined) {\n                        this.close();\n                    }\n                    break;\n            }\n        }\n    }\n    wheel(ev) {\n        ev.preventDefault();\n        if (this.model === undefined || !this.model.enabled) {\n            return;\n        }\n        this.displayElement.focus();\n        if (ev.deltaY > 0) {\n            this.model.next();\n        }\n        if (ev.deltaY < 0) {\n            this.model.prev();\n        }\n    }\n    pointerdown(ev) {\n        ev.preventDefault();\n        if (this.model === undefined || !this.model.enabled) {\n            return;\n        }\n        if (this.popup) {\n            this.close();\n            return;\n        }\n        this.displayElement.focus();\n        this.open();\n        this.button.setPointerCapture(ev.pointerId);\n    }\n    pointermove(ev) {\n        if (this.popup === undefined) {\n            return;\n        }\n        let newHover = this.findMenuItem(ev);\n        if (this.hover !== newHover) {\n            if (this.hover) {\n                this.hover.classList.remove(\"tx-hover\");\n            }\n            this.hover = newHover;\n            if (this.hover) {\n                this.hover.classList.add(\"tx-hover\");\n            }\n        }\n    }\n    findMenuItem(ev) {\n        let e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n        while (e) {\n            if (e.nodeName === \"LI\" &&\n                e.parentElement?.classList.contains(\"tx-menu\") &&\n                e.parentElement?.parentElement?.classList.contains(\"tx-popover\")) {\n                break;\n            }\n            e = e?.parentElement;\n        }\n        return (e ? e : undefined);\n    }\n    pointerup(ev) {\n        if (this.hover) {\n            const idx = parseInt(this.hover.dataset[\"idx\"]);\n            this.close();\n            this.select(idx);\n            return;\n        }\n        const e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n        if (this.displayElement.contains(e) || this.button.contains(e)) {\n            return;\n        }\n        this.close();\n    }\n    togglePopup() {\n        if (this.popup) {\n            this.close();\n        }\n        else {\n            this.open();\n        }\n    }\n    open() {\n        this.popup = div();\n        if (this.model) {\n            this.popup.replaceChildren(_jsx(\"ul\", { class: \"tx-menu\", \"aria-roledescription\": \"listbox\", children: this.model.map((value, key, idx) => {\n                    const l = li(this.model.asHtml(key));\n                    l.tabIndex = 0;\n                    l.ariaRoleDescription = \"option\";\n                    l.dataset[\"idx\"] = `${idx}`;\n                    l.onpointerdown = (ev) => {\n                        this.button.setPointerCapture(ev.pointerId);\n                        this.hover = l;\n                        ev.preventDefault();\n                    };\n                    l.onkeydown = this.keydown;\n                    return l;\n                }) }));\n        }\n        this.popup.classList.add(\"tx-popover\");\n        this.popup.style.position = \"fixed\";\n        this.popup.style.zIndex = \"99\";\n        this.shadowRoot.appendChild(this.popup);\n        placePopupVertical(this, this.popup);\n        this.focusToItem();\n    }\n    focusToItem() {\n        if (this.popup && this.model) {\n            const index = this.model.index;\n            if (index !== undefined) {\n                ;\n                this.popup.children[0].children[this.model.index].focus();\n            }\n        }\n    }\n    close() {\n        this.hover = undefined;\n        if (this.popup !== undefined) {\n            this.shadowRoot.removeChild(this.popup);\n            this.popup = undefined;\n            this.displayElement.focus();\n        }\n    }\n    select(index) {\n        if (this.model) {\n            this.model.index = index;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.displayElement.classList.add(\"tx-disabled\");\n            this.displayElement.setAttribute(\"disabled\", \"\");\n            this.button.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.displayElement.classList.remove(\"tx-disabled\");\n            this.displayElement.removeAttribute(\"disabled\");\n            this.button.removeAttribute(\"disabled\");\n        }\n        if (this.model?.error !== undefined) {\n            this.displayElement.classList.add(\"tx-error\");\n        }\n        else {\n            this.displayElement.classList.remove(\"tx-error\");\n        }\n    }\n}\nexport class Select extends SelectBase {\n    constructor(init) {\n        super(init);\n        this.displayElement = div();\n        this.displayElement.tabIndex = 0;\n        this.displayElement.style.minWidth = \"200px\";\n        this.displayElement.onpointerdown = this.pointerdown;\n        this.displayElement.onkeydown = this.keydown;\n        this.finalize();\n    }\n    updateView() {\n        super.updateView();\n        if (this.model !== undefined) {\n            this.displayElement.replaceChildren(this.model.html);\n        }\n        this.focusToItem();\n    }\n}\nexport class ComboBox extends SelectBase {\n    constructor(init) {\n        super(init);\n        this.textModel = init?.text;\n        this.displayElement = input();\n        this.displayElement.type = \"text\";\n        this.displayElement.onkeydown = (ev) => {\n            if (ev.key === \"Enter\" || this.popup !== undefined) {\n                this.keydown(ev);\n            }\n        };\n        this.displayElement.oninput = () => {\n            this.updateModel();\n        };\n        this.finalize();\n    }\n    close() {\n        super.close();\n        if (this.popup === undefined) {\n            this.displayElement.focus();\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            if (typeof this.model.value === \"number\") {\n                this.model.value = Number.parseFloat(this.displayElement.value);\n            }\n            else {\n                this.model.value = this.displayElement.value;\n            }\n        }\n        if (this.textModel) {\n            this.textModel.value = this.displayElement.value;\n        }\n    }\n    updateView() {\n        super.updateView();\n        if (this.model !== undefined) {\n            this.displayElement.value = `${this.model.value}`;\n        }\n        this.focusToItem();\n    }\n}\nSelect.define(\"tx-select\", Select);\nComboBox.define(\"tx-combobox\", ComboBox);\n//# sourceMappingURL=Select.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    :host {\n        position: relative;\n        box-sizing: content-box;\n        display: inline-block;\n    }\n\n    :host(:not([orientation=\"vertical\"])) {\n        height: 4px;\n        width: 100%;\n        padding-top: 8px;\n        padding-bottom: 8px;\n    }\n\n    :host([orientation=\"vertical\"]) {\n        width: 4px;\n        height: 100%;\n        padding-left: 8px;\n        padding-right: 8px;\n    }\n\n    .tx-space {\n        position: absolute;\n        box-sizing: content-box;\n        padding: 0;\n        margin: 0;\n        border: 0;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-space {\n        left: 8px;\n        right: 8px;\n        top: 0;\n        bottom: 0;\n    }\n\n    :host([orientation=\"vertical\"]) .tx-space {\n        left: 0;\n        right: 0;\n        top: 8px;\n        bottom: 8px;\n    }\n\n    .tx-rail {\n        background-color: var(--tx-gray-300);\n        position: absolute;\n        display: block;\n        border-radius: 2px;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-rail {\n        top: 50%;\n        width: 100%;\n        height: 2px;\n        transform: translateY(-50%);\n    }\n\n    :host([orientation=\"vertical\"]) .tx-rail {\n        left: 50%;\n        height: 100%;\n        width: 2px;\n        transform: translateX(-50%);\n    }\n\n    :host([disabled]) .tx-rail {\n        background-color: var(--tx-gray-100);\n    }\n    :host([disabled]) .tx-track {\n        background-color: var(--tx-gray-100);\n    }\n    :host([disabled]) .tx-thumb {\n        border-color: var(--tx-gray-500);\n    }\n    .tx-track {\n        background-color: var(--tx-gray-700);\n        position: absolute;\n        display: block;\n        border-radius: 2px;\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-track {  \n        top: 50%;\n        height: 2px;\n        transform: translateY(-50%);\n    }\n\n    :host([orientation=\"vertical\"]) .tx-track {  \n        left: 50%;\n        width: 2px;\n        transform: translateX(-50%);\n    }\n\n    .tx-thumb {\n        border: 2px solid var(--tx-gray-700); /* knob border */\n        border-radius: 50%;\n        background: var(--tx-gray-75); /* inside knob */\n        cursor: pointer;\n        position: absolute;\n        display: flex;\n        width: 14px;\n        height: 14px;\n        box-sizing: border-box;\n        outline-width: 0px;\n        border-radius: 50%;\n        transform: translate(-50%, -50%);\n    }\n    .tx-thumb:hover {\n        border-color: var(--tx-gray-800)\n    }\n\n    :host(:not([orientation=\"vertical\"])) .tx-thumb { \n        top: 50%;\n    }\n    :host([orientation=\"vertical\"]) .tx-thumb { \n        left: 50%;\n    }\n\n    .tx-focus {\n        outline: 2px solid;\n        outline-color: var(--tx-outline-color);\n        outline-offset: 1px;\n    }\n\n    .tx-thumb>input {\n        border: 0;\n        clip: rect(0, 0, 0, 0);\n        width: 100%;\n        height: 100%;\n        margin: -1px;\n        /* this hides most of the slider and centers the thumb */\n        overflow: hidden;\n        position: absolute;\n        white-space: nowrap;\n        direction: ltr;\n    }\n`);\n//# sourceMappingURL=tx-slider.js.map","export function hsv2rgb(h, s, v) {\n    const f = (n, k = (n + h / 60) % 6) => v - v * s * Math.max(Math.min(k, 4 - k, 1), 0);\n    return { r: f(5), g: f(3), b: f(1) };\n}\nexport function rgb2hsv(r, g, b) {\n    let v = Math.max(r, g, b), c = v - Math.min(r, g, b);\n    let h = c && (v == r ? (g - b) / c : v == g ? 2 + (b - r) / c : 4 + (r - g) / c);\n    return { h: 60 * (h < 0 ? h + 6 : h), s: v && c / v, v };\n}\nexport function rgb2hsl(rgb) {\n    const hsl = _rgb2hsl(rgb.r / 255, rgb.g / 255, rgb.b / 255);\n    return { h: hsl[0], s: hsl[1], l: hsl[2] };\n}\nfunction _hsl2rgb(h, s, l) {\n    let a = s * Math.min(l, 1 - l);\n    let f = (n, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n    return [f(0), f(8), f(4)];\n}\nfunction _rgb2hsl(r, g, b) {\n    let v = Math.max(r, g, b), c = v - Math.min(r, g, b), f = 1 - Math.abs(v + v - c - 1);\n    let h = c && (v == r ? (g - b) / c : v == g ? 2 + (b - r) / c : 4 + (r - g) / c);\n    return [60 * (h < 0 ? h + 6 : h), f ? c / f : 0, (v + v - c) / 2];\n}\nexport function parseColor(color) {\n    let m, r, g, b, a;\n    color = color.trim();\n    m = color.match(/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/);\n    if (m !== null) {\n        r = parseInt(m[1], 16);\n        g = parseInt(m[2], 16);\n        b = parseInt(m[3], 16);\n        r = r * 16 + r;\n        g = g * 16 + g;\n        b = b * 16 + b;\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/);\n    if (m !== null) {\n        r = parseInt(m[1], 16);\n        g = parseInt(m[2], 16);\n        b = parseInt(m[3], 16);\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n    if (m !== null) {\n        r = parseInt(m[1]);\n        g = parseInt(m[2]);\n        b = parseInt(m[3]);\n        a = 1;\n        return { r, g, b, a };\n    }\n    m = color.match(/^rgba\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n    if (m !== null) {\n        r = parseInt(m[1]);\n        g = parseInt(m[2]);\n        b = parseInt(m[3]);\n        a = parseInt(m[4]);\n        return { r, g, b, a };\n    }\n    return undefined;\n}\n//# sourceMappingURL=color.js.map","import { ModelView } from \"./ModelView.js\";\nimport { style as txSlider } from \"../style/tx-slider.js\";\nimport { div, input, span } from \"../util/lsx.js\";\nimport { parseColor } from \"../util/color.js\";\nexport class Slider extends ModelView {\n    constructor(init) {\n        super(init);\n        this.vertical = init ? init.orientation === \"vertical\" : this.getAttribute(\"orientation\") === \"vertical\";\n        let container, rail, track, thumb, slider;\n        container =\n            div(rail = span(), track = span(), thumb = span(slider = input()));\n        container.classList.add(\"tx-space\");\n        rail.classList.add('tx-rail');\n        track.classList.add('tx-track');\n        thumb.classList.add('tx-thumb');\n        slider.type = \"range\";\n        this.input = slider;\n        this.rail = rail;\n        this.track = track;\n        this.thumb = thumb;\n        const minColor = init ? init.minColor : this.getAttribute(\"minColor\");\n        const maxColor = init ? init.maxColor : this.getAttribute(\"maxColor\");\n        if (minColor) {\n            this.minColor = parseColor(minColor);\n        }\n        if (maxColor) {\n            this.maxColor = parseColor(maxColor);\n        }\n        this.setGradient();\n        this.updateView();\n        slider.onfocus = () => {\n            thumb.classList.add(\"tx-focus\");\n        };\n        slider.onblur = () => {\n            thumb.classList.remove(\"tx-focus\");\n        };\n        slider.oninput = () => {\n            if (this.model) {\n                this.model.value = parseFloat(slider.value);\n            }\n        };\n        let skew = undefined;\n        thumb.onpointerdown = (ev) => {\n            if (this.model?.enabled !== true) {\n                return;\n            }\n            thumb.setPointerCapture(ev.pointerId);\n            const value = parseFloat(slider.value);\n            const b = this.getBoundingClientRect();\n            const min = parseFloat(slider.min);\n            const max = parseFloat(slider.max);\n            if (this.vertical) {\n                const v = max - (ev.clientY - b.y) / b.height * (max - min);\n                skew = value - v;\n            }\n            else {\n                const v = (ev.clientX - b.x) / b.width * (max - min) + min;\n                skew = value - v;\n            }\n        };\n        thumb.onpointermove = (ev) => {\n            if (skew === undefined) {\n                return;\n            }\n            ev.preventDefault();\n            const b = this.getBoundingClientRect();\n            const min = parseFloat(slider.min);\n            const max = parseFloat(slider.max);\n            let v;\n            if (this.vertical) {\n                v = max - (ev.clientY - b.y) / b.height * (max - min);\n            }\n            else {\n                v = (ev.clientX - b.x) / b.width * (max - min) + min + skew;\n            }\n            if (v < min) {\n                v = min;\n            }\n            if (v > max) {\n                v = max;\n            }\n            if (this.model) {\n                this.model.value = v;\n            }\n        };\n        thumb.onpointerup = (ev) => {\n            if (skew === undefined) {\n                return;\n            }\n            thumb.onpointermove(ev);\n            skew = undefined;\n        };\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txSlider];\n        this.shadowRoot.replaceChildren(container);\n    }\n    setGradient() {\n        if (this.minColor && this.maxColor) {\n            if (this.model?.enabled === true) {\n                const rot = this.vertical ? \"0deg\" : \"90deg\";\n                const a = this.minColor;\n                const b = this.maxColor;\n                this.rail.style.backgroundImage = `linear-gradient(${rot}, rgb(${a.r},${a.g},${a.b}), rgb(${b.r},${b.g},${b.b}))`;\n            }\n            else {\n                this.rail.style.backgroundImage = \"\";\n            }\n            this.track.style.display = \"none\";\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = Number.parseFloat(this.input.value);\n        }\n    }\n    updateView() {\n        this.setGradient();\n        if (!this.model) {\n            this.setAttribute(\"disabled\", \"disabled\");\n            return;\n        }\n        if (this.model.enabled) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"disabled\");\n        }\n        if (this.model.step === undefined && this.model.min !== undefined && this.model.max !== undefined) {\n            this.input.step = `${(this.model.max - this.model.min) / 100}`;\n        }\n        else {\n            this.input.step = String(this.model.step);\n        }\n        this.input.min = String(this.model.min);\n        this.input.max = String(this.model.max);\n        this.input.value = String(this.model.value);\n        const min = this.model.min;\n        const max = this.model.max;\n        const value = this.model.value;\n        let v = (value - min) / (max - min);\n        if (this.minColor && this.maxColor) {\n            if (this.model?.enabled !== true) {\n                this.thumb.style.backgroundColor = \"\";\n            }\n            else {\n                const f = `rgb(${(this.maxColor.r - this.minColor.r) * v + this.minColor.r},${(this.maxColor.g - this.minColor.g) * v + this.minColor.g},${(this.maxColor.b - this.minColor.b) * v + this.minColor.b})`;\n                this.thumb.style.backgroundColor = f;\n            }\n        }\n        v *= 100;\n        if (this.vertical) {\n            this.track.style.top = `${100 - v}%`;\n            this.track.style.height = `${v}%`;\n            this.thumb.style.top = `${100 - v}%`;\n        }\n        else {\n            this.track.style.left = `0%`;\n            this.track.style.width = `${v}%`;\n            this.thumb.style.left = `${v}%`;\n        }\n    }\n}\nSlider.define(\"tx-slider\", Slider);\n//# sourceMappingURL=Slider.js.map","import { View } from \"./View.js\";\nexport class GenericTool extends View {\n    static focusIn(view) {\n        const viewParents = new Map();\n        for (let parent = view.parentElement, distance = 0; parent !== null; parent = parent.parentElement, ++distance) {\n            viewParents.set(parent, distance);\n        }\n        let closestToolDistance = Number.MAX_SAFE_INTEGER;\n        let closestParent;\n        let closestToolList = new Array();\n        for (const tool of this.allTools.values()) {\n            if (!tool.canHandle(view))\n                continue;\n            for (let toolParent = tool.parentElement, depth = 0; toolParent !== null; toolParent = toolParent.parentElement, ++depth) {\n                const toolDistance = viewParents.get(toolParent);\n                if (toolDistance === undefined)\n                    continue;\n                if (closestToolDistance < toolDistance)\n                    continue;\n                if (closestToolDistance > toolDistance) {\n                    closestToolList.length = 0;\n                }\n                closestToolDistance = toolDistance;\n                closestParent = toolParent;\n                closestToolList.push(tool);\n            }\n        }\n        if (!closestParent) {\n            return;\n        }\n        let closestTool;\n        const viewIndex = GenericTool.getIndex(view, closestParent);\n        let closestNextSiblingIndex = Number.MIN_SAFE_INTEGER;\n        for (let tool of closestToolList) {\n            const toolIndex = GenericTool.getIndex(tool, closestParent);\n            if (toolIndex < viewIndex && toolIndex > closestNextSiblingIndex) {\n                closestNextSiblingIndex = toolIndex;\n                closestTool = tool;\n            }\n        }\n        this.setActive(closestTool, view);\n    }\n    static getIndex(view, parent) {\n        if (parent === undefined) {\n            console.trace(`GenericTool.getIndex(${view}, ${parent})`);\n        }\n        let element = view;\n        while (element.parentElement !== parent)\n            element = element.parentElement;\n        return Array.from(parent.childNodes).indexOf(element);\n    }\n    static setActive(tool, view) {\n        if (this.activeTool)\n            this.activeTool.deactivate();\n        this.activeTool = tool;\n        this.activeView = view;\n        if (tool)\n            tool.activate();\n    }\n    static focusOut(view) {\n        if (this.activeView === view) {\n            this.setActive(undefined, undefined);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        GenericTool.allTools.add(this);\n    }\n    disconnectedCallback() {\n        if (GenericTool.activeTool === this) {\n            GenericTool.setActive(undefined, undefined);\n        }\n        GenericTool.allTools.delete(this);\n        super.disconnectedCallback();\n    }\n}\nGenericTool.allTools = new Set();\nwindow.addEventListener(\"focusin\", (event) => {\n    if (event.target instanceof GenericTool)\n        return;\n    if (event.relatedTarget instanceof View) {\n        GenericTool.focusOut(event.relatedTarget);\n    }\n    if (event.target instanceof View) {\n        GenericTool.focusIn(event.target);\n    }\n});\n//# sourceMappingURL=GenericTool.js.map","import { ModelView } from \"./ModelView.js\";\nimport { css } from \"../util/lsx.js\";\nexport const toolbuttonStyle = new CSSStyleSheet();\ntoolbuttonStyle.replaceSync(css `\n:host {\n    display: inline-block;\n    overflow: hidden;\n    box-sizing: border-box;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 3px;\n    background: var(--tx-gray-400);\n    color: var(--tx-gray-900);\n    width: 24px;\n    height: 22px;\n    margin: 0;\n    padding: 0;\n}\n\n:host([selected]) {\n    background-color: var(--tx-gray-100);\n    border: 1px solid var(--tx-gray-100);\n}\n\n:host([disabled]) {\n    opacity: 0.5;\n}\n\n:host([disabled]) img {\n    opacity: 0.5;\n}\n`);\nexport class ToolButton extends ModelView {\n    constructor(init) {\n        super(init);\n        if (!init) {\n            init = {\n                value: this.getAttribute(\"value\"),\n            };\n        }\n        else {\n            this.setAttribute(\"value\", `${init.value}`);\n        }\n        this.value = init?.value;\n        this.onpointerdown = (event) => {\n            if (this.hasAttribute(\"disabled\")) {\n                return;\n            }\n            this.focus();\n            event.preventDefault();\n            if (this.model !== undefined) {\n                this.model.value = this.value;\n            }\n        };\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [toolbuttonStyle];\n        this.shadowRoot.appendChild(document.createElement(\"slot\"));\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n        }\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n            this.removeAttribute(\"selected\");\n            return;\n        }\n        if (this.model.enabled && this.model.isEnabledOf(this.value)) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"\");\n        }\n        if (this.model.value === this.value) {\n            this.setAttribute(\"selected\", \"\");\n        }\n        else {\n            this.removeAttribute(\"selected\");\n        }\n    }\n}\nToolButton.define(\"tx-toolbutton\", ToolButton);\n//# sourceMappingURL=ToolButton.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class SlotView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        let value = this.model.value === undefined ? \"\" : this.model.value;\n        if (this.model instanceof HtmlModel)\n            this.innerHTML = value;\n        else\n            this.innerText = value;\n    }\n}\nSlotView.define(\"tx-slot\", SlotView);\n//# sourceMappingURL=SlotView.js.map","import { ModelView } from \"./ModelView.js\";\nexport class ToadIf extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (this.model) {\n            this.style.display = this.model.value ? \"\" : \"none\";\n        }\n    }\n}\nToadIf.define(\"tx-if\", ToadIf);\n//# sourceMappingURL=ToadIf.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    /*\n     * tabs, line, content\n     */\n    :host {\n        /* position: relative; */\n        display: grid;\n        /* flex-wrap: nowrap; */\n        /* box-sizing: border-box; */\n        margin: 0;\n        padding: 0;\n    }\n    :host(:not(.tx-vertical)) {\n        /* flex-direction: column; */\n        /* display: grid; */\n        /* height: */\n        grid-template-rows: 0 max-content auto;\n        grid-template-columns: 1;\n        /* https://stackoverflow.com/questions/43311943/prevent-content-from-expanding-grid-items */\n        /* https://www.w3.org/TR/css3-grid-layout/#min-size-auto */\n        min-width: 0;\n    }\n    :host(.tx-vertical) {\n        grid-template-rows: 1;\n        grid-template-columns: 0 max-content auto;\n        min-height: 0;\n    }\n\n    /*\n     * tabs\n     */\n    :host > ul {\n        display: flex;\n        flex-wrap: nowrap;\n        list-style: none;\n        box-sizing: border-box;\n        padding: 0;\n        margin: 0;\n    }\n    :host(:not(.tx-vertical)) > ul {\n        flex-direction: row;\n        border-bottom: 2px solid var(--tx-gray-200);\n    }\n    :host(.tx-vertical) > ul {\n        flex-direction: column;\n         border-left: 2px solid var(--tx-gray-200);\n    }\n    :host > ul > li {\n        box-sizing: border-box;\n        list-style: none;\n    }\n\n    /*\n     * label\n     */\n    :host > ul > li > span {\n        display: block;\n        list-style: none;\n        font-weight: 500;\n        margin: 8px 12px 8px 12px;\n        color: var(--tx-gray-700);\n        cursor: pointer;\n    }\n    :host(.tx-vertical) > ul > li > span {\n        margin: 0;\n        padding: 12px 8px 12px 8px;\n    }\n    :host > ul > li > span.active {\n        color: var(--tx-gray-900);\n    }\n    :host > ul > li > span:hover {\n        color: var(--tx-gray-900);\n    }\n\n    /*\n     * line\n     */\n    .line-container {\n        position: relative;\n        overflow: none;\n    }\n    :host > .line-container > .line {\n        position: absolute;\n        background-color: var(--tx-gray-900);\n        pointer-events: none;\n    }\n    :host(:not(.tx-vertical)) > .line-container > .line {\n        transition: left 0.5s ease-in-out, width 0.5s 0.1s;\n        /* position: relative; below labels */\n        top: 0px;\n        height: 2px;\n        left: 12px;\n        width: 0px;\n    }\n    :host(.tx-vertical) > .line-container > .line {\n        transition: top 0.5s ease-in-out, width 0.5s 0.1s;\n        /* position: absolute; */\n        left: 0; /* before labels */\n        height: 0px;\n        width: 2px;\n    }\n\n    /*\n     * content\n     */\n    .content {\n        overflow: auto;\n    }\n`);\n//# sourceMappingURL=tx-tabs.js.map","import { css } from \"../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n    ::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n    }\n    ::-webkit-scrollbar-thumb {\n        border-radius: 5px;\n    }\n    ::-webkit-scrollbar-track {\n        background: #1e1e1e;\n    }\n    ::-webkit-scrollbar-corner {\n        background: #1e1e1e;\n    }\n    ::-webkit-scrollbar-thumb {\n        background: var(--tx-gray-500);\n    }\n`);\n//# sourceMappingURL=tx-scrollbar.js.map","import { View } from \"../view/View.js\";\nimport { ul, li, span, text, div, slot } from \"../util/lsx.js\";\nimport { style as txTabs } from \"../style/tx-tabs.js\";\nimport { style as txScrollbar } from \"../style/tx-scrollbar.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class Tabs extends ModelView {\n    constructor(init) {\n        super(init);\n        this.labelMap = new Map();\n        this.activateTab = this.activateTab.bind(this);\n        this.classList.add(\"tx-tabs\");\n        this.vertical = this.hasAttribute(\"vertical\") || init?.orientation === \"vertical\";\n        if (this.vertical) {\n            this.classList.add(\"tx-vertical\");\n        }\n        let lineContainer, tabContainer;\n        const children = [\n            lineContainer = span(this.markerLine = div()),\n            tabContainer = ul(),\n            this.content = div(slot())\n        ];\n        lineContainer.classList.add(\"line-container\");\n        this.markerLine.classList.add(\"line\");\n        this.content.classList.add(\"content\");\n        let activeLabel = this.activeLabel, activePanel = this.activePanel;\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (!(child instanceof Tab)) {\n                console.log(`unexpected <${child.nodeName.toLowerCase()}> within <Tabs>`);\n                continue;\n            }\n            const panel = child;\n            if (typeof panel.value !== typeof this.model?.value) {\n                console.log(`Type error: Tab<${typeof panel.value}>({label=\"${panel.label}\", value=${panel.value}}) differs from Tabs<${typeof this.model?.value}>({model.value=${this.model?.value}})`);\n            }\n            let tabLabel;\n            tabContainer.appendChild(li((tabLabel = span(text(panel.getAttribute(\"label\"))))));\n            tabLabel.onpointerdown = (ev) => {\n                ev.stopPropagation();\n                ev.preventDefault();\n                this.activateTab(tabLabel, panel);\n            };\n            this.labelMap.set(panel, tabLabel);\n            if (activeLabel === undefined && (this.model === undefined || this.model.value === panel.value)) {\n                activeLabel = tabLabel;\n                activePanel = panel;\n            }\n            else {\n                panel.style.display = \"none\";\n            }\n        }\n        this.attachShadow({ mode: \"open\" });\n        this.shadowRoot.adoptedStyleSheets = [txTabs, txScrollbar];\n        this.shadowRoot.replaceChildren(...children);\n        if (activeLabel !== undefined) {\n            this.activateTab(activeLabel, activePanel);\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (!(child instanceof Tab)) {\n                console.log(`unexpected <${child.nodeName.toLowerCase()}> within <Tabs>`);\n                continue;\n            }\n            const tab = child;\n            if (this.model.value === tab.value) {\n                this.activateTab(this.labelMap.get(tab), tab);\n                break;\n            }\n        }\n    }\n    activateTab(tabLabel, panel) {\n        if (this.activePanel === panel) {\n            return;\n        }\n        if (this.activeLabel !== undefined && this.activePanel !== undefined) {\n            this.activeLabel.classList.remove(\"active\");\n            this.activePanel.style.display = \"none\";\n            this.activePanel.close();\n        }\n        this.activeLabel = tabLabel;\n        this.activePanel = panel;\n        this.activePanel.open();\n        this.activeLabel.classList.add(\"active\");\n        this.activePanel.style.display = \"\";\n        setTimeout(() => this.adjustLine(), 0);\n        if (this.model && panel.value !== undefined) {\n            this.model.value = panel.value;\n        }\n    }\n    adjustLine() {\n        const line = this.markerLine;\n        const label = this.activeLabel;\n        if (label !== undefined) {\n            if (this.vertical) {\n                line.style.top = `${label.offsetTop - this.offsetTop}px`;\n                line.style.height = `${label.clientHeight}px`;\n            }\n            else {\n                line.style.top = `-2px`;\n                line.style.left = `${label.offsetLeft - this.offsetLeft}px`;\n                line.style.width = `${label.clientWidth}px`;\n            }\n        }\n    }\n}\nTabs.define(\"tx-tabs\", Tabs);\nexport class Tab extends View {\n    constructor(init) {\n        super(init);\n        this.value = init?.value;\n        this.label = init?.label;\n        this.content = init?.content;\n    }\n    open() {\n        if (this.childNodes.length === 0 && this.content !== undefined) {\n            const content = this.content();\n            if (content instanceof Promise) {\n                content.then((module) => {\n                    if (typeof module === \"object\" && \"default\" in module) {\n                        const viewOrViewFunction = module.default;\n                        if (typeof viewOrViewFunction === \"function\") {\n                            const viewOrPromise = viewOrViewFunction();\n                            if (viewOrPromise instanceof Promise) {\n                                viewOrPromise.then((s) => {\n                                    appendChildren(this, s);\n                                });\n                            }\n                            else {\n                                appendChildren(this, viewOrPromise);\n                            }\n                        }\n                        else {\n                            appendChildren(this, viewOrViewFunction);\n                        }\n                    }\n                });\n            }\n            else {\n                appendChildren(this, this.content());\n            }\n        }\n    }\n    close() { }\n}\nView.define(\"tx-tab\", Tab);\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n//# sourceMappingURL=Tab.js.map","import { css } from \"../util/lsx.js\";\nexport const menuStyle = new CSSStyleSheet();\nmenuStyle.replaceSync(css `\n  :host(.menu-button) {\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-edit-font-size);\n    font-weight: var(--tx-edit-font-weight);\n    padding: 7px;\n    vertical-align: center;\n  \n    background: var(--tx-gray-200);\n    color: var(--tx-gray-900);\n    cursor: default;\n  }\n  :host(.menu-button:hover) {\n    background: var(--tx-gray-300);\n  }\n  :host(.menu-button.active) {\n    background: var(--tx-gray-400);\n    color: var(--tx-gray-900);\n  }\n  :host(.menu-button.disabled) {\n    color: var(--tx-gray-500);\n  }\n  :host(.menu-button.active.disabled) {\n    color: var(--tx-gray-700);\n  }\n  :host(.menu-button.menu-down) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-down) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.menu-side) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-side) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  .menu-bar {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n    background-color: var(--tx-gray-200);\n  }\n  .menu-popup {\n    position: fixed;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 2px 2px 5px var(--tx-gray-50);\n  }\n`);\n//# sourceMappingURL=menuStyle.js.map","import { Action } from \"../model/Action.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nimport { MenuState } from \"./MenuState.js\";\nimport { PopupMenu } from \"./PopupMenu.js\";\nexport class MenuButton extends ModelView {\n    constructor(master, node) {\n        super();\n        this.master = master;\n        this.node = node;\n        let menuButton = this;\n        this.classList.add(\"menu-button\");\n        if (node.down) {\n            if (master.vertical)\n                this.classList.add(\"menu-side\");\n            else\n                this.classList.add(\"menu-down\");\n        }\n        this.updateView();\n        this.onmousedown = (event) => {\n            event.stopPropagation();\n            let documentMouseUp = function (event) {\n                document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n                event.preventDefault();\n                setTimeout(() => {\n                    if (MenuButton.buttonDown)\n                        menuButton.dispatchEvent(new MouseEvent(\"mouseup\", event));\n                }, 0);\n            };\n            document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n            MenuButton.buttonDown = true;\n            if (!this.master)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                    this.master.state = MenuState.DOWN;\n                    this.activate();\n                    break;\n                case MenuState.UP_N_HOLD:\n                    if (this.master.active !== this) {\n                        this.master.state = MenuState.DOWN;\n                        this.activate();\n                    }\n                    else {\n                        this.master.state = MenuState.DOWN_N_HOLD;\n                    }\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseup = (event) => {\n            event.stopPropagation();\n            if (!MenuButton.buttonDown)\n                return;\n            MenuButton.buttonDown = false;\n            if (!this.master)\n                throw Error(\"yikes\");\n            if (!this.node)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                    if (this.node.isEnabled() && !this.node.down) {\n                        this.trigger();\n                        this.master.state = MenuState.WAIT;\n                    }\n                    else {\n                        this.master.state = MenuState.UP_N_HOLD;\n                        if (MenuButton.documentMouseDown) {\n                            document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                        }\n                        MenuButton.documentMouseDown = function (event) {\n                            if (MenuButton.documentMouseDown)\n                                document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, {\n                                    capture: false,\n                                });\n                            MenuButton.documentMouseDown = undefined;\n                            let tagName = event.target.tagName;\n                            if (tagName !== \"TOAD-MENUBUTTON\") {\n                                menuButton.collapse();\n                            }\n                        };\n                        document.addEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                    }\n                    break;\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                    this.master.state = MenuState.WAIT;\n                    this.deactivate();\n                    this.collapse();\n                    if (this.master.closeOnClose) {\n                    }\n                    break;\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.trigger();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseout = (event) => {\n            event.stopPropagation();\n            if (!this.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = undefined;\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                    break;\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.master.state = MenuState.DOWN_N_OUTSIDE;\n                    this.updateView();\n                    break;\n                default:\n                    throw Error(\"unexpected state\");\n            }\n            return false;\n        };\n        this.onmouseover = (event) => {\n            event.stopPropagation();\n            if (!menuButton.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = menuButton;\n            switch (menuButton.master.state) {\n                case MenuState.WAIT:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    if (!MenuButton.buttonDown)\n                        break;\n                    if (!this.master)\n                        throw Error(\"yikes\");\n                    if (this.master.active)\n                        this.master.active.deactivate();\n                    this.master.state = MenuState.DOWN_N_INSIDE_AGAIN;\n                    this.activate();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + menuButton.master.state);\n            }\n            return false;\n        };\n        this.attachShadow({ mode: \"open\" });\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        this.shadowRoot.adoptedStyleSheets = [menuStyle];\n        if (!this.node.modelId) {\n            this.shadowRoot.appendChild(document.createTextNode(node.label));\n        }\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        if (this.node.down === undefined) {\n            let actionId = this.node.title;\n            for (let node = this.node.parent; node; node = node.parent) {\n                if (!node.title.length)\n                    break;\n                actionId = node.title + \"|\" + actionId;\n            }\n            actionId = \"A:\" + actionId;\n            globalController.registerView(actionId, this);\n        }\n        if (this.node.modelId !== undefined) {\n            if (typeof this.node.modelId === \"string\") {\n                let modelId = \"M:\" + this.node.modelId;\n                globalController.registerView(modelId, this);\n            }\n            else {\n                this.setModel(this.node.modelId);\n            }\n        }\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n        }\n        else {\n            if (typeof model === \"object\") {\n                throw Error(`unexpected model of type ${model.constructor.name}`);\n            }\n            else {\n                throw Error(`unexpected model of type ${typeof model}`);\n            }\n        }\n        this.updateView();\n    }\n    updateView() {\n        if (this.model && this.model.value) {\n            if (!this.shadowRoot)\n                throw Error(\"yikes\");\n            let span = document.createElement(\"span\");\n            if (this.model instanceof HtmlModel)\n                span.innerHTML = this.model.value;\n            else\n                span.innerText = this.model.value;\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.removeChild(this.shadowRoot.children[1]);\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.insertBefore(span, this.shadowRoot.children[1]);\n            else\n                this.shadowRoot.appendChild(span);\n        }\n        if (!this.master)\n            throw Error(\"yikes\");\n        let active = false;\n        if (this.master.active == this) {\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    active = true;\n                    break;\n                case MenuState.DOWN_N_OUTSIDE:\n                    if (!this.node)\n                        throw Error(\"yikes\");\n                    active = this.node.down !== undefined && this.node.isEnabled();\n                    break;\n            }\n        }\n        this.classList.toggle(\"active\", active);\n        this.classList.toggle(\"disabled\", !this.isEnabled());\n    }\n    isEnabled() {\n        if (this.node.down !== undefined)\n            return true;\n        return this.action !== undefined && this.action.enabled;\n    }\n    trigger() {\n        this.collapse();\n        if (!this.action)\n            return;\n        this.action.trigger();\n    }\n    collapse() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.parentButton)\n            this.master.parentButton.collapse();\n        else\n            this.deactivate();\n    }\n    openPopup() {\n        if (!this.node)\n            return;\n        if (!this.node.down)\n            return;\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        if (!this.popup) {\n            this.popup = new PopupMenu(this.node, this);\n            this.shadowRoot.appendChild(this.popup);\n        }\n        else {\n            this.popup.show();\n        }\n    }\n    closePopup() {\n        if (!this.popup)\n            return;\n        if (this.popup.active)\n            this.popup.active.deactivate();\n        this.popup.hide();\n    }\n    activate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (!this.node)\n            throw Error(\"yikes\");\n        let oldActive = this.master.active;\n        this.master.active = this;\n        if (oldActive && oldActive !== this) {\n            oldActive.closePopup();\n            oldActive.updateView();\n        }\n        this.updateView();\n        this.openPopup();\n    }\n    deactivate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.active !== this)\n            return;\n        this.master.active.closePopup();\n        this.master.active = undefined;\n        this.master.state = MenuState.WAIT;\n        this.updateView();\n    }\n}\nMenuButton.define(\"tx-menubutton\", MenuButton);\n//# sourceMappingURL=MenuButton.js.map","import { MenuButton } from \"./MenuButton.js\";\nexport class MenuNode {\n    constructor(title, label, shortcut, type, modelId) {\n        this.title = title;\n        this.label = label;\n        this.shortcut = shortcut;\n        this.type = type ? type : \"entry\";\n        this.modelId = modelId;\n    }\n    isEnabled() {\n        return true;\n    }\n    isAvailable() {\n        return true;\n    }\n    createWindowAt(parent, parentView) {\n        if (this.type == \"spacer\") {\n            let span = document.createElement(\"span\");\n            span.style.flexGrow = \"1\";\n            parentView.appendChild(span);\n            return;\n        }\n        this.view = new MenuButton(parent, this);\n        parentView.appendChild(this.view);\n    }\n    deleteWindow() {\n    }\n}\n//# sourceMappingURL=MenuNode.js.map","import * as dom from \"../util/dom.js\";\nimport { MenuNode } from \"./MenuNode.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nexport class Menu extends MenuButtonContainer {\n    constructor(props) {\n        super(props);\n        this.config = props?.config;\n        this.vertical = false;\n        this.root = new MenuNode(\"\", \"\", undefined, undefined);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.tabIndex = 0;\n        if (this.config) {\n            this.config2nodes(this.config, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n            return;\n        }\n        if (this.children.length === 0) {\n            this._observer = new MutationObserver((record, observer) => {\n                if (this._timer !== undefined)\n                    clearTimeout(this._timer);\n                this._timer = window.setTimeout(() => {\n                    this._timer = undefined;\n                    this.layout2nodes(this.children, this.root);\n                    this.referenceActions();\n                    this.createShadowDOM();\n                }, 100);\n            });\n            this._observer.observe(this, {\n                childList: true,\n                subtree: true\n            });\n        }\n        else {\n            this.layout2nodes(this.children, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n        }\n    }\n    layout2nodes(children, parent) {\n        let node = parent.down;\n        for (let child of children) {\n            let newnode = undefined;\n            switch (child.nodeName) {\n                case \"TX-MENUSPACER\":\n                    newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n                    break;\n                case \"TX-MENUENTRY\":\n                    newnode = new MenuNode(dom.attribute(child, \"name\"), dom.attribute(child, \"label\"), dom.attributeOrUndefined(child, \"shortcut\"), dom.attributeOrUndefined(child, \"type\"), dom.attributeOrUndefined(child, \"model\"));\n                    break;\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            this.layout2nodes(child.children, node);\n        }\n    }\n    config2nodes(config, parent) {\n        let node = parent.down;\n        for (let child of config) {\n            let newnode = undefined;\n            if (child.space === true) {\n                newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n            }\n            else {\n                newnode = new MenuNode(child.name, child.label, child.shortcut, child.type, child.model);\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            if (child.sub)\n                this.config2nodes(child.sub, node);\n        }\n    }\n    referenceActions() {\n    }\n    findNode(str, parent) {\n        let strpos = str.indexOf(\"|\");\n        let left = strpos == -1 ? str : str.substr(0, strpos);\n        let right = strpos == -1 ? \"\" : str.substr(strpos + 1);\n        if (!parent)\n            parent = this.root;\n        for (let n = parent.down; n; n = n.next) {\n            if (n.title == left) {\n                if (!n.down) {\n                    return n;\n                }\n                return this.findNode(right, n);\n            }\n        }\n        return undefined;\n    }\n    createShadowDOM() {\n        this.view = document.createElement(\"div\");\n        this.view.classList.add(\"menu-bar\");\n        let node = this.root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.view);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [menuStyle];\n        this.shadowRoot.appendChild(this.view);\n    }\n}\nMenu.define(\"tx-menu\", Menu);\n//# sourceMappingURL=Menu.js.map","import { View } from \"../view/View.js\";\nexport class MenuSpacer extends HTMLElement {\n}\nView.define(\"tx-menuspacer\", MenuSpacer);\n//# sourceMappingURL=MenuSpacer.js.map","import { Model } from \"../../model/Model.js\";\nexport class TableModel extends Model {\n    isEmpty() { return this.colCount === 0 && this.rowCount === 0; }\n}\n//# sourceMappingURL=TableModel.js.map","export var TableEditMode;\n(function (TableEditMode) {\n    TableEditMode[TableEditMode[\"EDIT_CELL\"] = 0] = \"EDIT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_CELL\"] = 1] = \"SELECT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_ROW\"] = 2] = \"SELECT_ROW\";\n})(TableEditMode || (TableEditMode = {}));\n//# sourceMappingURL=TableEditMode.js.map","import { TypedTableModel } from \"../model/TypedTableModel.js\";\nexport var EditMode;\n(function (EditMode) {\n    EditMode[EditMode[\"EDIT_ON_FOCUS\"] = 0] = \"EDIT_ON_FOCUS\";\n    EditMode[EditMode[\"EDIT_ON_ENTER\"] = 1] = \"EDIT_ON_ENTER\";\n})(EditMode || (EditMode = {}));\nexport class TableAdapterConfig {\n    constructor() {\n        this.editMode = EditMode.EDIT_ON_FOCUS;\n        this.seamless = false;\n        this.expandColumn = false;\n        this.expandRow = false;\n    }\n}\nexport class TableAdapter {\n    constructor(model) {\n        this.config = new TableAdapterConfig();\n        this.model = model;\n    }\n    get colCount() { return this.model === undefined ? 0 : this.model.colCount; }\n    get rowCount() { return this.model === undefined ? 0 : this.model.rowCount; }\n    getColumnHead(col) { return undefined; }\n    getRowHead(row) { return undefined; }\n    showCell(pos, cell) { }\n    saveCell(pos, cell) { }\n    editCell(pos, cell) { }\n    isViewCompact() { return false; }\n    static register(adapter, model, data) {\n        let typeToModel = TableAdapter.modelToAdapter.get(model);\n        if (typeToModel === undefined) {\n            typeToModel = new Map();\n            TableAdapter.modelToAdapter.set(model, typeToModel);\n        }\n        if (data !== undefined) {\n            if (typeToModel.has(data)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(data, adapter);\n        }\n        else {\n            if (typeToModel.has(null)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(null, adapter);\n        }\n    }\n    static unbind() {\n        TableAdapter.modelToAdapter.clear();\n    }\n    static lookup(model) {\n        let dataType;\n        if (model instanceof TypedTableModel) {\n            dataType = model.nodeClass;\n        }\n        else {\n            dataType = null;\n        }\n        const typeToAdapter = TableAdapter.modelToAdapter.get(Object.getPrototypeOf(model).constructor);\n        let adapter = typeToAdapter?.get(dataType);\n        if (adapter === undefined) {\n            for (let baseClass of TableAdapter.modelToAdapter.keys()) {\n                if (model instanceof baseClass) {\n                    adapter = TableAdapter.modelToAdapter.get(baseClass)?.get(dataType);\n                    break;\n                }\n            }\n        }\n        if (adapter === undefined) {\n            let msg = `TableAdapter.lookup(): Did not find an adapter for model of type ${model.constructor.name}`;\n            msg += `\\n    Requested adapter: model=${model.constructor.name}, type=${dataType?.name}\\n    Available adapters:`;\n            if (TableAdapter.modelToAdapter.size === 0) {\n                msg += \" none.\";\n            }\n            else {\n                for (const [modelX, typeToAdapterX] of TableAdapter.modelToAdapter) {\n                    for (const [typeX, adapterX] of typeToAdapterX) {\n                        msg += `\\n        model=${modelX.name}`;\n                        if (typeX !== undefined && typeX !== null) {\n                            msg += `, type=${typeX.name}`;\n                        }\n                    }\n                }\n            }\n            throw Error(msg);\n        }\n        return adapter;\n    }\n}\nTableAdapter.modelToAdapter = new Map();\n//# sourceMappingURL=TableAdapter.js.map","export var TableEventType;\n(function (TableEventType) {\n    TableEventType[TableEventType[\"INSERT_ROW\"] = 0] = \"INSERT_ROW\";\n    TableEventType[TableEventType[\"REMOVE_ROW\"] = 1] = \"REMOVE_ROW\";\n    TableEventType[TableEventType[\"INSERT_COL\"] = 2] = \"INSERT_COL\";\n    TableEventType[TableEventType[\"REMOVE_COL\"] = 3] = \"REMOVE_COL\";\n    TableEventType[TableEventType[\"CELL_CHANGED\"] = 4] = \"CELL_CHANGED\";\n    TableEventType[TableEventType[\"RESIZE_ROW\"] = 5] = \"RESIZE_ROW\";\n    TableEventType[TableEventType[\"RESIZE_COL\"] = 6] = \"RESIZE_COL\";\n    TableEventType[TableEventType[\"CHANGED\"] = 7] = \"CHANGED\";\n})(TableEventType || (TableEventType = {}));\n//# sourceMappingURL=TableEventType.js.map","export class TablePos {\n    constructor(col, row) {\n        this.col = col;\n        this.row = row;\n    }\n    toString() {\n        return `TablePos { col:${this.col}, row:${this.row} }`;\n    }\n}\n//# sourceMappingURL=TablePos.js.map","import { Model } from \"../../model/Model.js\";\nimport { TableEditMode } from \"../TableEditMode.js\";\nimport { TablePos } from \"../TablePos.js\";\nexport class SelectionModel extends Model {\n    constructor(mode = TableEditMode.EDIT_CELL) {\n        super();\n        this.mode = mode;\n        this._value = new TablePos(0, 0);\n    }\n    set col(col) {\n        if (this._value.col === col)\n            return;\n        this._value.col = col;\n        this.modified.trigger();\n    }\n    get col() {\n        return this._value.col;\n    }\n    set row(row) {\n        if (this._value.row === row)\n            return;\n        this._value.row = row;\n        this.modified.trigger();\n    }\n    get row() {\n        return this._value.row;\n    }\n    set value(value) {\n        if (this._value.col === value.col && this._value.row === value.row)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n    toString() {\n        return `SelectionModel {enabled: ${this.enabled}, mode: ${TableEditMode[this.mode]}, value: ${this._value}}`;\n    }\n}\n//# sourceMappingURL=SelectionModel.js.map","import { TableModel } from \"./TableModel.js\";\nexport class TypedTableModel extends TableModel {\n    constructor(nodeClass, root) {\n        super();\n        this.nodeClass = nodeClass;\n    }\n}\n//# sourceMappingURL=TypedTableModel.js.map","import { TableEventType } from \"./TableEventType.js\";\nexport class TableEvent {\n    constructor(type, index, size) {\n        this.type = type;\n        this.index = index;\n        this.size = size;\n    }\n    get col() {\n        return this.index;\n    }\n    get row() {\n        return this.size;\n    }\n    toString() {\n        return `TableEvent {type: ${TableEventType[this.type]}, index: ${this.index}, size: ${this.size}}`;\n    }\n}\n//# sourceMappingURL=TableEvent.js.map","export class TableFriend {\n    constructor(table) {\n        this.table = table;\n    }\n    get logger() {\n        return this.table.logger;\n    }\n    get adapter() {\n        return this.table.adapter;\n    }\n    get root() {\n        return this.table.root;\n    }\n    get measure() {\n        return this.table.measure;\n    }\n    focus() {\n        this.table.focus();\n    }\n    getStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.bodyStaging;\n    }\n    getHeadStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.headStaging;\n    }\n    get body() {\n        return this.table.body;\n    }\n    get splitBody() {\n        return this.table.splitBody;\n    }\n    get colHeads() {\n        return this.table.colHeads;\n    }\n    set colHeads(div) {\n        this.table.colHeads = div;\n    }\n    get rowHeads() {\n        return this.table.rowHeads;\n    }\n    set rowHeads(div) {\n        this.table.rowHeads = div;\n    }\n    get colResizeHandles() {\n        return this.table.colResizeHandles;\n    }\n    set colResizeHandles(div) {\n        this.table.colResizeHandles = div;\n    }\n    get rowResizeHandles() {\n        return this.table.rowResizeHandles;\n    }\n    set rowResizeHandles(div) {\n        this.table.rowResizeHandles = div;\n    }\n    set animationDone(animationDone) {\n        this.table.animationDone = animationDone;\n    }\n    get selection() {\n        return this.table.selection;\n    }\n    get style() {\n        return this.table.style;\n    }\n    setCellSize(span, x, y, w, h) {\n        this.table.setCellSize(span, x, y, w, h);\n    }\n    clearAnimation() {\n        this.table.animation = undefined;\n    }\n}\n//# sourceMappingURL=TableFriend.js.map","import { Table } from \"../Table.js\";\nimport { TableFriend } from \"./TableFriend.js\";\nimport { div, span } from \"../../util/lsx.js\";\nexport class TableAnimation extends TableFriend {\n    constructor(table) {\n        super(table);\n    }\n    prepareStagingWithRows() {\n        this.prepareBodyStaging();\n        this.prepareRowHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareStagingWithColumns() {\n        this.prepareBodyStaging();\n        this.prepareColHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareBodyStaging() {\n        this.bodyStaging = div();\n        this.bodyStaging.className = \"staging\";\n        this.bodyStaging.style.left = this.body.style.left;\n        this.bodyStaging.style.top = this.body.style.top;\n    }\n    prepareRowHeadStaging() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.style.top = this.rowHeads.style.top;\n        this.headStaging.style.width = this.rowHeads.style.width;\n    }\n    prepareColHeadStaging() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.classList.add(\"colHack\");\n        this.headStaging.style.left = this.colHeads.style.left;\n        this.headStaging.style.height = this.colHeads.style.height;\n    }\n    disposeStaging() {\n        this.table.removeStaging(this.bodyStaging, this.headStaging);\n    }\n    scrollStaging() {\n    }\n    makeRowMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.top = `${start}px`;\n        mask.style.height = `${size}px`;\n        mask.style.left = `0`;\n        mask.style.right = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n    makeColumnMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.left = `${start}px`;\n        mask.style.width = `${size}px`;\n        mask.style.top = `0`;\n        mask.style.bottom = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n}\n//# sourceMappingURL=TableAnimation.js.map","import { TableAnimation } from \"./TableAnimation.js\";\nexport class InsertAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.event = event;\n    }\n    prepare() {\n        this.prepareCellsToBeMeasured();\n        this.prepareStaging();\n    }\n    firstFrame() {\n        this.arrangeInStaging();\n        this.split();\n    }\n    animationFrame(n) {\n        this.animate(this.animationStart + n * this.totalSize);\n    }\n    lastFrame() {\n        this.animate(this.animationStart + this.totalSize);\n        this.join();\n        this.disposeStaging();\n    }\n    join() {\n        if (this.done) {\n            return;\n        }\n        this.done = true;\n        this.joinHeader();\n        this.joinBody();\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n}\n//# sourceMappingURL=InsertAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nimport { span, div } from \"../../util/lsx.js\";\nexport class InsertRowAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.join = this.join.bind(this);\n        this.initialRowCount = this.adapter.rowCount - event.size;\n        InsertRowAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithRows();\n    }\n    animate(pos) {\n        this.splitBody.style.top = `${pos}px`;\n        this.mask.style.top = `${pos}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${pos}px`;\n            this.headMask.style.top = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let rowHeaders = new Array(this.event.size);\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row - this.event.index] = content;\n        }\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.colHeads === undefined && this.adapter.colCount === this.event.size) {\n            let colHeaders = new Array(this.adapter.colCount);\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const content = this.adapter.getColumnHead(col);\n                if (this.colHeads === undefined && content !== undefined) {\n                    this.colHeads = div();\n                    this.colHeads.className = \"cols\";\n                    this.root.appendChild(this.colHeads);\n                    this.colResizeHandles = div();\n                    this.colResizeHandles.className = \"cols\";\n                    this.root.appendChild(this.colResizeHandles);\n                }\n                colHeaders[col] = content;\n            }\n            if (this.colHeads !== undefined) {\n                for (let col = 0; col < this.adapter.colCount; ++col) {\n                    const cell = span(colHeaders[col]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.table.createCell();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let top = 0;\n        let idx = this.event.index * this.adapter.colCount;\n        if (this.body.children.length !== 0) {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                top = px2float(cell.style.top);\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                top = px2float(cell.style.top) + b.height - overlap;\n            }\n        }\n        let colWidth = new Array(this.adapter.colCount);\n        if (this.body.children.length > 0) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.body.children[col];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = bounds.width;\n                if (this.adapter.config.seamless) {\n                    colWidth[col] += 2;\n                }\n            }\n        }\n        else {\n            colWidth.fill(this.table.minCellWidth);\n        }\n        let rowHeadWidth = this.table.minCellWidth;\n        if (this.rowHeads && this.rowHeads.children.length > 0) {\n            const cell = this.rowHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            if (this.adapter.config.seamless) {\n                rowHeadWidth += 2;\n            }\n        }\n        let rowHeight = new Array(this.event.size);\n        rowHeight.fill(this.table.minCellHeight);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        let colHeadHeight = 0;\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            colHeadHeight = this.table.minCellHeight;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width - this.table.WIDTH_ADJUST);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height - this.table.HEIGHT_ADJUST);\n            }\n        }\n        else {\n            if (this.colHeads !== undefined) {\n                const b = this.colHeads.children[0].getBoundingClientRect();\n                colHeadHeight = b.height - this.table.HEIGHT_ADJUST;\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        if (this.rowHeads) {\n            if (colHeadHeight === 0) {\n                this.rowHeads.style.top = `0px`;\n            }\n            else {\n                this.rowHeads.style.top = `${colHeadHeight + this.table.HEIGHT_ADJUST - overlap}px`;\n            }\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n        }\n        for (let row = 0; row < this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                if (this.adapter.config.expandColumn) {\n                    colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width));\n                }\n                else {\n                    if (row === 0 && this.body.children.length === 0) {\n                        colWidth[col] = Math.ceil(bounds.width);\n                    }\n                }\n            }\n            this.totalSize += rowHeight[row] - overlap;\n        }\n        if (this.adapter.config.expandColumn) {\n            idx = 0;\n            let x = 0;\n            let col = 0;\n            while (idx < this.body.children.length) {\n                const cell = this.body.children[idx];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n                ++col;\n                ++idx;\n                if (col >= this.adapter.colCount) {\n                    x = 0;\n                    col = 0;\n                }\n            }\n        }\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let y = top;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, 0, y, rowHeadWidth, rowHeight[row]);\n                this.headStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n        }\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                cell.style.height = `${colHeadHeight}px`;\n                this.colHeads.appendChild(cell);\n                x += colWidth[col] - overlap;\n            }\n            colHeadHeight += this.table.HEIGHT_ADJUST;\n            this.body.style.top = `${colHeadHeight - overlap}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.headStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n        }\n        y = top;\n        for (let row = 0; row < this.event.size; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, colWidth[col], rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n            y += rowHeight[row] - overlap;\n            if (this.adapter.config.seamless) {\n                y -= 2;\n            }\n        }\n        this.mask = this.makeRowMask(top, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads !== undefined) {\n            this.headMask = this.makeRowMask(top, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n        if (this.initialRowCount !== 0) {\n            const overlap = this.adapter.config.seamless ? 0 : 1;\n            this.totalSize -= overlap;\n        }\n    }\n    split() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.animationStart = px2float(this.splitBody.style.top);\n    }\n    joinHeader() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.rowHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.rowHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let top = px2float(this.splitHead.style.top);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.rowHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        while (this.bodyStaging.children.length > 0) {\n            this.body.appendChild(this.bodyStaging.children[0]);\n        }\n        if (this.splitBody.children.length > 0) {\n            let top = px2float(this.splitBody.style.top);\n            while (this.splitBody.children.length > 0) {\n                const cell = this.splitBody.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.body.appendChild(cell);\n            }\n        }\n    }\n}\n//# sourceMappingURL=InsertRowAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveRowAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.event = event;\n        this.joinHorizontal = this.joinHorizontal.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialHeight = 0;\n        }\n        else {\n            const bottomCell = this.body.children[this.body.children.length - 1];\n            const top = px2float(bottomCell.style.top);\n            const bounds = bottomCell.getBoundingClientRect();\n            this.initialHeight = top + bounds.height;\n        }\n        this.overlap = this.adapter.config.seamless ? 0 : 1;\n        this.removeAll = this.event.index >= this.adapter.rowCount;\n        RemoveRowAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithRows();\n        this.arrangeRowsInStaging();\n        this.splitHorizontal();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        this.splitBody.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n        this.mask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n            this.headMask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        }\n    }\n    lastFrame() {\n        this.joinHorizontal();\n        this.disposeStaging();\n    }\n    arrangeRowsInStaging() {\n        const idx = this.event.index * this.adapter.colCount;\n        const cellCount = this.event.size * this.adapter.colCount;\n        const start = px2float(this.body.children[idx].style.top);\n        for (let i = 0; i < cellCount; ++i) {\n            this.bodyStaging.appendChild(this.body.children[idx]);\n        }\n        let bottomOfStaging;\n        if (idx < this.body.children.length) {\n            bottomOfStaging = px2float(this.body.children[idx].style.top);\n        }\n        else {\n            const cell = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n            bottomOfStaging = px2float(cell.style.top) + px2float(cell.style.height) + this.table.HEIGHT_ADJUST;\n        }\n        this.animationHeight = bottomOfStaging - start;\n        this.mask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.rowHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitHorizontal() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.topSplitBody = px2float(this.splitBody.style.top);\n        this.topMask = px2float(this.mask.style.top);\n    }\n    joinHorizontal() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.rowHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.rowHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitHead.style.top);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.rowHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitBody.style.top);\n        while (this.splitBody.children.length > 0) {\n            const cell = this.splitBody.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.body.appendChild(cell);\n        }\n    }\n}\n//# sourceMappingURL=RemoveRowAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { span, div } from \"../../util/lsx.js\";\nimport { px2int, px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nexport class InsertColumnAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.event = event;\n        this.join = this.join.bind(this);\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        InsertColumnAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithColumns();\n    }\n    animate(pos) {\n        this.mask.style.left = `${pos}px`;\n        this.splitBody.style.left = `${pos}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${pos}px`;\n            this.headMask.style.left = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let colHeaders = new Array(this.event.size);\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            colHeaders[col - this.event.index] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(colHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.rowHeads === undefined && this.adapter.rowCount === this.event.size) {\n            let rowHeaders = new Array(this.adapter.rowCount);\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const content = this.adapter.getRowHead(row);\n                if (this.rowHeads === undefined && content !== undefined) {\n                    this.rowHeads = div();\n                    this.rowHeads.className = \"rows\";\n                    this.root.appendChild(this.rowHeads);\n                    this.rowResizeHandles = div();\n                    this.rowResizeHandles.className = \"rows\";\n                    this.root.appendChild(this.rowResizeHandles);\n                }\n                rowHeaders[row] = content;\n            }\n            if (this.rowHeads !== undefined) {\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    const cell = span(rowHeaders[row]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = span();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const previousColCount = this.colCount - this.event.size;\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let left;\n        let idx = this.event.index;\n        if (idx < previousColCount) {\n            let cell = this.body.children[idx];\n            left = px2int(cell.style.left);\n        }\n        else {\n            if (this.body.children.length === 0) {\n                left = 0;\n            }\n            else {\n                const cell = this.body.children[previousColCount - 1];\n                left = px2int(cell.style.left) + px2int(cell.style.width) + this.table.WIDTH_ADJUST - overlap;\n            }\n        }\n        this.animationStart = left;\n        let rowHeight = new Array(this.adapter.rowCount);\n        if (this.body.children.length !== 0) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.body.children[row * previousColCount];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = bounds.height;\n                if (this.adapter.config.seamless) {\n                    rowHeight[row] += 2;\n                }\n            }\n        }\n        else {\n            rowHeight.fill(this.table.minCellHeight);\n        }\n        let colHeadHeight = this.table.minCellHeight;\n        if (this.colHeads && this.colHeads.children.length > 0) {\n            const cell = this.colHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            colHeadHeight = bounds.height;\n            if (this.adapter.config.seamless) {\n                colHeadHeight += 2;\n            }\n        }\n        let colWidth = new Array(this.event.size);\n        colWidth.fill(this.table.minCellWidth);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let rowHeadWidth = 0;\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            rowHeadWidth = this.table.minCellWidth;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height - this.table.HEIGHT_ADJUST);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width - this.table.WIDTH_ADJUST);\n            }\n        }\n        else {\n            if (this.rowHeads !== undefined) {\n                const b = this.rowHeads.children[0].getBoundingClientRect();\n                rowHeadWidth = b.width - this.table.WIDTH_ADJUST;\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        if (this.colHeads) {\n            if (rowHeadWidth === 0) {\n                this.colHeads.style.left = `0px`;\n            }\n            else {\n                this.colHeads.style.left = `${rowHeadWidth + this.table.WIDTH_ADJUST + 2 - overlap}px`;\n            }\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n            this.body.style.top = `${colHeadHeight - 1}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - 1}px`;\n        }\n        for (let col = 0; col < this.event.size; ++col) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width) - 2);\n                if (this.adapter.config.expandRow) {\n                    rowHeight[col] = Math.ceil(Math.max(rowHeight[row], bounds.height));\n                }\n                else {\n                    if (col === 0 && this.body.children.length === 0) {\n                        rowHeight[row] = Math.ceil(bounds.height);\n                    }\n                }\n            }\n            this.totalSize += colWidth[col] - overlap;\n        }\n        colWidth.forEach((v, i) => colWidth[i] = v + 4);\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let x = left;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, 0, colWidth[col], colHeadHeight);\n                this.headStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n        }\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            let y = 0;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                cell.style.top = `${y}px`;\n                cell.style.height = `${rowHeight[row] - this.table.HEIGHT_ADJUST}px`;\n                cell.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.appendChild(cell);\n                y += rowHeight[row] - overlap;\n            }\n            rowHeadWidth += this.table.WIDTH_ADJUST;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.headStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n        }\n        let totalWidth = 0;\n        x = left;\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            let columnWidth = colWidth[col - this.event.index];\n            let y = 0;\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, columnWidth, rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n            x += columnWidth - overlap - 2;\n            if (!this.adapter.config.seamless) {\n                x += 2;\n            }\n            totalWidth += columnWidth - 2;\n        }\n        this.totalSize = totalWidth + 2;\n        this.mask = this.makeColumnMask(left, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads !== undefined) {\n            this.headMask = this.makeColumnMask(left, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n    }\n    split() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n    }\n    joinHeader() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.colHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.colHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let left = px2float(this.splitHead.style.left);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                this.colHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        const totalWidth = this.adapter.model.colCount;\n        const bodyWidth = this.event.index;\n        const stagingWidth = this.event.size;\n        const splitWidth = totalWidth - stagingWidth - this.event.index;\n        for (let col = 0; col < stagingWidth; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.bodyStaging.children[0];\n                const idx = row * (bodyWidth + stagingWidth) + bodyWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n        let left = this.totalSize + this.animationStart;\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < splitWidth; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * totalWidth + bodyWidth + stagingWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=InsertColumnAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveColumnAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        this.event = event;\n        this.joinVertical = this.joinVertical.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialWidth = 0;\n        }\n        else {\n            const cell = this.body.children[this.body.children.length - 1];\n            const left = px2float(cell.style.left);\n            const bounds = cell.getBoundingClientRect();\n            this.initialWidth = left + bounds.width;\n        }\n        RemoveColumnAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithColumns();\n        this.arrangeColumnsInStaging();\n        this.splitVertical();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        let a = 0;\n        if (this.adapter.config.seamless) {\n            a = 1;\n        }\n        this.splitBody.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n        this.mask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n            this.headMask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        }\n    }\n    lastFrame() {\n        this.joinVertical();\n        this.disposeStaging();\n    }\n    arrangeColumnsInStaging() {\n        let idx = this.event.index;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.event.size; ++col) {\n                this.bodyStaging.appendChild(this.body.children[idx]);\n            }\n            idx += this.colCount;\n        }\n        const firstCellOfStaging = this.bodyStaging.children[0];\n        const lastCellOfStaging = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n        let rightOfStaging = px2float(lastCellOfStaging.style.left) + px2float(lastCellOfStaging.style.width) + this.table.WIDTH_ADJUST;\n        rightOfStaging -= 1;\n        let w = rightOfStaging - px2float(firstCellOfStaging.style.left);\n        this.animationWidth = w;\n        this.mask = this.makeColumnMask(rightOfStaging, w);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.colHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeColumnMask(rightOfStaging, w);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitVertical() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n        const left = px2float(this.splitBody.style.left);\n        this.splitBody.style.width = `${this.initialWidth - left - 1}px`;\n        this.leftSplitBody = left;\n        this.leftMask = px2float(this.mask.style.left);\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${left}px`;\n            this.splitHead.style.width = `${this.initialWidth - left - 1}px`;\n        }\n    }\n    joinVertical() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.colHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.colHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitHead.style.left);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.left = `${px2float(cell.style.left) + left}px`;\n            this.colHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitBody.style.left);\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < this.colCount - this.event.index; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * this.adapter.colCount + this.event.index + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=RemoveColumnAnimation.js.map","let animationFrameCount = 468;\nexport function setAnimationFrameCount(frames) {\n    animationFrameCount = frames;\n}\nexport function scrollIntoView(element) {\n    if (element === undefined)\n        return;\n    const scrollableParent = findScrollableParent(element);\n    if (scrollableParent === undefined)\n        return;\n    const parentRect = scrollableParent.getBoundingClientRect();\n    const clientRect = element.getBoundingClientRect();\n    if (scrollableParent !== document.body) {\n        const { x, y } = calculateScrollGoal(scrollableParent, parentRect, clientRect);\n        smoothScroll(scrollableParent, x, y);\n        if (window.getComputedStyle(scrollableParent).position !== 'fixed') {\n            window.scrollBy({\n                left: parentRect.left,\n                top: parentRect.top,\n                behavior: 'smooth'\n            });\n        }\n    }\n    else {\n        window.scrollBy({\n            left: clientRect.left,\n            top: clientRect.top,\n            behavior: 'smooth'\n        });\n    }\n}\nfunction calculateScrollGoal(scrollableParent, parentRect, clientRect) {\n    const GAP = 16;\n    const clientLeft = clientRect.left + scrollableParent.scrollLeft - parentRect.left - GAP;\n    const clientRight = clientRect.right + scrollableParent.scrollLeft - parentRect.left + GAP;\n    const clientTop = clientRect.top + scrollableParent.scrollTop - parentRect.top - GAP;\n    const clientBottom = clientRect.bottom + scrollableParent.scrollTop - parentRect.top + GAP;\n    const parentWidth = scrollableParent.clientWidth;\n    const parentHeight = scrollableParent.clientHeight;\n    var x = scrollableParent.scrollLeft;\n    var y = scrollableParent.scrollTop;\n    if (clientRight - clientLeft - 2 * GAP > parentWidth)\n        x = clientLeft;\n    else if (clientRight > scrollableParent.scrollLeft + parentWidth)\n        x = clientRight - parentWidth;\n    else if (clientLeft < scrollableParent.scrollLeft)\n        x = clientLeft;\n    if (clientBottom - clientTop - 2 * GAP > parentHeight)\n        y = clientTop;\n    else if (clientBottom > scrollableParent.scrollTop + parentHeight)\n        y = clientBottom - parentHeight;\n    else if (clientTop < scrollableParent.scrollTop)\n        y = clientTop;\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n    return { x, y };\n}\nconst concurrentScroll = new Map();\nfunction smoothScroll(scrollable, x, y) {\n    let activeGoal = concurrentScroll.get(scrollable);\n    if (activeGoal === undefined) {\n        activeGoal = { x: x, y: y };\n        concurrentScroll.set(scrollable, activeGoal);\n    }\n    else {\n        activeGoal.x = x;\n        activeGoal.y = y;\n    }\n    let startX, startY;\n    if (scrollable === document.body) {\n        startX = window.scrollX || window.pageXOffset;\n        startY = window.scrollY || window.pageYOffset;\n    }\n    else {\n        startX = scrollable.scrollLeft;\n        startY = scrollable.scrollTop;\n    }\n    const deltaX = x - startX;\n    const deltaY = y - startY;\n    if (deltaX === 0 && deltaY === 0) {\n        concurrentScroll.delete(scrollable);\n        return;\n    }\n    animate((value) => {\n        if (activeGoal.x !== x || activeGoal.y !== y) {\n            return false;\n        }\n        const nx = startX + value * deltaX;\n        const ny = startY + value * deltaY;\n        if (scrollable === document.body) {\n            window.scrollTo(nx, ny);\n        }\n        else {\n            scrollable.scrollLeft = nx;\n            scrollable.scrollTop = ny;\n        }\n        if (value === 1) {\n            concurrentScroll.delete(scrollable);\n        }\n        return true;\n    });\n}\nlet idSource = 0;\nexport function animate(callback) {\n    setTimeout(() => { window.requestAnimationFrame(animateStep.bind(window, callback, undefined, undefined)); }, 0);\n}\nfunction animateStep(callback, startTime, id) {\n    if (startTime === undefined) {\n        startTime = Date.now();\n        id = ++idSource;\n    }\n    const time = Date.now();\n    let elapsed = animationFrameCount > 0 ? (time - startTime) / animationFrameCount : 1;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n    const value = ease(elapsed);\n    if (callback(value) === false)\n        return;\n    if (value < 1.0) {\n        window.requestAnimationFrame(animateStep.bind(window, callback, startTime, id));\n    }\n}\nfunction ease(k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n}\nvar ROUNDING_TOLERANCE = isMicrosoftBrowser(window.navigator.userAgent) ? 1 : 0;\nfunction isMicrosoftBrowser(userAgent) {\n    const userAgentPatterns = ['MSIE ', 'Trident/', 'Edge/'];\n    return new RegExp(userAgentPatterns.join('|')).test(userAgent);\n}\nexport function findScrollableParent(el) {\n    while (el !== document.body && isScrollable(el) === false) {\n        if (el.parentElement === null)\n            return undefined;\n        el = el.parentElement;\n    }\n    return el;\n}\nexport function isScrollable(el) {\n    const isScrollableY = hasScrollableSpace(el, \"Y\") && canOverflow(el, \"Y\");\n    const isScrollableX = hasScrollableSpace(el, \"X\") && canOverflow(el, \"X\");\n    return isScrollableY || isScrollableX;\n}\nfunction hasScrollableSpace(el, axis) {\n    if (axis === 'X')\n        return el.clientWidth + ROUNDING_TOLERANCE < el.scrollWidth;\n    else\n        return el.clientHeight + ROUNDING_TOLERANCE < el.scrollHeight;\n}\nfunction canOverflow(el, axis) {\n    const style = window.getComputedStyle(el, null);\n    const overflowValue = style['overflow' + axis];\n    return overflowValue === 'auto' || overflowValue === 'scroll';\n}\n//# sourceMappingURL=scrollIntoView.js.map","import { css } from \"../../util/lsx.js\";\nexport const style = new CSSStyleSheet();\nstyle.replaceSync(css `\n:host {\n    position: relative;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-300);\n    border-radius: 3px;\n    /* outline-offset: -2px; */\n    outline: none;\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-font-size);\n    background: #1e1e1e;\n\n    /* not sure about these */\n    /*\n    width: 100%;\n    width: -moz-available;\n    width: -webkit-fill-available;\n    width: fill-available;\n    height: 100%;\n    height: -moz-available;\n    height: -webkit-fill-available;\n    height: fill-available;\n    */\n\n    min-height: 50px;\n    min-width: 50px;\n}\n\n.staging, .body, .splitBody, .cols, .rows {\n    position: absolute;\n}\n\n.cols {\n    right: 0;\n    top: 0;\n}\n\n.rows {\n    left: 0;\n    bottom: 0;\n}\n\n.staging {\n    overflow: hidden;\n    inset: 0;\n}\n\n.body {\n    overflow: auto;\n    inset: 0;\n}\n\n.cols, .rows {\n    overflow: hidden;\n}\n\n.body > span,\n.splitBody > span,\n.cols > span,\n.rows > span,\n.measure > span,\n.staging > span {\n    position: absolute;\n    box-sizing: content-box;\n    white-space: nowrap;\n    outline: none;\n    border: solid 1px var(--tx-gray-200);\n    padding: 0 2px 0 2px;\n    margin: 0;\n    background-color: #080808;\n    font-weight: 400;\n    overflow: hidden;\n    cursor: default;\n    caret-color: transparent;\n}\n\n.seamless > .body > span,\n.seamless > .body > .splitBody > span,\n.seamless > .cols > span,\n.seamless > .rows > span,\n.seamless > .cols > .splitBody > span,\n.seamless > .rows > .splitBody > span,\n.seamless > .measure > span,\n.seamless > .staging > span {\n    border: none 0px;\n}\n\n.body > span:hover {\n    background: #1a1a1a;\n}\n\n.body > span.error, .splitBody > span.error {\n    border-color: var(--tx-global-red-600);\n    z-index: 1;\n}\n\n.body > span:focus, .splitBody > span:focus {\n    background: #0e2035;\n    border-color: #2680eb;\n    z-index: 2;\n}\n\n.body > span:focus:hover {\n    background: #112d4d;\n}\n\n.body > span.error, .splitBody > span.error {\n    background-color: #522426;\n}\n\n.body > span.error:hover {\n    background: #401111;\n}\n\n.cols > span.handle,\n.rows > span.handle {\n    padding: 0;\n    border: 0 none;\n    opacity: 0;\n    background-color: #08f;\n}\n.fill {\n    opacity: 0;\n}\n\n.cols > span.handle {\n    cursor: col-resize;\n}\n.rows > span.handle {\n    cursor: row-resize;\n}\n\n.staging span.head,\n.cols span.head,\n.rows span.head,\n.measure span.head {\n    background: #1e1e1e;\n    font-weight: 600;\n}\n\n.colHack > span,\n.cols > span {\n    text-align: center;\n}\n\n.measure {\n    position: absolute;\n    opacity: 0;\n}\n\n.body > span.edit, .splitBody > span.edit, .body > span.edit:hover, .splitBody > span.edit:hover {\n    caret-color: currentcolor;\n}\n`);\n//# sourceMappingURL=tx-table.js.map","import { View } from \"../view/View.js\";\nimport { TableModel } from \"./model/TableModel.js\";\nimport { SelectionModel } from \"./model/SelectionModel.js\";\nimport { EditMode, TableAdapter } from \"./adapter/TableAdapter.js\";\nimport { TableEvent } from \"./TableEvent.js\";\nimport { TablePos } from \"./TablePos.js\";\nimport { TableEditMode } from \"./TableEditMode.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { Animator } from \"../util/animation.js\";\nimport { TableAnimation } from \"./private/TableAnimation.js\";\nimport { InsertRowAnimation } from \"./private/InsertRowAnimation.js\";\nimport { RemoveRowAnimation } from \"./private/RemoveRowAnimation.js\";\nimport { InsertColumnAnimation } from \"./private/InsertColumnAnimation.js\";\nimport { RemoveColumnAnimation } from \"./private/RemoveColumnAnimation.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nimport { span, div, text } from \"../util/lsx.js\";\nimport { scrollIntoView } from \"../util/scrollIntoView.js\";\nimport { style as txTable } from \"./style/tx-table.js\";\nimport { style as txScrollbar } from \"../style/tx-scrollbar.js\";\nimport { hasFocus } from \"../util/dom.js\";\nexport class NullLogger {\n    log(_) { }\n    print() { }\n}\nexport class MemoryLogger {\n    constructor() {\n        this.logs = [];\n    }\n    log(msg) {\n        this.logs.push(msg);\n    }\n    print() {\n        console.log(`MemoryLogger collected ${this.logs.length} logs`);\n        this.logs.forEach(msg => console.log(msg));\n    }\n}\nexport function px2int(s) {\n    return parseInt(s.substring(0, s.length - 2));\n}\nexport function px2float(s) {\n    return parseFloat(s.substring(0, s.length - 2));\n}\nfunction isVisible(e) {\n    if (e.isConnected === false) {\n        return false;\n    }\n    if (window.getComputedStyle(e).display === \"none\") {\n        return false;\n    }\n    if (e.parentElement) {\n        return isVisible(e.parentElement);\n    }\n    return true;\n}\nexport class Table extends View {\n    constructor(props) {\n        super();\n        this.WIDTH_ADJUST = 6;\n        this.HEIGHT_ADJUST = 2;\n        this.HANDLE_SIZE = 5;\n        this.HANDLE_SKEW = 3;\n        this.visible = false;\n        this.prepareInProgress = false;\n        this.animator = new Animator();\n        this.logger = new Table.loggerType();\n        this.logger.log(\"Table::constructor()\");\n        this.arrangeAllMeasuredInGrid = this.arrangeAllMeasuredInGrid.bind(this);\n        this.hostKeyDown = this.hostKeyDown.bind(this);\n        this.cellKeyDown = this.cellKeyDown.bind(this);\n        this.cellFocus = this.cellFocus.bind(this);\n        this.focusIn = this.focusIn.bind(this);\n        this.focusOut = this.focusOut.bind(this);\n        this.pointerDown = this.pointerDown.bind(this);\n        this.handleDown = this.handleDown.bind(this);\n        this.handleMove = this.handleMove.bind(this);\n        this.handleUp = this.handleUp.bind(this);\n        this.setHeadingFillerSizeToScrollbarSize = this.setHeadingFillerSizeToScrollbarSize.bind(this);\n        this.selectionChanged = this.selectionChanged.bind(this);\n        this.modelChanged = this.modelChanged.bind(this);\n        this.root = div((this.body = div()));\n        this.root.className = \"root\";\n        this.body.className = \"body\";\n        this.measure = div();\n        this.measure.classList.add(\"measure\");\n        this.onkeydown = this.hostKeyDown;\n        this.addEventListener(\"focusin\", this.focusIn);\n        this.addEventListener(\"focusout\", this.focusOut);\n        this.body.onresize = this.setHeadingFillerSizeToScrollbarSize;\n        this.body.onscroll = () => {\n            if (this.animator.current && this.animator.current instanceof TableAnimation) {\n                this.animator.current.scrollStaging();\n            }\n            this.setHeadingFillerSizeToScrollbarSize();\n            if (this.colHeads) {\n                this.colHeads.scrollLeft = this.body.scrollLeft;\n                this.colResizeHandles.scrollLeft = this.body.scrollLeft;\n            }\n            if (this.rowHeads) {\n                this.rowHeads.scrollTop = this.body.scrollTop;\n                this.rowResizeHandles.scrollTop = this.body.scrollTop;\n            }\n        };\n        this.body.onpointerdown = this.pointerDown;\n        this.attachShadow({ mode: \"open\", delegatesFocus: true });\n        this.shadowRoot.adoptedStyleSheets = [txTable, txScrollbar];\n        this.shadowRoot.appendChild(this.root);\n        this.shadowRoot.appendChild(this.measure);\n        if (props) {\n            setInitialProperties(this, props);\n            if (props.selectionModel) {\n                this.setModel(props.selectionModel);\n            }\n        }\n        if (Table.observer === undefined) {\n            Table.observer = new MutationObserver((mutations, observer) => {\n                Table.allTables.forEach((table) => {\n                    if (isVisible(table)) {\n                        this.logger.log(`Table.observer => table became visible => prepareCells()`);\n                        Table.allTables.delete(table);\n                        table.prepareCells();\n                    }\n                });\n            });\n            Table.observer.observe(document.body, {\n                attributes: true,\n                subtree: true,\n            });\n        }\n    }\n    connectedCallback() {\n        this.logger.log(`Table::connectedCallback()`);\n        setTimeout(() => {\n            if (isVisible(this)) {\n                this.logger.log(`Table::connectedCallback() => is visible => prepareCells()`);\n                this.prepareCells();\n            }\n            else {\n                this.logger.log(`Table::connectedCallback() => is not visible => track in Table.allTables`);\n                Table.allTables.add(this);\n            }\n        }, 0);\n        super.connectedCallback();\n        if (this.selection === undefined) {\n            this.selection = new SelectionModel(TableEditMode.SELECT_CELL);\n            this.selection.modified.add(this.selectionChanged, this);\n        }\n    }\n    disconnectedCallback() {\n        this.logger.log(`Table::disconnectedCallback()`);\n        Table.allTables.delete(this);\n    }\n    addStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.insertBefore(element, this.root.children[0]);\n        }\n    }\n    removeStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.removeChild(element);\n        }\n    }\n    hostKeyDown(ev) {\n        this.logger.log(`Table::hostKeyDown(ev): ${ev.key}, mode: ${TableEditMode[this.selection.mode]}, adapter edit mode ${EditMode[this.adapter.config.editMode]}, editing=${this.editing}`);\n        if (!this.selection)\n            return;\n        switch (this.selection.mode) {\n            case TableEditMode.SELECT_ROW:\n                {\n                    let row = this.selection.value.row;\n                    switch (ev.key) {\n                        case \"ArrowDown\":\n                            if (row + 1 < this.adapter.rowCount)\n                                ++row;\n                            break;\n                        case \"ArrowUp\":\n                            if (row > 0)\n                                --row;\n                            break;\n                    }\n                    this.selection.row = row;\n                }\n                break;\n            case TableEditMode.SELECT_CELL:\n                {\n                    let pos = { col: this.selection.col, row: this.selection.row };\n                    switch (ev.key) {\n                        case \"ArrowRight\":\n                            if (this.editing === undefined && pos.col + 1 < this.adapter.colCount) {\n                                ++pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowLeft\":\n                            if (this.editing === undefined && pos.col > 0) {\n                                --pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowDown\":\n                            if (pos.row + 1 < this.adapter.rowCount) {\n                                ++pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowUp\":\n                            if (pos.row > 0) {\n                                --pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"Enter\":\n                            if (this.editing === undefined) {\n                                if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                                    this.editCell();\n                                }\n                            }\n                            else {\n                                this.saveCell();\n                                if (pos.row + 1 < this.adapter.rowCount) {\n                                    ++pos.row;\n                                    this.selection.value = pos;\n                                    this.editCell();\n                                }\n                            }\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                            break;\n                    }\n                    this.selection.value = pos;\n                }\n                break;\n            case TableEditMode.EDIT_CELL:\n                let pos = { col: this.selection.col, row: this.selection.row };\n                switch (ev.key) {\n                    case \"ArrowDown\":\n                        if (pos.row + 1 < this.adapter.rowCount) {\n                            ++pos.row;\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                        }\n                        break;\n                    case \"ArrowUp\":\n                        if (pos.row > 0) {\n                            --pos.row;\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                        }\n                        break;\n                    case \"Enter\":\n                        if (this.editing === undefined) {\n                            if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                                this.editCell();\n                            }\n                        }\n                        else {\n                            this.saveCell();\n                            this.editCell();\n                        }\n                        ev.preventDefault();\n                        ev.stopPropagation();\n                        break;\n                }\n                this.selection.value = pos;\n                break;\n        }\n    }\n    cellKeyDown(ev) {\n        this.logger.log(`Table::cellKeyDown()`);\n        const cell = ev.target;\n        if (ev.key === \"Enter\") {\n            this.hostKeyDown(ev);\n            ev.preventDefault();\n            return;\n        }\n        if (!cell.classList.contains(\"edit\") && this.editing === undefined) {\n            switch (ev.key) {\n                case \"ArrowDown\":\n                case \"ArrowUp\":\n                case \"ArrowRight\":\n                case \"ArrowLeft\":\n                case \"Tab\":\n                case \"Enter\":\n                    break;\n                default:\n                    if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                        ev.preventDefault();\n                    }\n            }\n        }\n        else {\n        }\n    }\n    cellFocus(event) {\n        this.logger.log(\"Table::cellFocus(event)\");\n        const cell = event.target;\n        if (cell instanceof HTMLElement) {\n            const b = cell.getBoundingClientRect();\n            const p = this.clientPosToTablePos(b.x + b.width / 2, b.y + b.height / 2);\n            if (p !== undefined) {\n                this.selection.value = p;\n            }\n            if (this.selection?.mode === TableEditMode.SELECT_CELL &&\n                this.adapter?.config.editMode === EditMode.EDIT_ON_FOCUS) {\n                this.editCell();\n            }\n        }\n    }\n    focusIn(event) {\n    }\n    focusOut(event) {\n    }\n    editCell() {\n        const col = this.selection.value.col;\n        const row = this.selection.value.row;\n        this.logger.log(`Table.editCell(): cell[${col}, ${row}]`);\n        if (this.editing !== undefined) {\n            if (this.editing.col === this.selection.value.col && this.editing.row === this.selection.value.row) {\n                return;\n            }\n        }\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        this.editing = new TablePos(col, row);\n        cell.classList.add(\"edit\");\n        this.adapter.editCell(this.editing, cell);\n    }\n    saveCell() {\n        if (this.editing === undefined) {\n            return;\n        }\n        const col = this.editing.col;\n        const row = this.editing.row;\n        this.logger.log(`Table::saveCell(): cell[${col}, ${row}]`);\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        cell.classList.remove(\"edit\");\n        this.adapter.saveCell(this.editing, cell);\n        this.editing = undefined;\n        this.focus();\n    }\n    pointerDown(ev) {\n    }\n    getModel() {\n        return this.model;\n    }\n    setModel(model) {\n        if (model === undefined) {\n            this.logger.log(`Table::setModel(undefined) => remove all models`);\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.model = undefined;\n            this.selection = new SelectionModel();\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof SelectionModel) {\n            this.logger.log(`Table::setModel(SelectionModel) => set selection model`);\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.selection = model;\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof TableModel) {\n            this.logger.log(`Table::setModel(TableModel) => set table model`);\n            this.model = model;\n            this.model.modified.add(this.modelChanged, this);\n            const adapter = TableAdapter.lookup(model);\n            try {\n                this.adapter = new adapter(model);\n            }\n            catch (e) {\n                console.log(`Table.setModel(): failed to instantiate table adapter: ${e}`);\n                console.log(`setting TypeScript's target to 'es6' might help`);\n                throw e;\n            }\n            this.prepareCells();\n            return;\n        }\n        if (model instanceof Object) {\n            this.logger.log(`Table::setModel(TableModel) => unexpected model of type ${model.constructor.name}`);\n            throw Error(`Table.setModel(): unexpected model of type ${model.constructor.name}`);\n        }\n    }\n    selectionChanged() {\n        this.logger.log(`Table::selectionChanged(): ${this.selection?.col}, ${this.selection?.row}, mode=${this.selection ? TableEditMode[this.selection.mode] : \"undefined\"}`);\n        if (this.selection === undefined) {\n            return;\n        }\n        this.saveCell();\n        switch (this.selection.mode) {\n            case TableEditMode.EDIT_CELL:\n                {\n                    if (document.activeElement === this) {\n                        const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                        if (!hasFocus(cell)) {\n                            cell.focus();\n                        }\n                        scrollIntoView(cell);\n                        if (this.adapter?.config.editMode === EditMode.EDIT_ON_FOCUS) {\n                            this.editCell();\n                        }\n                    }\n                }\n                break;\n            case TableEditMode.SELECT_CELL:\n            case TableEditMode.SELECT_ROW:\n                {\n                    if (document.activeElement === this) {\n                        const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                        cell.focus();\n                        scrollIntoView(cell);\n                    }\n                }\n                break;\n        }\n    }\n    modelChanged(event) {\n        this.logger.log(`Table::modelChanged(${event})`);\n        if (!this.visible && this.body.children.length === 0) {\n            return;\n        }\n        if (event instanceof TableEvent) {\n            switch (event.type) {\n                case TableEventType.CELL_CHANGED:\n                    {\n                        const index = event.col + event.row * this.adapter.colCount;\n                        const cell = this.body.children[index];\n                        if (cell === undefined) {\n                            console.log(`Table::modelChanged(): failed to find cell ${event.col}, ${event.row} (${index}) (body has ${this.body.children.length} children and table has parent ${this.parentElement})`);\n                            return;\n                        }\n                        if (cell instanceof HTMLSpanElement) {\n                            this.showCell(event, cell);\n                        }\n                    }\n                    break;\n                case TableEventType.INSERT_ROW:\n                    this.animator.run(new InsertRowAnimation(this, event));\n                    break;\n                case TableEventType.REMOVE_ROW:\n                    this.animator.run(new RemoveRowAnimation(this, event));\n                    break;\n                case TableEventType.INSERT_COL:\n                    this.animator.run(new InsertColumnAnimation(this, event));\n                    break;\n                case TableEventType.REMOVE_COL:\n                    this.animator.run(new RemoveColumnAnimation(this, event));\n                    break;\n                default:\n            }\n        }\n    }\n    prepareCells() {\n        if (this.adapter === undefined) {\n            this.logger.log(`Table::prepareCells(): no adapter => abort`);\n            return;\n        }\n        if (this.adapter.colCount === 0 || this.adapter.rowCount === 0) {\n            this.logger.log(`Table::prepareCells(): col and/or row count is zero => abort`);\n            return;\n        }\n        this.visible = isVisible(this);\n        if (!this.visible) {\n            this.logger.log(`Table::prepareCells(): not visible, can not calculate layout => abort`);\n            return;\n        }\n        if (this.prepareInProgress) {\n            this.logger.log(`Table::prepareCells(): prepareInProgress => abort`);\n            return;\n        }\n        this.prepareInProgress = true;\n        this.logger.log(`Table::prepareCells(): start`);\n        if (this.adapter.config.seamless) {\n            this.root.classList.add(\"seamless\");\n        }\n        this.prepareMinCellSize();\n        this.prepareColumnHeads();\n        this.prepareRowHeads();\n        this.prepareBody();\n        this.logger.log(`Table::prepareCells(): finish, schedule arrangeAllMeasuredInGrid()`);\n        setTimeout(this.arrangeAllMeasuredInGrid, 0);\n    }\n    arrangeAllMeasuredInGrid() {\n        this.logger.log(`Table::arrangeAllMeasuredInGrid(): begin`);\n        this.calculateMinCellSize();\n        let { colWidths, colHeadHeight } = this.calculateColumnWidths();\n        let { rowHeights, rowHeadWidth } = this.calculateRowHeights();\n        this.placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth);\n        this.placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth);\n        this.placeBody(rowHeadWidth, colHeadHeight);\n        this.placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth);\n        this.setHeadingFillerSizeToScrollbarSize();\n        this.prepareInProgress = false;\n        this.logger.log(`Table::arrangeAllMeasuredInGrid(): finish`);\n    }\n    prepareMinCellSize() {\n        this.logger.log(`Table::prepareMinCellSize()`);\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = span(text(\"Tg\"));\n        this.measure.appendChild(measureLineHeight);\n    }\n    calculateMinCellSize() {\n        this.logger.log(`Table::calculateMinCellSize()`);\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = this.measure.children[0];\n        const b = measureLineHeight.getBoundingClientRect();\n        this.minCellWidth = Math.ceil(b.width - this.WIDTH_ADJUST);\n        this.minCellHeight = Math.ceil(b.height - this.HEIGHT_ADJUST);\n        this.measure.removeChild(measureLineHeight);\n    }\n    prepareColumnHeads() {\n        this.logger.log(`Table::prepareColumnHeads()`);\n        const columnHeaders = new Array(this.adapter.colCount);\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            columnHeaders[col] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = span(columnHeaders[col]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareRowHeads() {\n        this.logger.log(`Table::prepareRowHeads()`);\n        let rowHeaders = new Array(this.adapter.rowCount);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row] = content;\n        }\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareBody() {\n        this.logger.log(`Table::prepareBody()`);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.createCell();\n                this.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    createCell() {\n        const cell = span();\n        cell.onfocus = this.cellFocus;\n        cell.onkeydown = this.cellKeyDown;\n        cell.tabIndex = 0;\n        cell.setAttribute(\"contenteditable\", \"\");\n        return cell;\n    }\n    setCellSize(span, x, y, w, h) {\n        span.style.left = `${x}px`;\n        span.style.top = `${y}px`;\n        span.style.width = `${w - this.WIDTH_ADJUST}px`;\n        span.style.height = `${h - this.HEIGHT_ADJUST}px`;\n    }\n    showCell(pos, cell) {\n        this.adapter.showCell(pos, cell);\n        if (cell.children.length !== 0) {\n            cell.style.caretColor = \"currentcolor\";\n        }\n    }\n    calculateRowHeights() {\n        this.logger.log(`Table::calculateRowHeights()`);\n        let idx = this.colHeads ? this.adapter.colCount : 0;\n        let rowHeadWidth = 0;\n        const rowHeights = Array(this.adapter.rowCount);\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const child = this.measure.children[idx++];\n                const bounds = child.getBoundingClientRect();\n                rowHeights[row] = Math.max(bounds.height, this.minCellHeight);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        else {\n            rowHeights.fill(this.minCellHeight);\n        }\n        idx = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let rh = rowHeights[row];\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[idx + col + row * this.adapter.colCount];\n                const bounds = child.getBoundingClientRect();\n                rh = Math.max(rh, bounds.height);\n            }\n            rowHeights[row] = Math.ceil(rh);\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        return { rowHeights, rowHeadWidth };\n    }\n    calculateColumnWidths(withinBody = false) {\n        this.logger.log(`Table::calculateColumnWidths(withinBody = ${withinBody})`);\n        let colHeadHeight = 0;\n        const colWidths = Array(this.adapter.colCount);\n        if (this.colHeads) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[col];\n                const bounds = child.getBoundingClientRect();\n                colWidths[col] = Math.max(bounds.width, this.minCellWidth);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        else {\n            colWidths.fill(this.minCellWidth);\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let idxStart;\n        if (withinBody) {\n            idxStart = 0;\n        }\n        else {\n            idxStart = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        }\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            let cw = colWidths[col];\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                let child;\n                let idx = idxStart + col + row * this.adapter.colCount;\n                if (withinBody) {\n                    child = this.body.children[idx];\n                }\n                else {\n                    child = this.measure.children[idx];\n                }\n                const bounds = child.getBoundingClientRect();\n                cw = Math.max(cw, bounds.width);\n            }\n            colWidths[col] = Math.ceil(cw);\n        }\n        return { colWidths, colHeadHeight };\n    }\n    placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeColumnHeads(...)`);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let x = 0;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, x, 0, colWidths[col], colHeadHeight);\n            this.colHeads.appendChild(child);\n            x += colWidths[col] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colHeads.appendChild(filler);\n        this.colResizeHandles.style.left = `${rowHeadWidth}px`;\n        this.colResizeHandles.style.height = `${colHeadHeight}px`;\n        x = -this.HANDLE_SKEW;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            x += colWidths[col] - 1;\n            const handle = this.createHandle(col, x, 0, this.HANDLE_SIZE, colHeadHeight);\n            this.colResizeHandles.appendChild(handle);\n        }\n        x += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colResizeHandles.appendChild(filler);\n    }\n    placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeRowHeads(...)`);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, 0, y, rowHeadWidth, rowHeights[row]);\n            this.rowHeads.appendChild(child);\n            y += rowHeights[row] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowHeads.appendChild(filler);\n        this.rowResizeHandles.style.top = `${colHeadHeight}px`;\n        this.rowResizeHandles.style.width = `${rowHeadWidth}px`;\n        y = -this.HANDLE_SKEW;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            y += rowHeights[row] - 1;\n            const rowHandle = this.createHandle(row, 0, y, rowHeadWidth, this.HANDLE_SIZE);\n            this.rowResizeHandles.appendChild(rowHandle);\n        }\n        y += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}0px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowResizeHandles.appendChild(filler);\n    }\n    placeBody(rowHeadWidth, colHeadHeight) {\n        this.logger.log(`Table::placeBody(...)`);\n        if (this.colHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.colHeads.style.height = `${colHeadHeight - 2}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.colHeads.style.height = `${colHeadHeight}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 1)}px`;\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.rowHeads.style.width = `${rowHeadWidth - 2}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.rowHeads.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 1)}px`;\n            }\n        }\n        --rowHeadWidth;\n        --colHeadHeight;\n        if (this.adapter?.config.seamless) {\n            --rowHeadWidth;\n            --colHeadHeight;\n        }\n        if (rowHeadWidth < 0) {\n            rowHeadWidth = 0;\n        }\n        if (colHeadHeight < 0) {\n            colHeadHeight = 0;\n        }\n        this.body.style.left = `${rowHeadWidth}px`;\n        this.body.style.top = `${colHeadHeight}px`;\n        return { rowHeadWidth, colHeadHeight };\n    }\n    placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth) {\n        this.logger.log(`Table::placeBodyCells(...)`);\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[0];\n                this.setCellSize(child, x, y, colWidths[col], rowHeights[row]);\n                this.body.appendChild(child);\n                x += colWidths[col] - 2 + seam;\n            }\n            y += rowHeights[row] - 2 + seam;\n        }\n    }\n    createHandle(idx, x, y, w, h) {\n        const handle = span();\n        handle.className = \"handle\";\n        handle.style.left = `${x}px`;\n        handle.style.top = `${y}px`;\n        handle.style.width = `${w}px`;\n        handle.style.height = `${h}px`;\n        handle.dataset[\"idx\"] = `${idx}`;\n        handle.onpointerdown = this.handleDown;\n        handle.onpointermove = this.handleMove;\n        handle.onpointerup = this.handleUp;\n        return handle;\n    }\n    handleDown(ev) {\n        ev.preventDefault();\n        this.handle = ev.target;\n        this.handleIndex = parseInt(this.handle.dataset[\"idx\"]) + 1;\n        this.handle.setPointerCapture(ev.pointerId);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            this.deltaHandle = ev.clientX - px2int(this.handle.style.left);\n            this.deltaSplitBody = ev.clientX;\n            this.deltaSplitHead = ev.clientX - px2float(this.body.style.left);\n            const cell = this.colHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientX - px2float(cell.style.width);\n            this.splitVertical(this.handleIndex);\n        }\n        else {\n            this.deltaHandle = ev.clientY - px2float(this.handle.style.top);\n            this.deltaSplitBody = ev.clientY;\n            this.deltaSplitHead = ev.clientY - px2float(this.body.style.top);\n            const cell = this.rowHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientY - px2float(cell.style.height);\n            this.splitHorizontal(this.handleIndex);\n        }\n    }\n    handleMove(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.handle.style.left = `${clientX - this.deltaHandle}px`;\n            this.splitHead.style.left = `${clientX - this.deltaSplitHead}px`;\n            this.splitBody.style.left = `${clientX - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.colHeads.children[h - 1].style.width = `${clientX - this.deltaColumn}px`;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                ;\n                this.body.children[h - 1 + row * h].style.width = `${clientX - this.deltaColumn}px`;\n            }\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.handle.style.top = `${clientY - this.deltaHandle}px`;\n            this.splitHead.style.top = `${clientY - this.deltaSplitHead}px`;\n            this.splitBody.style.top = `${clientY - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.rowHeads.children[h - 1].style.height = `${clientY - this.deltaColumn}px`;\n            let idx = (h - 1) * this.adapter.colCount;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                ;\n                this.body.children[idx + col].style.height = `${clientY - this.deltaColumn}px`;\n            }\n        }\n    }\n    handleUp(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        this.handleMove(ev);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.joinVertical(this.handleIndex, clientX - this.deltaSplitBody);\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.joinHorizontal(this.handleIndex, clientY - this.deltaSplitBody);\n        }\n        this.handle = undefined;\n    }\n    splitVerticalNew(splitCol) {\n        this.logger.log(`Table.splitVerticalNew(splitCol = ${splitCol})`);\n        this.splitHeadVertical(splitCol);\n        this.splitBodyVertical(splitCol);\n    }\n    splitHeadVertical(splitCol) {\n        this.logger.log(`Table.splitHeadVertical(splitCol = ${splitCol})`);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody colHack\";\n        this.splitHead.style.top = `0`;\n        this.splitHead.style.bottom = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitCol;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.left = `0px`;\n            this.splitHead.style.width = `1px`;\n        }\n        else {\n            if (idx < this.colHeads.children.length) {\n                let cell = this.colHeads.children[idx];\n                let width = 0;\n                const left = px2float(cell.style.left);\n                while (idx < this.colHeads.children.length) {\n                    cell = this.colHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    width += b.width - overlap;\n                    let x = px2float(cell.style.left);\n                    cell.style.left = `${x - left}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    width += overlap;\n                }\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.colHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + b.width - overlap;\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `1px`;\n            }\n        }\n        this.colHeads.appendChild(this.splitHead);\n    }\n    splitBodyVertical(splitCol) {\n        this.logger.log(`Table.splitBodyVertical(splitCol=${splitCol})`);\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.top = `0`;\n        this.splitBody.style.bottom = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.left = `0px`;\n            this.splitBody.style.width = `1px`;\n        }\n        else {\n            const previousColCount = this.body.children.length / this.adapter.rowCount;\n            if (splitCol < previousColCount) {\n                let cell = this.body.children[splitCol];\n                const left = px2float(cell.style.left);\n                let width = 0;\n                const colsInBody = this.body.children.length / this.adapter.rowCount;\n                const colsToSplit = colsInBody - splitCol;\n                let idx = splitCol;\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    for (let col = 0; col < colsToSplit; ++col) {\n                        cell = this.body.children[idx];\n                        if (row === 0) {\n                            const b = cell.getBoundingClientRect();\n                            width += b.width - overlap;\n                        }\n                        cell.style.left = `${px2float(cell.style.left) - left}px`;\n                        this.splitBody.appendChild(cell);\n                    }\n                    idx += splitCol;\n                }\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let boundary = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + boundary.width - overlap;\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitVertical(splitColumn, extra = 0) {\n        this.logger.log(`Table::splitVertical(splitColumn=${splitColumn}, extra=${extra})`);\n        if (this.colHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"cols\";\n            this.splitHead.style.left = this.colHeads.style.left;\n            this.splitHead.style.height = this.colHeads.style.height;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.colHeads.scrollTop;\n                this.splitHead.scrollLeft = this.colHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const bodyWidth = splitColumn;\n        const splitBodyColumns = this.adapter.colCount - splitColumn + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyColumns; ++i) {\n                this.splitHead.appendChild(this.colHeads.children[splitColumn]);\n            }\n            this.splitHead.appendChild(this.colHeads.children[this.colHeads.children.length - 1].cloneNode());\n        }\n        let idx = splitColumn;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n            idx += bodyWidth;\n        }\n    }\n    joinVertical(splitCol, delta, extra = 0, colCount, rowCount) {\n        this.logger.log(`Table::joinVertical(splitCol=${splitCol}, delta=${delta}, extra=${extra}, colCount = ${colCount}, rowCount = ${rowCount})`);\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyColumns = colCount - splitCol + extra;\n        let idx = splitCol - extra;\n        if (this.colHeads !== undefined) {\n            const filler = this.colHeads.children[this.colHeads.children.length - 1];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitHead.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.colHeads.insertBefore(cell, filler);\n            }\n            const fillerLeft = filler.style.left;\n            const left = px2float(fillerLeft);\n            filler.style.left = `${left + delta}px`;\n            for (let col = idx; col <= colCount; ++col) {\n                const cell = this.colResizeHandles.children[col];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n            }\n        }\n        for (let row = 0; row < rowCount; ++row) {\n            let beforeChild = this.body.children[idx];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitBody.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.body.insertBefore(cell, beforeChild);\n            }\n            idx += colCount;\n        }\n        if (this.colHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    splitHorizontalNew(splitRow) {\n        this.logger.log(`Table.splitHorizontalNew(splitRow = ${splitRow})`);\n        this.splitHeadHorizontal(splitRow);\n        this.splitBodyHorizontal(splitRow);\n    }\n    splitHeadHorizontal(splitRow) {\n        this.logger.log(`Table.splitHeadHorizontal(splitRow = ${splitRow})`);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody\";\n        this.splitHead.style.left = `0`;\n        this.splitHead.style.right = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitRow;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.top = `0px`;\n            this.splitHead.style.height = `1px`;\n        }\n        else {\n            if (idx < this.rowHeads.children.length) {\n                let cell = this.rowHeads.children[idx];\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.rowHeads.children.length) {\n                    cell = this.rowHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    height += b.height - overlap;\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    height += overlap;\n                }\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `${height}px`;\n            }\n            else {\n                let cell = this.rowHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let top = px2float(cell.style.top) + b.height - overlap;\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `1px`;\n            }\n        }\n        this.rowHeads.appendChild(this.splitHead);\n    }\n    splitBodyHorizontal(splitRow) {\n        this.logger.log(`Table.splitBodyHorizontal(splitRow = ${splitRow})`);\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.left = `0`;\n        this.splitBody.style.right = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        const idx = splitRow * this.adapter.colCount;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.top = `0px`;\n            this.splitBody.style.height = `1px`;\n        }\n        else {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                let col = this.adapter.colCount;\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.body.children.length) {\n                    cell = this.body.children[idx];\n                    --col;\n                    if (col === 0) {\n                        const b = cell.getBoundingClientRect();\n                        height += b.height - overlap;\n                        col = this.adapter.colCount;\n                    }\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitBody.appendChild(cell);\n                }\n                height += overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `${height}px`;\n            }\n            else {\n                let cellAtBottom = this.body.children[this.body.children.length - 1];\n                let b = cellAtBottom.getBoundingClientRect();\n                let top = px2float(cellAtBottom.style.top) + b.height - overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitHorizontal(splitRow, extra = 0, event) {\n        this.logger.log(`Table.splitHorizontal(splitRow = ${splitRow}, extra = ${extra}, event = ...)`);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"rows\";\n            this.splitHead.style.top = this.rowHeads.style.top;\n            this.splitHead.style.width = this.rowHeads.style.width;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.rowHeads.scrollTop;\n                this.splitHead.scrollLeft = this.rowHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.backgroundColor = \"rgba(255,128,0,0.5)\";\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const splitBodyRows = this.adapter.rowCount - splitRow + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyRows; ++i) {\n                this.splitHead.appendChild(this.rowHeads.children[splitRow]);\n            }\n            this.splitHead.appendChild(this.rowHeads.children[this.rowHeads.children.length - 1].cloneNode());\n        }\n        let idx = this.adapter.colCount * splitRow;\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n        }\n        if (this.splitBody.children.length > 0) {\n            idx = this.splitBody.children.length - 1;\n            const last = this.splitBody.children[idx];\n            const top = px2int(last.style.top);\n            for (let i = 0; i < this.splitBody.children.length; ++i) {\n                const c = this.splitBody.children[i];\n                const y = px2int(c.style.top);\n                c.style.top = `${y - top}px`;\n            }\n            this.splitBody.style.backgroundColor = \"#f80\";\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (event !== undefined && this.body.children.length > 0) {\n            idx = event.index * this.adapter.colCount;\n            const last = this.body.children[idx];\n            const top = px2int(last.style.top);\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (this.body.children.length > 0) {\n            const filler = span();\n            idx = this.body.children.length - 2;\n            const last = this.body.children[idx];\n            const bf = this.body.children[idx].getBoundingClientRect();\n            filler.style.border = \"none\";\n            filler.style.backgroundColor = \"#1e1e1e\";\n            const top = px2int(last.style.top) + bf.height;\n            filler.style.top = `${top}px`;\n            filler.style.left = `0px`;\n            filler.style.width = `${b.width - 2}px`;\n            filler.style.height = `${b.height - top}px`;\n            this.splitBody.appendChild(filler);\n        }\n        else {\n        }\n    }\n    joinHorizontal(splitRow, delta, extra = 0, colCount, rowCount) {\n        this.logger.log(`Table. joinHorizontal(splitRow = ${splitRow}, delta = ${delta}, extra = ${extra}, colCount = ${colCount}, rowCount = ${rowCount}`);\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyRows = rowCount - splitRow + extra;\n        if (this.rowHeads !== undefined) {\n            const filler = this.rowHeads.children[this.rowHeads.children.length - 1];\n            for (let row = 0; row < splitBodyRows; ++row) {\n                const cell = this.splitHead.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.rowHeads.insertBefore(cell, filler);\n            }\n            const fillerTop = filler.style.top;\n            const top = px2float(fillerTop);\n            filler.style.top = `${top + delta}px`;\n            let idx = splitRow;\n            for (let row = idx; row <= rowCount; ++row) {\n                const cell = this.rowResizeHandles.children[row];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n            }\n        }\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < colCount; ++col) {\n                const cell = this.splitBody.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.body.appendChild(cell);\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    setHeadingFillerSizeToScrollbarSize() {\n        this.logger.log(`Table.setHeadingFillerSizeToScrollbarSize()`);\n        const bounds = this.body.getBoundingClientRect();\n        if (this.colHeads !== undefined) {\n            const w = Math.ceil(bounds.width - this.body.clientWidth);\n            this.colHeads.children[this.colHeads.children.length - 1].style.width = `${w}px`;\n            this.colHeads.style.right = `${w}px`;\n        }\n        if (this.rowHeads !== undefined) {\n            const h = Math.ceil(bounds.height - this.body.clientHeight);\n            this.rowHeads.children[this.rowHeads.children.length - 1].style.height = `${h}px`;\n            this.rowHeads.style.bottom = `${h}px`;\n        }\n    }\n    clientPosToTablePos(x, y) {\n        let col, row;\n        for (col = 0; col < this.adapter.colCount; ++col) {\n            const b = this.body.children[col].getBoundingClientRect();\n            if (b.x <= x && x < b.x + b.width)\n                break;\n        }\n        if (col >= this.adapter.colCount) {\n            return undefined;\n        }\n        let idx = 0;\n        for (row = 0; row < this.adapter.rowCount; ++row) {\n            const b = this.body.children[idx].getBoundingClientRect();\n            if (b.y <= y && y < b.y + b.height)\n                break;\n            idx += this.adapter.colCount;\n        }\n        if (row >= this.adapter.rowCount) {\n            return undefined;\n        }\n        return new TablePos(col, row);\n    }\n}\nTable.maskColor = `#1e1e1e`;\nTable.splitColor = `#1e1e1e`;\nTable.allTables = new Set();\nTable.loggerType = NullLogger;\nTable.define(\"tx-table\", Table);\n//# sourceMappingURL=Table.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { View } from \"../view/View.js\";\nimport { GenericTool } from \"../view/GenericTool.js\";\nimport { textAreaStyle } from \"../view/textAreaStyle.js\";\nimport { Table } from \"./Table.js\";\nexport class TableTool extends GenericTool {\n    constructor() {\n        super();\n        this.toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonAddRowAbove = _jsx(\"button\", { class: \"left\", title: \"add row above\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"8.5\", x2: \"4.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"8.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"2\", x2: \"6.5\", y2: \"7\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"4.5\", x2: \"9\", y2: \"4.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowAbove.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowAbove);\n        this.buttonAddRowBelow = _jsx(\"button\", { title: \"add row below\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"6\", x2: \"6.5\", y2: \"11\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"8.5\", x2: \"9\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowBelow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowBelow);\n        this.buttonDeleteRow = _jsx(\"button\", { class: \"right\", title: \"delete row\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"5.5\", y1: \"3.5\", x2: \"11.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"11.5\", y1: \"3.5\", x2: \"5.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteRow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.removeRow(selection.row, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteRow);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddColumnLeft = _jsx(\"button\", { class: \"left\", title: \"add column left\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"7\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"4\", x2: \"4.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnLeft.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnLeft);\n        this.buttonAddColumnRight = _jsx(\"button\", { title: \"add column right\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"4.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6\", y1: \"6.5\", x2: \"11\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4\", x2: \"8.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnRight.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnRight);\n        this.buttonDeleteColumn = _jsx(\"button\", { class: \"right\", title: \"delete column\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"5.5\", x2: \"9.5\", y2: \"11.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11.5\", x2: \"9.5\", y2: \"5.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteColumn.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.removeColumn(selection.col, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteColumn);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddNodeAbove = _jsx(\"button\", { class: \"left\", title: \"add node above\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeAbove);\n        this.buttonAddNodeBelow = _jsx(\"button\", { title: \"add node below\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11\", x2: \"3.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"12.5\", x2: \"5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"16\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeBelow);\n        this.buttonAddNodeParent = _jsx(\"button\", { title: \"add node parent\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.buttonAddNodeParent.onclick = () => {\n        };\n        this.toolbar.appendChild(this.buttonAddNodeParent);\n        this.buttonAddNodeChild = _jsx(\"button\", { title: \"add node child\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"11\", x2: \"9.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8\", y1: \"12.5\", x2: \"11\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeChild);\n        this.buttonDeleteNode = _jsx(\"button\", { class: \"right\", title: \"delete node\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 17\", width: \"10\", height: \"17\", children: [_jsx(\"rect\", { x: \"1.5\", y: \"5.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"2\", x2: \"4.5\", y2: \"5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"12\", x2: \"4.5\", y2: \"15\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"0.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.toolbar.appendChild(this.buttonDeleteNode);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.adoptedStyleSheets = [textAreaStyle];\n        this.shadowRoot.appendChild(this.toolbar);\n    }\n    canHandle(view) {\n        return view instanceof Table;\n    }\n    activate() {\n        this.lastActiveTable = GenericTool.activeView;\n        this.toolbar.classList.add(\"active\");\n    }\n    deactivate() {\n        this.lastActiveTable = undefined;\n        this.toolbar.classList.remove(\"active\");\n    }\n}\nView.define(\"tx-tabletool\", TableTool);\nfunction isRowEditInterface(model) {\n    return model !== undefined && 'insertRow' in model && \"removeRow\" in model;\n}\nfunction isColumnEditInterface(model) {\n    return model !== undefined && 'insertColumn' in model && \"removeColumn\" in model;\n}\n//# sourceMappingURL=TableTool.js.map","import { Point } from \"Point\"\n\nexport class Selector {\n    height = 104;\n    width = 192;\n    cursorPos: Point = { x: 96/2, y: 54 };\n    rows: number\n    cols: number\n    maxValue: number\n    cellRatio: number\n    points: Point[] = [];\n    labels: string[]\n    private dists?: number[]\n\n    constructor(rows: number, cols: number, labels: string[]) {\n        this.rows = rows\n        this.cols = cols\n        this.labels = labels\n\n        const cellWidth = this.width / (cols - 1)\n        const cellHeight = this.height / (rows - 1)\n        this.cellRatio = cellWidth / cellHeight\n        this.maxValue = Math.min(cellWidth, cellHeight * this.cellRatio)\n\n        for (let i = 0; i < rows; ++i) {\n            for (let j = 0; j < cols; ++j) {\n                this.points.push({\n                    x: j * cellWidth,\n                    y: i * cellHeight,\n                })\n            }\n        }\n    }\n    setCursorPos(x: number, y: number) {\n        this.dists = undefined\n        x = Math.max(Math.min(x, this.width), 0)\n        y = Math.max(Math.min(y, this.height), 0)\n        this.cursorPos.x = x\n        this.cursorPos.y = y\n    }\n    getDists() {\n        if (this.dists !== undefined) {\n            return this.dists\n        }\n        this.dists = []\n        \n        let x = this.cursorPos.x, y = this.cursorPos.y\n\n        for (const tmp of this.points) {\n            const dist = Math.sqrt(\n                Math.pow(tmp.x - x, 2) + Math.pow((tmp.y - y) * this.cellRatio, 2)\n            )\n            const value = 1 - dist / this.maxValue\n            if (value > 0) {\n                this.dists.push(value)\n            } else {\n                this.dists.push(0)\n            }\n        }\n        return this.dists\n    }\n}\n","import { Selector } from \"Selector\"\nimport { Mesh } from \"animorph/Mesh\"\n\nexport class SelectorListener {\n    mesh: Mesh\n\n    age: Selector\n    muscleSize: Selector\n    breast: Selector\n    shape: Selector\n\n    constructor(mesh: Mesh) {\n        this.mesh = mesh\n\n        // prettier-ignore\n        this.age = new Selector(2, 5, [\n            \"female_10\", \"female_30\", \"female_50\", \"female_70\", \"female_90\",\n            \"male_10\", \"male_30\", \"male_50\", \"male_70\", \"male_90\"\n        ])\n        // prettier-ignore\n        this.muscleSize = new Selector(2, 2, [\n            \"skinny_nomuscle\", \"big_nomuscle\",\n            \"skinny_muscle\", \"big_muscle\"\n        ])\n        // prettier-ignore\n        this.breast = new Selector(2, 2, [\n            \"cone_little\", \"cone_big\",\n            \"sphere_little\", \"sphere_big\"\n        ])\n        this.breast.setCursorPos(96, 54)\n        // prettier-ignore\n        this.shape = new Selector(2, 2, [\n            \"brevilinear_vshape\", \"brevilinear_peershape\",\n            \"longilinear_vshape\", \"longilinear_peershape\"\n        ])\n        // this.calcWidgetTargets() // FIXME: when called here, UI stops working\n    }\n\n    doMorph(target_name: string, morph_value: number) {\n        this.mesh.doMorph(target_name, morph_value)\n    }\n\n    calcWidgetTargets() {\n        const ageDists = this.age.getDists()\n        const muscleSizeDists = this.muscleSize.getDists()\n        const breastDists = this.breast.getDists()\n        const shapeDists = this.shape.getDists()\n\n        let i: number, j: number, k: number\n\n        i = 0\n        for (const di_it of ageDists) {\n            if (i < this.age.labels.length) {\n                const tmpTargetName = `ages/${this.age.labels[i++]}.target`\n                this.doMorph(tmpTargetName, di_it)\n            }\n        }\n\n        j = 0\n        for (const ms_it of muscleSizeDists) {\n            i = 0\n            for (const di_it of ageDists) {\n                if (j < this.muscleSize.labels.length && i < this.age.labels.length) {\n                    const tmpTargetName = `muscleSize/${this.age.labels[i]}_${this.muscleSize.labels[j]}.target`\n                    const tmpTargetValue = di_it * ms_it\n                    this.doMorph(tmpTargetName, tmpTargetValue)\n                }\n                k = 0\n                if (i <= 4) {\n                    for (const br_it of breastDists) {\n                        if (k < this.breast.labels.length) {\n                            const tmpTargetName = `breast/${this.age.labels[i]}_${this.muscleSize.labels[j]}_${this.breast.labels[k]}.target`\n                            const tmpTargetValue = di_it * ms_it * br_it\n                            this.doMorph(tmpTargetName, tmpTargetValue)\n                        }\n                        ++k\n                    }\n                }\n                ++i\n            }\n            ++j\n        }\n\n        i = 0\n        for (const sh_it of shapeDists) {\n            if (i < this.shape.labels.length) {\n                const tmpTargetName = `shapes/${this.shape.labels[i++]}.target`\n                this.doMorph(tmpTargetName, sh_it)\n            }\n        }\n    }\n}\n","import { vec3 } from \"gl-matrix\"\n\nexport class VectorArray extends Float32Array {\n    getVec3(idx: number): vec3 {\n        idx *= 3\n        return vec3.fromValues(this[idx], this[idx + 1], this[idx + 2])\n    }\n    setVec3(idx: number, v: vec3) {\n        this.set(v, idx * 3)\n    }\n}\n","import { FaceVector } from \"./FaceVector\"\nimport { VertexVector } from \"./VertexVector\"\nimport { DirectoryList, FileType } from \"./DirectoryList\"\nimport { TargetEntry } from \"./TargetEntry\"\nimport { PoseEntry } from \"./PoseEntry\"\nimport { FaceGroup } from \"./FaceGroup\"\nimport { PoseTarget } from \"./PoseTarget\"\nimport { PoseTranslation } from \"./PoseTranslation\"\nimport { PoseRotation, RotateAxis } from \"./PoseRotation\"\nimport { mat4, vec3 } from \"gl-matrix\"\nimport { Signal } from \"toad.js\"\nimport { Target } from \"./Target\"\nimport { SelectorListener } from \"SelectorListener\"\nimport { VectorArray } from \"./VectorArray\"\n\nclass TargetMap extends Map<string, TargetEntry> {}\nclass PoseMap extends Map<string, PoseEntry> {}\n\nenum Mode {\n    MORPH,\n    POSE,\n}\n\n// animorph-0.3/src/Mesh.cpp\nexport class Mesh {\n    mgr: SelectorListener\n\n    changed = new Signal()\n    private dirty = false\n    private poseChanged = false\n    private mode = Mode.MORPH\n\n    private vertexBase!: VectorArray // vertices as loaded from file\n    private vertexMorphed!: VectorArray // morphed vertices\n    private vertexPosed!: VectorArray // morphed and posed vertices\n\n    // user settings for posing\n    private poses = new BodySettings()\n    private bodyset = new BodySettings()\n\n    // faces\n    facevector = new FaceVector()\n    facegroup = new FaceGroup()\n    targetmap = new TargetMap()\n    posemap = new PoseMap()\n\n    constructor() {\n        this.loadMeshFactory(\"base.vertices\", \"base.faces\")\n        this.loadGroupsFactory(\"base.parts\")\n        this.loadTargetsFactory(\"targets\")\n        this.loadTargetsFactory(\"selectors\", 1, true, false)\n        this.loadPoseTargetsFactory(\"rotations\")\n        this.mgr = new SelectorListener(this)\n        this.mgr.calcWidgetTargets()\n        this.update()\n    }\n\n    morphMode() {\n        this.mode = Mode.MORPH\n        this.markDirty()\n    }\n    poseMode() {\n        this.initPoses()\n        this.mode = Mode.POSE\n        this.poseChanged = true\n        this.markDirty()\n    }\n    getVertexes(): Float32Array {\n        switch (this.mode) {\n            case Mode.MORPH:\n                return this.vertexMorphed\n            case Mode.POSE:\n                return this.vertexPosed\n        }\n    }\n    clear() {\n        switch (this.mode) {\n            case Mode.MORPH:\n                this.clearMorph()\n                break\n            case Mode.POSE:\n                this.clearPose()\n                break\n        }\n    }\n    clearMorph() {\n        if (this.bodyset.size === 0) {\n            return\n        }\n        this.vertexMorphed.set(this.vertexBase)\n        this.bodyset.clear()\n        this.markDirty()\n    }\n    clearPose() {\n        if (this.poses.size === 0) {\n            return\n        }\n        this.poses.clear()\n        this.poseChanged = true\n        this.markDirty()\n    }\n    private markDirty() {\n        if (this.dirty === false) {\n            this.dirty = true\n            this.changed.trigger()\n        }\n    }\n    update() {\n        this.updatePose()\n        this.dirty = false\n    }\n\n    //\n    // LOAD\n    //\n    private loadMeshFactory(meshFilename: string, facesFilename: string) {\n        const vertex = new VertexVector()\n        vertex.load(meshFilename)\n        this.vertexBase = new VectorArray(vertex.length * 3)\n        let o = 0\n        for(let i=0; i<vertex.length; ++i) {\n            const co = vertex[i].co\n            this.vertexBase[o++] = co[0]\n            this.vertexBase[o++] = co[1]\n            this.vertexBase[o++] = co[2]\n        }\n        this.facevector.loadGeometry(facesFilename)\n        this.vertexMorphed = new VectorArray(this.vertexBase)\n        this.vertexPosed = new VectorArray(this.vertexBase)\n    }\n    private loadGroupsFactory(groups_filename: string) {\n        return this.facegroup.load(groups_filename)\n    }\n    private loadTargetsFactory(targetRootPath: string, recursiveLevel = 1, preload = false, clearmap = true) {\n        if (clearmap) {\n            this.targetmap.clear()\n        }\n\n        // reading all the targets recursively\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(targetRootPath)\n        dir_list.setRecursive(recursiveLevel)\n        dir_list.setFileFilter(\".target\")\n\n        const files = dir_list.getDirectoryList()\n        for (const file of files) {\n            const target_name = file.substring(targetRootPath.length + 1)\n            const targetEntry = new TargetEntry(file, preload)\n            this.targetmap.set(target_name, targetEntry)\n        }\n        console.log(`${preload ? \"loaded\" : \"referenced\"} ${files.length} morph targets from ${targetRootPath}/`)\n    }\n    private loadPoseTargetsFactory(targetRootPath: string, recursiveLevel = 1) {\n        this.posemap.clear()\n\n        // reading all the targets recursively\n        const dir_list = new DirectoryList()\n        dir_list.setRootPath(targetRootPath)\n        dir_list.setRecursive(recursiveLevel)\n        dir_list.setFileType(FileType.DIRECTORY)\n\n        const files = dir_list.getDirectoryList()\n        let counter = 0\n        for (const file of files) {\n            const target_name = file.substring(targetRootPath.length + 1)\n            if (target_name.indexOf(\"/\") === -1) {\n                continue\n            }\n            this.posemap.set(target_name, new PoseEntry(target_name, file, false))\n            ++counter\n        }\n        console.log(`referenced ${counter} pose targets from ${targetRootPath}/`)\n    }\n\n    //\n    // POSE\n    //\n    private initPoses() {\n        this.vertexPosed.set(this.vertexMorphed)\n        this.posemap.forEach((poseEntry) => {\n            if (!poseEntry.isLoaded()) {\n                return\n            }\n            const tmp = poseEntry.getTarget()!\n            tmp.calcRotationsCenteroids(this.vertexMorphed)\n            tmp.calcTranslationsFormFactors(this.vertexMorphed)\n            tmp.calcNormalizations()\n        })\n\n        // for (std::vector <SkinVertex>::iterator skin_it = skin.begin ();\n        //     skin_it != skin.end ();\n        //     skin_it++)\n        // {\n        //     SkinVertex &skinVertex = (*skin_it);\n\n        //     Vector3f centeroid(calcCenteroid(skinVertex.getLinkedMuscles(), vertexvector_morph));\n\n        //     Vector3f oriDist = vertexvector_morph[skinVertex.getSkinVertex()].co - centeroid;\n        //     skinVertex.setOriginalDist(oriDist.getMagnitude());\n        // }\n    }\n\n    setPose(target_name: string, morph_value: number) {\n        const poseTarget = this.getPoseTargetForName(target_name)\n        if (poseTarget === undefined) {\n            throw Error(`unknown pose target ${target_name}`)\n        }\n        if (morph_value < poseTarget.getMinAngle()) {\n            morph_value = poseTarget.getMinAngle()\n        }\n        if (morph_value > poseTarget.getMaxAngle()) {\n            morph_value = poseTarget.getMaxAngle()\n        }\n        if (!this.posemap.has(target_name)) {\n            throw new Error(`a pose target with name \"${target_name}\" wasn't found in posemap`)\n        }\n\n        if (morph_value === 0) {\n            if (!this.poses.has(target_name)) {\n                return morph_value\n            }\n            this.poses.delete(target_name)\n        } else {\n            if (this.poses.get(target_name) === morph_value) {\n                return morph_value\n            }\n            this.poses.set(target_name, morph_value)\n        }\n\n        if (this.poseChanged === false) {\n            this.poseChanged = true\n            this.markDirty()\n        }\n        return morph_value\n    }\n    getPose(target_name: string): number {\n        const p = this.poses.get(target_name)\n        return p === undefined ? 0 : p\n    }\n    updatePose() {\n        if (this.poseChanged === false) {\n            return\n        }\n        this.poseChanged = false\n\n        this.vertexPosed.set(this.vertexMorphed)\n\n        // Map is not sorted but poses must be applied sorted by target_name\n        ;[...this.poses.keys()].sort().forEach((target_name) => {\n            const poseTarget = this.getPoseTargetForName(target_name)\n            const morph_value = this.poses.get(target_name)!\n            this.doPose(target_name, morph_value, poseTarget!.getModVertex())\n        })\n        // applySkin();\n        // applySmooth(2);\n    }\n\n    getTargetForName(target_name: string): Target | undefined {\n        return this.targetmap.get(target_name)?.getTarget()\n    }\n    getPoseTargetForName(target_name: string): PoseTarget | undefined {\n        const poseEntry = this.posemap.get(target_name)!\n        if (poseEntry === undefined) {\n            return undefined\n        }\n        let target\n        if (!poseEntry.isLoaded()) {\n            target = poseEntry.getTarget()!\n            target.calcRotationsCenteroids(this.vertexMorphed)\n            target.calcTranslationsFormFactors(this.vertexMorphed)\n            target.calcNormalizations()\n        } else {\n            target = poseEntry.getTarget()!\n        }\n        return target\n    }\n\n    doPose(target_name: string, morph_value: number, modVertex: Set<number>) {\n        const cat = \"00\"\n        const poseTarget = this.getPoseTargetForName(target_name)!\n        const rotations = morph_value < 0 ? poseTarget.getNegativeRotations() : poseTarget.getPositiveRotations()\n        const translations =\n            morph_value < 0 ? poseTarget.getNegativeTranslations() : poseTarget.getPositiveTranslations()\n        for (const pt of translations) {\n            if (cat !== pt.getCat()) {\n                throw Error(`not implemented yet`)\n            }\n            this.doPoseTranslation(pt, morph_value, modVertex)\n        }\n        for (const pr of rotations) {\n            this.doPoseRotation(pr, morph_value, modVertex)\n        }\n    }\n    doPoseTranslation(pt: PoseTranslation, morph_value: number, modVertex: Set<number>) {\n        const tmpTarget = pt.getTarget()\n        const formFactor = pt.getFormFactor()\n        let real_value = 0.0\n\n        if (pt.getNormalize()) {\n            if (morph_value < 0) {\n                if (morph_value < pt.getMaxAngle()) {\n                    real_value = Math.max(morph_value, pt.getMinAngle()) - pt.getMaxAngle()\n                }\n            } else {\n                if (morph_value > pt.getMinAngle()) {\n                    real_value = Math.min(morph_value, pt.getMaxAngle()) - pt.getMinAngle()\n                }\n            }\n        } else {\n            real_value = morph_value\n        }\n\n        for (const td of tmpTarget) {\n            if (!modVertex.has(td.vertex_number)) {\n                continue\n            }\n            const co = this.vertexPosed.getVec3(td.vertex_number)\n            vec3.add(\n                co,\n                co,\n                vec3.fromValues(\n                    formFactor[0] * td.morph_vector[0] * real_value,\n                    formFactor[1] * td.morph_vector[1] * real_value,\n                    formFactor[2] * td.morph_vector[2] * real_value\n                )\n            )\n            this.vertexPosed.setVec3(td.vertex_number, co)\n        }\n    }\n    doPoseRotation(pr: PoseRotation, morph_value: number, modVertex: Set<number>) {\n        let real_value = 0\n        let rotMatrix = mat4.create()\n\n        if (pr.getNormalize()) {\n            if (morph_value < 0) {\n                if (morph_value < pr.getMaxAngle()) {\n                    real_value = Math.max(morph_value, pr.getMinAngle()) - pr.getMaxAngle()\n                }\n            } else {\n                if (morph_value > pr.getMinAngle()) {\n                    real_value = Math.min(morph_value, pr.getMaxAngle()) - pr.getMinAngle()\n                }\n            }\n        } else {\n            real_value = morph_value\n        }\n\n        const axis = pr.getAxis()\n        const M_PI_180 = Math.PI / 180.0\n\n        for (const td of pr) {\n            if (!modVertex.has(td.vertex_number)) {\n                continue\n            }\n            const theta = real_value * td.rotation * M_PI_180\n            mat4.identity(rotMatrix)\n            switch (axis) {\n                case RotateAxis.X_AXIS:\n                    mat4.rotateX(rotMatrix, rotMatrix, theta)\n                    break\n                case RotateAxis.Y_AXIS:\n                    mat4.rotateY(rotMatrix, rotMatrix, theta)\n                    break\n                case RotateAxis.Z_AXIS:\n                    mat4.rotateZ(rotMatrix, rotMatrix, theta)\n                    break\n            }\n            const co = this.vertexPosed.getVec3(td.vertex_number)\n            if (co === undefined) {\n                throw Error()\n            }\n            vec3.sub(co, co, pr.getCenter())\n            vec3.transformMat4(co, co, rotMatrix)\n            vec3.add(co, co, pr.getCenter())\n            this.vertexPosed.setVec3(td.vertex_number, co)\n        }\n    }\n\n    //\n    // MORPH\n    //\n\n    doMorph(target_name: string, morph_value: number) {\n        if (morph_value < 0) {\n            morph_value = 0\n        }\n        if (morph_value > 1) {\n            morph_value = 1\n        }\n\n        if (!this.targetmap.has(target_name)) {\n            throw new Error(`a morph target with name \"${target_name}\" wasn't found in targetmap`)\n        }\n\n        let real_morph_value\n        let bs_morph_value = this.getMorph(target_name)\n        if (morph_value === 0) {\n            real_morph_value = -bs_morph_value\n        } else {\n            real_morph_value = morph_value - bs_morph_value\n        }\n\n        const target = this.getTargetForName(target_name)!\n\n        for (const td of target) {\n            const co = this.vertexMorphed.getVec3(td.vertex_number)\n            const mv = vec3.scale(vec3.create(), td.morph_vector, real_morph_value)\n            vec3.add(co, co, mv)\n            this.vertexMorphed.setVec3(td.vertex_number, co)\n        }\n\n        if (morph_value === 0) {\n            if (!this.bodyset.has(target_name)) {\n                return morph_value\n            }\n            this.bodyset.delete(target_name)\n        } else {\n            if (this.bodyset.get(target_name) === morph_value) {\n                return morph_value\n            }\n            this.bodyset.set(target_name, morph_value)\n        }\n\n        this.markDirty()\n        return morph_value\n    }\n    getMorph(target_name: string): number {\n        const p = this.bodyset.get(target_name)\n        return p === undefined ? 0 : p\n    }\n}\n\nclass BodySettings extends Map<string, number> {}\n","import { vec3 } from 'gl-matrix'\n\nexport function calculateNormalsQuads(\n    normals: Float32Array,\n    vertex: Float32Array,\n    indices: number[]): Float32Array {\n\n    function addNormal(index: number, normal: vec3) {\n        normals[index] += normal[0]\n        normals[index + 1] += normal[1]\n        normals[index + 2] += normal[2]\n    }\n    \n    // add vectors\n    for (let i = 0; i < indices.length;) {\n        const i1 = indices[i++] * 3\n        const i2 = indices[i++] * 3\n        const i3 = indices[i++] * 3\n        const i4 = indices[i++] * 3\n    \n\n        const p1 = vec3.fromValues(vertex[i1], vertex[i1 + 1], vertex[i1 + 2])\n        const p2 = vec3.fromValues(vertex[i2], vertex[i2 + 1], vertex[i2 + 2])\n        const p3 = vec3.fromValues(vertex[i3], vertex[i3 + 1], vertex[i3 + 2])\n\n        const u = vec3.create(), v = vec3.create(), n = vec3.create()\n        vec3.subtract(u, p2, p1)\n        vec3.subtract(v, p3, p1)\n        vec3.cross(n, u, v)\n        vec3.normalize(n, n)\n\n        addNormal(i1, n)\n        addNormal(i2, n)\n        addNormal(i3, n)\n        addNormal(i4, n)\n    }\n\n    // normalize\n    for(let normalIndex = 0; normalIndex < vertex.length; normalIndex += 3) {\n        const normal = vec3.fromValues(normals[normalIndex], normals[normalIndex + 1], normals[normalIndex + 2])\n        vec3.normalize(normal, normal)\n        normals[normalIndex] = normal[0]\n        normals[normalIndex + 1] = normal[1]\n        normals[normalIndex + 2] = normal[2]\n    }\n    return normals\n}\n\nexport function calculateNormalsTriangles(\n    normals: Float32Array,\n    vertex: Float32Array,\n    indices: number[]): Float32Array {\n\n    function addNormal(index: number, normal: vec3) {\n        normals[index] += normal[0]\n        normals[index + 1] += normal[1]\n        normals[index + 2] += normal[2]\n    }\n    \n    // add vectors\n    for (let i = 0; i < indices.length;) {\n        const i1 = indices[i++] * 3\n        const i2 = indices[i++] * 3\n        const i3 = indices[i++] * 3\n\n        const p1 = vec3.fromValues(vertex[i1], vertex[i1 + 1], vertex[i1 + 2])\n        const p2 = vec3.fromValues(vertex[i2], vertex[i2 + 1], vertex[i2 + 2])\n        const p3 = vec3.fromValues(vertex[i3], vertex[i3 + 1], vertex[i3 + 2])\n\n        const u = vec3.create(), v = vec3.create(), n = vec3.create()\n        vec3.subtract(u, p2, p1)\n        vec3.subtract(v, p3, p1)\n        vec3.cross(n, u, v)\n        vec3.normalize(n, n)\n\n        addNormal(i1, n)\n        addNormal(i2, n)\n        addNormal(i3, n)\n    }\n\n    // normalize\n    for(let normalIndex = 0; normalIndex < vertex.length; normalIndex += 3) {\n        const normal = vec3.fromValues(normals[normalIndex], normals[normalIndex + 1], normals[normalIndex + 2])\n        vec3.normalize(normal, normal)\n        normals[normalIndex] = normal[0]\n        normals[normalIndex + 1] = normal[1]\n        normals[normalIndex + 2] = normal[2]\n    }\n    return normals\n}\n","import { calculateNormalsQuads, calculateNormalsTriangles } from \"./calculateNormals\"\nimport { AbstractShader } from \"./shader/AbstractShader\"\n\ninterface GLXYZUV {\n    idxExtra: number[]\n    indices: number[]\n    vertex: Float32Array\n    texcoord?: Float32Array\n}\n\n/**\n * I am a mesh which can be rendered by OpenGL.\n * a) convert quads to triangles\n * b) join fxyz and fuv into one list\n * c) calculate normals\n */\nexport class RenderMesh {\n    gl: WebGL2RenderingContext\n    glIndices: WebGLBuffer\n    glVertex: WebGLBuffer\n    glNormal: WebGLBuffer\n    glTexture?: WebGLBuffer\n\n    fvertex: number[]\n    normal: Float32Array\n    glData: GLXYZUV\n    quads: boolean\n\n    constructor(\n        gl: WebGL2RenderingContext,\n        vertex: Float32Array,\n        fvertex: number[],\n        uvs?: Float32Array,\n        fuvs?: number[],\n        quads = true\n    ) {\n        this.gl = gl\n        this.fvertex = fvertex\n        this.quads = quads\n\n        if (quads === false) {\n            this.glIndices = this.createBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, fvertex)\n            this.glVertex = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, vertex)\n            this.normal = new Float32Array(vertex.length)\n            calculateNormalsTriangles(this.normal, vertex, fvertex)\n            this.glNormal = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, this.normal)\n            this.glData = {\n                indices: fvertex,\n            } as GLXYZUV\n            return\n        }\n\n        const glData = decoupleXYZandUV(vertex, fvertex, uvs, fuvs)\n        this.glData = glData\n        this.glIndices = this.createBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, glData.indices)\n        this.glVertex = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, glData.vertex)\n        if (glData.texcoord) {\n            this.glTexture = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, glData.texcoord)\n        }\n\n        this.normal = new Float32Array(glData.vertex.length)\n        calculateNormalsQuads(this.normal, vertex, fvertex)\n        this.glData.idxExtra.forEach((v, i) => {\n            this.normal[vertex.length + i * 3] = this.normal[v * 3]\n            this.normal[vertex.length + i * 3 + 1] = this.normal[v * 3 + 1]\n            this.normal[vertex.length + i * 3 + 2] = this.normal[v * 3 + 2]\n        })\n\n        this.glNormal = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, this.normal)\n    }\n\n    update(vertex: Float32Array) {\n        if (this.quads) {\n            this.glData.vertex.set(vertex)\n            calculateNormalsQuads(this.normal, vertex, this.fvertex)\n\n            this.glData.idxExtra.forEach((v, i) => {\n                this.glData.vertex[vertex.length + i * 3] = vertex[v * 3]\n                this.glData.vertex[vertex.length + i * 3 + 1] = vertex[v * 3 + 1]\n                this.glData.vertex[vertex.length + i * 3 + 2] = vertex[v * 3 + 2]\n\n                this.normal[vertex.length + i * 3] = this.normal[v * 3]\n                this.normal[vertex.length + i * 3 + 1] = this.normal[v * 3 + 1]\n                this.normal[vertex.length + i * 3 + 2] = this.normal[v * 3 + 2]\n            })\n            // prettier-ignore\n            this.updateBuffer(this.glVertex, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.glData.vertex)\n            this.updateBuffer(this.glNormal, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.normal)\n        } else {\n            this.updateBuffer(this.glVertex, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, vertex)\n            calculateNormalsTriangles(this.normal, vertex, this.fvertex)\n            this.updateBuffer(this.glNormal, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, this.normal)\n        }\n    }\n\n    draw(programInfo: AbstractShader, mode: number) {\n        this.bind(programInfo)\n        this.gl.drawElements(mode, this.glData.indices.length, this.gl.UNSIGNED_SHORT, 0)\n    }\n\n    bind(programInfo: AbstractShader): void {\n        programInfo.bind(this.glIndices, this.glVertex, this.glNormal, this.glTexture)\n    }\n\n    drawSubset(mode: number, offset: number, length: number) {\n        // divide by quad edge count, multiply by triangle edge count, multiply by octets in short\n        // this.gl.drawElements(mode, (length / 4) * 6, this.gl.UNSIGNED_SHORT, (offset / 4) * 6)\n        this.gl.drawElements(mode, length, this.gl.UNSIGNED_SHORT, offset * 2)\n    }\n\n    protected createBuffer(\n        target: GLenum,\n        usage: GLenum,\n        type: Float32ArrayConstructor | Uint16ArrayConstructor,\n        data: number[] | Float32Array\n    ): WebGLBuffer {\n        const buffer = this.gl.createBuffer()\n        if (buffer === null) {\n            throw Error(\"Failed to create new WebGLBuffer\")\n        }\n        this.updateBuffer(buffer, target, usage, type, data)\n        return buffer\n    }\n\n    protected updateBuffer(\n        buffer: WebGLBuffer,\n        target: GLenum,\n        usage: GLenum,\n        type: Float32ArrayConstructor | Uint16ArrayConstructor,\n        data: number[] | Float32Array\n    ) {\n        this.gl.bindBuffer(target, buffer)\n        if (data instanceof Float32Array) {\n            this.gl.bufferData(target, data, usage)\n            return\n        }\n        if (data instanceof Int16Array) {\n            this.gl.bufferData(target, data, usage)\n            return\n        }\n        this.gl.bufferData(target, new type(data), usage)\n    }\n}\n\nexport function decoupleXYZandUV(\n    xyz: Float32Array,\n    fxyz: Uint16Array | number[],\n    uv?: Float32Array | number[],\n    fuv?: Uint16Array | number[]\n): GLXYZUV {\n    if (fuv !== undefined && fxyz.length !== fuv.length) {\n        throw Error(`fvertex and fuv must have the same length, instead it is ${fxyz.length} and ${fuv.length}`)\n    }\n    if (fuv !== undefined && uv === undefined) {\n        throw Error(`uv & fuv must both be defined`)\n    }\n    const indices: number[] = []\n    const uvOut = new Array((xyz.length / 3) * 2) // for each vertex we have texture coordinate\n\n    const idxExtra: number[] = []\n    const xyzOutExtra: number[] = []\n    const uvOutExtra: number[] = []\n\n    function getIndex(i: number) {\n        return fxyz[i]\n    }\n\n    function decoupleXYZandUV(i: number) {\n        const idxXYZ = fxyz[i]\n\n        const xyzIdx = fxyz[i]\n        const uvIdx = fuv![i]\n        const u = uv![uvIdx * 2]\n        const v = uv![uvIdx * 2 + 1]\n\n        if (uvOut[xyzIdx * 2] === undefined) {\n            uvOut[xyzIdx * 2] = u\n            uvOut[xyzIdx * 2 + 1] = v\n            return idxXYZ\n        }\n        if (uvOut[xyzIdx * 2] === u && uvOut[xyzIdx * 2 + 1] === v) {\n            return idxXYZ\n        }\n\n        const newIdxXYZ = (xyz.length + xyzOutExtra.length) / 3\n\n        const idxXYZIn = idxXYZ * 3\n        const x = xyz[idxXYZIn]\n        const y = xyz[idxXYZIn + 1]\n        const z = xyz[idxXYZIn + 2]\n\n        idxExtra.push(idxXYZ)\n        xyzOutExtra.push(x)\n        xyzOutExtra.push(y)\n        xyzOutExtra.push(z)\n        uvOutExtra.push(u)\n        uvOutExtra.push(v)\n\n        return newIdxXYZ\n    }\n\n    let f\n    if (fuv === undefined) {\n        f = getIndex\n    } else {\n        f = decoupleXYZandUV\n    }\n\n    for (let i = 0; i < fxyz.length; i += 4) {\n        const i0 = f(i)\n        indices.push(i0)\n        indices.push(f(i + 1))\n        const i2 = f(i + 2)\n        indices.push(i2)\n        indices.push(f(i + 3))\n        indices.push(i0)\n        indices.push(i2)\n    }\n\n    if (fuv === undefined) {\n        return {\n            idxExtra: [],\n            indices,\n            vertex: xyz,\n            texcoord: undefined,\n        }\n    }\n\n    const vertex = new Float32Array(xyz.length + xyzOutExtra.length)\n    const texcoord = new Float32Array(uvOut.length + uvOutExtra.length)\n\n    vertex.set(xyz)\n    vertex.set(xyzOutExtra, xyz.length)\n    texcoord.set(uvOut)\n    texcoord.set(uvOutExtra, uvOut.length)\n\n    return { indices, vertex, texcoord, idxExtra }\n}\n","import { mat4 } from 'gl-matrix'\n\nexport abstract class AbstractShader {\n    protected gl: WebGL2RenderingContext\n    protected program: WebGLProgram\n\n    protected vertexPosition: number\n    protected vertexNormal: number\n    protected textureCoord?: number\n\n    projectionMatrix: WebGLUniformLocation\n    protected modelViewMatrix: WebGLUniformLocation\n    protected normalMatrix: WebGLUniformLocation\n\n    constructor(gl: WebGL2RenderingContext, vertexShaderSrc: string, fragmentShaderSrc: string) {\n        const program = gl.createProgram()\n        if (program === null) {\n            throw Error('Unable to create WebGLProgram')\n        }\n        const vertexShader = AbstractShader.compileShader(gl, gl.VERTEX_SHADER, vertexShaderSrc)\n        const fragmentShader = AbstractShader.compileShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSrc)\n        gl.attachShader(program, vertexShader)\n        gl.attachShader(program, fragmentShader)\n        gl.linkProgram(program)\n\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n            throw Error(`Unable to initialize WebGLProgram: ${gl.getProgramInfoLog(program)}`)\n        }\n        this.gl = gl\n        this.program = program\n\n        this.vertexPosition = gl.getAttribLocation(this.program, 'aVertexPosition')\n        this.vertexNormal = gl.getAttribLocation(this.program, 'aVertexNormal')\n\n        this.projectionMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uProjectionMatrix')\n        this.modelViewMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uModelViewMatrix')\n        this.normalMatrix = AbstractShader.getUniformLocation(gl, this.program, 'uNormalMatrix')\n    }\n\n    bind(indices: WebGLBuffer, vertices: WebGLBuffer, normales: WebGLBuffer, texture?: WebGLBuffer) {\n        const numComponents = 3, type = this.gl.FLOAT, normalize = false, stride = 0, offset = 0\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, vertices)\n        this.gl.vertexAttribPointer(this.vertexPosition, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(this.vertexPosition)\n\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, normales)\n        this.gl.vertexAttribPointer(this.vertexNormal, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(this.vertexNormal)\n\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, indices)\n    }\n\n    init(projectionMatrix: mat4, modelViewMatrix: mat4, normalMatrix: mat4) {\n        this.initProgram()\n        this.initProjectionMatrix(projectionMatrix)\n        this.initModelViewMatrix(modelViewMatrix)\n        this.initNormalMatrix(normalMatrix)\n    }\n\n    initProgram() {\n        this.gl.useProgram(this.program)\n    }\n\n    initProjectionMatrix(projectionMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.projectionMatrix, false, projectionMatrix)\n    }\n\n    initModelViewMatrix(modelViewMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.modelViewMatrix, false, modelViewMatrix)\n    }\n\n    initNormalMatrix(normalMatrix: mat4) {\n        this.gl.uniformMatrix4fv(this.normalMatrix, false, normalMatrix)\n    }\n\n    static compileShader(gl: WebGL2RenderingContext, type: GLenum, source: string): WebGLShader {\n        const shader = gl.createShader(type)\n        if (shader === null)\n            throw Error('Unable to create WebGLShader')\n        gl.shaderSource(shader, source)\n        gl.compileShader(shader)\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            gl.deleteShader(shader)\n            throw Error(`An error occurred compiling the ${type} WebGLShader: ${gl.getShaderInfoLog(shader)}`)\n        }\n        return shader\n    }\n\n    static getUniformLocation(gl: WebGL2RenderingContext, program: WebGLProgram, name: string): WebGLUniformLocation {\n        const location = gl.getUniformLocation(program, name)\n        if (location === null)\n            throw Error(`Internal Error: Failed to get uniform location for ${name}`)\n        return location\n    }\n}\n\n\n","import { AbstractShader } from './AbstractShader'\n\nexport class RGBAShader extends AbstractShader {\n    protected _color: WebGLUniformLocation\n    constructor(gl: WebGL2RenderingContext) {\n        super(gl, rgbaVertexShaderSrc, rgbaFragmentShaderSrc)\n        this._color = AbstractShader.getUniformLocation(gl, this.program, 'uColor')\n    }\n    // set RGBA color\n    setColor(rgba: number[]) {\n        this.gl.uniform4fv(this._color, rgba)\n    }\n}\nconst rgbaVertexShaderSrc = `\n// this is our input per vertex\nattribute vec4 aVertexPosition;\nattribute vec3 aVertexNormal;\n\n// input for all vertices (uniform for the whole shader program)\nuniform mat4 uNormalMatrix;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uColor;\n\n// data exchanged with other graphic pipeline stages\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n\n  highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n  highp vec3 directionalLightColor = vec3(1, 1, 1);\n  highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));\n\n  highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n\n  highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n  vLighting = ambientLight + (directionalLightColor * directional);\n\n  vColor = uColor;\n}`\nconst rgbaFragmentShaderSrc = `\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\nvoid main(void) {\n  gl_FragColor = vec4(vec3(vColor[0],vColor[1],vColor[2]) * vLighting, vColor[3]);\n}`\n","import { RenderMesh } from \"gl/RenderMesh\"\nimport { Mesh } from \"./animorph/Mesh\"\nimport { RGBAShader } from \"gl/shader/RGBAShader\"\nimport {\n    createModelViewMatrix,\n    createNormalMatrix,\n    createProjectionMatrix,\n    adjustCanvasSize,\n    prepareViewport\n} from \"gl/util\"\n\ninterface FG {\n    offset: number\n    length: number\n}\n\n// makehuman-0.9.1-rc1a/src/makehuman.cpp, line 923\nexport function renderMesh(canvas: HTMLCanvasElement, mesh: Mesh) {\n    mesh.update()\n\n    // STEP 1: convert mesh.vertexvector_morph to Float32Array\n    const vertex = mesh.getVertexes()\n    // const vertex: number[] = []\n    // for (const v of mesh.getVertexes()) {\n    //     vertex.push(v.co[0], v.co[1], v.co[2])\n    // }\n\n    // STEP 2: created faces and as they are a mix of triangles and quads, convert them to triangles\n    const fvertex: number[] = []\n    const faceGroups = new Map<string, FG>()\n    mesh.facegroup.forEach((group, name) => {\n        const offset = fvertex.length\n        for (const faceIdx of group.facesIndexes) {\n            const foo = mesh.facevector[faceIdx]\n            if (foo === undefined) {\n                // FIXME: load creates bogus last entry\n                continue\n            }\n            const face = mesh.facevector[faceIdx].vertices\n            switch (face.length) {\n                case 3:\n                    fvertex.push(...face)\n                    break\n                case 4:\n                    fvertex.push(face[0], face[1], face[2], face[0], face[2], face[3])\n                    break\n                default:\n                    console.log(`skipping face with ${face.length} edges`)\n            }\n        }\n        const length = fvertex.length - offset\n        faceGroups.set(name, { offset: offset, length: length })\n    })\n\n    const gl = (canvas.getContext(\"webgl2\") || canvas.getContext(\"experimental-webgl\")) as WebGL2RenderingContext\n    if (gl == null) {\n        throw Error(\"Unable to initialize WebGL. Your browser or machine may not support it.\")\n    }\n\n    const renderMesh = new RenderMesh(gl, new Float32Array(vertex), fvertex, undefined, undefined, false)\n\n    const programRGBA = new RGBAShader(gl)\n    programRGBA.initProgram()\n\n    renderMesh.bind(programRGBA)\n\n    // flip image pixels into the bottom-to-top order that WebGL expects.\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true)\n    gl.enable(gl.CULL_FACE)\n    gl.cullFace(gl.BACK)\n\n    let lastX = 0, lastY = 0\n\n    const paint = () => {\n        adjustCanvasSize(canvas)\n        const projectionMatrix = createProjectionMatrix(canvas)\n        const modelViewMatrix = createModelViewMatrix(lastX, lastY)\n        const normalMatrix = createNormalMatrix(modelViewMatrix)\n        programRGBA.initModelViewMatrix(modelViewMatrix)\n        programRGBA.initNormalMatrix(normalMatrix)\n        programRGBA.initProjectionMatrix(projectionMatrix)\n        prepareViewport(gl, canvas)\n\n        faceGroups.forEach((group, name) => {\n            switch (name) {\n                case \"body\":\n                case \"head\":\n                    programRGBA.setColor([1, 0.8, 0.7, 1])\n                    break\n                case \"teeth\":\n                    programRGBA.setColor([1, 1, 1, 1])\n                    break\n                case \"tongue\":\n                case \"gums\":\n                    programRGBA.setColor([1, 0, 0, 1])\n                    break\n                case \"eyes\": // the white in the eyes\n                    programRGBA.setColor([1, 1, 1, 1])\n                    break\n                case \"zcornea\": // the cornea in the eyes\n                    programRGBA.setColor([0, 0, 0, 1])\n                    break\n                case \"zeyebrows\":\n                case \"zeyelashes\":\n                    programRGBA.setColor([0, 0, 0, 1])\n                    break\n                default:\n                    console.log(name)\n                    programRGBA.setColor([1, 0, 0, 1])\n            }\n            renderMesh.drawSubset(gl.TRIANGLES, group.offset, group.length)\n        })\n    }\n    paint()\n\n    mesh.changed.add(() => {\n        requestAnimationFrame(() => {\n            mesh.update()\n            renderMesh.update(mesh.getVertexes())\n            paint()\n        })\n    })\n\n    new ResizeObserver(paint).observe(canvas)\n    let downX = 0, downY = 0, buttonDown = false\n    canvas.onpointerdown = (ev: PointerEvent) => {\n        canvas.setPointerCapture(ev.pointerId)\n        buttonDown = true\n        // console.log(ev)\n        lastX = downX = ev.x\n        lastY = downY = ev.y\n    }\n    canvas.onpointerup = (ev: PointerEvent) => {\n        buttonDown = false\n    }\n    canvas.onpointermove = (ev: PointerEvent) => {\n        if (buttonDown) {\n            const x = ev.x - downX\n            const y = ev.y - downY\n            if (x !== lastX || y !== lastY) {\n                lastX = x\n                lastY = y\n                requestAnimationFrame(() => paint())\n            }\n        }\n    }\n}\n","import { mat4 } from \"gl-matrix\"\n\nexport function adjustCanvasSize(canvas: HTMLCanvasElement) {\n    if (canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight) {\n        canvas.width = canvas.clientWidth\n        canvas.height = canvas.clientHeight\n    }\n}\n\nexport function prepareViewport(gl: WebGL2RenderingContext, canvas: HTMLCanvasElement) {\n    gl.viewport(0, 0, canvas.width, canvas.height)\n    gl.clearColor(0, 0, 0, 1)\n    gl.clearDepth(1)\n    gl.enable(gl.DEPTH_TEST)\n    gl.depthFunc(gl.LEQUAL)\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n    gl.depthMask(true)\n}\n\nexport function createModelViewMatrix(x: number, y: number) {\n    const D = 180 / Math.PI\n    const modelViewMatrix = mat4.create()\n    mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0, -25])\n    mat4.rotateX(modelViewMatrix, modelViewMatrix, y / D)\n    mat4.rotateY(modelViewMatrix, modelViewMatrix, x / D)\n    return modelViewMatrix\n}\n\nexport function createProjectionMatrix(canvas: HTMLCanvasElement) {\n    const fieldOfView = (45 * Math.PI) / 180 // in radians\n    const aspect = canvas.width / canvas.height\n    const zNear = 0.1\n    const zFar = 100\n    const projectionMatrix = mat4.create()\n    mat4.perspective(projectionMatrix, fieldOfView, aspect, zNear, zFar)\n    return projectionMatrix\n}\n\nexport function createNormalMatrix(modelViewMatrix: mat4) {\n    const normalMatrix = mat4.create()\n    mat4.invert(normalMatrix, modelViewMatrix)\n    mat4.transpose(normalMatrix, normalMatrix)\n    return normalMatrix\n}\n//\n// Initialize a texture and load an image.\n// When the image finished loading copy it into the texture.\n//\nexport function loadTexture(gl: WebGLRenderingContext, url: string) {\n    const texture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n\n    // Because images have to be downloaded over the internet\n    // they might take a moment until they are ready.\n    // Until then put a single pixel in the texture so we can\n    // use it immediately. When the image has finished downloading\n    // we'll update the texture with the contents of the image.\n    const level = 0\n    const internalFormat = gl.RGBA\n    const width = 1\n    const height = 1\n    const border = 0\n    const srcFormat = gl.RGBA\n    const srcType = gl.UNSIGNED_BYTE\n    const pixel = new Uint8Array([0, 0, 255, 255]) // opaque blue\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, width, height, border, srcFormat, srcType, pixel)\n\n    const image = new Image()\n    image.onload = () => {\n        console.log(`texture \"${url}\" has been loaded`)\n        gl.bindTexture(gl.TEXTURE_2D, texture)\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, srcFormat, srcType, image)\n\n        // WebGL1 has different requirements for power of 2 images\n        // vs non power of 2 images so check if the image is a\n        // power of 2 in both dimensions.\n        if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n            // Yes, it's a power of 2. Generate mips.\n            gl.generateMipmap(gl.TEXTURE_2D)\n        } else {\n            // No, it's not a power of 2. Turn off mips and set\n            // wrapping to clamp to edge\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n        }\n    }\n    image.src = url\n\n    return texture\n}\nfunction isPowerOf2(value: number) {\n    return (value & (value - 1)) === 0\n}\n","/*\n *  The TOAD JavaScript/TypeScript GUI Library\n *  Copyright (C) 2018-2023 Mark-Andr Hopf <mhopf@mark13.org>\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\nexport class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value, writable: true });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue, writable: true });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map((a) => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        element.replaceChildren(...this);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\n// https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== \"string\") {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case \"children\":\n                break;\n            case \"action\":\n                ;\n                element.setAction(value);\n                break;\n            case \"model\":\n                ;\n                element.setModel(value);\n                break;\n            case \"class\":\n                element.classList.add(value); // FIXME: value is whitespace separated list\n                break;\n            case \"style\":\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    if (typeof svalue === \"number\") {\n                        svalue = `${svalue}`;\n                    }\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case \"set\":\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element, writable: true });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substring(2), value);\n                }\n                else {\n                    if (typeof value === \"string\" || typeof value === \"number\" || typeof value === \"boolean\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        appendChildren(element, props.children);\n    }\n}\nfunction appendChildren(element, children) {\n    for (const child of children) {\n        if (child instanceof Array) {\n            appendChildren(element, child);\n            continue;\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n}\n// the FunctionConstructor is a hack for <></>\n// actually it would be nice if we could support value objects too, eg. <TableView> instead of <toad-table>\n// export function createElement(name: string, props: JSX.HTMLElementProps, ...children: any): Element\n// export function createElement(name: FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Fragment\n// export function createElement(name: string | FunctionConstructor, props: JSX.HTMLElementProps, ...children: any): Element | Fragment {\n// }\n// backward compability\nexport function createElement(nameOrConstructor, props, ...children) {\n    // console.log(`createElement(${nameOrConstructor}, ${JSON.stringify(props)}, ${children}`)\n    // props: remove 'key', add 'children'\n    let key;\n    if (props !== null) {\n        if (\"key\" in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","import { Mesh } from \"animorph/Mesh\"\nimport { Reference } from \"toad.jsx/lib/jsx-runtime\"\n\ninterface RefTypes {\n    details: HTMLElement\n}\nconst refs: RefTypes = {} as any\n\ninterface Tile {\n    targetName?: string\n    img?: HTMLImageElement\n}\nlet tiles: Tile[]\n\nlet selectedJoint: number | undefined = undefined\n\nexport function posesBodyPanel(mesh: Mesh) {\n    mesh.poseMode()\n    const panel: HTMLElement[] = []\n    tiles = new Array<Tile>(poseTargets.length)\n    for (let jointIdx = 1; jointIdx < poseTargets.length; ++jointIdx) {\n        panel.push(createTile(mesh, jointIdx))\n    }\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Poses</div>\n            <div id=\"panel\" style={{ lineHeight: \"0\" }}>\n                {...panel}\n            </div>\n            <div id=\"details\" set={new Reference(refs, \"details\")}></div>\n        </>\n    )\n}\n\nfunction createTile(mesh: Mesh, jointIdx: number): HTMLElement {\n    const target = poseTargets[jointIdx]\n    tiles[jointIdx] = { targetName: target }\n\n    const tileImg = (\n        <img src={`images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}.png`} />\n    ) as HTMLImageElement\n    tiles[jointIdx].img = tileImg\n\n    if (target === undefined) {\n        return tileImg\n    }\n    const title = target.at(4)!.toUpperCase() + target.substring(5).replaceAll(\"_\", \" \")\n    tileImg.title = title\n    tileImg.onpointerenter = () => {\n        tileImg.src = `images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}_over.png`\n    }\n    tileImg.onpointerleave = () => {\n        if (selectedJoint !== jointIdx) {\n            tileImg.src = `images/ui/rotations_${jointIdx.toString().padStart(2, \"0\")}.png`\n        }\n    }\n    tileImg.onpointerdown = () => {\n        if (jointIdx < tiles.length) {\n            const details = (\n                <>\n                    <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>{title}</div>\n                </>\n            )\n            mesh.posemap.forEach((poseEntry, name) => {\n                if (name.startsWith(`${tiles[jointIdx].targetName}/`)) {\n                    details.push(createKnob(mesh, name))\n                }\n            })\n            refs.details.replaceChildren(...details)\n            if (selectedJoint !== undefined && selectedJoint !== jointIdx) {\n                tiles[selectedJoint].img!.src = `images/ui/rotations_${selectedJoint.toString().padStart(2, \"0\")}.png`\n            }\n            selectedJoint = jointIdx\n        }\n    }\n    return tileImg\n}\n\n// value changes on: drag left & right / wheel\n// white: default, red: changed\nfunction createKnob(mesh: Mesh, name: string) {\n    const img0 = `images/rot/${name}.png`\n    const img1 = `images/rot/${name}_over.png`\n\n    const detail = (\n        <div style={{ display: \"inline-block\", textAlign: \"center\" }}>\n            <img width=\"64\" height=\"64\" title={name} src={img0} />\n            <div></div>\n        </div>\n    ) as HTMLElement\n\n    let lastValue = 0,\n        downX: number | undefined\n\n    const img = detail.children[0] as HTMLImageElement\n    const txt = detail.children[1] as HTMLDivElement\n    const setValue = (value: number) => {\n        const v = mesh.setPose(name, value)\n        txt.innerText = Math.round(v).toString()\n        if (value !== 0) {\n            txt.style.color = \"#f00\"\n        } else {\n            txt.style.color = \"\"\n        }\n    }\n    setValue(mesh.getPose(name))\n\n    img.onpointerenter = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.src = img1\n    }\n    img.onpointerleave = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.src = img0\n    }\n    img.oncontextmenu = (ev: MouseEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.setPointerCapture(ev.pointerId)\n        switch (ev.button) {\n            case 0:\n                downX = ev.x\n                lastValue = mesh.getPose(name)\n                break\n            case 2:\n                setValue(0)\n                break\n        }\n    }\n    img.onpointerup = (ev: PointerEvent) => {\n        ev.preventDefault()\n        downX = undefined\n    }\n    img.onpointermove = (ev: PointerEvent) => {\n        ev.preventDefault()\n        if (downX !== undefined) {\n            setValue(lastValue! + ev.x - downX)\n        }\n    }\n\n    return detail\n}\n\n// the body pose panel consists of 6x14 tiles\nconst poseTargets: (string | undefined)[] = [\n    undefined,\n    \"260_right_collar\",\n    \"300_head\",\n    \"280_left_collar\",\n    \"070_left_ringfinger_3\",\n    \"067_left_middlefinger_3\",\n    \"064_left_forefinger_3\",\n\n    \"220_right_upper_arm\",\n    \"320_neck\",\n    \"240_left_upper_arm\",\n    \"071_left_ringfinger_2\",\n    \"068_left_middlefinger_2\",\n    \"065_left_forefinger_2\",\n\n    undefined,\n    \"360_torso\",\n    undefined,\n    \"073_left_littlefinger_3\",\n    \"069_left_middlefinger_1\",\n    \"066_left_forefinger_1\",\n\n    \"140_right_lower_arm\",\n    \"380_pivot\",\n    \"160_left_lower_arm\",\n    \"074_left_littlefinger_2\",\n    \"072_left_ringfinger_1\",\n    \"061_left_pollex_3\",\n\n    \"060_right_hand\",\n    undefined,\n    \"080_left_hand\",\n    \"075_left_littlefinger_1\",\n    \"063_left_pollex_1\",\n    \"062_left_pollex_2\",\n\n    \"180_right_upper_leg\",\n    undefined,\n    \"200_left_upper_leg\",\n    \"044_right_forefinger_3\",\n    \"047_right_middlefinger_3\",\n    \"050_right_ringfinger_3\",\n\n    \"100_right_lower_leg\",\n    undefined,\n    \"120_left_lower_leg\",\n    \"045_right_forefinger_2\",\n    \"048_right_middlefinger_2\",\n    \"051_right_ringfinger_2\",\n\n    undefined,\n    undefined,\n    undefined,\n    \"046_right_forefinger_1\",\n    \"049_right_middlefinger_1\",\n    \"053_right_littlefinger_3\",\n\n    \"020_right_foot\",\n    undefined,\n    \"040_left_foot\",\n    \"041_right_pollex_3\",\n    \"052_right_ringfinger_1\",\n    \"054_right_littlefinger_2\",\n\n    undefined,\n    undefined,\n    undefined,\n    \"042_right_pollex_2\",\n    \"043_right_pollex_1\",\n    \"055_right_littlefinger_1\",\n\n    \"002_right_footfinger_4_2\",\n    \"000_right_footfinger_5_2\",\n    \"001_right_footfinger_5_1\",\n    \"022_left_footfinger_5_1\",\n    \"021_left_footfinger_5_2\",\n    \"023_left_footfinger_4_2\",\n\n    \"004_right_footfinger_3_2\",\n    \"005_right_footfinger_3_1\",\n    \"003_right_footfinger_4_1\",\n    \"024_left_footfinger_4_1\",\n    \"026_left_footfinger_3_1\",\n    \"025_left_footfinger_3_2\",\n\n    \"006_right_footfinger_2_2\",\n    \"007_right_footfinger_2_1\",\n    \"009_right_footfinger_1_1\",\n    \"030_left_footfinger_1_1\",\n    \"028_left_footfinger_2_1\",\n    \"027_left_footfinger_2_2\",\n\n    \"008_right_footfinger_1_2\",\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    \"029_left_footfinger_1_2\",\n]\n","import { Mesh } from \"animorph/Mesh\"\nimport { Reference } from \"toad.jsx/lib/jsx-runtime\"\n\ninterface RefTypes {\n    details: HTMLElement\n}\nexport const refs: RefTypes = {} as any\n\ninterface Tile {\n    // title: string\n    targetName?: string\n    img?: HTMLImageElement\n    imgSrc?: string\n    imgSrcOver?: string\n}\nlet tiles: Tile[]\n\nlet selectedTile: number | undefined = undefined\n\nexport function bodyDetailsPanel(mesh: Mesh) {\n    mesh.morphMode()\n    const panel: HTMLElement[] = []\n    tiles = new Array<Tile>(detailTargets.length)\n    for (let tileIdx = 0; tileIdx < detailTargets.length; ++tileIdx) {\n        panel.push(createTile(mesh, tileIdx))\n    }\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Body Details</div>\n            <div id=\"panel\" style={{ lineHeight: \"0\" }}>\n                {...panel}\n            </div>\n            <div id=\"details\" set={new Reference(refs, \"details\")}></div>\n        </>\n    )\n}\n\nfunction createTile(mesh: Mesh, tileIdx: number): HTMLElement {\n    const target = detailTargets[tileIdx]\n    tiles[tileIdx] = { targetName: target }\n    const row = Math.floor(tileIdx / 6)\n    const col = tileIdx % 6\n    let src: string\n    let num\n    if (col < 2) {\n        src = \"body\"\n        num = 1 + col + row * 2\n    } else {\n        if (row < 6) {\n            src = \"face\"\n            num = 1 + col - 2 + row * 4\n        } else {\n            src = \"hands\"\n            num = 1 + col - 2 + (row - 6) * 4\n        }\n    }\n    src = `${src}_${num.toString().padStart(2, \"0\")}`\n    tiles[tileIdx].imgSrc = `images/ui/${src}.png`\n    tiles[tileIdx].imgSrcOver = `images/ui/${src}_over.png`\n\n    const tileImg = (<img src={tiles[tileIdx].imgSrc} />) as HTMLImageElement\n    const name = detailTargets[tileIdx]\n    if (name !== undefined) {\n        const title = name.at(0)!.toUpperCase() + name.substring(1).replace(\"_\", \" \")\n        tileImg.title = title\n        tileImg.onpointerenter = () => {\n            tileImg.src = tiles[tileIdx].imgSrcOver!\n        }\n        tileImg.onpointerleave = () => {\n            if (selectedTile !== tileIdx) {\n                tileImg.src = tiles[tileIdx].imgSrc!\n            }\n        }\n        tileImg.onpointerdown = () => {\n            const details = (\n                <>\n                    <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>{title}</div>\n                </>\n            )\n            mesh.targetmap.forEach((targetEntry, name) => {\n                if (name.startsWith(`${tiles[tileIdx].targetName}/`)) {\n                    details.push(createKnob(mesh, name))\n                }\n            })\n            refs.details.replaceChildren(...details)\n\n            if (selectedTile !== undefined && selectedTile !== tileIdx) {\n                tiles[selectedTile].img!.src = tiles[selectedTile].imgSrc!\n            }\n            selectedTile = tileIdx\n        }\n    }\n    tiles[tileIdx].img = tileImg\n    return tileImg\n}\n\nfunction createKnob(mesh: Mesh, name: string) {\n    const imgSrc = `images/target/${name.substring(0, name.length - 7)}.png`\n\n    const detail = (\n        <div style={{ display: \"inline-block\", textAlign: \"center\" }}>\n            <img width=\"64\" height=\"64\" title={name} src={imgSrc} />\n            <div></div>\n        </div>\n    ) as HTMLElement\n\n    let lastValue = 0,\n        downX: number | undefined\n\n    const img = detail.children[0] as HTMLImageElement\n    const txt = detail.children[1] as HTMLDivElement\n    const setValue = (value: number) => {\n        value /= 100.0\n        const v = mesh.doMorph(name, value)\n        txt.innerText = v.toPrecision(2)\n        if (isZero(value)) {\n            value = 0\n        }\n        if (isEqual(value, 1)) {\n            value = 1\n        }\n        if (v !== 0) {\n            txt.style.color = \"#f00\"\n        } else {\n            txt.style.color = \"\"\n        }\n    }\n    setValue(mesh.getMorph(name) * 100)\n\n    img.onpointerenter = (ev: PointerEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerleave = (ev: PointerEvent) => {\n        ev.preventDefault()\n    }\n    img.oncontextmenu = (ev: MouseEvent) => {\n        ev.preventDefault()\n    }\n    img.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        img.setPointerCapture(ev.pointerId)\n        switch (ev.button) {\n            case 0:\n                lastValue = mesh.getMorph(name) * 100\n                downX = ev.x\n                break\n            case 2:\n                setValue(0)\n                break\n        }\n    }\n    img.onpointerup = (ev: PointerEvent) => {\n        ev.preventDefault()\n        downX = undefined\n    }\n    img.onpointermove = (ev: PointerEvent) => {\n        ev.preventDefault()\n        if (downX !== undefined) {\n            setValue(lastValue! + ev.x - downX)\n        }\n    }\n\n    return detail\n}\n\nconst epsilon = 0.00001\n\nfunction isZero(a: number): boolean {\n    return Math.abs(a) <= epsilon\n}\nfunction isEqual(a: number, b: number) {\n    return isZero(a - b)\n}\n\n// prettier-ignore\nconst detailTargets: (string | undefined)[] = [\n    \"torso\", \"head\", undefined, undefined, undefined, undefined, \n    \"shoulders\", \"neck\", undefined, \"forehead\", undefined, undefined,\n    \"upper_arms\", undefined, undefined, \"eyes\", undefined, undefined,\n    \"lower_arms\", \"abdomen\", \"nose\", \"cheek\", \"ears\", undefined,\n    \"hands\", \"pelvis\", \"mouth\", undefined, undefined, undefined,\n    \"upper_legs\", undefined, \"chin_jaw\", undefined, undefined, undefined,\n    undefined, undefined, \"forefinger\", \"middlefinger\", \"ringfinger\", undefined,\n    \"lower_legs\", undefined, \"pollex\", undefined, \"littlefinger\", undefined,\n    \"feet\", undefined, undefined, undefined, undefined, undefined\n]\n","import { Mesh } from \"animorph/Mesh\"\nimport { SelectorListener } from \"SelectorListener\"\nimport { Selector } from \"Selector\"\n\nfunction createSelectorView(listener: SelectorListener, selector: Selector, name: string) {\n    const view = (\n        <div style={{ position: \"relative\" }}>\n            <div\n                style={{\n                    pointerEvents: \"none\",\n                    position: \"absolute\",\n                    left: `${selector.cursorPos.x - 3}px`,\n                    top: `${104 - selector.cursorPos.y - 3}px`,\n                    width: \"6px\",\n                    height: \"6px\",\n                    border: \"0\",\n                    background: \"#f00\",\n                }}\n            ></div>\n            <img src={`images/ui/${name}_selector.png`} />\n        </div>\n    ) as HTMLDivElement\n    const caret = view.children[0] as HTMLDivElement\n    const set = (ev: PointerEvent) => {\n        selector.setCursorPos(ev.offsetX, 104 - ev.offsetY)\n        caret.style.left = `${selector.cursorPos.x - 3}px`\n        caret.style.top = `${104 - selector.cursorPos.y - 3}px`\n        listener.calcWidgetTargets()\n    }\n    view.onpointerdown = (ev: PointerEvent) => {\n        ev.preventDefault()\n        view.setPointerCapture(ev.pointerId)\n        set(ev)\n    }\n    view.onpointermove = (ev: PointerEvent) => {\n        if (ev.buttons !== 0) {\n            set(ev)\n        }\n    }\n    return view\n}\n\nexport function characterPanel(mesh: Mesh) {\n    const mgr = mesh.mgr\n    mesh.morphMode()\n    return (\n        <>\n            <div style={{ padding: \"5px\", fontWeight: \"bold\" }}>Character</div>\n            {createSelectorView(mgr, mgr.age, \"age\")}\n            {createSelectorView(mgr, mgr.muscleSize, \"muscle_size\")}\n            {createSelectorView(mgr, mgr.breast, \"breast\")}\n            {createSelectorView(mgr, mgr.shape, \"shape\")}\n        </>\n    )\n}\n","import { posesBodyPanel } from \"PosePanel\"\nimport { Mesh } from \"animorph/Mesh\"\nimport { bodyDetailsPanel } from \"DetailPanel\"\nimport { Fragment, Reference } from \"toad.jsx/lib/jsx-runtime\"\nimport { characterPanel } from \"CharacterPanel\"\nimport { SelectorListener } from \"SelectorListener\"\n\ninterface RefTypes {\n    panel: HTMLDivElement\n}\nconst refs: RefTypes = {} as any\n\nenum TAB {\n    LOAD,\n    SAVE,\n    CHARACTER,\n    DETAILS,\n    POSE,\n}\n\ninterface ToolDef {\n    id: TAB\n    file: string\n    desc: string\n    img?: HTMLImageElement\n    render?: (mesh: Mesh) => Fragment\n}\n\nconst toolbarDefinition: ToolDef[] = [\n    { id: TAB.LOAD, file: \"load\", desc: \"Load body setting\" },\n    { id: TAB.SAVE, file: \"save\", desc: \"Save body setting\" },\n    {\n        id: TAB.CHARACTER,\n        file: \"charac_sett\",\n        desc: \"Character setting (somatypes, shapes, age, etc...)\",\n        render: (mesh: Mesh) => characterPanel(mesh),\n    },\n    {\n        id: TAB.DETAILS,\n        file: \"body_det_real\",\n        desc: \"Body details (realistic morphings)\",\n        render: (mesh: Mesh) => bodyDetailsPanel(mesh),\n    },\n    { id: TAB.POSE, file: \"poses\", desc: \"Reset mesh\", render: (mesh: Mesh) => posesBodyPanel(mesh) },\n]\n\nlet activeTab: ToolDef | undefined\nfunction setTab(mesh: Mesh, tab: ToolDef) {\n    if (activeTab) {\n        activeTab.img!.src = `images/ui/toolbar_${activeTab.file}.png`\n    }\n    activeTab = tab\n    activeTab.img!.src = `images/ui/toolbar_${activeTab.file}_over.png`\n    if (tab.render !== undefined) {\n        refs.panel.replaceChildren(...tab.render(mesh))\n    } else {\n        refs.panel.replaceChildren()\n    }\n}\n\nfunction toolbarPanel(mesh: Mesh): HTMLElement[] {\n    return toolbarDefinition.map((it) => {\n        const img = (<img src={`images/ui/toolbar_${it.file}.png`} title={it.desc} />) as HTMLImageElement\n        it.img = img\n        img.onpointerenter = () => {\n            img.src = `images/ui/toolbar_${it.file}_over.png`\n        }\n        img.onpointerleave = () => {\n            if (it !== activeTab) {\n                img.src = `images/ui/toolbar_${it.file}.png`\n            }\n        }\n        img.onpointerdown = () => {\n            setTab(mesh, it)\n        }\n        return img\n    })\n}\n\nexport default (mesh: Mesh) => {\n    const page = (\n        <>\n            <div\n                style={{\n                    position: \"absolute\",\n                    display: \"block\",\n                    left: \"0\",\n                    top: \"0\",\n                    bottom: \"0\",\n                    width: \"192px\",\n                }}\n            >\n                <div id=\"toolbar\" style={{ lineHeight: \"0\" }}>\n                    {...toolbarPanel(mesh)}\n                    <img src=\"images/ui/toolbar_reset.png\" title=\"Reset mesh\" onpointerdown={() => mesh.clear()} />\n                </div>\n                <div set={new Reference(refs, \"panel\")}></div>\n            </div>\n            <div\n                style={{\n                    position: \"absolute\",\n                    left: \"192px\",\n                    top: \"0px\",\n                    bottom: \"0px\",\n                    right: \"0px\",\n                }}\n            >\n                <canvas\n                    style={{\n                        width: \"100%\",\n                        height: \"100%\",\n                    }}\n                />\n            </div>\n        </>\n    ) as Fragment\n\n    setTab(mesh, toolbarDefinition[2])\n\n    return page\n}\n","import { FileSystemAdapter } from \"./filesystem/FileSystemAdapter\"\nimport { HTTPFSAdapter } from \"./filesystem/HTTPFSAdapter\"\nimport { Mesh } from \"./animorph/Mesh\"\nimport { renderMesh } from \"renderMesh\"\nimport screen from \"./screen\"\n\nexport function main() {\n    console.log(`mh091rc1a (Makehuman 0.9.1-rc1a clone)`)\n    FileSystemAdapter.setInstance(new HTTPFSAdapter())\n    const mesh = new Mesh()\n    document.body.replaceChildren(...screen(mesh))\n    const canvas = document.body.querySelector(\"canvas\") as HTMLCanvasElement\n    renderMesh(canvas, mesh)\n}\n\ntry {\n    main()\n} catch (e) {\n    console.log(e)\n}\n"],"names":["FileSystemAdapter","setInstance","instance","readFile","pathname","exists","isFile","isDir","listDir","realPath","joinPath","pathname1","pathname2","u8","Uint8Array","u16","Uint16Array","i32","Int32Array","fleb","fdeb","clim","freb","eb","start","b","i","r","j","_a","fl","revfl","fd","rev","x","hMap","cd","mb","s","length","l","co","le","rvb","sv","r_1","v","m","flt","fdt","flrm","fdrm","max","a","bits","d","p","o","bits16","ec","err","ind","msg","nt","e","Error","code","captureStackTrace","inflt","dat","st","buf","dict","sl","dl","f","noBuf","resize","noSt","cbuf","bl","nbuf","Math","set","final","pos","bt","lm","dm","lbt","dbt","n","tbts","type","t","subarray","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","c","lt","dt","lms","dms","lpos","sym","add","dsym","end","shift","dend","min","slc","et","unzlibSync","data","opts","dictionary","out","td","TextDecoder","decode","stream","HTTPFSAdapter","debug","console","log","endsWith","req","XMLHttpRequest","overrideMimeType","open","send","status","statusText","ab","ArrayBuffer","responseText","ua","charCodeAt","this","info","directoryCache","get","undefined","slash","lastIndexOf","substring","dir","includes","file","JSON","parse","fullfile","push","Map","ARRAY_TYPE","Float32Array","Array","create","glMatrix.ARRAY_TYPE","rotateX","rad","sin","cos","a10","a11","a12","a13","a20","a21","a22","a23","rotateY","a00","a01","a02","a03","rotateZ","hypot","y","arguments","sqrt","perspective","fovy","aspect","near","far","nf","tan","Infinity","fromValues","z","subtract","scale","normalize","len","cross","ax","ay","az","bx","by","bz","transformMat4","w","RecursiveLevel","FileType","RotateAxis","sub","Face","size","vertices","constructor","v0","v1","v2","v3","material_index","no","vec3.create","StringToLineIterator","index","next","value","done","nextIndex","indexOf","result","substr","StringToLine","Symbol","iterator","FaceVector","loadGeometry","filename","reader","triangles","quads","line","trim","tokens","split","parseFloat","Vertex","xOrVertex","vec3.fromValues","VertexVector","load","clone","setFrom","src","DirectoryList","file_list","file_filter","path","recursive_level","recursive_counter","file_type","REGULAR_FILE","setFileFilter","setRecursive","setRootPath","setFileType","getDirectoryList","readDirRecursive","dir_str","dname","charAt","dir_file","DIRECTORY","NO_LIMIT","hasFileFilterEnding","UnsortedUsedVertex","Target","modVertex","vertex_number","parseInt","morph_vector","getModVertex","TargetEntry","preload","mTarget","mTargetLoadTry","mFilename","loadFromFile","getTarget","PoseRotation","hasCenter","minAngle","maxAngle","cat","clear","map","it","str","minMax","rotation","axis","X_AXIS","Y_AXIS","Z_AXIS","centerVertexNumbers","getCenterVertexNumbers","getCenter","center","setCenter","getAxis","getHasCenter","setHasCenter","getMinAngle","getMaxAngle","getNormalize","setNormalize","inNormalize","getCat","setCat","inCat","setLimb","limb","mbLimb","getLimb","MultiSet","order","array","entries","last","eraseLast","first","eraseFirst","splice","insert","k","firstIndex","lastIndex","middleIndex","floor","PoseTranslation","target","formFactor","inFilename","originalSize","calcFormFactor","vertexvector","minXSet","maxXSet","minYSet","maxYSet","minZSet","maxZSet","counter","n_vertex","tmpTarget","FF_VERTEX_N","getVec3","minX","maxX","minY","maxY","minZ","maxZ","xsize","ysize","zsize","getFormFactor","getFilename","calcCenteroid","vertexNumbers","vn","vec3.add","vec3.scale","PoseTarget","targetName","fullpath","positiveTranslations","negativeTranslations","positiveRotations","negativeRotations","negative","positive","normalizationInited","Set","fullPath","dir_list","files","target_name","tmpRotation","forEach","idx","tmpTranslation","calcRotationsCenteroids","rotations","rotations_it","calcTranslationsFormFactors","translations","translations_it","calcNormalizations","hasNegative","hasPositive","getPositiveTranslations","getNegativeTranslations","getPositiveRotations","getNegativeRotations","PoseEntry","mFullPath","isLoaded","FaceGroup","loaded","vertexes","fgroup_indent","content","ch","visible","facesIndexes","jsx","nameOrConstructor","props","key","children","jsxs","namespace","name","tag","document","createElementNS","setInitialProperties","element","Object","setAction","setModel","classList","skey","svalue","regex","replace","upperCase","toLowerCase","style","setProperty","defineProperty","object","attribute","addEventListener","setAttributeNS","appendChildren","child","appendChild","createTextNode","css","strings","values","concat","createElement","text","div","span","slot","input","button","ul","li","ns","svg","SignalLink","callback","id","Signal","locked","busy","callbacks","remove","count","lock","unlock","triggered","trigger","withLock","closure","error","ModelReason","ValueModelReason","NumberModelReason","Model","options","modified","enabled","ENABLED","color","COLOR","label","LABEL","description","DESCRIPTION","ERROR","applyStyle","removeAttribute","setAttribute","fontStyle","fontWeight","AbstractValueModel","aDefault","default","DEFAULT","resetToDefault","ValueModel","super","_value","VALUE","BooleanModel","BigDecimal","_n","ints","decis","String","BigInt","padEnd","DECIMALS","slice","ROUNDED","fromBigInt","bigint","assign","prototype","num","_divRound","dividend","divisor","mul","SHIFT","toString","padStart","repeat","ExpressionNode","eval","model","getCell","_calculatedValue","down","append","node","dependencies","deps","_toString","indent","Lexer","stack","isspace","isnumber","isalpha","isalnum","unlex","lex","pop","col","row","state","at","additive_expression","lexer","n0","multiplicative_expression","n1","n2","unary_expression","NumberModel","increment","step","clip","decrement","number","ex","autocorrect","check","MIN","MAX","STEP","AUTOCORRECT","TextModel","promise","trace","HtmlModel","Action","signal","_","getAttribute","nodeName","attributeOrUndefined","globalController","modelId2Models","modelId2Views","view2ModelIds","sigChanged","registerAction","actionId","action","_registerModel","registerModel","modelId","modelsForModelId","viewsForModelId","view","registerView","controller","modelIdsForView","modelsForView","unregisterView","modelIds","views","delete","entry","bind","html","boolean","AnimationBase","_stop","_firstFrame","_animationFrame","prepare","requestAnimationFrame","stop","animator","current","clearCurrent","animation","animationFrame","lastFrame","firstFrame","window","time","startTime","elapsed","animationFrameCount","ease","_current","PI","AnimationWrapper","Animator","run","animationBase","previousAnimation","halt","View","HTMLElement","define","customElements","getModelId","hasAttribute","getActionId","connectedCallback","disconnectedCallback","ModelView","init","updateModel","updateView","reason","isConnected","ALL","ActionView","Function","isEnabled","CSSStyleSheet","replaceSync","TextField","onkeydown","onblur","oninput","wheel","onwheel","ondblclick","attachShadow","mode","delegatesFocus","shadowRoot","adoptedStyleSheets","txText","preventDefault","deltaY","focus","blur","observedAttributes","attributeChangedCallback","oldValue","newValue","strValue","textAreaStyle","TextTool","texttool","toolbar","_jsx","class","buttonH1","onclick","execCommand","update","buttonH2","buttonH3","buttonH4","buttonBold","buttonItalic","buttonUnderline","buttonStrikeThrough","buttonSubscript","buttonSuperscript","buttonJustifyLeft","_jsxs","viewBox","width","height","x1","y1","x2","y2","buttonJustifyCenter","buttonJustifyRight","toggle","queryCommandValue","queryCommandState","TextArea","contentEditable","event","firstChild","nodeType","innerHTML","metaKey","updateTextTool","shiftKey","onkeyup","onmouseup","innerText","Display","ButtonVariant","Button","variant","PRIMARY","SECONDARY","ACCENT","NEGATIVE","txButton","_observer","MutationObserver","record","observer","_timer","clearTimeout","setTimeout","observe","childList","subtree","characterData","BooleanView","checked","Checkbox","onchange","checkmark","txCheckbox","replaceChildren","Search","s0","s1","form","placeholder","autocomplete","txSearch","Switch","txSwitch","RadioButton","disabled","txRadio","radioGroup","radioGroups","radioGroupCounter","childNodes","labelOf","isEnabledOf","MenuState","WeakMap","MenuButtonContainer","vertical","closeOnClose","WAIT","PopupMenu","root","parent","parentButton","popup","isAvailable","createWindowAt","deleteWindow","show","master","parentBoundary","getBoundingClientRect","opacity","left","top","popupBoundary","innerHeight","innerWidth","placePopupHorizontal","placePopupVertical","display","hide","popupBottom","SelectBase","pointerup","pointermove","pointerdown","keydown","tabIndex","outline","onpointerdown","onpointermove","onpointerup","txCombobox","txMenu","finalize","displayElement","ev","prev","togglePopup","close","setPointerCapture","pointerId","newHover","findMenuItem","hover","elementFromPoint","clientX","clientY","parentElement","contains","dataset","select","asHtml","ariaRoleDescription","position","zIndex","focusToItem","removeChild","Select","minWidth","ComboBox","textModel","Number","parseColor","g","match","Slider","container","rail","track","thumb","slider","orientation","minColor","maxColor","skew","setGradient","onfocus","txSlider","rot","backgroundImage","backgroundColor","GenericTool","focusIn","viewParents","distance","closestParent","closestTool","closestToolDistance","MAX_SAFE_INTEGER","closestToolList","tool","allTools","canHandle","toolParent","depth","toolDistance","viewIndex","getIndex","closestNextSiblingIndex","MIN_SAFE_INTEGER","toolIndex","setActive","from","activeTool","deactivate","activeView","activate","focusOut","relatedTarget","toolbuttonStyle","ToolButton","SlotView","ToadIf","Tabs","lineContainer","tabContainer","labelMap","activateTab","markerLine","activeLabel","activePanel","Tab","panel","tabLabel","stopPropagation","txTabs","txScrollbar","tab","adjustLine","offsetTop","clientHeight","offsetLeft","clientWidth","Promise","then","module","viewOrViewFunction","viewOrPromise","menuStyle","btoa","MenuButton","menuButton","onmousedown","documentMouseUp","removeEventListener","capture","buttonDown","dispatchEvent","MouseEvent","DOWN","UP_N_HOLD","active","DOWN_N_HOLD","documentMouseDown","tagName","collapse","DOWN_N_OUTSIDE","DOWN_N_INSIDE_AGAIN","onmouseout","inside","onmouseover","title","insertBefore","openPopup","closePopup","oldActive","MenuNode","shortcut","parentView","flexGrow","Menu","config","config2nodes","referenceActions","createShadowDOM","layout2nodes","newnode","dom.attribute","dom.attributeOrUndefined","space","findNode","strpos","right","MenuSpacer","TableModel","isEmpty","colCount","rowCount","TableEditMode","EditMode","TableEventType","TablePos","SelectionModel","EDIT_CELL","TypedTableModel","nodeClass","TableAdapterConfig","editMode","EDIT_ON_FOCUS","seamless","expandColumn","expandRow","TableAdapter","getColumnHead","getRowHead","showCell","cell","saveCell","editCell","isViewCompact","register","adapter","typeToModel","modelToAdapter","has","unbind","lookup","dataType","typeToAdapter","getPrototypeOf","baseClass","keys","modelX","typeToAdapterX","typeX","adapterX","TableEvent","TableFriend","table","logger","measure","getStaging","bodyStaging","getHeadStaging","headStaging","body","splitBody","colHeads","rowHeads","colResizeHandles","rowResizeHandles","animationDone","selection","setCellSize","h","clearAnimation","TableAnimation","prepareStagingWithRows","prepareBodyStaging","prepareRowHeadStaging","addStaging","scrollStaging","prepareStagingWithColumns","prepareColHeadStaging","className","disposeStaging","removeStaging","makeRowMask","mask","boxSizing","border","Table","maskColor","makeColumnMask","bottom","InsertAnimation","prepareCellsToBeMeasured","prepareStaging","arrangeInStaging","animate","animationStart","totalSize","join","joinHeader","joinBody","InsertRowAnimation","initialRowCount","splitHead","headMask","prepareMinCellSize","rowHeaders","colHeaders","createCell","calculateMinCellSize","overlap","px2float","colWidth","bounds","fill","minCellWidth","rowHeadWidth","rowHeight","minCellHeight","ceil","colHeadHeight","WIDTH_ADJUST","HEIGHT_ADJUST","splitHorizontalNew","lastElementChild","RemoveRowAnimation","joinHorizontal","initialHeight","bottomCell","removeAll","arrangeRowsInStaging","splitHorizontal","topSplitBody","animationHeight","topMask","cellCount","bottomOfStaging","moveSplitBodyToBody","moveSplitHeadToHead","InsertColumnAnimation","previousColCount","px2int","totalWidth","columnWidth","splitVerticalNew","bodyWidth","stagingWidth","splitWidth","bodyInsertAt","beforeChild","RemoveColumnAnimation","joinVertical","initialWidth","arrangeColumnsInStaging","splitVertical","leftSplitBody","animationWidth","leftMask","firstCellOfStaging","lastCellOfStaging","rightOfStaging","scrollIntoView","scrollableParent","el","isScrollable","findScrollableParent","parentRect","clientRect","GAP","clientLeft","scrollLeft","clientRight","clientTop","scrollTop","clientBottom","parentWidth","parentHeight","calculateScrollGoal","scrollable","startX","startY","activeGoal","concurrentScroll","scrollX","pageXOffset","scrollY","pageYOffset","deltaX","nx","ny","scrollTo","animateStep","smoothScroll","getComputedStyle","scrollBy","behavior","idSource","Date","now","userAgent","ROUNDING_TOLERANCE","navigator","RegExp","test","isScrollableY","hasScrollableSpace","canOverflow","isScrollableX","scrollWidth","scrollHeight","overflowValue","isVisible","HANDLE_SIZE","HANDLE_SKEW","prepareInProgress","loggerType","arrangeAllMeasuredInGrid","hostKeyDown","cellKeyDown","cellFocus","pointerDown","handleDown","handleMove","handleUp","setHeadingFillerSizeToScrollbarSize","selectionChanged","modelChanged","onresize","onscroll","txTable","selectionModel","mutations","allTables","prepareCells","attributes","SELECT_CELL","elements","editing","SELECT_ROW","EDIT_ON_ENTER","clientPosToTablePos","getModel","activeElement","hasFocus","CELL_CHANGED","HTMLSpanElement","INSERT_ROW","REMOVE_ROW","INSERT_COL","REMOVE_COL","prepareColumnHeads","prepareRowHeads","prepareBody","colWidths","calculateColumnWidths","rowHeights","calculateRowHeights","placeColumnHeads","placeRowHeads","placeBody","placeBodyCells","measureLineHeight","columnHeaders","caretColor","rh","withinBody","idxStart","cw","seam","filler","handle","createHandle","rowHandle","handleIndex","deltaHandle","deltaSplitBody","deltaSplitHead","deltaColumn","xLimit","yLimit","splitCol","splitHeadVertical","splitBodyVertical","splitColor","colsToSplit","boundary","splitColumn","extra","splitBodyColumns","cloneNode","delta","splitRow","splitHeadHorizontal","splitBodyHorizontal","cellAtBottom","splitBodyRows","bf","print","isRowEditInterface","isColumnEditInterface","buttonAddRowAbove","lastActiveTable","insertRow","buttonAddRowBelow","buttonDeleteRow","removeRow","buttonAddColumnLeft","insertColumn","buttonAddColumnRight","buttonDeleteColumn","removeColumn","buttonAddNodeAbove","buttonAddNodeBelow","buttonAddNodeParent","buttonAddNodeChild","buttonDeleteNode","Selector","rows","cols","labels","cursorPos","points","cellWidth","cellHeight","cellRatio","maxValue","setCursorPos","dists","getDists","tmp","pow","SelectorListener","mesh","age","muscleSize","breast","shape","doMorph","morph_value","calcWidgetTargets","ageDists","muscleSizeDists","breastDists","shapeDists","di_it","tmpTargetName","ms_it","tmpTargetValue","br_it","sh_it","VectorArray","setVec3","TargetMap","PoseMap","Mode","Mesh","changed","dirty","poseChanged","MORPH","poses","BodySettings","bodyset","facevector","facegroup","targetmap","posemap","loadMeshFactory","loadGroupsFactory","loadTargetsFactory","loadPoseTargetsFactory","mgr","morphMode","markDirty","poseMode","initPoses","POSE","getVertexes","vertexMorphed","vertexPosed","clearMorph","clearPose","vertexBase","updatePose","meshFilename","facesFilename","vertex","groups_filename","targetRootPath","recursiveLevel","clearmap","targetEntry","poseEntry","setPose","poseTarget","getPoseTargetForName","getPose","sort","doPose","getTargetForName","pt","doPoseTranslation","pr","doPoseRotation","real_value","rotMatrix","mat4.create","M_PI_180","theta","mat4.rotateX","mat4.rotateY","mat4.rotateZ","vec3.sub","vec3.transformMat4","real_morph_value","bs_morph_value","getMorph","calculateNormalsQuads","normals","indices","addNormal","normal","i1","i2","i3","i4","p1","p2","p3","u","vec3.subtract","vec3.cross","vec3.normalize","normalIndex","calculateNormalsTriangles","RenderMesh","gl","fvertex","uvs","fuvs","glIndices","createBuffer","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","glVertex","ARRAY_BUFFER","glNormal","glData","xyz","fxyz","uv","fuv","uvOut","idxExtra","xyzOutExtra","uvOutExtra","decoupleXYZandUV","idxXYZ","xyzIdx","uvIdx","newIdxXYZ","idxXYZIn","i0","texcoord","glTexture","updateBuffer","draw","programInfo","drawElements","UNSIGNED_SHORT","drawSubset","offset","usage","buffer","bindBuffer","Int16Array","bufferData","AbstractShader","vertexShaderSrc","fragmentShaderSrc","program","createProgram","vertexShader","compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","vertexPosition","getAttribLocation","vertexNormal","projectionMatrix","getUniformLocation","modelViewMatrix","normalMatrix","normales","texture","FLOAT","vertexAttribPointer","enableVertexAttribArray","initProgram","initProjectionMatrix","initModelViewMatrix","initNormalMatrix","useProgram","uniformMatrix4fv","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","deleteShader","getShaderInfoLog","location","RGBAShader","rgbaVertexShaderSrc","rgbaFragmentShaderSrc","_color","setColor","rgba","uniform4fv","renderMesh","canvas","faceGroups","group","faceIdx","face","getContext","programRGBA","pixelStorei","UNPACK_FLIP_Y_WEBGL","enable","CULL_FACE","cullFace","BACK","lastX","lastY","paint","adjustCanvasSize","fieldOfView","mat4.perspective","createProjectionMatrix","D","mat4.translate","createModelViewMatrix","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","mat4.transpose","createNormalMatrix","viewport","clearColor","clearDepth","DEPTH_TEST","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","depthMask","prepareViewport","TRIANGLES","ResizeObserver","downX","downY","Reference","writable","fromString","outValue","Fragment","replaceIn","appendTo","refs","tiles","selectedJoint","createTile","jointIdx","poseTargets","tileImg","img","toUpperCase","replaceAll","onpointerenter","onpointerleave","details","_Fragment","padding","startsWith","img0","img1","detail","textAlign","lastValue","txt","setValue","round","oncontextmenu","createKnob","selectedTile","tileIdx","detailTargets","imgSrc","imgSrcOver","toPrecision","isZero","epsilon","abs","createSelectorView","listener","selector","pointerEvents","background","caret","offsetX","offsetY","buttons","TAB","toolbarDefinition","LOAD","desc","SAVE","CHARACTER","render","characterPanel","DETAILS","lineHeight","bodyDetailsPanel","posesBodyPanel","activeTab","setTab","toolbarPanel","main","page","screen","querySelector"],"mappings":"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","x_google_ignoreList":[1,3,4,5,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,110]}